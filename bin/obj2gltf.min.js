!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).obj2gltf=t()}(this,(function(){"use strict";var e="undefined"!=typeof document?document.currentScript:null,t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var r,o,i={exports:{}},s={};var a,u,c,l={exports:{}};function f(){return u||(u=1,function(e){var n=/%[sdj%]/g;e.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var o=arguments,i=o.length,s=String(e).replace(n,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(o[r++]);case"%d":return Number(o[r++]);case"%j":try{return JSON.stringify(o[r++])}catch(e){return"[Circular]"}default:return e}})),a=o[r];r<i;a=o[++r])_(a)||!w(a)?s+=" "+a:s+=" "+u(a);return s},e.deprecate=function(n,r){if(E(t.process))return function(){return e.deprecate(n,r).apply(this,arguments)};if(!0===process.noDeprecation)return n;var o=!1;return function(){if(!o){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,s={};function u(t,n){var r={seen:[],stylize:f};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&e._extend(r,n),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),p(r,t,r.depth)}function c(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function f(e,t){return e}function p(t,n,r){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return b(o)||(o=p(t,o,r)),o}var i=function(e,t){if(E(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(g(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(_(t))return e.stylize("null","null")}(t,n);if(i)return i;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),T(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(x(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(O(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(v(n))return t.stylize(Date.prototype.toString.call(n),"date");if(T(n))return h(n)}var c,l="",f=!1,w=["{","}"];(m(n)&&(f=!0,w=["[","]"]),x(n))&&(l=" [Function"+(n.name?": "+n.name:"")+"]");return O(n)&&(l=" "+RegExp.prototype.toString.call(n)),v(n)&&(l=" "+Date.prototype.toUTCString.call(n)),T(n)&&(l=" "+h(n)),0!==s.length||f&&0!=n.length?r<0?O(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=f?function(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)I(t,String(s))?i.push(d(e,t,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(t,n,r,a,s):s.map((function(e){return d(t,n,r,a,e,f)})),t.seen.pop(),function(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,w)):w[0]+l+w[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),I(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(u.value)<0?(a=_(n)?p(e,u.value,null):p(e,u.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),E(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function m(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function _(e){return null===e}function g(e){return"number"==typeof e}function b(e){return"string"==typeof e}function E(e){return void 0===e}function O(e){return w(e)&&"[object RegExp]"===R(e)}function w(e){return"object"==typeof e&&null!==e}function v(e){return w(e)&&"[object Date]"===R(e)}function T(e){return w(e)&&("[object Error]"===R(e)||e instanceof Error)}function x(e){return"function"==typeof e}function R(e){return Object.prototype.toString.call(e)}function A(e){return e<10?"0"+e.toString(10):e.toString(10)}e.debuglog=function(t){if(E(i)&&(i=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=process.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=m,e.isBoolean=y,e.isNull=_,e.isNullOrUndefined=function(e){return null==e},e.isNumber=g,e.isString=b,e.isSymbol=function(e){return"symbol"==typeof e},e.isUndefined=E,e.isRegExp=O,e.isObject=w,e.isDate=v,e.isError=T,e.isFunction=x,e.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},e.isBuffer=o?r:(o=1,r=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8});var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[A(t.getHours()),A(t.getMinutes()),A(t.getSeconds())].join(":"),[t.getDate(),S[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=(a||(a=1,"function"==typeof Object.create?l.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:l.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}),l.exports),e._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}(s)),s}var p,h=function(){if(c)return i.exports;c=1;var e="win32"===process.platform,t=f();function n(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(o))}return n}function r(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var o=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,s=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,a={};function u(e){var t=o.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",i=s.exec(r);return[n,i[1],i[2],i[3]]}function l(e){var t=o.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function p(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}a.resolve=function(){for(var e="",r="",o=!1,i=arguments.length-1;i>=-1;i--){var s;if(i>=0?s=arguments[i]:e?(s=process.env["="+e])&&s.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(s=e+"\\"):s=process.cwd(),!t.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var a=l(s),u=a.device,c=a.isUnc,f=a.isAbsolute,h=a.tail;if((!u||!e||u.toLowerCase()===e.toLowerCase())&&(e||(e=u),o||(r=h+"\\"+r,o=f),e&&o))break}}return c&&(e=p(e)),e+(o?"\\":"")+(r=n(r.split(/[\\\/]+/),!o).join("\\"))||"."},a.normalize=function(e){var t=l(e),r=t.device,o=t.isUnc,i=t.isAbsolute,s=t.tail,a=/[\\\/]$/.test(s);return(s=n(s.split(/[\\\/]+/),!i).join("\\"))||i||(s="."),s&&a&&(s+="\\"),o&&(r=p(r)),r+(i?"\\":"")+s},a.isAbsolute=function(e){return l(e).isAbsolute},a.join=function(){for(var e=[],n=0;n<arguments.length;n++){var r=arguments[n];if(!t.isString(r))throw new TypeError("Arguments to path.join must be strings");r&&e.push(r)}var o=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(o=o.replace(/^[\\\/]{2,}/,"\\")),a.normalize(o)},a.relative=function(e,t){e=a.resolve(e),t=a.resolve(t);for(var n=e.toLowerCase(),o=t.toLowerCase(),i=r(t.split("\\")),s=r(n.split("\\")),u=r(o.split("\\")),c=Math.min(s.length,u.length),l=c,f=0;f<c;f++)if(s[f]!==u[f]){l=f;break}if(0==l)return t;var p=[];for(f=l;f<s.length;f++)p.push("..");return(p=p.concat(i.slice(l))).join("\\")},a._makeLong=function(e){if(!t.isString(e))return e;if(!e)return"";var n=a.resolve(e);return/^[a-zA-Z]\:\\/.test(n)?"\\\\?\\"+n:/^\\\\[^?.]/.test(n)?"\\\\?\\UNC\\"+n.substring(2):e},a.dirname=function(e){var t=u(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},a.basename=function(e,t){var n=u(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},a.extname=function(e){return u(e)[3]},a.format=function(e){if(!t.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var n=e.root||"";if(!t.isString(n))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var r=e.dir,o=e.base||"";return r?r[r.length-1]===a.sep?r+o:r+a.sep+o:o},a.parse=function(e){if(!t.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var n=u(e);if(!n||4!==n.length)throw new TypeError("Invalid path '"+e+"'");return{root:n[0],dir:n[0]+n[1].slice(0,-1),base:n[2],ext:n[3],name:n[2].slice(0,n[2].length-n[3].length)}},a.sep="\\",a.delimiter=";";var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,d={};function m(e){return h.exec(e).slice(1)}return d.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var i=o>=0?arguments[o]:process.cwd();if(!t.isString(i))throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i[0])}return(r?"/":"")+(e=n(e.split("/"),!r).join("/"))||"."},d.normalize=function(e){var t=d.isAbsolute(e),r=e&&"/"===e[e.length-1];return(e=n(e.split("/"),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},d.isAbsolute=function(e){return"/"===e.charAt(0)},d.join=function(){for(var e="",n=0;n<arguments.length;n++){var r=arguments[n];if(!t.isString(r))throw new TypeError("Arguments to path.join must be strings");r&&(e+=e?"/"+r:r)}return d.normalize(e)},d.relative=function(e,t){e=d.resolve(e).substr(1),t=d.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),s=i,a=0;a<i;a++)if(n[a]!==o[a]){s=a;break}var u=[];for(a=s;a<n.length;a++)u.push("..");return(u=u.concat(o.slice(s))).join("/")},d._makeLong=function(e){return e},d.dirname=function(e){var t=m(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},d.basename=function(e,t){var n=m(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},d.extname=function(e){return m(e)[3]},d.format=function(e){if(!t.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var n=e.root||"";if(!t.isString(n))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+d.sep:"")+(e.base||"")},d.parse=function(e){if(!t.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var n=m(e);if(!n||4!==n.length)throw new TypeError("Invalid path '"+e+"'");return n[1]=n[1]||"",n[2]=n[2]||"",n[3]=n[3]||"",{root:n[0],dir:n[0]+n[1].slice(0,-1),base:n[2],ext:n[3],name:n[2].slice(0,n[2].length-n[3].length)}},d.sep="/",d.delimiter=":",i.exports=e?a:d,i.exports.posix=d,i.exports.win32=a,i.exports}(),d=n(h),m={exports:{}};var y=(p||(p=1,function(e){e.exports=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof _dereq_&&_dereq_;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,(function(e){var n=t[s][1][e];return o(n||e)}),l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){t.exports=function(e){var t=e._SomePromiseArray;function n(e){var n=new t(e),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}},{}],2:[function(e,t,n){var r;try{throw new Error}catch(e){r=e}var o=e("./schedule"),i=e("./queue");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=o}function a(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function u(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function c(e){this._normalQueue._pushOne(e),this._queueTick()}function l(e){for(;e.length()>0;)f(e)}function f(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var n=e.shift(),r=e.shift();t.call(n,r)}}s.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},s.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.prototype.invokeLater=a,s.prototype.invoke=u,s.prototype.settlePromises=c,s.prototype._drainQueues=function(){l(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,l(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},t.exports=s,t.exports.firstLineError=r},{"./queue":26,"./schedule":29}],3:[function(e,t,n){t.exports=function(e,t,n,r){var o=!1,i=function(e,t){this._reject(t)},s=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},a=function(e,t){50397184&this._bitField||this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var c=n(i),l=new e(t);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(c),c instanceof e){var p={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:c};f._then(t,s,void 0,l,p),c._then(a,u,void 0,l,p),l._setOnCancel(c)}else l._resolveCallback(f);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return!(2097152&~this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},{}],4:[function(e,t,n){var r;function o(){try{Promise===i&&(Promise=r)}catch(e){}return i}"undefined"!=typeof Promise&&(r=Promise);var i=e("./promise")();i.noConflict=o,t.exports=i},{"./promise":22}],5:[function(e,t,n){var r=Object.create;if(r){var o=r(null),i=r(null);o[" size"]=i[" size"]=0}t.exports=function(t){var n,r=e("./util"),o=r.canEvaluate;function i(e,n){var o;if(null!=e&&(o=e[n]),"function"!=typeof o){var i="Object "+r.classString(e)+" has no method '"+r.toString(n)+"'";throw new t.TypeError(i)}return o}function s(e){return i(e,this.pop()).apply(e,this)}function a(e){return e[this]}function u(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}r.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(s,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=u;else if(o){var r=n(e);t=null!==r?r:a}else t=a;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,n){t.exports=function(t,n,r,o){var i=e("./util"),s=i.tryCatch,a=i.errorObj,u=t._async;t.prototype.break=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=s(e).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),u.throwLater(r.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,n){t.exports=function(t){var n=e("./util"),r=e("./es5").keys,o=n.tryCatch,i=n.errorObj;function s(e,s,a){return function(u){var c=a._boundValue();e:for(var l=0;l<e.length;++l){var f=e[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(u instanceof f)return o(s).call(c,u)}else if("function"==typeof f){var p=o(f).call(c,u);if(p===i)return p;if(p)return o(s).call(c,u)}else if(n.isObject(u)){for(var h=r(f),d=0;d<h.length;++d){var m=h[d];if(f[m]!=u[m])continue e}return o(s).call(c,u)}}return t}}return s}},{"./es5":13,"./util":36}],8:[function(e,t,n){t.exports=function(e){var t=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function o(){if(t)return new r}function i(){var e=n.length-1;if(e>=0)return n[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var e=n.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},r.CapturedTrace=null,r.create=o,r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=e.prototype._pushContext,o=e.prototype._popContext,s=e._peekContext,a=e.prototype._peekContext,u=e.prototype._promiseCreated;r.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=o,e._peekContext=s,e.prototype._peekContext=a,e.prototype._promiseCreated=u,t=!1},t=!0,e.prototype._pushContext=r.prototype._pushContext,e.prototype._popContext=r.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},r}},{}],9:[function(e,t,n){t.exports=function(t,n,r,o){var i,s,a,u,c=t._async,l=e("./errors").Warning,f=e("./util"),p=e("./es5"),h=f.canAttachTrace,d=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,m=/\((?:timers\.js):\d+:\d+\)/,y=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,_=null,g=null,b=!1,E=!(0==f.env("BLUEBIRD_DEBUG")),O=!(0==f.env("BLUEBIRD_WARNINGS")||!E&&!f.env("BLUEBIRD_WARNINGS")),w=!(0==f.env("BLUEBIRD_LONG_STACK_TRACES")||!E&&!f.env("BLUEBIRD_LONG_STACK_TRACES")),v=0!=f.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(O||!!f.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var e=[];function n(){for(var t=0;t<e.length;++t)e[t]._notifyUnhandledRejection();r()}function r(){e.length=0}u=function(t){e.push(t),setTimeout(n,1)},p.defineProperty(t,"_unhandledRejectionCheck",{value:n}),p.defineProperty(t,"_unhandledRejectionClear",{value:r})}(),t.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},t.prototype._ensurePossibleRejectionHandled=function(){524288&this._bitField||(this._setRejectionIsUnhandled(),u(this))},t.prototype._notifyUnhandledRejectionIsHandled=function(){ee("rejectionHandled",i,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return!!(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),ee("unhandledRejection",s,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(e,t,n){return W(e,t,n||this)},t.onPossiblyUnhandledRejection=function(e){var n=t._getContext();s=f.contextBind(n,e)},t.onUnhandledRejectionHandled=function(e){var n=t._getContext();i=f.contextBind(n,e)};var T=function(){};t.longStackTraces=function(){if(c.haveItemsQueued()&&!le.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!le.longStackTraces&&re()){var e=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace,o=t.prototype._dereferenceTrace;le.longStackTraces=!0,T=function(){if(c.haveItemsQueued()&&!le.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=r,t.prototype._dereferenceTrace=o,n.deactivateLongStackTraces(),le.longStackTraces=!1},t.prototype._captureStackTrace=z,t.prototype._attachExtraTrace=k,t.prototype._dereferenceTrace=G,n.activateLongStackTraces()}},t.hasLongStackTraces=function(){return le.longStackTraces&&re()};var x={unhandledrejection:{before:function(){var e=f.global.onunhandledrejection;return f.global.onunhandledrejection=null,e},after:function(e){f.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=f.global.onrejectionhandled;return f.global.onrejectionhandled=null,e},after:function(e){f.global.onrejectionhandled=e}}},R=function(){var e=function(e,t){if(!e)return!f.global.dispatchEvent(t);var n;try{return n=e.before(),!f.global.dispatchEvent(t)}finally{e.after(n)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return f.global.dispatchEvent(t),function(t,n){t=t.toLowerCase();var r=new CustomEvent(t,{detail:n,cancelable:!0});return p.defineProperty(r,"promise",{value:n.promise}),p.defineProperty(r,"reason",{value:n.reason}),e(x[t],r)}}return"function"==typeof Event?(t=new Event("CustomEvent"),f.global.dispatchEvent(t),function(t,n){t=t.toLowerCase();var r=new Event(t,{cancelable:!0});return r.detail=n,p.defineProperty(r,"promise",{value:n.promise}),p.defineProperty(r,"reason",{value:n.reason}),e(x[t],r)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),f.global.dispatchEvent(t),function(t,n){t=t.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,!1,!0,n),e(x[t],r)})}catch(e){}return function(){return!1}}(),A=f.isNode?function(){return process.emit.apply(process,arguments)}:f.global?function(e){var t="on"+e.toLowerCase(),n=f.global[t];return!!n&&(n.apply(f.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function S(e,t){return{promise:t}}var I={promiseCreated:S,promiseFulfilled:S,promiseRejected:S,promiseResolved:S,promiseCancelled:S,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:S},N=function(e){var t=!1;try{t=A.apply(null,arguments)}catch(e){c.throwLater(e),t=!0}var n=!1;try{n=R(e,I[e].apply(null,arguments))}catch(e){c.throwLater(e),n=!0}return n||t};function C(){return!1}function P(e,t,n){var r=this;try{e(t,n,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+f.toString(e));r._attachCancellationCallback(e)}))}catch(e){return e}}function M(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?f.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function j(){return this._onCancelField}function U(e){this._onCancelField=e}function F(){this._cancellationParent=void 0,this._onCancelField=void 0}function q(e,t){if(1&t){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}2&t&&e._isBound()&&this._setBoundTo(e._boundTo)}function L(e,t){2&t&&e._isBound()&&this._setBoundTo(e._boundTo)}t.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&T()),"warnings"in e){var n=e.warnings;le.warnings=!!n,v=le.warnings,f.isObject(n)&&"wForgottenReturn"in n&&(v=!!n.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!le.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=F,t.prototype._propagateFrom=q,t.prototype._onCancel=j,t.prototype._setOnCancel=U,t.prototype._attachCancellationCallback=M,t.prototype._execute=P,D=q,le.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!le.monitoring?(le.monitoring=!0,t.prototype._fireEvent=N):!e.monitoring&&le.monitoring&&(le.monitoring=!1,t.prototype._fireEvent=C)),"asyncHooks"in e&&f.nodeSupportsAsyncResource){var i=le.asyncHooks,s=!!e.asyncHooks;i!==s&&(le.asyncHooks=s,s?r():o())}return t},t.prototype._fireEvent=C,t.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(e){},t.prototype._attachCancellationCallback=function(e){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._dereferenceTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(e,t){};var D=L;function B(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function z(){this._trace=new ue(this._peekContext())}function k(e,t){if(h(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=K(e);f.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),f.notEnumerableProp(e,"__stackCleaned__",!0)}}}function G(){this._trace=void 0}function V(e,t,n,r,o){if(void 0===e&&null!==t&&v){if(void 0!==o&&o._returnedNonUndefined())return;if(!(65535&r._bitField))return;n&&(n+=" ");var i="",s="";if(t._trace){for(var a=t._trace.stack.split("\n"),u=Z(a),c=u.length-1;c>=0;--c){var l=u[c];if(!m.test(l)){var f=l.match(y);f&&(i="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(u.length>0){var p=u[0];for(c=0;c<a.length;++c)if(a[c]===p){c>0&&(s="\n"+a[c-1]);break}}}var h="a promise was created in a "+n+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(h,!0,t)}}function H(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),W(n)}function W(e,n,r){if(le.warnings){var o,i=new l(e);if(n)r._attachExtraTrace(i);else if(le.longStackTraces&&(o=t._peekContext()))o.attachExtraTrace(i);else{var s=K(i);i.stack=s.message+"\n"+s.stack.join("\n")}N("warning",i)||J(i,"",!0)}}function X(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function $(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function Y(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],o=t.length-1,i=t[o],s=-1,a=r.length-1;a>=0;--a)if(r[a]===i){s=a;break}for(a=s;a>=0;--a){var u=r[a];if(t[o]!==u)break;t.pop(),o--}t=r}}function Z(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],o="    (No stack trace)"===r||_.test(r),i=o&&oe(r);o&&!i&&(b&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function Q(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||_.test(r))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}function K(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?Q(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:Z(t)}}function J(e,t,n){if("undefined"!=typeof console){var r;if(f.isObject(e)){var o=e.stack;r=t+g(o,e)}else r=t+String(e);"function"==typeof a?a(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function ee(e,t,n,r){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(e){c.throwLater(e)}"unhandledRejection"===e?N(e,n,r)||o||J(n,"Unhandled rejection "):N(e,r)}function te(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():f.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+ne(t)+">, no stack trace)"}function ne(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function re(){return"function"==typeof ce}var oe=function(){return!1},ie=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function se(e){var t=e.match(ie);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function ae(e,t){if(re()){for(var n,r,o=(e.stack||"").split("\n"),i=(t.stack||"").split("\n"),s=-1,a=-1,u=0;u<o.length;++u)if(c=se(o[u])){n=c.fileName,s=c.line;break}for(u=0;u<i.length;++u){var c;if(c=se(i[u])){r=c.fileName,a=c.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||(oe=function(e){if(d.test(e))return!0;var t=se(e);return!!(t&&t.fileName===n&&s<=t.line&&t.line<=a)})}}function ue(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ce(this,ue),t>32&&this.uncycle()}f.inherits(ue,Error),n.CapturedTrace=ue,ue.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},r=0,o=this;void 0!==o;++r)t.push(o),o=o._parent;for(r=(e=this._length=r)-1;r>=0;--r){var i=t[r].stack;void 0===n[i]&&(n[i]=r)}for(r=0;r<e;++r){var s=n[t[r].stack];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var a=r>0?t[r-1]:this;s<e-1?(a._parent=t[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,c=r-2;c>=0;--c)t[c]._length=u,u++;return}}}},ue.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=K(e),n=t.message,r=[t.stack],o=this;void 0!==o;)r.push(Z(o.stack.split("\n"))),o=o._parent;Y(r),$(r),f.notEnumerableProp(e,"stack",X(n,r)),f.notEnumerableProp(e,"__stackCleaned__",!0)}};var ce=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():te(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,_=e,g=t;var n=Error.captureStackTrace;return oe=function(e){return d.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return _=/@/,g=t,b=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){r="stack"in e}return!("stack"in o)&&r&&"number"==typeof Error.stackTraceLimit?(_=e,g=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6}):(g=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?te(t):t.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(a=function(e){console.warn(e)},f.isNode&&process.stderr.isTTY?a=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:f.isNode||"string"!=typeof(new Error).stack||(a=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var le={warnings:O,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return w&&t.longStackTraces(),{asyncHooks:function(){return le.asyncHooks},longStackTraces:function(){return le.longStackTraces},warnings:function(){return le.warnings},cancellation:function(){return le.cancellation},monitoring:function(){return le.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return B},checkForgottenReturns:V,setBounds:ae,warn:W,deprecated:H,CapturedTrace:ue,fireDomEvent:R,fireGlobalEvent:A}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,t,n){t.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1],r=function(){throw t};return this.caught(e,r)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();var o=function(){return r};return this.caught(n,o)}}},{}],11:[function(e,t,n){t.exports=function(e,t){var n=e.reduce,r=e.all;function o(){return r(this)}function i(e,r){return n(e,r,t,t)}e.prototype.each=function(e){return n(this,e,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return n(this,e,t,t)},e.each=function(e,r){return n(e,r,t,0)._then(o,void 0,void 0,e,void 0)},e.mapSeries=i}},{}],12:[function(e,t,n){var r,o,i=e("./es5"),s=i.freeze,a=e("./util"),u=a.inherits,c=a.notEnumerableProp;function l(e,t){function n(r){if(!(this instanceof n))return new n(r);c(this,"message","string"==typeof r?r:t),c(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(n,Error),n}var f=l("Warning","warning"),p=l("CancellationError","cancellation error"),h=l("TimeoutError","timeout error"),d=l("AggregateError","aggregate error");try{r=TypeError,o=RangeError}catch(e){r=l("TypeError","type error"),o=l("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<m.length;++y)"function"==typeof Array.prototype[m[y]]&&(d.prototype[m[y]]=Array.prototype[m[y]]);i.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var _=0;function g(e){if(!(this instanceof g))return new g(e);c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}d.prototype.toString=function(){var e=Array(4*_+1).join(" "),t="\n"+e+"AggregateError of:\n";_++,e=Array(4*_+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",o=r.split("\n"),i=0;i<o.length;++i)o[i]=e+o[i];t+=(r=o.join("\n"))+"\n"}return _--,t},u(g,Error);var b=Error.__BluebirdErrorTypes__;b||(b=s({CancellationError:p,TimeoutError:h,OperationalError:g,RejectionError:g,AggregateError:d}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:r,RangeError:o,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(e,t,n){var r=function(){return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,i={}.toString,s={}.constructor.prototype,a=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t},u=function(e,t){return{value:e[t]}},c=function(e,t,n){return e[t]=n.value,e},l=function(e){return e},f=function(e){try{return Object(e).constructor.prototype}catch(e){return s}},p=function(e){try{return"[object Array]"===i.call(e)}catch(e){return!1}};t.exports={isArray:p,keys:a,names:a,defineProperty:c,getDescriptor:u,freeze:l,getPrototypeOf:f,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,n){t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,o){return n(e,r,o,t)}}},{}],15:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=t.CancellationError,s=o.errorObj,a=e("./catch_filter")(r);function u(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function c(e){this.finallyHandler=e}function l(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function f(){return h.call(this,this.promise._target()._settledValue())}function p(e){if(!l(this,e))return s.e=e,s}function h(e){var o=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(o._boundValue()):a.call(o._boundValue(),e);if(u===r)return u;if(void 0!==u){o._setReturnedNonUndefined();var h=n(u,o);if(h instanceof t){if(null!=this.cancelPromise){if(h._isCancelled()){var d=new i("late cancellation observer");return o._attachExtraTrace(d),s.e=d,s}h.isPending()&&h._attachCancellationCallback(new c(this))}return h._then(f,p,void 0,this,void 0)}}}return o.isRejected()?(l(this),s.e=e,s):(l(this),e)}return u.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){l(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,r){return"function"!=typeof e?this.then():this._then(n,r,void 0,new u(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,h,h)},t.prototype.tap=function(e){return this._passThrough(e,1,h)},t.prototype.tapCatch=function(e){var n=arguments.length;if(1===n)return this._passThrough(e,1,void 0,h);var r,i=new Array(n-1),s=0;for(r=0;r<n-1;++r){var u=arguments[r];if(!o.isObject(u))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(u)));i[s++]=u}i.length=s;var c=arguments[r];return this._passThrough(a(i,c,this),1,void 0,h)},u}},{"./catch_filter":7,"./util":36}],16:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./errors").TypeError,u=e("./util"),c=u.errorObj,l=u.tryCatch,f=[];function p(e,n,r){for(var i=0;i<n.length;++i){r._pushContext();var s=l(n[i])(e);if(r._popContext(),s===c){r._pushContext();var a=t.reject(c.e);return r._popContext(),a}var u=o(s,r);if(u instanceof t)return u}return null}function h(e,n,o,i){if(s.cancellation()){var a=new t(r),u=this._finallyPromise=new t(r);this._promise=a.lastly((function(){return u})),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new t(r))._captureStackTrace();this._stack=i,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(h,i),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),e=l(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},h.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(e){var n=this._promise;if(e===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var r=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var i=o(r,this._promise);if(i instanceof t||null!==(i=p(i,this._yieldHandlers,this._promise))){var s=(i=i._target())._bitField;50397184&s?33554432&s?t._async.invoke(this._promiseFulfilled,this,i._value()):16777216&s?t._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled():(this._yieldedPromise=i,i._proxy(this,null))}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,r=h,o=(new Error).stack;return function(){var t=e.apply(this,arguments),i=new r(void 0,void 0,n,o),s=i.promise();return i._generator=t,i._promiseFulfilled(void 0),s}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new a("expecting a function but got "+u.classString(e));f.push(e)},t.spawn=function(e){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new h(e,this),o=r.promise();return r._run(t.spawn),o}}},{"./errors":12,"./util":36}],17:[function(e,t,n){t.exports=function(t,n,r,o,i){var s=e("./util");s.canEvaluate,s.tryCatch,s.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var r=[].slice.call(arguments);e&&r.pop();var o=new n(r).promise();return void 0!==e?o.spread(e):o}}},{"./util":36}],18:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./util"),u=a.tryCatch,c=a.errorObj,l=t._async;function f(e,n,r,o){this.constructor$(e),this._promise._captureStackTrace();var s=t._getContext();if(this._callback=a.contextBind(s,n),this._preservedValues=o===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0),a.isArray(e))for(var u=0;u<e.length;++u){var c=e[u];c instanceof t&&c.suppressUnhandledRejections()}}function p(e,n,o,i){if("function"!=typeof n)return r("expecting a function but got "+a.classString(n));var s=0;if(void 0!==o){if("object"!=typeof o||null===o)return t.reject(new TypeError("options argument must be an object but it is "+a.classString(o)));if("number"!=typeof o.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(o.concurrency)));s=o.concurrency}return new f(e,n,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,i).promise()}a.inherits(f,n),f.prototype._asyncInit=function(){this._init$(void 0,-2)},f.prototype._init=function(){},f.prototype._promiseFulfilled=function(e,n){var r=this._values,i=this.length(),a=this._preservedValues,l=this._limit;if(n<0){if(r[n=-1*n-1]=e,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=e,this._queue.push(n),!1;null!==a&&(a[n]=e);var f=this._promise,p=this._callback,h=f._boundValue();f._pushContext();var d=u(p).call(h,e,n,i),m=f._popContext();if(s.checkForgottenReturns(d,m,null!==a?"Promise.filter":"Promise.map",f),d===c)return this._reject(d.e),!0;var y=o(d,this._promise);if(y instanceof t){var _=(y=y._target())._bitField;if(!(50397184&_))return l>=1&&this._inFlight++,r[n]=y,y._proxy(this,-1*(n+1)),!1;if(!(33554432&_))return 16777216&_?(this._reject(y._reason()),!0):(this._cancel(),!0);d=y._value()}r[n]=d}return++this._totalResolved>=i&&(null!==a?this._filter(r,a):this._resolve(r),!0)},f.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},f.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),o=0,i=0;i<n;++i)e[i]&&(r[o++]=t[i]);r.length=o,this._resolve(r)},f.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return p(this,e,t,null)},t.map=function(e,t,n,r){return p(e,t,n,r)}}},{"./util":36}],19:[function(e,t,n){t.exports=function(t,n,r,o,i){var s=e("./util"),a=s.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+s.classString(e));return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var o=a(e).apply(this,arguments),s=r._popContext();return i.checkForgottenReturns(o,s,"Promise.method",r),r._resolveFromSyncValue(o),r}},t.attempt=t.try=function(e){if("function"!=typeof e)return o("expecting a function but got "+s.classString(e));var r,u=new t(n);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];r=s.isArray(c)?a(e).apply(l,c):a(e).call(l,c)}else r=a(e)();var f=u._popContext();return i.checkForgottenReturns(r,f,"Promise.try",u),u._resolveFromSyncValue(r),u},t.prototype._resolveFromSyncValue=function(e){e===s.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,n){var r=e("./util"),o=r.maybeWrapAsError,i=e("./errors").OperationalError,s=e("./es5");function a(e){return e instanceof Error&&s.getPrototypeOf(e)===Error.prototype}var u=/^(?:name|message|stack|cause)$/;function c(e){var t;if(a(e)){(t=new i(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var n=s.keys(e),o=0;o<n.length;++o){var c=n[o];u.test(c)||(t[c]=e[c])}return t}return r.markAsOriginatingFromRejection(e),e}function l(e,t){return function(n,r){if(null!==e){if(n){var i=c(o(n));e._attachExtraTrace(i),e._reject(i)}else if(t){var s=[].slice.call(arguments,1);e._fulfill(s)}else e._fulfill(r);e=null}}}t.exports=l},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,n){t.exports=function(t){var n=e("./util"),r=t._async,o=n.tryCatch,i=n.errorObj;function s(e,t){var s=this;if(!n.isArray(e))return a.call(s,e,t);var u=o(t).apply(s._boundValue(),[null].concat(e));u===i&&r.throwLater(u.e)}function a(e,t){var n=this._boundValue(),s=void 0===e?o(t).call(n,null):o(t).call(n,null,e);s===i&&r.throwLater(s.e)}function u(e,t){var n=this;if(!e){var s=new Error(e+"");s.cause=e,e=s}var a=o(t).call(n._boundValue(),e);a===i&&r.throwLater(a.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var n=a;void 0!==t&&Object(t).spread&&(n=s),this._then(n,u,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,t,n){t.exports=function(){var n=function(){return new E("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},r=function(){return new F.PromiseInspection(this._target())},o=function(e){return F.reject(new E(e))};function i(){}var s={},a=e("./util");a.setReflectHandler(r);var u=function(){var e=process.domain;return void 0===e?null:e},c=function(){return null},l=function(){return{domain:u(),async:null}},f=a.isNode&&a.nodeSupportsAsyncResource?e("async_hooks").AsyncResource:null,p=function(){return{domain:u(),async:new f("Bluebird::Promise")}},h=a.isNode?l:c;a.notEnumerableProp(F,"_getContext",h);var d=function(){h=p,a.notEnumerableProp(F,"_getContext",p)},m=function(){h=l,a.notEnumerableProp(F,"_getContext",l)},y=e("./es5"),_=e("./async"),g=new _;y.defineProperty(F,"_async",{value:g});var b=e("./errors"),E=F.TypeError=b.TypeError;F.RangeError=b.RangeError;var O=F.CancellationError=b.CancellationError;F.TimeoutError=b.TimeoutError,F.OperationalError=b.OperationalError,F.RejectionError=b.OperationalError,F.AggregateError=b.AggregateError;var w=function(){},v={},T={},x=e("./thenables")(F,w),R=e("./promise_array")(F,w,x,o,i),A=e("./context")(F),S=A.create,I=e("./debuggability")(F,A,d,m);I.CapturedTrace;var N=e("./finally")(F,x,T),C=e("./catch_filter")(T),P=e("./nodeback"),M=a.errorObj,j=a.tryCatch;function U(e,t){if(null==e||e.constructor!==F)throw new E("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new E("expecting a function but got "+a.classString(t))}function F(e){e!==w&&U(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function q(e){this.promise._resolveCallback(e)}function L(e){this.promise._rejectCallback(e,!1)}function D(e){var t=new F(w);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return F.prototype.toString=function(){return"[object Promise]"},F.prototype.caught=F.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),i=0;for(n=0;n<t-1;++n){var s=arguments[n];if(!a.isObject(s))return o("Catch statement predicate: expecting an object but got "+a.classString(s));r[i++]=s}if(r.length=i,"function"!=typeof(e=arguments[n]))throw new E("The last argument to .catch() must be a function, got "+a.toString(e));return this.then(void 0,C(r,e,this))}return this.then(void 0,e)},F.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},F.prototype.then=function(e,t){if(I.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+a.classString(e);arguments.length>1&&(n+=", "+a.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},F.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},F.prototype.spread=function(e){return"function"!=typeof e?o("expecting a function but got "+a.classString(e)):this.all()._then(e,void 0,void 0,v,void 0)},F.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},F.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new R(this).promise()},F.prototype.error=function(e){return this.caught(a.originatesFromRejection,e)},F.getNewLibraryCopy=t.exports,F.is=function(e){return e instanceof F},F.fromNode=F.fromCallback=function(e){var t=new F(w);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=j(e)(P(t,n));return r===M&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},F.all=function(e){return new R(e).promise()},F.cast=function(e){var t=x(e);return t instanceof F||((t=new F(w))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},F.resolve=F.fulfilled=F.cast,F.reject=F.rejected=function(e){var t=new F(w);return t._captureStackTrace(),t._rejectCallback(e,!0),t},F.setScheduler=function(e){if("function"!=typeof e)throw new E("expecting a function but got "+a.classString(e));return g.setScheduler(e)},F.prototype._then=function(e,t,n,r,o){var i=void 0!==o,s=i?o:new F(w),u=this._target(),c=u._bitField;i||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&2097152&this._bitField&&(r=50397184&c?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=h();if(50397184&c){var f,p,d=u._settlePromiseCtx;33554432&c?(p=u._rejectionHandler0,f=e):16777216&c?(p=u._fulfillmentHandler0,f=t,u._unsetRejectionIsUnhandled()):(d=u._settlePromiseLateCancellationObserver,p=new O("late cancellation observer"),u._attachExtraTrace(p),f=t),g.invoke(d,u,{handler:a.contextBind(l,f),promise:s,receiver:r,value:p})}else u._addCallbacks(e,t,s,r,l);return s},F.prototype._length=function(){return 65535&this._bitField},F.prototype._isFateSealed=function(){return!!(117506048&this._bitField)},F.prototype._isFollowing=function(){return!(67108864&~this._bitField)},F.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},F.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},F.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},F.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},F.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},F.prototype._isFinal=function(){return(4194304&this._bitField)>0},F.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},F.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},F.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},F.prototype._setAsyncGuaranteed=function(){if(!g.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},F.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&this._bitField|536870912},F.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==s)return void 0===t&&this._isBound()?this._boundValue():t},F.prototype._promiseAt=function(e){return this[4*e-4+2]},F.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},F.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},F.prototype._boundValue=function(){},F.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,r=e._promise0,o=e._receiverAt(0);void 0===o&&(o=s),this._addCallbacks(t,n,r,o,null)},F.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=s),this._addCallbacks(n,r,o,i,null)},F.prototype._addCallbacks=function(e,t,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=a.contextBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=a.contextBind(o,t));else{var s=4*i-4;this[s+2]=n,this[s+3]=r,"function"==typeof e&&(this[s+0]=a.contextBind(o,e)),"function"==typeof t&&(this[s+1]=a.contextBind(o,t))}return this._setLength(i+1),i},F.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},F.prototype._resolveCallback=function(e,t){if(!(117506048&this._bitField)){if(e===this)return this._rejectCallback(n(),!1);var r=x(e,this);if(!(r instanceof F))return this._fulfill(e);t&&this._propagateFrom(r,2);var o=r._target();if(o!==this){var i=o._bitField;if(50397184&i)if(33554432&i)this._fulfill(o._value());else if(16777216&i)this._reject(o._reason());else{var s=new O("late cancellation observer");o._attachExtraTrace(s),this._reject(s)}else{var a=this._length();a>0&&o._migrateCallback0(this);for(var u=1;u<a;++u)o._migrateCallbackAt(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(r)}}else this._reject(n())}},F.prototype._rejectCallback=function(e,t,n){var r=a.ensureErrorObject(e),o=r===e;if(!o&&!n&&I.warnings()){var i="a promise was rejected with a non-error: "+a.classString(e);this._warn(i,!0)}this._attachExtraTrace(r,!!t&&o),this._reject(e)},F.prototype._resolveFromExecutor=function(e){if(e!==w){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,n)}));n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)}},F.prototype._settlePromiseFromHandler=function(e,t,n,r){var o=r._bitField;if(!(65536&o)){var i;r._pushContext(),t===v?n&&"number"==typeof n.length?i=j(e).apply(this._boundValue(),n):(i=M).e=new E("cannot .spread() a non-array: "+a.classString(n)):i=j(e).call(t,n);var s=r._popContext();65536&(o=r._bitField)||(i===T?r._reject(n):i===M?r._rejectCallback(i.e,!1):(I.checkForgottenReturns(i,s,"",r,this),r._resolveCallback(i)))}},F.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},F.prototype._followee=function(){return this._rejectionHandler0},F.prototype._setFollowee=function(e){this._rejectionHandler0=e},F.prototype._settlePromise=function(e,t,n,o){var s=e instanceof F,a=this._bitField,u=!!(134217728&a);65536&a?(s&&e._invokeInternalOnCancel(),n instanceof N&&n.isFinallyHandler()?(n.cancelPromise=e,j(t).call(n,o)===M&&e._reject(M.e)):t===r?e._fulfill(r.call(n)):n instanceof i?n._promiseCancelled(e):s||e instanceof R?e._cancel():n.cancel()):"function"==typeof t?s?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,o,e)):t.call(n,o,e):n instanceof i?n._isResolved()||(33554432&a?n._promiseFulfilled(o,e):n._promiseRejected(o,e)):s&&(u&&e._setAsyncGuaranteed(),33554432&a?e._fulfill(o):e._reject(o))},F.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,o=e.value;"function"==typeof t?n instanceof F?this._settlePromiseFromHandler(t,r,o,n):t.call(r,o,n):n instanceof F&&n._reject(o)},F.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},F.prototype._settlePromise0=function(e,t,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,o,t)},F.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},F.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(134217728&t?this._settlePromises():g.settlePromises(this),this._dereferenceTrace())}},F.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return g.fatalError(e,a.isNode);(65535&t)>0?g.settlePromises(this):this._ensurePossibleRejectionHandled()}},F.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},F.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},F.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(16842752&e){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},F.prototype._settledValue=function(){var e=this._bitField;return 33554432&e?this._rejectionHandler0:16777216&e?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&y.defineProperty(F.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),F.defer=F.pending=function(){return I.deprecated("Promise.defer","new Promise"),{promise:new F(w),resolve:q,reject:L}},a.notEnumerableProp(F,"_makeSelfResolutionError",n),e("./method")(F,w,x,o,I),e("./bind")(F,w,x,I),e("./cancel")(F,R,o,I),e("./direct_resolve")(F),e("./synchronous_inspection")(F),e("./join")(F,R,x,w,g),F.Promise=F,F.version="3.7.2",e("./call_get.js")(F),e("./generators.js")(F,o,w,x,i,I),e("./map.js")(F,R,o,x,w,I),e("./nodeify.js")(F),e("./promisify.js")(F,w),e("./props.js")(F,R,x,o),e("./race.js")(F,w,x,o),e("./reduce.js")(F,R,o,x,w,I),e("./settle.js")(F,R,I),e("./some.js")(F,R,o),e("./timers.js")(F,w,I),e("./using.js")(F,o,x,S,w,I),e("./any.js")(F),e("./each.js")(F,w),e("./filter.js")(F,w),a.toFastProperties(F),a.toFastProperties(F.prototype),D({a:1}),D({b:2}),D({c:3}),D(1),D((function(){})),D(void 0),D(!1),D(new F(w)),I.setBounds(_.firstLineError,a.lastLineError),F}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,t,n){t.exports=function(t,n,r,o,i){var s=e("./util");function a(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}function u(e){var r=this._promise=new t(n);e instanceof t&&(r._propagateFrom(e,3),e.suppressUnhandledRejections()),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.isArray,s.inherits(u,i),u.prototype.length=function(){return this._length},u.prototype.promise=function(){return this._promise},u.prototype._init=function e(n,i){var u=r(this._values,this._promise);if(u instanceof t){var c=(u=u._target())._bitField;if(this._values=u,!(50397184&c))return this._promise._setAsyncGuaranteed(),u._then(e,this._reject,void 0,this,i);if(!(33554432&c))return 16777216&c?this._reject(u._reason()):this._cancel();u=u._value()}if(null!==(u=s.asArray(u)))0!==u.length?this._iterate(u):-5===i?this._resolveEmptyArray():this._resolve(a(i));else{var l=o("expecting an array or an iterable object but got "+s.classString(u)).reason();this._promise._rejectCallback(l,!1)}},u.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,s=null,a=0;a<n;++a){var u=r(e[a],o);s=u instanceof t?(u=u._target())._bitField:null,i?null!==s&&u.suppressUnhandledRejections():null!==s?50397184&s?i=33554432&s?this._promiseFulfilled(u._value(),a):16777216&s?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):(u._proxy(this,a),this._values[a]=u):i=this._promiseFulfilled(u,a)}i||o._setAsyncGuaranteed()},u.prototype._isResolved=function(){return null===this._values},u.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},u.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},u.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},u.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},u.prototype._promiseCancelled=function(){return this._cancel(),!0},u.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},u.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},u.prototype.shouldCopyValues=function(){return!0},u.prototype.getActualLength=function(e){return e},u}},{"./util":36}],24:[function(e,t,n){t.exports=function(t,n){var r={},o=e("./util"),i=e("./nodeback"),s=o.withAppended,a=o.maybeWrapAsError,u=o.canEvaluate,c=e("./errors").TypeError,l="Async",f={__isPromisified__:!0},p=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(e){return o.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function d(e){return!p.test(e)}function m(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function y(e,t,n){var r=o.getDataPropertyOrDefault(e,t+n,f);return!!r&&m(r)}function _(e,t,n){for(var r=0;r<e.length;r+=2){var o=e[r];if(n.test(o))for(var i=o.replace(n,""),s=0;s<e.length;s+=2)if(e[s]===i)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function g(e,t,n,r){for(var i=o.inheritedDataKeys(e),s=[],a=0;a<i.length;++a){var u=i[a],c=e[u],l=r===h||h(u);"function"!=typeof c||m(c)||y(e,u,t)||!r(u,c,e,l)||s.push(u,c)}return _(s,t,n),s}var b,E=function(e){return e.replace(/([$])/,"\\$")};function O(e,u,c,l,f,p){var h=function(){return this}(),d=e;function m(){var o=u;u===r&&(o=this);var c=new t(n);c._captureStackTrace();var l="string"==typeof d&&this!==h?this[d]:e,f=i(c,p);try{l.apply(o,s(arguments,f))}catch(e){c._rejectCallback(a(e),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof d&&(e=l),o.notEnumerableProp(m,"__isPromisified__",!0),m}var w=u?b:O;function v(e,t,n,i,s){for(var a=new RegExp(E(t)+"$"),u=g(e,t,a,n),c=0,l=u.length;c<l;c+=2){var f=u[c],p=u[c+1],h=f+t;if(i===w)e[h]=w(f,r,f,p,t,s);else{var d=i(p,(function(){return w(f,r,f,p,t,s)}));o.notEnumerableProp(d,"__isPromisified__",!0),e[h]=d}}return o.toFastProperties(e),e}function T(e,t,n){return w(e,t,void 0,e,null,n)}t.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+o.classString(e));if(m(e))return e;var n=T(e,void 0===(t=Object(t)).context?r:t.context,!!t.multiArgs);return o.copyDescriptors(e,n,d),n},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(t=Object(t)).multiArgs,r=t.suffix;"string"!=typeof r&&(r=l);var i=t.filter;"function"!=typeof i&&(i=h);var s=t.promisifier;if("function"!=typeof s&&(s=w),!o.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=o.inheritedDataKeys(e),u=0;u<a.length;++u){var f=e[a[u]];"constructor"!==a[u]&&o.isClass(f)&&(v(f.prototype,r,i,s,n),v(f,r,i,s,n))}return v(e,r,i,s,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,n){t.exports=function(t,n,r,o){var i,s=e("./util"),a=s.isObject,u=e("./es5");"function"==typeof Map&&(i=Map);var c=function(){var e=0,t=0;function n(n,r){this[e]=n,this[e+t]=r,e++}return function(r){t=r.size,e=0;var o=new Array(2*r.size);return r.forEach(n,o),o}}(),l=function(e){for(var t=new i,n=e.length/2|0,r=0;r<n;++r){var o=e[n+r],s=e[r];t.set(o,s)}return t};function f(e){var t,n=!1;if(void 0!==i&&e instanceof i)t=c(e),n=!0;else{var r=u.keys(e),o=r.length;t=new Array(2*o);for(var s=0;s<o;++s){var a=r[s];t[s]=e[a],t[s+o]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,n?-6:-3)}function p(e){var n,i=r(e);return a(i)?(n=i instanceof t?i._then(t.props,void 0,void 0,void 0,void 0):new f(i).promise(),i instanceof t&&n._propagateFrom(i,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(f,n),f.prototype._init=function(){},f.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var n;if(this._isMap)n=l(this._values);else{n={};for(var r=this.length(),o=0,i=this.length();o<i;++o)n[this._values[o+r]]=this._values[o]}return this._resolve(n),!0}return!1},f.prototype.shouldCopyValues=function(){return!1},f.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return p(this)},t.props=function(e){return p(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,n){function r(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t],e[i+t]=void 0}function o(e){this._capacity=e,this._length=0,this._front=0}o.prototype._willBeOverCapacity=function(e){return this._capacity<e},o.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},o.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=n,this._length=r},o.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},o.prototype.length=function(){return this._length},o.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},o.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,r(this,0,this,t,this._front+this._length&t-1)},t.exports=o},{}],27:[function(e,t,n){t.exports=function(t,n,r,o){var i=e("./util"),s=function(e){return e.then((function(t){return a(t,e)}))};function a(e,a){var u=r(e);if(u instanceof t)return s(u);if(null===(e=i.asArray(e)))return o("expecting an array or an iterable object but got "+i.classString(e));var c=new t(n);void 0!==a&&c._propagateFrom(a,3);for(var l=c._fulfill,f=c._reject,p=0,h=e.length;p<h;++p){var d=e[p];(void 0!==d||p in e)&&t.cast(d)._then(l,f,void 0,c,null)}return c}t.race=function(e){return a(e,void 0)},t.prototype.race=function(){return a(this,void 0)}}},{"./util":36}],28:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./util"),u=a.tryCatch;function c(e,n,r,o){this.constructor$(e);var s=t._getContext();this._fn=a.contextBind(s,n),void 0!==r&&(r=t.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function f(e,t,n,o){return"function"!=typeof t?r("expecting a function but got "+a.classString(t)):new c(e,t,n,o).promise()}function p(e){this.accum=e,this.array._gotAccum(e);var n=o(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(h,void 0,void 0,this,void 0)):h.call(this,n)}function h(e){var n,r=this.array,o=r._promise,i=u(r._fn);o._pushContext(),(n=void 0!==r._eachValues?i.call(o._boundValue(),e,this.index,this.length):i.call(o._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(r._currentCancellable=n);var a=o._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",o),n}a.inherits(c,n),c.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},c.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},c.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},c.prototype._iterate=function(e){var n,r;this._values=e;var o=e.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=t.resolve(e[0]),r=1),this._currentCancellable=n;for(var i=r;i<o;++i){var s=e[i];s instanceof t&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;r<o;++r){var a={accum:null,value:e[r],index:r,length:o,array:this};n=n._then(p,void 0,void 0,a,void 0),127&r||n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},t.prototype.reduce=function(e,t){return f(this,e,t,null)},t.reduce=function(e,t,n,r){return f(e,t,n,r)}}},{"./util":36}],29:[function(e,n,r){var o,i=e("./util"),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},a=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var u=t.setImmediate,c=process.nextTick;o=i.isRecentNode?function(e){u.call(t,e)}:function(e){c.call(process,e)}}else if("function"==typeof a&&"function"==typeof a.resolve){var l=a.resolve();o=function(e){l.then(e)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:s:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver((function(){e.classList.toggle("foo"),n=!1})).observe(r,t);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver((function(){r.disconnect(),n()}));r.observe(e,t),o()}}();n.exports=o},{"./util":36}],30:[function(e,t,n){t.exports=function(t,n,r){var o=t.PromiseInspection;function i(e){this.constructor$(e)}e("./util").inherits(i,n),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var n=new o;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},i.prototype._promiseRejected=function(e,t){var n=new o;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},t.settle=function(e){return r.deprecated(".settle()",".reflect()"),new i(e).promise()},t.allSettled=function(e){return new i(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=e("./errors").RangeError,s=e("./errors").AggregateError,a=o.isArray,u={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,t){if((0|t)!==t||t<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(e),o=n.promise();return n.setHowMany(t),n.init(),o}o.inherits(c,n),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=a(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new s,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new i(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return l(e,t)},t.prototype.some=function(e){return l(this,e)},t._SomePromiseArray=c}},{"./errors":12,"./util":36}],32:[function(e,t,n){t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return!!(33554432&this._bitField)},i=t.prototype.isRejected=function(){return!!(16777216&this._bitField)},s=t.prototype.isPending=function(){return!(50397184&this._bitField)},a=t.prototype.isResolved=function(){return!!(50331648&this._bitField)};t.prototype.isCancelled=function(){return!!(8454144&this._bitField)},e.prototype.__isCancelled=function(){return!(65536&~this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return!!(8454144&this._target()._bitField)},e.prototype.isPending=function(){return s.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,n){t.exports=function(t,n){var r=e("./util"),o=r.errorObj,i=r.isObject;function s(e,r){if(i(e)){if(e instanceof t)return e;var s=u(e);if(s===o){r&&r._pushContext();var a=t.reject(s.e);return r&&r._popContext(),a}if("function"==typeof s)return l(e)?(a=new t(n),e._then(a._fulfill,a._reject,void 0,a,null),a):f(e,s,r)}return e}function a(e){return e.then}function u(e){try{return a(e)}catch(e){return o.e=e,o}}var c={}.hasOwnProperty;function l(e){try{return c.call(e,"_promise0")}catch(e){return!1}}function f(e,i,s){var a=new t(n),u=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var c=!0,l=r.tryCatch(i).call(e,f,p);function f(e){a&&(a._resolveCallback(e),a=null)}function p(e){a&&(a._rejectCallback(e,c,!0),a=null)}return c=!1,a&&l===o&&(a._rejectCallback(l.e,!0,!0),a=null),u}return s}},{"./util":36}],34:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=t.TimeoutError;function s(e){this.handle=e}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(e){return u(+this).thenReturn(e)},u=t.delay=function(e,o){var i,u;return void 0!==o?(i=t.resolve(o)._then(a,null,null,e,void 0),r.cancellation()&&o instanceof t&&i._setOnCancel(o)):(i=new t(n),u=setTimeout((function(){i._fulfill()}),+e),r.cancellation()&&i._setOnCancel(new s(u)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};t.prototype.delay=function(e){return u(e,this)};var c=function(e,t,n){var r;r="string"!=typeof t?t instanceof Error?t:new i("operation timed out"):new i(t),o.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=n&&n.cancel()};function l(e){return clearTimeout(this.handle),e}function f(e){throw clearTimeout(this.handle),e}t.prototype.timeout=function(e,t){var n,o;e=+e;var i=new s(setTimeout((function(){n.isPending()&&c(n,t,o)}),e));return r.cancellation()?(o=this.then(),(n=o._then(l,f,void 0,i,void 0))._setOnCancel(i)):n=this._then(l,f,void 0,i,void 0),n}}},{"./util":36}],35:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./util"),u=e("./errors").TypeError,c=e("./util").inherits,l=a.errorObj,f=a.tryCatch,p={};function h(e){setTimeout((function(){throw e}),0)}function d(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function m(e,n){var o=0,s=e.length,a=new t(i);function u(){if(o>=s)return a._fulfill();var i=d(e[o++]);if(i instanceof t&&i._isDisposable()){try{i=r(i._getDisposer().tryDispose(n),e.promise)}catch(e){return h(e)}if(i instanceof t)return i._then(u,h,null,null,null)}u()}return u(),a}function y(e,t,n){this._data=e,this._promise=t,this._context=n}function _(e,t,n){this.constructor$(e,t,n)}function g(e){return y.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function b(e){this.length=e,this.promise=null,this[e-1]=null}y.prototype.data=function(){return this._data},y.prototype.promise=function(){return this._promise},y.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():p},y.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=t!==p?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},y.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},c(_,y),_.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},b.prototype._resultCancelled=function(){for(var e=this.length,n=0;n<e;++n){var r=this[n];r instanceof t&&r.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var o,i=arguments[e-1];if("function"!=typeof i)return n("expecting a function but got "+a.classString(i));var u=!0;2===e&&Array.isArray(arguments[0])?(e=(o=arguments[0]).length,u=!1):(o=arguments,e--);for(var c=new b(e),p=0;p<e;++p){var h=o[p];if(y.isDisposer(h)){var d=h;(h=h.promise())._setDisposable(d)}else{var _=r(h);_ instanceof t&&(h=_._then(g,null,null,{resources:c,index:p},void 0))}c[p]=h}var E=new Array(c.length);for(p=0;p<E.length;++p)E[p]=t.resolve(c[p]).reflect();var O=t.all(E).then((function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return l.e=n.error(),l;if(!n.isFulfilled())return void O.cancel();e[t]=n.value()}w._pushContext(),i=f(i);var r=u?i.apply(void 0,e):i(e),o=w._popContext();return s.checkForgottenReturns(r,o,"Promise.using",w),r})),w=O.lastly((function(){var e=new t.PromiseInspection(O);return m(c,e)}));return c.promise=w,w._setOnCancel(c),w},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new _(e,this,o());throw new u}}},{"./errors":12,"./util":36}],36:[function(e,n,r){var o,i=e("./es5"),s="undefined"==typeof navigator,a={e:{}},u="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==this?this:null;function c(){try{var e=o;return o=null,e.apply(this,arguments)}catch(e){return a.e=e,a}}function l(e){return o=e,c}var f=function(e,t){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=t.prototype[r])}return r.prototype=t.prototype,e.prototype=new r,e.prototype};function p(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function h(e){return"function"==typeof e||"object"==typeof e&&null!==e}function d(e){return p(e)?new Error(R(e)):e}function m(e,t){var n,r=e.length,o=new Array(r+1);for(n=0;n<r;++n)o[n]=e[n];return o[n]=t,o}function y(e,t,n){if(!i.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function _(e,t,n){if(p(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return i.defineProperty(e,t,r),e}function g(e){throw e}var b=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(i.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],o=Object.create(null);null!=e&&!t(e);){var s;try{s=n(e)}catch(e){return r}for(var a=0;a<s.length;++a){var u=s[a];if(!o[u]){o[u]=!0;var c=Object.getOwnPropertyDescriptor(e,u);null!=c&&null==c.get&&null==c.set&&r.push(u)}}e=i.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var i in n)if(r.call(n,i))o.push(i);else{for(var s=0;s<e.length;++s)if(r.call(e[s],i))continue e;o.push(i)}return o}}(),E=/this\s*\.\s*\S+\s*=/;function O(e){try{if("function"==typeof e){var t=i.names(e.prototype),n=i.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=E.test(e+"")&&i.names(e).length>0;if(n||r||o)return!0}return!1}catch(e){return!1}}function w(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.foo}return r(),r(),e}var v=/^[a-z$_][a-z$_0-9]*$/i;function T(e){return v.test(e)}function x(e,t,n){for(var r=new Array(e),o=0;o<e;++o)r[o]=t+o+n;return r}function R(e){try{return e+""}catch(e){return"[no string representation]"}}function A(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function S(e){try{_(e,"isOperational",!0)}catch(e){}}function I(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function N(e){return A(e)&&i.propertyIsWritable(e,"stack")}var C="stack"in new Error?function(e){return N(e)?e:new Error(R(e))}:function(e){if(N(e))return e;try{throw new Error(R(e))}catch(e){return e}};function P(e){return{}.toString.call(e)}function M(e,t,n){for(var r=i.names(e),o=0;o<r.length;++o){var s=r[o];if(n(s))try{i.defineProperty(t,s,i.getDescriptor(e,s))}catch(e){}}}var j=function(e){return i.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var U="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};j=function(e){return i.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?U(e):null}}var F,q="undefined"!=typeof process&&"[object process]"===P(process).toLowerCase(),L="undefined"!=typeof process&&void 0!==process.env;function D(e){return L?process.env[e]:void 0}function B(){if("function"==typeof Promise)try{if("[object Promise]"===P(new Promise((function(){}))))return Promise}catch(e){}}function z(e,t){if(null===e||"function"!=typeof t||t===F)return t;null!==e.domain&&(t=e.domain.bind(t));var n=e.async;if(null!==n){var r=t;t=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=r,e[1]=this,n.runInAsyncScope.apply(n,e)}}return t}var k,G={setReflectHandler:function(e){F=e},isClass:O,isIdentifier:T,inheritedDataKeys:b,getDataPropertyOrDefault:y,thrower:g,isArray:i.isArray,asArray:j,notEnumerableProp:_,isPrimitive:p,isObject:h,isError:A,canEvaluate:s,errorObj:a,tryCatch:l,inherits:f,withAppended:m,maybeWrapAsError:d,toFastProperties:w,filledRange:x,toString:R,canAttachTrace:N,ensureErrorObject:C,originatesFromRejection:I,markAsOriginatingFromRejection:S,classString:P,copyDescriptors:M,isNode:q,hasEnvVariables:L,env:D,global:u,getNativePromise:B,contextBind:z};G.isRecentNode=G.isNode&&(process.versions&&process.versions.node?k=process.versions.node.split(".").map(Number):process.version&&(k=process.version.split(".").map(Number)),0===k[0]&&k[1]>10||k[0]>0),G.nodeSupportsAsyncResource=G.isNode&&function(){var t=!1;try{t="function"==typeof e("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(e){t=!1}return t}(),G.isNode&&G.toFastProperties(process);try{throw new Error}catch(e){G.lastLineError=e}n.exports=G},{"./es5":13,async_hooks:void 0}]},{},[4])(4),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}(m)),m.exports);function _(e,t){return null!=e?e:t}function g(e){return null!=e}function b(e){let t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}_.EMPTY_OBJECT=Object.freeze({}),g(Object.create)&&(b.prototype=Object.create(Error.prototype),b.prototype.constructor=b),b.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return g(this.stack)&&(e+=`\n${this.stack.toString()}`),e},b.throwInstantiationError=function(){throw new b("This function defines an interface and should not be called directly.")};var E=Object.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047});const O={BYTE:E.BYTE,UNSIGNED_BYTE:E.UNSIGNED_BYTE,SHORT:E.SHORT,UNSIGNED_SHORT:E.UNSIGNED_SHORT,INT:E.INT,UNSIGNED_INT:E.UNSIGNED_INT,FLOAT:E.FLOAT,DOUBLE:E.DOUBLE,getSizeInBytes:function(e){if(!g(e))throw new b("value is required.");switch(e){case O.BYTE:return Int8Array.BYTES_PER_ELEMENT;case O.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case O.SHORT:return Int16Array.BYTES_PER_ELEMENT;case O.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case O.INT:return Int32Array.BYTES_PER_ELEMENT;case O.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case O.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case O.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new b("componentDatatype is not a valid value.")}},fromTypedArray:function(e){if(e instanceof Int8Array)return O.BYTE;if(e instanceof Uint8Array)return O.UNSIGNED_BYTE;if(e instanceof Int16Array)return O.SHORT;if(e instanceof Uint16Array)return O.UNSIGNED_SHORT;if(e instanceof Int32Array)return O.INT;if(e instanceof Uint32Array)return O.UNSIGNED_INT;if(e instanceof Float32Array)return O.FLOAT;if(e instanceof Float64Array)return O.DOUBLE;throw new b("array must be an Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, Uint32Array, Float32Array, or Float64Array.")},validate:function(e){return g(e)&&(e===O.BYTE||e===O.UNSIGNED_BYTE||e===O.SHORT||e===O.UNSIGNED_SHORT||e===O.INT||e===O.UNSIGNED_INT||e===O.FLOAT||e===O.DOUBLE)},createTypedArray:function(e,t){if(!g(e))throw new b("componentDatatype is required.");if(!g(t))throw new b("valuesOrLength is required.");switch(e){case O.BYTE:return new Int8Array(t);case O.UNSIGNED_BYTE:return new Uint8Array(t);case O.SHORT:return new Int16Array(t);case O.UNSIGNED_SHORT:return new Uint16Array(t);case O.INT:return new Int32Array(t);case O.UNSIGNED_INT:return new Uint32Array(t);case O.FLOAT:return new Float32Array(t);case O.DOUBLE:return new Float64Array(t);default:throw new b("componentDatatype is not a valid value.")}},createArrayBufferView:function(e,t,n,r){if(!g(e))throw new b("componentDatatype is required.");if(!g(t))throw new b("buffer is required.");switch(n=_(n,0),r=_(r,(t.byteLength-n)/O.getSizeInBytes(e)),e){case O.BYTE:return new Int8Array(t,n,r);case O.UNSIGNED_BYTE:return new Uint8Array(t,n,r);case O.SHORT:return new Int16Array(t,n,r);case O.UNSIGNED_SHORT:return new Uint16Array(t,n,r);case O.INT:return new Int32Array(t,n,r);case O.UNSIGNED_INT:return new Uint32Array(t,n,r);case O.FLOAT:return new Float32Array(t,n,r);case O.DOUBLE:return new Float64Array(t,n,r);default:throw new b("componentDatatype is not a valid value.")}},fromName:function(e){switch(e){case"BYTE":return O.BYTE;case"UNSIGNED_BYTE":return O.UNSIGNED_BYTE;case"SHORT":return O.SHORT;case"UNSIGNED_SHORT":return O.UNSIGNED_SHORT;case"INT":return O.INT;case"UNSIGNED_INT":return O.UNSIGNED_INT;case"FLOAT":return O.FLOAT;case"DOUBLE":return O.DOUBLE;default:throw new b("name is not a valid value.")}}};var w=Object.freeze(O);function v(e){this.componentDatatype=e,this.typedArray=w.createTypedArray(e,0),this.length=0}function T(e,t){const n=w.createTypedArray(e.componentDatatype,t);n.set(e.typedArray),e.typedArray=n}v.prototype.push=function(e){const t=this.length,n=this.typedArray.length;0===t?T(this,1024):t===n&&T(this,t<33554432?2*n:n+33554432),this.typedArray[this.length++]=e},v.prototype.get=function(e){return this.typedArray[e]};function x(){this.transparent=!1,this.source=void 0,this.name=void 0,this.extension=void 0,this.path=void 0,this.pixels=void 0,this.width=void 0,this.height=void 0}function R(e,t){return(t=_(t,{})).checkTransparency=_(t.checkTransparency,!1),t.decode=_(t.decode,!1),t.keepSource=_(t.keepSource,!1),new y.Promise((function(t,n){const r=d.basename(e,d.extname(e)),o=d.extname(e).toLowerCase(),i=new x;i.name=r,i.extension=o,i.path=e,".png"===o?i.transparent=!0:".jpg"!==o&&".jpeg"!==o||(i.transparent=!1),t(i)}))}async function A(e,t){try{const n=await async function(e,t){if("string"!=typeof e)throw new Error("fetch url "+e+" is illegal. ");try{const n=await fetch(e,t);if(n.ok)return n;throw new Error("fetch url "+e+" failed, status="+n.status+" ;statusText="+n.statusText)}catch(e){throw e}}(e,t),r=await n.text();if(r)return r;throw new Error("fetchText result is null. ")}catch(e){throw e}}function S(e,t,n){return new Promise(((r,o)=>{function i(e){const n=e.split(/\r\n|\r|\n/g);let i=0;const s=n.length;n.forEach((e=>{if(t)try{t(e,i,s)}catch(e){o(e)}i++})),r()}if(e instanceof Blob)!function(e,t,n,r){new Promise(((o,i)=>{const s=new FileReader;s.onload=function(){t&&t(s.result),o(s.result)},s.onerror=function(e){console.error("readAsText failed.",e),n&&n(e),i(e)},s.readAsText(e,r)}))}(e,(e=>{i(e)}),(e=>{o(e)}),n);else if(e instanceof ArrayBuffer){i(new TextDecode(n).decode(e))}else if("string"==typeof e){i(e)}else o(new Error("unsupported data."+e))}))}function I(e,t){return new Promise((function(n,r){A(e).then((e=>{S(e,t).then((()=>{n()})).catch((e=>{r(e)}))})).catch((e=>{r(e)}))}))}var N,C;v.prototype.toUint16Buffer=function(){const e=this.length,t=this.typedArray,n=e+(e%2==0?0:1),r=Buffer.alloc(2*n);for(let n=0;n<e;++n)r.writeUInt16LE(t[n],2*n);return r},v.prototype.toUint32Buffer=function(){const e=this.length,t=this.typedArray,n=Buffer.alloc(4*e);for(let r=0;r<e;++r)n.writeUInt32LE(t[r],4*r);return n},v.prototype.toFloatBuffer=function(){const e=this.length,t=this.typedArray,n=Buffer.alloc(4*e);for(let r=0;r<e;++r)n.writeFloatLE(t[r],4*r);return n},v.prototype.getMinMax=function(e){const t=this.length,n=this.typedArray,r=t/e,o=new Array(e).fill(Number.POSITIVE_INFINITY),i=new Array(e).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<r;++t)for(let r=0;r<e;++r){const s=n[t*e+r];o[r]=Math.min(o[r],s),i[r]=Math.max(i[r],s)}return{min:o,max:i}};var P=function(){if(C)return N;C=1;var e=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};return e.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.init_by_array=function(e,t){var n,r,o;for(this.init_seed(19650218),n=1,r=0,o=this.N>t?this.N:t;o;o--){var i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&i)>>>16)<<16)+1664525*(65535&i))+e[r]+r,this.mt[n]>>>=0,r++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=t&&(r=0)}for(o=this.N-1;o;o--){i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1566083941*((4294901760&i)>>>16)<<16)+1566083941*(65535&i))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648},e.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random_int31=function(){return this.random_int()>>>1},e.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},e.prototype.random=function(){return this.random_int()*(1/4294967296)},e.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},e.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},N=e}(),M=n(P);const j={};function U(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}j.typeOf={},j.defined=function(e,t){if(!g(t))throw new b(function(e){return`${e} is required, actual value was undefined`}(e))},j.typeOf.func=function(e,t){if("function"!=typeof t)throw new b(U(typeof t,"function",e))},j.typeOf.string=function(e,t){if("string"!=typeof t)throw new b(U(typeof t,"string",e))},j.typeOf.number=function(e,t){if("number"!=typeof t)throw new b(U(typeof t,"number",e))},j.typeOf.number.lessThan=function(e,t,n){if(j.typeOf.number(e,t),t>=n)throw new b(`Expected ${e} to be less than ${n}, actual value was ${t}`)},j.typeOf.number.lessThanOrEquals=function(e,t,n){if(j.typeOf.number(e,t),t>n)throw new b(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)},j.typeOf.number.greaterThan=function(e,t,n){if(j.typeOf.number(e,t),t<=n)throw new b(`Expected ${e} to be greater than ${n}, actual value was ${t}`)},j.typeOf.number.greaterThanOrEquals=function(e,t,n){if(j.typeOf.number(e,t),t<n)throw new b(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)},j.typeOf.object=function(e,t){if("object"!=typeof t)throw new b(U(typeof t,"object",e))},j.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new b(U(typeof t,"boolean",e))},j.typeOf.bigint=function(e,t){if("bigint"!=typeof t)throw new b(U(typeof t,"bigint",e))},j.typeOf.number.equals=function(e,t,n,r){if(j.typeOf.number(e,n),j.typeOf.number(t,r),n!==r)throw new b(`${e} must be equal to ${t}, the actual values are ${n} and ${r}`)};const F={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};F.sign=_(Math.sign,(function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1})),F.signNotZero=function(e){return e<0?-1:1},F.toSNorm=function(e,t){return t=_(t,255),Math.round((.5*F.clamp(e,-1,1)+.5)*t)},F.fromSNorm=function(e,t){return t=_(t,255),F.clamp(e,0,t)/t*2-1},F.normalize=function(e,t,n){return 0===(n=Math.max(n-t,0))?0:F.clamp((e-t)/n,0,1)},F.sinh=_(Math.sinh,(function(e){return(Math.exp(e)-Math.exp(-e))/2})),F.cosh=_(Math.cosh,(function(e){return(Math.exp(e)+Math.exp(-e))/2})),F.lerp=function(e,t,n){return(1-n)*e+n*t},F.PI=Math.PI,F.ONE_OVER_PI=1/Math.PI,F.PI_OVER_TWO=Math.PI/2,F.PI_OVER_THREE=Math.PI/3,F.PI_OVER_FOUR=Math.PI/4,F.PI_OVER_SIX=Math.PI/6,F.THREE_PI_OVER_TWO=3*Math.PI/2,F.TWO_PI=2*Math.PI,F.ONE_OVER_TWO_PI=1/(2*Math.PI),F.RADIANS_PER_DEGREE=Math.PI/180,F.DEGREES_PER_RADIAN=180/Math.PI,F.RADIANS_PER_ARCSECOND=F.RADIANS_PER_DEGREE/3600,F.toRadians=function(e){if(!g(e))throw new b("degrees is required.");return e*F.RADIANS_PER_DEGREE},F.toDegrees=function(e){if(!g(e))throw new b("radians is required.");return e*F.DEGREES_PER_RADIAN},F.convertLongitudeRange=function(e){if(!g(e))throw new b("angle is required.");const t=F.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n},F.clampToLatitudeRange=function(e){if(!g(e))throw new b("angle is required.");return F.clamp(e,-1*F.PI_OVER_TWO,F.PI_OVER_TWO)},F.negativePiToPi=function(e){if(!g(e))throw new b("angle is required.");return e>=-F.PI&&e<=F.PI?e:F.zeroToTwoPi(e+F.PI)-F.PI},F.zeroToTwoPi=function(e){if(!g(e))throw new b("angle is required.");if(e>=0&&e<=F.TWO_PI)return e;const t=F.mod(e,F.TWO_PI);return Math.abs(t)<F.EPSILON14&&Math.abs(e)>F.EPSILON14?F.TWO_PI:t},F.mod=function(e,t){if(!g(e))throw new b("m is required.");if(!g(t))throw new b("n is required.");if(0===t)throw new b("divisor cannot be 0.");return F.sign(e)===F.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t},F.equalsEpsilon=function(e,t,n,r){if(!g(e))throw new b("left is required.");if(!g(t))throw new b("right is required.");n=_(n,0),r=_(r,n);const o=Math.abs(e-t);return o<=r||o<=n*Math.max(Math.abs(e),Math.abs(t))},F.lessThan=function(e,t,n){if(!g(e))throw new b("first is required.");if(!g(t))throw new b("second is required.");if(!g(n))throw new b("absoluteEpsilon is required.");return e-t<-n},F.lessThanOrEquals=function(e,t,n){if(!g(e))throw new b("first is required.");if(!g(t))throw new b("second is required.");if(!g(n))throw new b("absoluteEpsilon is required.");return e-t<n},F.greaterThan=function(e,t,n){if(!g(e))throw new b("first is required.");if(!g(t))throw new b("second is required.");if(!g(n))throw new b("absoluteEpsilon is required.");return e-t>n},F.greaterThanOrEquals=function(e,t,n){if(!g(e))throw new b("first is required.");if(!g(t))throw new b("second is required.");if(!g(n))throw new b("absoluteEpsilon is required.");return e-t>-n};const q=[1];F.factorial=function(e){if("number"!=typeof e||e<0)throw new b("A number greater than or equal to 0 is required.");const t=q.length;if(e>=t){let n=q[t-1];for(let r=t;r<=e;r++){const e=n*r;q.push(e),n=e}}return q[e]},F.incrementWrap=function(e,t,n){if(n=_(n,0),!g(e))throw new b("n is required.");if(t<=n)throw new b("maximumValue must be greater than minimumValue.");return++e>t&&(e=n),e},F.isPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new b("A number between 0 and (2^32)-1 is required.");return 0!==e&&!(e&e-1)},F.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>2147483648)throw new b("A number between 0 and 2^31 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},F.previousPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new b("A number between 0 and (2^32)-1 is required.");return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e=((e|=e>>32)>>>0)-(e>>>1)},F.clamp=function(e,t,n){return j.typeOf.number("value",e),j.typeOf.number("min",t),j.typeOf.number("max",n),e<t?t:e>n?n:e};let L,D=new M;function B(e,t){if(null===e||"object"!=typeof e)return e;t=_(t,!1);const n=new e.constructor;for(const r in e)if(e.hasOwnProperty(r)){let o=e[r];t&&(o=B(o,t)),n[r]=o}return n}function z(e,t,n){n=_(n,!1);const r={},o=g(e),i=g(t);let s,a,u;if(o)for(s in e)e.hasOwnProperty(s)&&(a=e[s],i&&n&&"object"==typeof a&&t.hasOwnProperty(s)?(u=t[s],r[s]="object"==typeof u?z(a,u,n):a):r[s]=a);if(i)for(s in t)t.hasOwnProperty(s)&&!r.hasOwnProperty(s)&&(u=t[s],r[s]=u);return r}function k(e,t){let n,r,o;const i=d.dirname(e),s=[],a={},u=[],c=t.overridingTextures,l=_(c.metallicRoughnessOcclusionTexture,c.specularGlossinessTexture),f=_(c.metallicRoughnessOcclusionTexture,c.specularGlossinessTexture),p=_(c.metallicRoughnessOcclusionTexture,c.occlusionTexture),h=c.normalTexture,m=c.baseColorTexture,b=c.emissiveTexture,E=c.alphaTexture,O={decode:!0},w={checkTransparency:t.checkTransparency},v=g(p)?void 0:t.packOcclusion?O:void 0,T=g(l)?void 0:O,x=g(f)?void 0:O,A={decode:!0};function S(e,t){e=e.replace(/^"(.+)"$/,"$1");return/-(bm|t|s|o|blendu|blendv|boost|mm|texres|clamp|imfchan|type)/.test(e)&&(e=e.split(/\s+/).pop()),e=e.replace(/\\/g,"/"),d.normalize(d.resolve(t,e))}function N(e){const n=g(e.alphaTexture)?A:w;e.diffuseTexture===e.ambientTexture&&(e.ambientTexture=void 0);const r=["diffuseTexture","ambientTexture","emissiveTexture","specularTexture","specularShininessTexture","normalTexture","alphaTexture"],o=[n,v,undefined,T,x,undefined,A],s={};r.forEach((function(t,n){const r=e[t],i=o[n];if(g(r)&&g(i)){g(s[r])||(s[r]=B(i));const e=s[r];e.checkTransparency=e.checkTransparency||i.checkTransparency,e.decode=e.decode||i.decode,e.keepSource=e.keepSource||!i.decode||!i.checkTransparency}})),r.forEach((function(n){const r=e[n];g(r)&&function(e,t,n,r,o,i,s){const a=e[t];if(!g(a))return;let u=o[a];if(!g(u)){const e=d.join(r,d.basename(a));u=R(a,n).catch((function(t){return s.logger(t.message),s.logger(`Could not read texture file at ${a}. Attempting to read the texture file from within the obj directory instead.`),R(e,n)})).catch((function(t){s.logger(t.message),s.logger(`Could not read texture file at ${e}. This texture will be ignored.`)})),o[a]=u}i.push(u.then((function(n){e[t]=n})))}(e,n,s[r],i,a,u,t)}))}return I(e,(function(e){if(e=e.trim(),/^newmtl/i.test(e)){!function(e){n=new V,n.name=e,n.specularShininess=t.metallicRoughness?1:0,n.specularTexture=l,n.specularShininessTexture=f,n.diffuseTexture=m,n.ambientTexture=p,n.normalTexture=h,n.emissiveTexture=b,n.alphaTexture=E,s.push(n)}(e.substring(7).trim())}else/^Ka /i.test(e)?(r=e.substring(3).trim().split(" "),n.ambientColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ke /i.test(e)?(r=e.substring(3).trim().split(" "),n.emissiveColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Kd /i.test(e)?(r=e.substring(3).trim().split(" "),n.diffuseColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ks /i.test(e)?(r=e.substring(3).trim().split(" "),n.specularColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ns /i.test(e)?(o=e.substring(3).trim(),n.specularShininess=parseFloat(o)):/^d /i.test(e)?(o=e.substring(2).trim(),n.alpha=G(parseFloat(o))):/^Tr /i.test(e)?(o=e.substring(3).trim(),n.alpha=G(1-parseFloat(o))):/^map_Ka /i.test(e)?g(p)||(n.ambientTexture=S(e.substring(7).trim(),i)):/^map_Ke /i.test(e)?g(b)||(n.emissiveTexture=S(e.substring(7).trim(),i)):/^map_Kd /i.test(e)?g(m)||(n.diffuseTexture=S(e.substring(7).trim(),i)):/^map_Ks /i.test(e)?g(l)||(n.specularTexture=S(e.substring(7).trim(),i)):/^map_Ns /i.test(e)?g(f)||(n.specularShininessTexture=S(e.substring(7).trim(),i)):/^map_Bump /i.test(e)?g(h)||(n.normalTexture=S(e.substring(9).trim(),i)):/^map_d /i.test(e)&&(g(E)||(n.alphaTexture=S(e.substring(6).trim(),i)))})).then((function(){const e=s.length;for(let t=0;t<e;++t)N(s[t]);return y.Promise.all(u)})).then((function(){return function(e,t){return e.map((function(e){return H(e,t)}))}(s,t)}))}function G(e){return 0===e?1:e}function V(){this.name=void 0,this.ambientColor=[0,0,0,1],this.emissiveColor=[0,0,0,1],this.diffuseColor=[.5,.5,.5,1],this.specularColor=[0,0,0,1],this.specularShininess=0,this.alpha=1,this.ambientTexture=void 0,this.emissiveTexture=void 0,this.diffuseTexture=void 0,this.specularTexture=void 0,this.specularShininessTexture=void 0,this.normalTexture=void 0,this.alphaTexture=void 0}function H(e,t){return t.specularGlossiness?function(e,t){const n=e.emissiveTexture,r=e.normalTexture,o=e.ambientTexture,i=e.diffuseTexture,s=e.alphaTexture,a=e.specularTexture,u=e.specularShininessTexture,c=function(e,t,n){if(g(n.overridingTextures.specularGlossinessTexture))return e;const r=g(e),o=g(t);if(!r&&!o)return;if(r&&!g(e.pixels))return void n.logger(`Could not get decoded texture data for ${e.path}. The material will be created without a specularGlossiness texture.`);if(o&&!g(t.pixels))return void n.logger(`Could not get decoded texture data for ${t.path}. The material will be created without a specularGlossiness texture.`);const i=[e,t].filter((function(e){return g(e)&&g(e.pixels)})),s=$(i,n),a=s[0],u=s[1],c=a*u,l=Buffer.alloc(4*c,255),f=Buffer.alloc(c);if(r){X(l,W(e,0,a,u,f),0);X(l,W(e,1,a,u,f),1);X(l,W(e,2,a,u,f),2)}if(o){X(l,W(t,0,a,u,f),3)}const p=i.length,h=new Array(p);for(let e=0;e<p;++e)h[e]=i[e].name;const d=h.join("_"),m=new x;return m.name=d,m.extension=".png",m.pixels=l,m.width=a,m.height=u,m}(a,u,t),l=Y(i,s,t);let f=e.emissiveColor.slice(0,3),p=e.diffuseColor,h=e.specularColor.slice(0,3),d=e.specularShininess;g(n)&&(f=[1,1,1]);g(i)&&(p=[1,1,1,1]);g(a)&&(h=[1,1,1]);g(u)&&(d=1);let m=!1;if(g(s))m=!0;else{const t=e.alpha;p[3]=t,m=t<1}g(i)&&(m=m||i.transparent);const y=m||t.doubleSidedMaterial,_=m?"BLEND":"OPAQUE";return{name:e.name,extensions:{KHR_materials_pbrSpecularGlossiness:{diffuseTexture:l,specularGlossinessTexture:c,diffuseFactor:p,specularFactor:h,glossinessFactor:d}},emissiveTexture:n,normalTexture:r,occlusionTexture:o,emissiveFactor:f,alphaMode:_,doubleSided:y}}(e,t):(t.metallicRoughness||function(e){const t=(n=e.specularColor,.2125*n[0]+.7154*n[1]+.0721*n[2]);var n;let r=e.specularShininess;r/=1e3,r=1-r,r=F.clamp(r,0,1),t<.1&&(r*=1-t);const o=0;e.specularColor=[o,o,o,1],e.specularShininess=r}(e),Z(e,t))}function W(e,t,n,r,o){const i=e.pixels,s=e.width,a=e.height,u=s*a,c=n*r;let l=o;u>c&&((!g(L)||u>L.length)&&(L=Buffer.alloc(u)),l=L);for(let e=0;e<u;++e){const n=i.readUInt8(4*e+t);l.writeUInt8(n,e)}return u>c&&function(e,t,n,r,o,i){const s=t/o,a=n/i;for(let n=0;n<i;++n)for(let i=0;i<o;++i){const u=n*o+i,c=Math.round(n*a)*t+Math.round(i*s),l=e.readUInt8(c);r.writeUInt8(l,u)}}(l,s,a,o,n,r),o}function X(e,t,n){const r=e.length/4;for(let o=0;o<r;++o){const r=t.readUInt8(o);e.writeUInt8(r,4*o+n)}}function $(e,t){let n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;const o=e.length;for(let t=0;t<o;++t){const o=e[t];n=Math.min(o.width,n),r=Math.min(o.height,r)}for(let i=0;i<o;++i){const o=e[i];o.width===n&&o.height===r||t.logger(`Texture ${o.path} will be scaled from ${o.width}x${o.height} to ${n}x${r}.`)}return[n,r]}function Y(e,t,n){const r=g(e),o=g(t);if(!r)return;if(!o)return e;if(e===t)return e;if(!g(e.pixels)||!g(t.pixels))return n.logger(`Could not get decoded texture data for ${e.path} or ${t.path}. The material will be created without an alpha texture.`),e;const i=$([e,t],n),s=i[0],a=i[1],u=s*a,c=Buffer.alloc(4*u,255),l=Buffer.alloc(u);X(c,W(e,0,s,a,l),0);X(c,W(e,1,s,a,l),1);X(c,W(e,2,s,a,l),2);let f=W(t,3,s,a,l);(function(e){const t=e.readUInt8(0),n=e.length;for(let r=1;r<n;++r)if(e[r]!==t)return!1;return!0})(f)&&(f=W(t,0,s,a,l)),X(c,f,3);const p=new x;return p.name=e.name,p.extension=".png",p.pixels=c,p.width=s,p.height=a,p.transparent=!0,p}function Z(e,t){const n=e.emissiveTexture,r=e.normalTexture;let o=e.ambientTexture;const i=e.diffuseTexture,s=e.alphaTexture,a=e.specularTexture,u=e.specularShininessTexture,c=function(e,t,n,r){if(g(r.overridingTextures.metallicRoughnessOcclusionTexture))return e;const o=g(e),i=g(t),s=g(n)&&r.packOcclusion;if(!o&&!i)return;if(o&&!g(e.pixels))return void r.logger(`Could not get decoded texture data for ${e.path}. The material will be created without a metallicRoughness texture.`);if(i&&!g(t.pixels))return void r.logger(`Could not get decoded texture data for ${t.path}. The material will be created without a metallicRoughness texture.`);if(s&&!g(n.pixels))return void r.logger(`Could not get decoded texture data for ${n.path}. The occlusion texture will not be packed in the metallicRoughness texture.`);const a=[e,t,n].filter((function(e){return g(e)&&g(e.pixels)})),u=$(a,r),c=u[0],l=u[1],f=c*l,p=Buffer.alloc(4*f,255),h=Buffer.alloc(f);o&&X(p,W(e,0,c,l,h),2);i&&X(p,W(t,0,c,l,h),1);s&&X(p,W(n,0,c,l,h),0);const d=a.length,m=new Array(d);for(let e=0;e<d;++e)m[e]=a[e].name;const y=m.join("_"),_=new x;return _.name=y,_.extension=".png",_.pixels=p,_.width=c,_.height=l,_}(a,u,o,t),l=Y(i,s,t);t.packOcclusion&&(o=c);let f=e.emissiveColor.slice(0,3),p=e.diffuseColor,h=e.specularColor[0],d=e.specularShininess;g(n)&&(f=[1,1,1]),g(i)&&(p=[1,1,1,1]),g(a)&&(h=1),g(u)&&(d=1);let m=!1;if(g(s))m=!0;else{const t=e.alpha;p[3]=t,m=t<1}g(i)&&(m=m||i.transparent);const y=m||t.doubleSidedMaterial,_=m?"BLEND":"OPAQUE";return{name:e.name,pbrMetallicRoughness:{baseColorTexture:l,metallicRoughnessTexture:c,baseColorFactor:p,metallicFactor:h,roughnessFactor:d},emissiveTexture:n,normalTexture:r,occlusionTexture:o,emissiveFactor:f,alphaMode:_,doubleSided:y}}function Q(e,t,n){this.x=_(e,0),this.y=_(t,0),this.z=_(n,0)}F.setRandomNumberSeed=function(e){if(!g(e))throw new b("seed is required.");D=new M(e)},F.nextRandomNumber=function(){return D.random()},F.randomBetween=function(e,t){return F.nextRandomNumber()*(t-e)+e},F.acosClamped=function(e){if(!g(e))throw new b("value is required.");return Math.acos(F.clamp(e,-1,1))},F.asinClamped=function(e){if(!g(e))throw new b("value is required.");return Math.asin(F.clamp(e,-1,1))},F.chordLength=function(e,t){if(!g(e))throw new b("angle is required.");if(!g(t))throw new b("radius is required.");return 2*t*Math.sin(.5*e)},F.logBase=function(e,t){if(!g(e))throw new b("number is required.");if(!g(t))throw new b("base is required.");return Math.log(e)/Math.log(t)},F.cbrt=_(Math.cbrt,(function(e){const t=Math.pow(Math.abs(e),1/3);return e<0?-t:t})),F.log2=_(Math.log2,(function(e){return Math.log(e)*Math.LOG2E})),F.fog=function(e,t){const n=e*t;return 1-Math.exp(-n*n)},F.fastApproximateAtan=function(e){return j.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},F.fastApproximateAtan2=function(e,t){let n;j.typeOf.number("x",e),j.typeOf.number("y",t);let r=Math.abs(e);n=Math.abs(t);const o=Math.max(r,n);n=Math.min(r,n);const i=n/o;if(isNaN(i))throw new b("either x or y must be nonzero");return r=F.fastApproximateAtan(i),r=Math.abs(t)>Math.abs(e)?F.PI_OVER_TWO-r:r,r=e<0?F.PI-r:r,r=t<0?-r:r,r},k.getDefaultMaterial=function(e){return H(new V,e)},k._createMaterial=function(e,t){return H(z(e,new V),t)},Q.fromSpherical=function(e,t){j.typeOf.object("spherical",e),g(t)||(t=new Q);const n=e.clock,r=e.cone,o=_(e.magnitude,1),i=o*Math.sin(r);return t.x=i*Math.cos(n),t.y=i*Math.sin(n),t.z=o*Math.cos(r),t},Q.fromElements=function(e,t,n,r){return g(r)?(r.x=e,r.y=t,r.z=n,r):new Q(e,t,n)},Q.clone=function(e,t){if(g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new Q(e.x,e.y,e.z)},Q.fromCartesian4=Q.clone,Q.packedLength=3,Q.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t},Q.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new Q),n.x=e[t++],n.y=e[t++],n.z=e[t],n},Q.packArray=function(e,t){j.defined("array",e);const n=e.length,r=3*n;if(g(t)){if(!Array.isArray(t)&&t.length!==r)throw new b("If result is a typed array, it must have exactly array.length * 3 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)Q.pack(e[r],t,3*r);return t},Q.unpackArray=function(e,t){if(j.defined("array",e),j.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new b("array length must be a multiple of 3.");const n=e.length;g(t)?t.length=n/3:t=new Array(n/3);for(let r=0;r<n;r+=3){const n=r/3;t[n]=Q.unpack(e,r,t[n])}return t},Q.fromArray=Q.unpack,Q.maximumComponent=function(e){return j.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},Q.minimumComponent=function(e){return j.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},Q.minimumByComponent=function(e,t,n){return j.typeOf.object("first",e),j.typeOf.object("second",t),j.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n},Q.maximumByComponent=function(e,t,n){return j.typeOf.object("first",e),j.typeOf.object("second",t),j.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n},Q.clamp=function(e,t,n,r){j.typeOf.object("value",e),j.typeOf.object("min",t),j.typeOf.object("max",n),j.typeOf.object("result",r);const o=F.clamp(e.x,t.x,n.x),i=F.clamp(e.y,t.y,n.y),s=F.clamp(e.z,t.z,n.z);return r.x=o,r.y=i,r.z=s,r},Q.magnitudeSquared=function(e){return j.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},Q.magnitude=function(e){return Math.sqrt(Q.magnitudeSquared(e))};const K=new Q;Q.distance=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),Q.subtract(e,t,K),Q.magnitude(K)},Q.distanceSquared=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),Q.subtract(e,t,K),Q.magnitudeSquared(K)},Q.normalize=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=Q.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new b("normalized result is not a number");return t},Q.dot=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},Q.multiplyComponents=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n},Q.divideComponents=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n},Q.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n},Q.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n},Q.multiplyByScalar=function(e,t,n){return j.typeOf.object("cartesian",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n},Q.divideByScalar=function(e,t,n){return j.typeOf.object("cartesian",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n},Q.negate=function(e,t){return j.typeOf.object("cartesian",e),j.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},Q.abs=function(e,t){return j.typeOf.object("cartesian",e),j.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};const J=new Q;Q.lerp=function(e,t,n,r){return j.typeOf.object("start",e),j.typeOf.object("end",t),j.typeOf.number("t",n),j.typeOf.object("result",r),Q.multiplyByScalar(t,n,J),r=Q.multiplyByScalar(e,1-n,r),Q.add(J,r,r)};const ee=new Q,te=new Q;Q.angleBetween=function(e,t){j.typeOf.object("left",e),j.typeOf.object("right",t),Q.normalize(e,ee),Q.normalize(t,te);const n=Q.dot(ee,te),r=Q.magnitude(Q.cross(ee,te,ee));return Math.atan2(r,n)};const ne=new Q;Q.mostOrthogonalAxis=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=Q.normalize(e,ne);return Q.abs(n,n),t=n.x<=n.y?n.x<=n.z?Q.clone(Q.UNIT_X,t):Q.clone(Q.UNIT_Z,t):n.y<=n.z?Q.clone(Q.UNIT_Y,t):Q.clone(Q.UNIT_Z,t)},Q.projectVector=function(e,t,n){j.defined("a",e),j.defined("b",t),j.defined("result",n);const r=Q.dot(e,t)/Q.dot(t,t);return Q.multiplyByScalar(t,r,n)},Q.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},Q.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]},Q.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.x,t.x,n,r)&&F.equalsEpsilon(e.y,t.y,n,r)&&F.equalsEpsilon(e.z,t.z,n,r)},Q.cross=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=t.x,a=t.y,u=t.z,c=o*u-i*a,l=i*s-r*u,f=r*a-o*s;return n.x=c,n.y=l,n.z=f,n},Q.midpoint=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y),n.z=.5*(e.z+t.z),n},Q.fromDegrees=function(e,t,n,r,o){return j.typeOf.number("longitude",e),j.typeOf.number("latitude",t),e=F.toRadians(e),t=F.toRadians(t),Q.fromRadians(e,t,n,r,o)};let re=new Q,oe=new Q;function ie(e,t,n,r,o,i,s,a,u){this[0]=_(e,0),this[1]=_(r,0),this[2]=_(s,0),this[3]=_(t,0),this[4]=_(o,0),this[5]=_(a,0),this[6]=_(n,0),this[7]=_(i,0),this[8]=_(u,0)}Q._ellipsoidRadiiSquared=new Q(40680631590769,40680631590769,40408299984661.445),Q.fromRadians=function(e,t,n,r,o){j.typeOf.number("longitude",e),j.typeOf.number("latitude",t),n=_(n,0);const i=g(r)?r.radiiSquared:Q._ellipsoidRadiiSquared,s=Math.cos(t);re.x=s*Math.cos(e),re.y=s*Math.sin(e),re.z=Math.sin(t),re=Q.normalize(re,re),Q.multiplyComponents(i,re,oe);const a=Math.sqrt(Q.dot(re,oe));return oe=Q.divideByScalar(oe,a,oe),re=Q.multiplyByScalar(re,n,re),g(o)||(o=new Q),Q.add(oe,re,o)},Q.fromDegreesArray=function(e,t,n){if(j.defined("coordinates",e),e.length<2||e.length%2!=0)throw new b("the number of coordinates must be a multiple of 2 and at least 2");const r=e.length;g(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=e[o],i=e[o+1],s=o/2;n[s]=Q.fromDegrees(r,i,0,t,n[s])}return n},Q.fromRadiansArray=function(e,t,n){if(j.defined("coordinates",e),e.length<2||e.length%2!=0)throw new b("the number of coordinates must be a multiple of 2 and at least 2");const r=e.length;g(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=e[o],i=e[o+1],s=o/2;n[s]=Q.fromRadians(r,i,0,t,n[s])}return n},Q.fromDegreesArrayHeights=function(e,t,n){if(j.defined("coordinates",e),e.length<3||e.length%3!=0)throw new b("the number of coordinates must be a multiple of 3 and at least 3");const r=e.length;g(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=e[o],i=e[o+1],s=e[o+2],a=o/3;n[a]=Q.fromDegrees(r,i,s,t,n[a])}return n},Q.fromRadiansArrayHeights=function(e,t,n){if(j.defined("coordinates",e),e.length<3||e.length%3!=0)throw new b("the number of coordinates must be a multiple of 3 and at least 3");const r=e.length;g(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=e[o],i=e[o+1],s=e[o+2],a=o/3;n[a]=Q.fromRadians(r,i,s,t,n[a])}return n},Q.ZERO=Object.freeze(new Q(0,0,0)),Q.ONE=Object.freeze(new Q(1,1,1)),Q.UNIT_X=Object.freeze(new Q(1,0,0)),Q.UNIT_Y=Object.freeze(new Q(0,1,0)),Q.UNIT_Z=Object.freeze(new Q(0,0,1)),Q.prototype.clone=function(e){return Q.clone(this,e)},Q.prototype.equals=function(e){return Q.equals(this,e)},Q.prototype.equalsEpsilon=function(e,t,n){return Q.equalsEpsilon(this,e,t,n)},Q.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`},ie.packedLength=9,ie.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t},ie.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new ie),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n},ie.packArray=function(e,t){j.defined("array",e);const n=e.length,r=9*n;if(g(t)){if(!Array.isArray(t)&&t.length!==r)throw new b("If result is a typed array, it must have exactly array.length * 9 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)ie.pack(e[r],t,9*r);return t},ie.unpackArray=function(e,t){if(j.defined("array",e),j.typeOf.number.greaterThanOrEquals("array.length",e.length,9),e.length%9!=0)throw new b("array length must be a multiple of 9.");const n=e.length;g(t)?t.length=n/9:t=new Array(n/9);for(let r=0;r<n;r+=9){const n=r/9;t[n]=ie.unpack(e,r,t[n])}return t},ie.clone=function(e,t){if(g(e))return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new ie(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},ie.fromArray=ie.unpack,ie.fromColumnMajorArray=function(e,t){return j.defined("values",e),ie.clone(e,t)},ie.fromRowMajorArray=function(e,t){return j.defined("values",e),g(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new ie(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},ie.fromQuaternion=function(e,t){j.typeOf.object("quaternion",e);const n=e.x*e.x,r=e.x*e.y,o=e.x*e.z,i=e.x*e.w,s=e.y*e.y,a=e.y*e.z,u=e.y*e.w,c=e.z*e.z,l=e.z*e.w,f=e.w*e.w,p=n-s-c+f,h=2*(r-l),d=2*(o+u),m=2*(r+l),y=-n+s-c+f,_=2*(a-i),b=2*(o-u),E=2*(a+i),O=-n-s+c+f;return g(t)?(t[0]=p,t[1]=m,t[2]=b,t[3]=h,t[4]=y,t[5]=E,t[6]=d,t[7]=_,t[8]=O,t):new ie(p,h,d,m,y,_,b,E,O)},ie.fromHeadingPitchRoll=function(e,t){j.typeOf.object("headingPitchRoll",e);const n=Math.cos(-e.pitch),r=Math.cos(-e.heading),o=Math.cos(e.roll),i=Math.sin(-e.pitch),s=Math.sin(-e.heading),a=Math.sin(e.roll),u=n*r,c=-o*s+a*i*r,l=a*s+o*i*r,f=n*s,p=o*r+a*i*s,h=-a*r+o*i*s,d=-i,m=a*n,y=o*n;return g(t)?(t[0]=u,t[1]=f,t[2]=d,t[3]=c,t[4]=p,t[5]=m,t[6]=l,t[7]=h,t[8]=y,t):new ie(u,c,l,f,p,h,d,m,y)},ie.fromScale=function(e,t){return j.typeOf.object("scale",e),g(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new ie(e.x,0,0,0,e.y,0,0,0,e.z)},ie.fromUniformScale=function(e,t){return j.typeOf.number("scale",e),g(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new ie(e,0,0,0,e,0,0,0,e)},ie.fromCrossProduct=function(e,t){return j.typeOf.object("vector",e),g(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new ie(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},ie.fromRotationX=function(e,t){j.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=r,t[6]=0,t[7]=-r,t[8]=n,t):new ie(1,0,0,0,n,-r,0,r,n)},ie.fromRotationY=function(e,t){j.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=1,t[5]=0,t[6]=r,t[7]=0,t[8]=n,t):new ie(n,0,r,0,1,0,-r,0,n)},ie.fromRotationZ=function(e,t){j.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new ie(n,-r,0,r,n,0,0,0,1)},ie.toArray=function(e,t){return j.typeOf.object("matrix",e),g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},ie.getElementIndex=function(e,t){return j.typeOf.number.greaterThanOrEquals("row",t,0),j.typeOf.number.lessThanOrEquals("row",t,2),j.typeOf.number.greaterThanOrEquals("column",e,0),j.typeOf.number.lessThanOrEquals("column",e,2),3*e+t},ie.getColumn=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,2),j.typeOf.object("result",n);const r=3*t,o=e[r],i=e[r+1],s=e[r+2];return n.x=o,n.y=i,n.z=s,n},ie.setColumn=function(e,t,n,r){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,2),j.typeOf.object("cartesian",n),j.typeOf.object("result",r);const o=3*t;return(r=ie.clone(e,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r},ie.getRow=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,2),j.typeOf.object("result",n);const r=e[t],o=e[t+3],i=e[t+6];return n.x=r,n.y=o,n.z=i,n},ie.setRow=function(e,t,n,r){return j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,2),j.typeOf.object("cartesian",n),j.typeOf.object("result",r),(r=ie.clone(e,r))[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};const se=new Q;ie.setScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("scale",t),j.typeOf.object("result",n);const r=ie.getScale(e,se),o=t.x/r.x,i=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*i,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};const ae=new Q;ie.setUniformScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number("scale",t),j.typeOf.object("result",n);const r=ie.getScale(e,ae),o=t/r.x,i=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*i,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};const ue=new Q;ie.getScale=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t.x=Q.magnitude(Q.fromElements(e[0],e[1],e[2],ue)),t.y=Q.magnitude(Q.fromElements(e[3],e[4],e[5],ue)),t.z=Q.magnitude(Q.fromElements(e[6],e[7],e[8],ue)),t};const ce=new Q;ie.getMaximumScale=function(e){return ie.getScale(e,ce),Q.maximumComponent(ce)};const le=new Q;ie.setRotation=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("result",n);const r=ie.getScale(e,le);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=t[3]*r.y,n[4]=t[4]*r.y,n[5]=t[5]*r.y,n[6]=t[6]*r.z,n[7]=t[7]*r.z,n[8]=t[8]*r.z,n};const fe=new Q;ie.getRotation=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=ie.getScale(e,fe);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t},ie.multiply=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n);const r=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],o=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],i=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],a=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],u=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],l=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],f=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=r,n[1]=o,n[2]=i,n[3]=s,n[4]=a,n[5]=u,n[6]=c,n[7]=l,n[8]=f,n},ie.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n},ie.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n},ie.multiplyByVector=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("cartesian",t),j.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e[0]*r+e[3]*o+e[6]*i,a=e[1]*r+e[4]*o+e[7]*i,u=e[2]*r+e[5]*o+e[8]*i;return n.x=s,n.y=a,n.z=u,n},ie.multiplyByScalar=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},ie.multiplyByScale=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.object("scale",t),j.typeOf.object("result",n),n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n},ie.multiplyByUniformScale=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.number("scale",t),j.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},ie.negate=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},ie.transpose=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=e[0],r=e[3],o=e[6],i=e[1],s=e[4],a=e[7],u=e[2],c=e[5],l=e[8];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=s,t[5]=a,t[6]=u,t[7]=c,t[8]=l,t};const pe=[1,0,0],he=[2,2,1];function de(e){let t=0;for(let n=0;n<3;++n){const r=e[ie.getElementIndex(he[n],pe[n])];t+=2*r*r}return Math.sqrt(t)}function me(e,t){const n=F.EPSILON15;let r=0,o=1;for(let t=0;t<3;++t){const n=Math.abs(e[ie.getElementIndex(he[t],pe[t])]);n>r&&(o=t,r=n)}let i=1,s=0;const a=pe[o],u=he[o];if(Math.abs(e[ie.getElementIndex(u,a)])>n){const t=(e[ie.getElementIndex(u,u)]-e[ie.getElementIndex(a,a)])/2/e[ie.getElementIndex(u,a)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),i=1/Math.sqrt(1+n*n),s=n*i}return(t=ie.clone(ie.IDENTITY,t))[ie.getElementIndex(a,a)]=t[ie.getElementIndex(u,u)]=i,t[ie.getElementIndex(u,a)]=s,t[ie.getElementIndex(a,u)]=-s,t}const ye=new ie,_e=new ie;ie.computeEigenDecomposition=function(e,t){j.typeOf.object("matrix",e);const n=F.EPSILON20;let r=0,o=0;g(t)||(t={});const i=t.unitary=ie.clone(ie.IDENTITY,t.unitary),s=t.diagonal=ie.clone(e,t.diagonal),a=n*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(s);for(;o<10&&de(s)>a;)me(s,ye),ie.transpose(ye,_e),ie.multiply(s,ye,s),ie.multiply(_e,s,s),ie.multiply(i,ye,i),++r>2&&(++o,r=0);return t},ie.abs=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},ie.determinant=function(e){j.typeOf.object("matrix",e);const t=e[0],n=e[3],r=e[6],o=e[1],i=e[4],s=e[7],a=e[2],u=e[5],c=e[8];return t*(i*c-u*s)+o*(u*r-n*c)+a*(n*s-i*r)},ie.inverse=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],f=ie.determinant(e);if(Math.abs(f)<=F.EPSILON15)throw new b("matrix is not invertible");t[0]=s*l-c*a,t[1]=c*o-r*l,t[2]=r*a-s*o,t[3]=u*a-i*l,t[4]=n*l-u*o,t[5]=i*o-n*a,t[6]=i*c-u*s,t[7]=u*r-n*c,t[8]=n*s-i*r;const p=1/f;return ie.multiplyByScalar(t,p,t)};const ge=new ie;function be(e,t,n,r){this.x=_(e,0),this.y=_(t,0),this.z=_(n,0),this.w=_(r,0)}ie.inverseTranspose=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),ie.inverse(ie.transpose(e,ge),t)},ie.equals=function(e,t){return e===t||g(e)&&g(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},ie.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n},ie.IDENTITY=Object.freeze(new ie(1,0,0,0,1,0,0,0,1)),ie.ZERO=Object.freeze(new ie(0,0,0,0,0,0,0,0,0)),ie.COLUMN0ROW0=0,ie.COLUMN0ROW1=1,ie.COLUMN0ROW2=2,ie.COLUMN1ROW0=3,ie.COLUMN1ROW1=4,ie.COLUMN1ROW2=5,ie.COLUMN2ROW0=6,ie.COLUMN2ROW1=7,ie.COLUMN2ROW2=8,Object.defineProperties(ie.prototype,{length:{get:function(){return ie.packedLength}}}),ie.prototype.clone=function(e){return ie.clone(this,e)},ie.prototype.equals=function(e){return ie.equals(this,e)},ie.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]},ie.prototype.equalsEpsilon=function(e,t){return ie.equalsEpsilon(this,e,t)},ie.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})\n(${this[1]}, ${this[4]}, ${this[7]})\n(${this[2]}, ${this[5]}, ${this[8]})`},be.fromElements=function(e,t,n,r,o){return g(o)?(o.x=e,o.y=t,o.z=n,o.w=r,o):new be(e,t,n,r)},be.fromColor=function(e,t){return j.typeOf.object("color",e),g(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new be(e.red,e.green,e.blue,e.alpha)},be.clone=function(e,t){if(g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new be(e.x,e.y,e.z,e.w)},be.packedLength=4,be.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},be.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new be),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n},be.packArray=function(e,t){j.defined("array",e);const n=e.length,r=4*n;if(g(t)){if(!Array.isArray(t)&&t.length!==r)throw new b("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)be.pack(e[r],t,4*r);return t},be.unpackArray=function(e,t){if(j.defined("array",e),j.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new b("array length must be a multiple of 4.");const n=e.length;g(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;t[n]=be.unpack(e,r,t[n])}return t},be.fromArray=be.unpack,be.maximumComponent=function(e){return j.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z,e.w)},be.minimumComponent=function(e){return j.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z,e.w)},be.minimumByComponent=function(e,t,n){return j.typeOf.object("first",e),j.typeOf.object("second",t),j.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n},be.maximumByComponent=function(e,t,n){return j.typeOf.object("first",e),j.typeOf.object("second",t),j.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n},be.clamp=function(e,t,n,r){j.typeOf.object("value",e),j.typeOf.object("min",t),j.typeOf.object("max",n),j.typeOf.object("result",r);const o=F.clamp(e.x,t.x,n.x),i=F.clamp(e.y,t.y,n.y),s=F.clamp(e.z,t.z,n.z),a=F.clamp(e.w,t.w,n.w);return r.x=o,r.y=i,r.z=s,r.w=a,r},be.magnitudeSquared=function(e){return j.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},be.magnitude=function(e){return Math.sqrt(be.magnitudeSquared(e))};const Ee=new be;be.distance=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),be.subtract(e,t,Ee),be.magnitude(Ee)},be.distanceSquared=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),be.subtract(e,t,Ee),be.magnitudeSquared(Ee)},be.normalize=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=be.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))throw new b("normalized result is not a number");return t},be.dot=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},be.multiplyComponents=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n},be.divideComponents=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n},be.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},be.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},be.multiplyByScalar=function(e,t,n){return j.typeOf.object("cartesian",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},be.divideByScalar=function(e,t,n){return j.typeOf.object("cartesian",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},be.negate=function(e,t){return j.typeOf.object("cartesian",e),j.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},be.abs=function(e,t){return j.typeOf.object("cartesian",e),j.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};const Oe=new be;be.lerp=function(e,t,n,r){return j.typeOf.object("start",e),j.typeOf.object("end",t),j.typeOf.number("t",n),j.typeOf.object("result",r),be.multiplyByScalar(t,n,Oe),r=be.multiplyByScalar(e,1-n,r),be.add(Oe,r,r)};const we=new be;be.mostOrthogonalAxis=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=be.normalize(e,we);return be.abs(n,n),t=n.x<=n.y?n.x<=n.z?n.x<=n.w?be.clone(be.UNIT_X,t):be.clone(be.UNIT_W,t):n.z<=n.w?be.clone(be.UNIT_Z,t):be.clone(be.UNIT_W,t):n.y<=n.z?n.y<=n.w?be.clone(be.UNIT_Y,t):be.clone(be.UNIT_W,t):n.z<=n.w?be.clone(be.UNIT_Z,t):be.clone(be.UNIT_W,t)},be.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},be.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]},be.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.x,t.x,n,r)&&F.equalsEpsilon(e.y,t.y,n,r)&&F.equalsEpsilon(e.z,t.z,n,r)&&F.equalsEpsilon(e.w,t.w,n,r)},be.ZERO=Object.freeze(new be(0,0,0,0)),be.ONE=Object.freeze(new be(1,1,1,1)),be.UNIT_X=Object.freeze(new be(1,0,0,0)),be.UNIT_Y=Object.freeze(new be(0,1,0,0)),be.UNIT_Z=Object.freeze(new be(0,0,1,0)),be.UNIT_W=Object.freeze(new be(0,0,0,1)),be.prototype.clone=function(e){return be.clone(this,e)},be.prototype.equals=function(e){return be.equals(this,e)},be.prototype.equalsEpsilon=function(e,t,n){return be.equalsEpsilon(this,e,t,n)},be.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const ve=new Float32Array(1),Te=new Uint8Array(ve.buffer),xe=new Uint32Array([287454020]),Re=68===new Uint8Array(xe.buffer)[0];function Ae(e){let t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}function Se(e,t,n,r,o,i,s,a,u,c,l,f,p,h,d,m){this[0]=_(e,0),this[1]=_(o,0),this[2]=_(u,0),this[3]=_(p,0),this[4]=_(t,0),this[5]=_(i,0),this[6]=_(c,0),this[7]=_(h,0),this[8]=_(n,0),this[9]=_(s,0),this[10]=_(l,0),this[11]=_(d,0),this[12]=_(r,0),this[13]=_(a,0),this[14]=_(f,0),this[15]=_(m,0)}be.packFloat=function(e,t){return j.typeOf.number("value",e),g(t)||(t=new be),ve[0]=e,Re?(t.x=Te[0],t.y=Te[1],t.z=Te[2],t.w=Te[3]):(t.x=Te[3],t.y=Te[2],t.z=Te[1],t.w=Te[0]),t},be.unpackFloat=function(e){return j.typeOf.object("packedFloat",e),Re?(Te[0]=e.x,Te[1]=e.y,Te[2]=e.z,Te[3]=e.w):(Te[0]=e.w,Te[1]=e.z,Te[2]=e.y,Te[3]=e.x),ve[0]},g(Object.create)&&(Ae.prototype=Object.create(Error.prototype),Ae.prototype.constructor=Ae),Ae.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return g(this.stack)&&(e+=`\n${this.stack.toString()}`),e},Se.packedLength=16,Se.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t},Se.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new Se),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n},Se.packArray=function(e,t){j.defined("array",e);const n=e.length,r=16*n;if(g(t)){if(!Array.isArray(t)&&t.length!==r)throw new b("If result is a typed array, it must have exactly array.length * 16 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)Se.pack(e[r],t,16*r);return t},Se.unpackArray=function(e,t){if(j.defined("array",e),j.typeOf.number.greaterThanOrEquals("array.length",e.length,16),e.length%16!=0)throw new b("array length must be a multiple of 16.");const n=e.length;g(t)?t.length=n/16:t=new Array(n/16);for(let r=0;r<n;r+=16){const n=r/16;t[n]=Se.unpack(e,r,t[n])}return t},Se.clone=function(e,t){if(g(e))return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new Se(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},Se.fromArray=Se.unpack,Se.fromColumnMajorArray=function(e,t){return j.defined("values",e),Se.clone(e,t)},Se.fromRowMajorArray=function(e,t){return j.defined("values",e),g(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new Se(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Se.fromRotationTranslation=function(e,t,n){return j.typeOf.object("rotation",e),t=_(t,Q.ZERO),g(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new Se(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},Se.fromTranslationQuaternionRotationScale=function(e,t,n,r){j.typeOf.object("translation",e),j.typeOf.object("rotation",t),j.typeOf.object("scale",n),g(r)||(r=new Se);const o=n.x,i=n.y,s=n.z,a=t.x*t.x,u=t.x*t.y,c=t.x*t.z,l=t.x*t.w,f=t.y*t.y,p=t.y*t.z,h=t.y*t.w,d=t.z*t.z,m=t.z*t.w,y=t.w*t.w,_=a-f-d+y,b=2*(u-m),E=2*(c+h),O=2*(u+m),w=-a+f-d+y,v=2*(p-l),T=2*(c-h),x=2*(p+l),R=-a-f+d+y;return r[0]=_*o,r[1]=O*o,r[2]=T*o,r[3]=0,r[4]=b*i,r[5]=w*i,r[6]=x*i,r[7]=0,r[8]=E*s,r[9]=v*s,r[10]=R*s,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r},Se.fromTranslationRotationScale=function(e,t){return j.typeOf.object("translationRotationScale",e),Se.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},Se.fromTranslation=function(e,t){return j.typeOf.object("translation",e),Se.fromRotationTranslation(ie.IDENTITY,e,t)},Se.fromScale=function(e,t){return j.typeOf.object("scale",e),g(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Se(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},Se.fromUniformScale=function(e,t){return j.typeOf.number("scale",e),g(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Se(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)},Se.fromRotation=function(e,t){return j.typeOf.object("rotation",e),g(t)||(t=new Se),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};const Ie=new Q,Ne=new Q,Ce=new Q;Se.fromCamera=function(e,t){j.typeOf.object("camera",e);const n=e.position,r=e.direction,o=e.up;j.typeOf.object("camera.position",n),j.typeOf.object("camera.direction",r),j.typeOf.object("camera.up",o),Q.normalize(r,Ie),Q.normalize(Q.cross(Ie,o,Ne),Ne),Q.normalize(Q.cross(Ne,Ie,Ce),Ce);const i=Ne.x,s=Ne.y,a=Ne.z,u=Ie.x,c=Ie.y,l=Ie.z,f=Ce.x,p=Ce.y,h=Ce.z,d=n.x,m=n.y,y=n.z,_=i*-d+s*-m+a*-y,b=f*-d+p*-m+h*-y,E=u*d+c*m+l*y;return g(t)?(t[0]=i,t[1]=f,t[2]=-u,t[3]=0,t[4]=s,t[5]=p,t[6]=-c,t[7]=0,t[8]=a,t[9]=h,t[10]=-l,t[11]=0,t[12]=_,t[13]=b,t[14]=E,t[15]=1,t):new Se(i,s,a,_,f,p,h,b,-u,-c,-l,E,0,0,0,1)},Se.computePerspectiveFieldOfView=function(e,t,n,r,o){j.typeOf.number.greaterThan("fovY",e,0),j.typeOf.number.lessThan("fovY",e,Math.PI),j.typeOf.number.greaterThan("near",n,0),j.typeOf.number.greaterThan("far",r,0),j.typeOf.object("result",o);const i=1/Math.tan(.5*e),s=i/t,a=(r+n)/(n-r),u=2*r*n/(n-r);return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=a,o[11]=-1,o[12]=0,o[13]=0,o[14]=u,o[15]=0,o},Se.computeOrthographicOffCenter=function(e,t,n,r,o,i,s){j.typeOf.number("left",e),j.typeOf.number("right",t),j.typeOf.number("bottom",n),j.typeOf.number("top",r),j.typeOf.number("near",o),j.typeOf.number("far",i),j.typeOf.object("result",s);let a=1/(t-e),u=1/(r-n),c=1/(i-o);const l=-(t+e)*a,f=-(r+n)*u,p=-(i+o)*c;return a*=2,u*=2,c*=-2,s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=c,s[11]=0,s[12]=l,s[13]=f,s[14]=p,s[15]=1,s},Se.computePerspectiveOffCenter=function(e,t,n,r,o,i,s){j.typeOf.number("left",e),j.typeOf.number("right",t),j.typeOf.number("bottom",n),j.typeOf.number("top",r),j.typeOf.number("near",o),j.typeOf.number("far",i),j.typeOf.object("result",s);const a=2*o/(t-e),u=2*o/(r-n),c=(t+e)/(t-e),l=(r+n)/(r-n),f=-(i+o)/(i-o),p=-2*i*o/(i-o);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=c,s[9]=l,s[10]=f,s[11]=-1,s[12]=0,s[13]=0,s[14]=p,s[15]=0,s},Se.computeInfinitePerspectiveOffCenter=function(e,t,n,r,o,i){j.typeOf.number("left",e),j.typeOf.number("right",t),j.typeOf.number("bottom",n),j.typeOf.number("top",r),j.typeOf.number("near",o),j.typeOf.object("result",i);const s=2*o/(t-e),a=2*o/(r-n),u=(t+e)/(t-e),c=(r+n)/(r-n),l=-2*o;return i[0]=s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=u,i[9]=c,i[10]=-1,i[11]=-1,i[12]=0,i[13]=0,i[14]=l,i[15]=0,i},Se.computeViewportTransformation=function(e,t,n,r){g(r)||(r=new Se),e=_(e,_.EMPTY_OBJECT);const o=_(e.x,0),i=_(e.y,0),s=_(e.width,0),a=_(e.height,0);t=_(t,0);const u=.5*s,c=.5*a,l=.5*((n=_(n,1))-t),f=u,p=c,h=l,d=o+u,m=i+c,y=t+l;return r[0]=f,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=p,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=h,r[11]=0,r[12]=d,r[13]=m,r[14]=y,r[15]=1,r},Se.computeView=function(e,t,n,r,o){return j.typeOf.object("position",e),j.typeOf.object("direction",t),j.typeOf.object("up",n),j.typeOf.object("right",r),j.typeOf.object("result",o),o[0]=r.x,o[1]=n.x,o[2]=-t.x,o[3]=0,o[4]=r.y,o[5]=n.y,o[6]=-t.y,o[7]=0,o[8]=r.z,o[9]=n.z,o[10]=-t.z,o[11]=0,o[12]=-Q.dot(r,e),o[13]=-Q.dot(n,e),o[14]=Q.dot(t,e),o[15]=1,o},Se.toArray=function(e,t){return j.typeOf.object("matrix",e),g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},Se.getElementIndex=function(e,t){return j.typeOf.number.greaterThanOrEquals("row",t,0),j.typeOf.number.lessThanOrEquals("row",t,3),j.typeOf.number.greaterThanOrEquals("column",e,0),j.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},Se.getColumn=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,3),j.typeOf.object("result",n);const r=4*t,o=e[r],i=e[r+1],s=e[r+2],a=e[r+3];return n.x=o,n.y=i,n.z=s,n.w=a,n},Se.setColumn=function(e,t,n,r){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,3),j.typeOf.object("cartesian",n),j.typeOf.object("result",r);const o=4*t;return(r=Se.clone(e,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r[o+3]=n.w,r},Se.getRow=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,3),j.typeOf.object("result",n);const r=e[t],o=e[t+4],i=e[t+8],s=e[t+12];return n.x=r,n.y=o,n.z=i,n.w=s,n},Se.setRow=function(e,t,n,r){return j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,3),j.typeOf.object("cartesian",n),j.typeOf.object("result",r),(r=Se.clone(e,r))[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r},Se.setTranslation=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.object("translation",t),j.typeOf.object("result",n),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};const Pe=new Q;Se.setScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("scale",t),j.typeOf.object("result",n);const r=Se.getScale(e,Pe),o=t.x/r.x,i=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const Me=new Q;Se.setUniformScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number("scale",t),j.typeOf.object("result",n);const r=Se.getScale(e,Me),o=t/r.x,i=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const je=new Q;Se.getScale=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t.x=Q.magnitude(Q.fromElements(e[0],e[1],e[2],je)),t.y=Q.magnitude(Q.fromElements(e[4],e[5],e[6],je)),t.z=Q.magnitude(Q.fromElements(e[8],e[9],e[10],je)),t};const Ue=new Q;Se.getMaximumScale=function(e){return Se.getScale(e,Ue),Q.maximumComponent(Ue)};const Fe=new Q;Se.setRotation=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("result",n);const r=Se.getScale(e,Fe);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=e[3],n[4]=t[3]*r.y,n[5]=t[4]*r.y,n[6]=t[5]*r.y,n[7]=e[7],n[8]=t[6]*r.z,n[9]=t[7]*r.z,n[10]=t[8]*r.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const qe=new Q;Se.getRotation=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=Se.getScale(e,qe);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t},Se.multiply=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],m=e[12],y=e[13],_=e[14],g=e[15],b=t[0],E=t[1],O=t[2],w=t[3],v=t[4],T=t[5],x=t[6],R=t[7],A=t[8],S=t[9],I=t[10],N=t[11],C=t[12],P=t[13],M=t[14],U=t[15],F=r*b+a*E+f*O+m*w,q=o*b+u*E+p*O+y*w,L=i*b+c*E+h*O+_*w,D=s*b+l*E+d*O+g*w,B=r*v+a*T+f*x+m*R,z=o*v+u*T+p*x+y*R,k=i*v+c*T+h*x+_*R,G=s*v+l*T+d*x+g*R,V=r*A+a*S+f*I+m*N,H=o*A+u*S+p*I+y*N,W=i*A+c*S+h*I+_*N,X=s*A+l*S+d*I+g*N,$=r*C+a*P+f*M+m*U,Y=o*C+u*P+p*M+y*U,Z=i*C+c*P+h*M+_*U,Q=s*C+l*P+d*M+g*U;return n[0]=F,n[1]=q,n[2]=L,n[3]=D,n[4]=B,n[5]=z,n[6]=k,n[7]=G,n[8]=V,n[9]=H,n[10]=W,n[11]=X,n[12]=$,n[13]=Y,n[14]=Z,n[15]=Q,n},Se.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n},Se.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n},Se.multiplyTransformation=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],s=e[4],a=e[5],u=e[6],c=e[8],l=e[9],f=e[10],p=e[12],h=e[13],d=e[14],m=t[0],y=t[1],_=t[2],g=t[4],b=t[5],E=t[6],O=t[8],w=t[9],v=t[10],T=t[12],x=t[13],R=t[14],A=r*m+s*y+c*_,S=o*m+a*y+l*_,I=i*m+u*y+f*_,N=r*g+s*b+c*E,C=o*g+a*b+l*E,P=i*g+u*b+f*E,M=r*O+s*w+c*v,U=o*O+a*w+l*v,F=i*O+u*w+f*v,q=r*T+s*x+c*R+p,L=o*T+a*x+l*R+h,D=i*T+u*x+f*R+d;return n[0]=A,n[1]=S,n[2]=I,n[3]=0,n[4]=N,n[5]=C,n[6]=P,n[7]=0,n[8]=M,n[9]=U,n[10]=F,n[11]=0,n[12]=q,n[13]=L,n[14]=D,n[15]=1,n},Se.multiplyByMatrix3=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("rotation",t),j.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],s=e[4],a=e[5],u=e[6],c=e[8],l=e[9],f=e[10],p=t[0],h=t[1],d=t[2],m=t[3],y=t[4],_=t[5],g=t[6],b=t[7],E=t[8],O=r*p+s*h+c*d,w=o*p+a*h+l*d,v=i*p+u*h+f*d,T=r*m+s*y+c*_,x=o*m+a*y+l*_,R=i*m+u*y+f*_,A=r*g+s*b+c*E,S=o*g+a*b+l*E,I=i*g+u*b+f*E;return n[0]=O,n[1]=w,n[2]=v,n[3]=0,n[4]=T,n[5]=x,n[6]=R,n[7]=0,n[8]=A,n[9]=S,n[10]=I,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},Se.multiplyByTranslation=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("translation",t),j.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=r*e[0]+o*e[4]+i*e[8]+e[12],a=r*e[1]+o*e[5]+i*e[9]+e[13],u=r*e[2]+o*e[6]+i*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=s,n[13]=a,n[14]=u,n[15]=e[15],n},Se.multiplyByScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("scale",t),j.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z;return 1===r&&1===o&&1===i?Se.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=o*e[6],n[7]=e[7],n[8]=i*e[8],n[9]=i*e[9],n[10]=i*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},Se.multiplyByUniformScale=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.number("scale",t),j.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},Se.multiplyByVector=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("cartesian",t),j.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=t.w,a=e[0]*r+e[4]*o+e[8]*i+e[12]*s,u=e[1]*r+e[5]*o+e[9]*i+e[13]*s,c=e[2]*r+e[6]*o+e[10]*i+e[14]*s,l=e[3]*r+e[7]*o+e[11]*i+e[15]*s;return n.x=a,n.y=u,n.z=c,n.w=l,n},Se.multiplyByPointAsVector=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("cartesian",t),j.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e[0]*r+e[4]*o+e[8]*i,a=e[1]*r+e[5]*o+e[9]*i,u=e[2]*r+e[6]*o+e[10]*i;return n.x=s,n.y=a,n.z=u,n},Se.multiplyByPoint=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("cartesian",t),j.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e[0]*r+e[4]*o+e[8]*i+e[12],a=e[1]*r+e[5]*o+e[9]*i+e[13],u=e[2]*r+e[6]*o+e[10]*i+e[14];return n.x=s,n.y=a,n.z=u,n},Se.multiplyByScalar=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n},Se.negate=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},Se.transpose=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=e[1],r=e[2],o=e[3],i=e[6],s=e[7],a=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[10]=e[10],t[11]=e[14],t[12]=o,t[13]=s,t[14]=a,t[15]=e[15],t},Se.abs=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},Se.equals=function(e,t){return e===t||g(e)&&g(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},Se.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n},Se.getTranslation=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},Se.getMatrix3=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};const Le=new ie,De=new ie,Be=new be,ze=new be(0,0,0,1);Se.inverse=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=e[0],r=e[4],o=e[8],i=e[12],s=e[1],a=e[5],u=e[9],c=e[13],l=e[2],f=e[6],p=e[10],h=e[14],d=e[3],m=e[7],y=e[11],_=e[15];let g=p*_,b=h*y,E=f*_,O=h*m,w=f*y,v=p*m,T=l*_,x=h*d,R=l*y,A=p*d,S=l*m,I=f*d;const N=g*a+O*u+w*c-(b*a+E*u+v*c),C=b*s+T*u+A*c-(g*s+x*u+R*c),P=E*s+x*a+S*c-(O*s+T*a+I*c),M=v*s+R*a+I*u-(w*s+A*a+S*u),U=b*r+E*o+v*i-(g*r+O*o+w*i),q=g*n+x*o+R*i-(b*n+T*o+A*i),L=O*n+T*r+I*i-(E*n+x*r+S*i),D=w*n+A*r+S*o-(v*n+R*r+I*o);g=o*c,b=i*u,E=r*c,O=i*a,w=r*u,v=o*a,T=n*c,x=i*s,R=n*u,A=o*s,S=n*a,I=r*s;const B=g*m+O*y+w*_-(b*m+E*y+v*_),z=b*d+T*y+A*_-(g*d+x*y+R*_),k=E*d+x*m+S*_-(O*d+T*m+I*_),G=v*d+R*m+I*y-(w*d+A*m+S*y),V=E*p+v*h+b*f-(w*h+g*f+O*p),H=R*h+g*l+x*p-(T*p+A*h+b*l),W=T*f+I*h+O*l-(S*h+E*l+x*f),X=S*p+w*l+A*f-(R*f+I*p+v*l);let $=n*N+r*C+o*P+i*M;if(Math.abs($)<F.EPSILON21){if(ie.equalsEpsilon(Se.getMatrix3(e,Le),De,F.EPSILON7)&&be.equals(Se.getRow(e,3,Be),ze))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new Ae("matrix is not invertible because its determinate is zero.")}return $=1/$,t[0]=N*$,t[1]=C*$,t[2]=P*$,t[3]=M*$,t[4]=U*$,t[5]=q*$,t[6]=L*$,t[7]=D*$,t[8]=B*$,t[9]=z*$,t[10]=k*$,t[11]=G*$,t[12]=V*$,t[13]=H*$,t[14]=W*$,t[15]=X*$,t},Se.inverseTransformation=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=e[0],r=e[1],o=e[2],i=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10],f=e[12],p=e[13],h=e[14],d=-n*f-r*p-o*h,m=-i*f-s*p-a*h,y=-u*f-c*p-l*h;return t[0]=n,t[1]=i,t[2]=u,t[3]=0,t[4]=r,t[5]=s,t[6]=c,t[7]=0,t[8]=o,t[9]=a,t[10]=l,t[11]=0,t[12]=d,t[13]=m,t[14]=y,t[15]=1,t};const ke=new Se;Se.inverseTranspose=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),Se.inverse(Se.transpose(e,ke),t)},Se.IDENTITY=Object.freeze(new Se(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Se.ZERO=Object.freeze(new Se(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),Se.COLUMN0ROW0=0,Se.COLUMN0ROW1=1,Se.COLUMN0ROW2=2,Se.COLUMN0ROW3=3,Se.COLUMN1ROW0=4,Se.COLUMN1ROW1=5,Se.COLUMN1ROW2=6,Se.COLUMN1ROW3=7,Se.COLUMN2ROW0=8,Se.COLUMN2ROW1=9,Se.COLUMN2ROW2=10,Se.COLUMN2ROW3=11,Se.COLUMN3ROW0=12,Se.COLUMN3ROW1=13,Se.COLUMN3ROW2=14,Se.COLUMN3ROW3=15,Object.defineProperties(Se.prototype,{length:{get:function(){return Se.packedLength}}}),Se.prototype.clone=function(e){return Se.clone(this,e)},Se.prototype.equals=function(e){return Se.equals(this,e)},Se.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]},Se.prototype.equalsEpsilon=function(e,t){return Se.equalsEpsilon(this,e,t)},Se.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})\n(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})\n(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})\n(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};const Ge={X:0,Y:1,Z:2};Ge.Y_UP_TO_Z_UP=Se.fromRotationTranslation(ie.fromArray([1,0,0,0,0,1,0,-1,0])),Ge.Z_UP_TO_Y_UP=Se.fromRotationTranslation(ie.fromArray([1,0,0,0,0,-1,0,1,0])),Ge.X_UP_TO_Z_UP=Se.fromRotationTranslation(ie.fromArray([0,0,1,0,1,0,-1,0,0])),Ge.Z_UP_TO_X_UP=Se.fromRotationTranslation(ie.fromArray([0,0,-1,0,1,0,1,0,0])),Ge.X_UP_TO_Y_UP=Se.fromRotationTranslation(ie.fromArray([0,1,0,-1,0,0,0,0,1])),Ge.Y_UP_TO_X_UP=Se.fromRotationTranslation(ie.fromArray([0,-1,0,1,0,0,0,0,1])),Ge.fromName=function(e){return j.typeOf.string("name",e),Ge[e]};var Ve=Object.freeze(Ge);function He(e,t){this.x=_(e,0),this.y=_(t,0)}He.fromElements=function(e,t,n){return g(n)?(n.x=e,n.y=t,n):new He(e,t)},He.clone=function(e,t){if(g(e))return g(t)?(t.x=e.x,t.y=e.y,t):new He(e.x,e.y)},He.fromCartesian3=He.clone,He.fromCartesian4=He.clone,He.packedLength=2,He.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e.x,t[n]=e.y,t},He.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new He),n.x=e[t++],n.y=e[t],n},He.packArray=function(e,t){j.defined("array",e);const n=e.length,r=2*n;if(g(t)){if(!Array.isArray(t)&&t.length!==r)throw new b("If result is a typed array, it must have exactly array.length * 2 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)He.pack(e[r],t,2*r);return t},He.unpackArray=function(e,t){if(j.defined("array",e),j.typeOf.number.greaterThanOrEquals("array.length",e.length,2),e.length%2!=0)throw new b("array length must be a multiple of 2.");const n=e.length;g(t)?t.length=n/2:t=new Array(n/2);for(let r=0;r<n;r+=2){const n=r/2;t[n]=He.unpack(e,r,t[n])}return t},He.fromArray=He.unpack,He.maximumComponent=function(e){return j.typeOf.object("cartesian",e),Math.max(e.x,e.y)},He.minimumComponent=function(e){return j.typeOf.object("cartesian",e),Math.min(e.x,e.y)},He.minimumByComponent=function(e,t,n){return j.typeOf.object("first",e),j.typeOf.object("second",t),j.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n},He.maximumByComponent=function(e,t,n){return j.typeOf.object("first",e),j.typeOf.object("second",t),j.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n},He.clamp=function(e,t,n,r){j.typeOf.object("value",e),j.typeOf.object("min",t),j.typeOf.object("max",n),j.typeOf.object("result",r);const o=F.clamp(e.x,t.x,n.x),i=F.clamp(e.y,t.y,n.y);return r.x=o,r.y=i,r},He.magnitudeSquared=function(e){return j.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},He.magnitude=function(e){return Math.sqrt(He.magnitudeSquared(e))};const We=new He;He.distance=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),He.subtract(e,t,We),He.magnitude(We)},He.distanceSquared=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),He.subtract(e,t,We),He.magnitudeSquared(We)},He.normalize=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=He.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,isNaN(t.x)||isNaN(t.y))throw new b("normalized result is not a number");return t},He.dot=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),e.x*t.x+e.y*t.y},He.cross=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),e.x*t.y-e.y*t.x},He.multiplyComponents=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n},He.divideComponents=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n},He.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n},He.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n},He.multiplyByScalar=function(e,t,n){return j.typeOf.object("cartesian",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n},He.divideByScalar=function(e,t,n){return j.typeOf.object("cartesian",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n},He.negate=function(e,t){return j.typeOf.object("cartesian",e),j.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},He.abs=function(e,t){return j.typeOf.object("cartesian",e),j.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};const Xe=new He;He.lerp=function(e,t,n,r){return j.typeOf.object("start",e),j.typeOf.object("end",t),j.typeOf.number("t",n),j.typeOf.object("result",r),He.multiplyByScalar(t,n,Xe),r=He.multiplyByScalar(e,1-n,r),He.add(Xe,r,r)};const $e=new He,Ye=new He;He.angleBetween=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),He.normalize(e,$e),He.normalize(t,Ye),F.acosClamped(He.dot($e,Ye))};const Ze=new He;He.mostOrthogonalAxis=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=He.normalize(e,Ze);return He.abs(n,n),t=n.x<=n.y?He.clone(He.UNIT_X,t):He.clone(He.UNIT_Y,t)},He.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y},He.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]},He.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.x,t.x,n,r)&&F.equalsEpsilon(e.y,t.y,n,r)},He.ZERO=Object.freeze(new He(0,0)),He.ONE=Object.freeze(new He(1,1)),He.UNIT_X=Object.freeze(new He(1,0)),He.UNIT_Y=Object.freeze(new He(0,1)),He.prototype.clone=function(e){return He.clone(this,e)},He.prototype.equals=function(e){return He.equals(this,e)},He.prototype.equalsEpsilon=function(e,t,n){return He.equalsEpsilon(this,e,t,n)},He.prototype.toString=function(){return`(${this.x}, ${this.y})`};const Qe=new Q,Ke=new Q;function Je(e,t,n,r,o){if(!g(e))throw new b("cartesian is required.");if(!g(t))throw new b("oneOverRadii is required.");if(!g(n))throw new b("oneOverRadiiSquared is required.");if(!g(r))throw new b("centerToleranceSquared is required.");const i=e.x,s=e.y,a=e.z,u=t.x,c=t.y,l=t.z,f=i*i*u*u,p=s*s*c*c,h=a*a*l*l,d=f+p+h,m=Math.sqrt(1/d),y=Q.multiplyByScalar(e,m,Qe);if(d<r)return isFinite(m)?Q.clone(y,o):void 0;const _=n.x,E=n.y,O=n.z,w=Ke;w.x=y.x*_*2,w.y=y.y*E*2,w.z=y.z*O*2;let v,T,x,R,A,S,I,N,C,P,M,j=(1-m)*Q.magnitude(e)/(.5*Q.magnitude(w)),U=0;do{j-=U,x=1/(1+j*_),R=1/(1+j*E),A=1/(1+j*O),S=x*x,I=R*R,N=A*A,C=S*x,P=I*R,M=N*A,v=f*S+p*I+h*N-1,T=f*C*_+p*P*E+h*M*O;U=v/(-2*T)}while(Math.abs(v)>F.EPSILON12);return g(o)?(o.x=i*x,o.y=s*R,o.z=a*A,o):new Q(i*x,s*R,a*A)}function et(e,t,n){this.longitude=_(e,0),this.latitude=_(t,0),this.height=_(n,0)}et.fromRadians=function(e,t,n,r){return j.typeOf.number("longitude",e),j.typeOf.number("latitude",t),n=_(n,0),g(r)?(r.longitude=e,r.latitude=t,r.height=n,r):new et(e,t,n)},et.fromDegrees=function(e,t,n,r){return j.typeOf.number("longitude",e),j.typeOf.number("latitude",t),e=F.toRadians(e),t=F.toRadians(t),et.fromRadians(e,t,n,r)};const tt=new Q,nt=new Q,rt=new Q;function ot(e,t,n,r){t=_(t,0),n=_(n,0),r=_(r,0),j.typeOf.number.greaterThanOrEquals("x",t,0),j.typeOf.number.greaterThanOrEquals("y",n,0),j.typeOf.number.greaterThanOrEquals("z",r,0),e._radii=new Q(t,n,r),e._radiiSquared=new Q(t*t,n*n,r*r),e._radiiToTheFourth=new Q(t*t*t*t,n*n*n*n,r*r*r*r),e._oneOverRadii=new Q(0===t?0:1/t,0===n?0:1/n,0===r?0:1/r),e._oneOverRadiiSquared=new Q(0===t?0:1/(t*t),0===n?0:1/(n*n),0===r?0:1/(r*r)),e._minimumRadius=Math.min(t,n,r),e._maximumRadius=Math.max(t,n,r),e._centerToleranceSquared=F.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function it(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,ot(this,e,t,n)}et._ellipsoidOneOverRadii=new Q(1/6378137,1/6378137,1/6356752.314245179),et._ellipsoidOneOverRadiiSquared=new Q(1/40680631590769,1/40680631590769,1/40408299984661.445),et._ellipsoidCenterToleranceSquared=F.EPSILON1,et.fromCartesian=function(e,t,n){const r=g(t)?t.oneOverRadii:et._ellipsoidOneOverRadii,o=g(t)?t.oneOverRadiiSquared:et._ellipsoidOneOverRadiiSquared,i=Je(e,r,o,g(t)?t._centerToleranceSquared:et._ellipsoidCenterToleranceSquared,nt);if(!g(i))return;let s=Q.multiplyComponents(i,o,tt);s=Q.normalize(s,s);const a=Q.subtract(e,i,rt),u=Math.atan2(s.y,s.x),c=Math.asin(s.z),l=F.sign(Q.dot(a,e))*Q.magnitude(a);return g(n)?(n.longitude=u,n.latitude=c,n.height=l,n):new et(u,c,l)},et.toCartesian=function(e,t,n){return j.defined("cartographic",e),Q.fromRadians(e.longitude,e.latitude,e.height,t,n)},et.clone=function(e,t){if(g(e))return g(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new et(e.longitude,e.latitude,e.height)},et.equals=function(e,t){return e===t||g(e)&&g(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},et.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n},et.ZERO=Object.freeze(new et(0,0,0)),et.prototype.clone=function(e){return et.clone(this,e)},et.prototype.equals=function(e){return et.equals(this,e)},et.prototype.equalsEpsilon=function(e,t){return et.equalsEpsilon(this,e,t)},et.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`},Object.defineProperties(it.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),it.clone=function(e,t){if(!g(e))return;const n=e._radii;return g(t)?(Q.clone(n,t._radii),Q.clone(e._radiiSquared,t._radiiSquared),Q.clone(e._radiiToTheFourth,t._radiiToTheFourth),Q.clone(e._oneOverRadii,t._oneOverRadii),Q.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new it(n.x,n.y,n.z)},it.fromCartesian3=function(e,t){return g(t)||(t=new it),g(e)?(ot(t,e.x,e.y,e.z),t):t},it.WGS84=Object.freeze(new it(6378137,6378137,6356752.314245179)),it.UNIT_SPHERE=Object.freeze(new it(1,1,1)),it.MOON=Object.freeze(new it(F.LUNAR_RADIUS,F.LUNAR_RADIUS,F.LUNAR_RADIUS)),it._default=it.WGS84,Object.defineProperties(it,{default:{get:function(){return it._default},set:function(e){j.typeOf.object("value",e),it._default=e,Q._ellipsoidRadiiSquared=e.radiiSquared,et._ellipsoidOneOverRadii=e.oneOverRadii,et._ellipsoidOneOverRadiiSquared=e.oneOverRadiiSquared,et._ellipsoidCenterToleranceSquared=e._centerToleranceSquared}}}),it.prototype.clone=function(e){return it.clone(this,e)},it.packedLength=Q.packedLength,it.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),Q.pack(e._radii,t,n),t},it.unpack=function(e,t,n){j.defined("array",e),t=_(t,0);const r=Q.unpack(e,t);return it.fromCartesian3(r,n)},it.prototype.geocentricSurfaceNormal=Q.normalize,it.prototype.geodeticSurfaceNormalCartographic=function(e,t){j.typeOf.object("cartographic",e);const n=e.longitude,r=e.latitude,o=Math.cos(r),i=o*Math.cos(n),s=o*Math.sin(n),a=Math.sin(r);return g(t)||(t=new Q),t.x=i,t.y=s,t.z=a,Q.normalize(t,t)},it.prototype.geodeticSurfaceNormal=function(e,t){if(j.typeOf.object("cartesian",e),isNaN(e.x)||isNaN(e.y)||isNaN(e.z))throw new b("cartesian has a NaN component");if(!Q.equalsEpsilon(e,Q.ZERO,F.EPSILON14))return g(t)||(t=new Q),t=Q.multiplyComponents(e,this._oneOverRadiiSquared,t),Q.normalize(t,t)};const st=new Q,at=new Q;it.prototype.cartographicToCartesian=function(e,t){const n=st,r=at;this.geodeticSurfaceNormalCartographic(e,n),Q.multiplyComponents(this._radiiSquared,n,r);const o=Math.sqrt(Q.dot(n,r));return Q.divideByScalar(r,o,r),Q.multiplyByScalar(n,e.height,n),g(t)||(t=new Q),Q.add(r,n,t)},it.prototype.cartographicArrayToCartesianArray=function(e,t){j.defined("cartographics",e);const n=e.length;g(t)?t.length=n:t=new Array(n);for(let r=0;r<n;r++)t[r]=this.cartographicToCartesian(e[r],t[r]);return t};const ut=new Q,ct=new Q,lt=new Q;it.prototype.cartesianToCartographic=function(e,t){const n=this.scaleToGeodeticSurface(e,ct);if(!g(n))return;const r=this.geodeticSurfaceNormal(n,ut),o=Q.subtract(e,n,lt),i=Math.atan2(r.y,r.x),s=Math.asin(r.z),a=F.sign(Q.dot(o,e))*Q.magnitude(o);return g(t)?(t.longitude=i,t.latitude=s,t.height=a,t):new et(i,s,a)},it.prototype.cartesianArrayToCartographicArray=function(e,t){j.defined("cartesians",e);const n=e.length;g(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.cartesianToCartographic(e[r],t[r]);return t},it.prototype.scaleToGeodeticSurface=function(e,t){return Je(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},it.prototype.scaleToGeocentricSurface=function(e,t){j.typeOf.object("cartesian",e),g(t)||(t=new Q);const n=e.x,r=e.y,o=e.z,i=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*i.x+r*r*i.y+o*o*i.z);return Q.multiplyByScalar(e,s,t)},it.prototype.transformPositionToScaledSpace=function(e,t){return g(t)||(t=new Q),Q.multiplyComponents(e,this._oneOverRadii,t)},it.prototype.transformPositionFromScaledSpace=function(e,t){return g(t)||(t=new Q),Q.multiplyComponents(e,this._radii,t)},it.prototype.equals=function(e){return this===e||g(e)&&Q.equals(this._radii,e._radii)},it.prototype.toString=function(){return this._radii.toString()},it.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){if(j.typeOf.object("position",e),!F.equalsEpsilon(this._radii.x,this._radii.y,F.EPSILON15))throw new b("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");j.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),t=_(t,0);const r=this._squaredXOverSquaredZ;if(g(n)||(n=new Q),n.x=0,n.y=0,n.z=e.z*(1-r),!(Math.abs(n.z)>=this._radii.z-t))return n};const ft=new Q;it.prototype.getLocalCurvature=function(e,t){j.typeOf.object("surfacePosition",e),g(t)||(t=new He);const n=this.getSurfaceNormalIntersectionWithZAxis(e,0,ft),r=Q.distance(e,n),o=r*(this.minimumRadius*r/this.maximumRadius**2)**2;return He.fromElements(1/r,1/o,t)};const pt=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],ht=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function dt(e,t,n){j.typeOf.number("a",e),j.typeOf.number("b",t),j.typeOf.func("func",n);const r=.5*(t+e),o=.5*(t-e);let i=0;for(let e=0;e<5;e++){const t=o*pt[e];i+=ht[e]*(n(r+t)+n(r-t))}return i*=o,i}function mt(e){this._ellipsoid=_(e,it.default),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}it.prototype.surfaceArea=function(e){j.typeOf.object("rectangle",e);const t=e.west;let n=e.east;const r=e.south,o=e.north;for(;n<t;)n+=F.TWO_PI;const i=this._radiiSquared,s=i.x,a=i.y,u=i.z,c=s*a;return dt(r,o,(function(e){const r=Math.cos(e),o=Math.sin(e);return Math.cos(e)*dt(t,n,(function(e){const t=Math.cos(e),n=Math.sin(e);return Math.sqrt(c*o*o+u*(a*t*t+s*n*n)*r*r)}))}))},Object.defineProperties(mt.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),mt.prototype.project=function(e,t){const n=this._semimajorAxis,r=e.longitude*n,o=e.latitude*n,i=e.height;return g(t)?(t.x=r,t.y=o,t.z=i,t):new Q(r,o,i)},mt.prototype.unproject=function(e,t){if(!g(e))throw new b("cartesian is required");const n=this._oneOverSemimajorAxis,r=e.x*n,o=e.y*n,i=e.z;return g(t)?(t.longitude=r,t.latitude=o,t.height=i,t):new et(r,o,i)};var yt=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function _t(e,t){this.start=_(e,0),this.stop=_(t,0)}function gt(e,t,n){j.defined("array",e),j.defined("itemToFind",t),j.defined("comparator",n);let r,o,i=0,s=e.length-1;for(;i<=s;)if(r=~~((i+s)/2),o=n(e[r],t),o<0)i=r+1;else{if(!(o>0))return r;s=r-1}return~(s+1)}function bt(e,t,n,r,o){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=o}function Et(e){if(null===e||isNaN(e))throw new b("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}const Ot=[31,28,31,30,31,30,31,31,30,31,30,31];function wt(e,t,n,r,o,i,s,a){e=_(e,1),t=_(t,1),n=_(n,1),r=_(r,0),o=_(o,0),i=_(i,0),s=_(s,0),a=_(a,!1),j.typeOf.number.greaterThanOrEquals("Year",e,1),j.typeOf.number.lessThanOrEquals("Year",e,9999),j.typeOf.number.greaterThanOrEquals("Month",t,1),j.typeOf.number.lessThanOrEquals("Month",t,12),j.typeOf.number.greaterThanOrEquals("Day",n,1),j.typeOf.number.lessThanOrEquals("Day",n,31),j.typeOf.number.greaterThanOrEquals("Hour",r,0),j.typeOf.number.lessThanOrEquals("Hour",r,23),j.typeOf.number.greaterThanOrEquals("Minute",o,0),j.typeOf.number.lessThanOrEquals("Minute",o,59),j.typeOf.bool("IsLeapSecond",a),j.typeOf.number.greaterThanOrEquals("Second",i,0),j.typeOf.number.lessThanOrEquals("Second",i,a?60:59),j.typeOf.number.greaterThanOrEquals("Millisecond",s,0),j.typeOf.number.lessThan("Millisecond",s,1e3),function(){const r=2===t&&Et(e)?Ot[t-1]+1:Ot[t-1];if(n>r)throw new b("Month and Day represents invalid date")}(),this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=o,this.second=i,this.millisecond=s,this.isLeapSecond=a}function vt(e,t){this.julianDate=e,this.offset=t}var Tt=Object.freeze({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5});var xt=Object.freeze({UTC:0,TAI:1});const Rt=new wt,At=[31,28,31,30,31,30,31,31,30,31,30,31];function St(e,t){return Vt.compare(e.julianDate,t.julianDate)}const It=new vt;function Nt(e){It.julianDate=e;const t=Vt.leapSeconds;let n=gt(t,It,St);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let r=t[n].offset;if(n>0){Vt.secondsDifference(t[n].julianDate,e)>r&&(n--,r=t[n].offset)}Vt.addSeconds(e,r,e)}function Ct(e,t){It.julianDate=e;const n=Vt.leapSeconds;let r=gt(n,It,St);if(r<0&&(r=~r),0===r)return Vt.addSeconds(e,-n[0].offset,t);if(r>=n.length)return Vt.addSeconds(e,-n[r-1].offset,t);const o=Vt.secondsDifference(n[r].julianDate,e);return 0===o?Vt.addSeconds(e,-n[r].offset,t):o<=1?void 0:Vt.addSeconds(e,-n[--r].offset,t)}function Pt(e,t,n){const r=t/Tt.SECONDS_PER_DAY|0;return e+=r,(t-=Tt.SECONDS_PER_DAY*r)<0&&(e--,t+=Tt.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function Mt(e,t,n,r,o,i,s){const a=(t-14)/12|0,u=e+4800+a;let c=(1461*u/4|0)+(367*(t-2-12*a)/12|0)-(3*((u+100)/100|0)/4|0)+n-32075;(r-=12)<0&&(r+=24);const l=i+(r*Tt.SECONDS_PER_HOUR+o*Tt.SECONDS_PER_MINUTE+s*Tt.SECONDS_PER_MILLISECOND);return l>=43200&&(c-=1),[c,l]}const jt=/^(\d{4})$/,Ut=/^(\d{4})-(\d{2})$/,Ft=/^(\d{4})-?(\d{3})$/,qt=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,Lt=/^(\d{4})-?(\d{2})-?(\d{2})$/,Dt=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Bt=/^(\d{2})(\.\d+)?/.source+Dt.source,zt=/^(\d{2}):?(\d{2})(\.\d+)?/.source+Dt.source,kt=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+Dt.source,Gt="Invalid ISO 8601 date.";function Vt(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=_(e,0),t=_(t,0),n=_(n,xt.UTC);const r=0|e;Pt(r,t+=(e-r)*Tt.SECONDS_PER_DAY,this),n===xt.UTC&&Nt(this)}Vt.fromGregorianDate=function(e,t){if(!(e instanceof wt))throw new b("date must be a valid GregorianDate.");const n=Mt(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return g(t)?(Pt(n[0],n[1],t),Nt(t),t):new Vt(n[0],n[1],xt.UTC)},Vt.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new b("date must be a valid JavaScript Date.");const n=Mt(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return g(t)?(Pt(n[0],n[1],t),Nt(t),t):new Vt(n[0],n[1],xt.UTC)},Vt.fromIso8601=function(e,t){if("string"!=typeof e)throw new b(Gt);let n,r=(e=e.replace(",",".")).split("T"),o=1,i=1,s=0,a=0,u=0,c=0;const l=r[0],f=r[1];let p,h,d,m;if(!g(l))throw new b(Gt);if(r=l.match(Lt),null!==r){if(d=l.split("-").length-1,d>0&&2!==d)throw new b(Gt);n=+r[1],o=+r[2],i=+r[3]}else if(r=l.match(Ut),null!==r)n=+r[1],o=+r[2];else if(r=l.match(jt),null!==r)n=+r[1];else{let e;if(r=l.match(Ft),null!==r){if(n=+r[1],e=+r[2],h=Et(n),e<1||h&&e>366||!h&&e>365)throw new b(Gt)}else{if(r=l.match(qt),null===r)throw new b(Gt);{n=+r[1];const t=+r[2],o=+r[3]||0;if(d=l.split("-").length-1,d>0&&(!g(r[3])&&1!==d||g(r[3])&&2!==d))throw new b(Gt);e=7*t+o-new Date(Date.UTC(n,0,4)).getUTCDay()-3}}p=new Date(Date.UTC(n,0,1)),p.setUTCDate(e),o=p.getUTCMonth()+1,i=p.getUTCDate()}if(h=Et(n),o<1||o>12||i<1||(2!==o||!h)&&i>At[o-1]||h&&2===o&&i>29)throw new b(Gt);if(g(f)){if(r=f.match(kt),null!==r){if(d=f.split(":").length-1,d>0&&2!==d&&3!==d)throw new b(Gt);s=+r[1],a=+r[2],u=+r[3],c=1e3*+(r[4]||0),m=5}else if(r=f.match(zt),null!==r){if(d=f.split(":").length-1,d>2)throw new b(Gt);s=+r[1],a=+r[2],u=60*+(r[3]||0),m=4}else{if(r=f.match(Bt),null===r)throw new b(Gt);s=+r[1],a=60*+(r[2]||0),m=3}if(a>=60||u>=61||s>24||24===s&&(a>0||u>0||c>0))throw new b(Gt);const e=r[m],t=+r[m+1],l=+(r[m+2]||0);switch(e){case"+":s-=t,a-=l;break;case"-":s+=t,a+=l;break;case"Z":break;default:a+=new Date(Date.UTC(n,o-1,i,s,a)).getTimezoneOffset()}}const y=60===u;for(y&&u--;a>=60;)a-=60,s++;for(;s>=24;)s-=24,i++;for(p=h&&2===o?29:At[o-1];i>p;)i-=p,o++,o>12&&(o-=12,n++),p=h&&2===o?29:At[o-1];for(;a<0;)a+=60,s--;for(;s<0;)s+=24,i--;for(;i<1;)o--,o<1&&(o+=12,n--),p=h&&2===o?29:At[o-1],i+=p;const _=Mt(n,o,i,s,a,u,c);return g(t)?(Pt(_[0],_[1],t),Nt(t)):t=new Vt(_[0],_[1],xt.UTC),y&&Vt.addSeconds(t,1,t),t},Vt.now=function(e){return Vt.fromDate(new Date,e)};const Ht=new Vt(0,0,xt.TAI);Vt.toGregorianDate=function(e,t){if(!g(e))throw new b("julianDate is required.");let n=!1,r=Ct(e,Ht);g(r)||(Vt.addSeconds(e,-1,Ht),r=Ct(Ht,Ht),n=!0);let o=r.dayNumber;const i=r.secondsOfDay;i>=43200&&(o+=1);let s=o+68569|0;const a=4*s/146097|0;s=s-((146097*a+3)/4|0)|0;const u=4e3*(s+1)/1461001|0;s=s-(1461*u/4|0)+31|0;const c=80*s/2447|0,l=s-(2447*c/80|0)|0;s=c/11|0;const f=c+2-12*s|0,p=100*(a-49)+u+s|0;let h=i/Tt.SECONDS_PER_HOUR|0,d=i-h*Tt.SECONDS_PER_HOUR;const m=d/Tt.SECONDS_PER_MINUTE|0;d-=m*Tt.SECONDS_PER_MINUTE;let y=0|d;const _=(d-y)/Tt.SECONDS_PER_MILLISECOND;return h+=12,h>23&&(h-=24),n&&(y+=1),g(t)?(t.year=p,t.month=f,t.day=l,t.hour=h,t.minute=m,t.second=y,t.millisecond=_,t.isLeapSecond=n,t):new wt(p,f,l,h,m,y,_,n)},Vt.toDate=function(e){if(!g(e))throw new b("julianDate is required.");const t=Vt.toGregorianDate(e,Rt);let n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))},Vt.toIso8601=function(e,t){if(!g(e))throw new b("julianDate is required.");const n=Vt.toGregorianDate(e,Rt);let r=n.year,o=n.month,i=n.day,s=n.hour;const a=n.minute,u=n.second,c=n.millisecond;let l;return 1e4===r&&1===o&&1===i&&0===s&&0===a&&0===u&&0===c&&(r=9999,o=12,i=31,s=24),g(t)||0===c?g(t)&&0!==t?(l=(.01*c).toFixed(t).replace(".","").slice(0,t),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}.${l}Z`):`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}Z`:(l=(.01*c).toString().replace(".",""),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}.${l}Z`)},Vt.clone=function(e,t){if(g(e))return g(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new Vt(e.dayNumber,e.secondsOfDay,xt.TAI)},Vt.compare=function(e,t){if(!g(e))throw new b("left is required.");if(!g(t))throw new b("right is required.");const n=e.dayNumber-t.dayNumber;return 0!==n?n:e.secondsOfDay-t.secondsOfDay},Vt.equals=function(e,t){return e===t||g(e)&&g(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},Vt.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(Vt.secondsDifference(e,t))<=n},Vt.totalDays=function(e){if(!g(e))throw new b("julianDate is required.");return e.dayNumber+e.secondsOfDay/Tt.SECONDS_PER_DAY},Vt.secondsDifference=function(e,t){if(!g(e))throw new b("left is required.");if(!g(t))throw new b("right is required.");return(e.dayNumber-t.dayNumber)*Tt.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},Vt.daysDifference=function(e,t){if(!g(e))throw new b("left is required.");if(!g(t))throw new b("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/Tt.SECONDS_PER_DAY},Vt.computeTaiMinusUtc=function(e){It.julianDate=e;const t=Vt.leapSeconds;let n=gt(t,It,St);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset},Vt.addSeconds=function(e,t,n){if(!g(e))throw new b("julianDate is required.");if(!g(t))throw new b("seconds is required.");if(!g(n))throw new b("result is required.");return Pt(e.dayNumber,e.secondsOfDay+t,n)},Vt.addMinutes=function(e,t,n){if(!g(e))throw new b("julianDate is required.");if(!g(t))throw new b("minutes is required.");if(!g(n))throw new b("result is required.");const r=e.secondsOfDay+t*Tt.SECONDS_PER_MINUTE;return Pt(e.dayNumber,r,n)},Vt.addHours=function(e,t,n){if(!g(e))throw new b("julianDate is required.");if(!g(t))throw new b("hours is required.");if(!g(n))throw new b("result is required.");const r=e.secondsOfDay+t*Tt.SECONDS_PER_HOUR;return Pt(e.dayNumber,r,n)},Vt.addDays=function(e,t,n){if(!g(e))throw new b("julianDate is required.");if(!g(t))throw new b("days is required.");if(!g(n))throw new b("result is required.");return Pt(e.dayNumber+t,e.secondsOfDay,n)},Vt.lessThan=function(e,t){return Vt.compare(e,t)<0},Vt.lessThanOrEquals=function(e,t){return Vt.compare(e,t)<=0},Vt.greaterThan=function(e,t){return Vt.compare(e,t)>0},Vt.greaterThanOrEquals=function(e,t){return Vt.compare(e,t)>=0},Vt.prototype.clone=function(e){return Vt.clone(this,e)},Vt.prototype.equals=function(e){return Vt.equals(this,e)},Vt.prototype.equalsEpsilon=function(e,t){return Vt.equalsEpsilon(this,e,t)},Vt.prototype.toString=function(){return Vt.toIso8601(this)},Vt.leapSeconds=[new vt(new Vt(2441317,43210,xt.TAI),10),new vt(new Vt(2441499,43211,xt.TAI),11),new vt(new Vt(2441683,43212,xt.TAI),12),new vt(new Vt(2442048,43213,xt.TAI),13),new vt(new Vt(2442413,43214,xt.TAI),14),new vt(new Vt(2442778,43215,xt.TAI),15),new vt(new Vt(2443144,43216,xt.TAI),16),new vt(new Vt(2443509,43217,xt.TAI),17),new vt(new Vt(2443874,43218,xt.TAI),18),new vt(new Vt(2444239,43219,xt.TAI),19),new vt(new Vt(2444786,43220,xt.TAI),20),new vt(new Vt(2445151,43221,xt.TAI),21),new vt(new Vt(2445516,43222,xt.TAI),22),new vt(new Vt(2446247,43223,xt.TAI),23),new vt(new Vt(2447161,43224,xt.TAI),24),new vt(new Vt(2447892,43225,xt.TAI),25),new vt(new Vt(2448257,43226,xt.TAI),26),new vt(new Vt(2448804,43227,xt.TAI),27),new vt(new Vt(2449169,43228,xt.TAI),28),new vt(new Vt(2449534,43229,xt.TAI),29),new vt(new Vt(2450083,43230,xt.TAI),30),new vt(new Vt(2450630,43231,xt.TAI),31),new vt(new Vt(2451179,43232,xt.TAI),32),new vt(new Vt(2453736,43233,xt.TAI),33),new vt(new Vt(2454832,43234,xt.TAI),34),new vt(new Vt(2456109,43235,xt.TAI),35),new vt(new Vt(2457204,43236,xt.TAI),36),new vt(new Vt(2457754,43237,xt.TAI),37)];var Wt,Xt={exports:{}},$t={exports:{}},Yt=$t.exports;var Zt,Qt={exports:{}},Kt=Qt.exports;
/*!
	 * URI.js - Mutating URLs
	 * IPv6 Support
	 *
	 * Version: 1.19.11
	 *
	 * Author: Rodney Rehm
	 * Web: http://medialize.github.io/URI.js/
	 *
	 * Licensed under
	 *   MIT License http://www.opensource.org/licenses/mit-license
	 *
	 */var Jt,en={exports:{}},tn=en.exports;
/*!
	 * URI.js - Mutating URLs
	 * Second Level Domain (SLD) Support
	 *
	 * Version: 1.19.11
	 *
	 * Author: Rodney Rehm
	 * Web: http://medialize.github.io/URI.js/
	 *
	 * Licensed under
	 *   MIT License http://www.opensource.org/licenses/mit-license
	 *
	 */
/*!
	 * URI.js - Mutating URLs
	 *
	 * Version: 1.19.11
	 *
	 * Author: Rodney Rehm
	 * Web: http://medialize.github.io/URI.js/
	 *
	 * Licensed under
	 *   MIT License http://www.opensource.org/licenses/mit-license
	 *
	 */
var nn,rn=Xt.exports;var on=(nn||(nn=1,function(e){var n,r;n=rn,r=function(e,t,n,r){var o=r&&r.URI;function i(e,t){var n=arguments.length>=1;if(!(this instanceof i))return n?arguments.length>=2?new i(e,t):new i(e):new i;if(void 0===e){if(n)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&n)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}i.version="1.19.11";var s=i.prototype,a=Object.prototype.hasOwnProperty;function u(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function l(e){return"Array"===c(e)}function f(e,t){var n,r,o={};if("RegExp"===c(t))o=null;else if(l(t))for(n=0,r=t.length;n<r;n++)o[t[n]]=!0;else o[t]=!0;for(n=0,r=e.length;n<r;n++)(o&&void 0!==o[e[n]]||!o&&t.test(e[n]))&&(e.splice(n,1),r--,n--);return e}function p(e,t){var n,r;if(l(t)){for(n=0,r=t.length;n<r;n++)if(!p(e,t[n]))return!1;return!0}var o=c(t);for(n=0,r=e.length;n<r;n++)if("RegExp"===o){if("string"==typeof e[n]&&e[n].match(t))return!0}else if(e[n]===t)return!0;return!1}function h(e,t){if(!l(e)||!l(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function d(e){return e.replace(/^\/+|\/+$/g,"")}function m(e){return escape(e)}function y(e){return encodeURIComponent(e).replace(/[!'()*]/g,m).replace(/\*/g,"%2A")}i._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:i.preventInvalidHostname,duplicateQueryParameters:i.duplicateQueryParameters,escapeQuerySpace:i.escapeQuerySpace}},i.preventInvalidHostname=!1,i.duplicateQueryParameters=!1,i.escapeQuerySpace=!0,i.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,i.idn_expression=/[^a-z0-9\._-]/i,i.punycode_expression=/(xn--)/i,i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,i.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},i.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,i.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},i.hostProtocols=["http","https"],i.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,i.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},i.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return i.domAttributes[t]}},i.encode=y,i.decode=decodeURIComponent,i.iso8859=function(){i.encode=escape,i.decode=unescape},i.unicode=function(){i.encode=y,i.decode=decodeURIComponent},i.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},i.encodeQuery=function(e,t){var n=i.encode(e+"");return void 0===t&&(t=i.escapeQuerySpace),t?n.replace(/%20/g,"+"):n},i.decodeQuery=function(e,t){e+="",void 0===t&&(t=i.escapeQuerySpace);try{return i.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var _,g={encode:"encode",decode:"decode"},b=function(e,t){return function(n){try{return i[t](n+"").replace(i.characters[e][t].expression,(function(n){return i.characters[e][t].map[n]}))}catch(e){return n}}};for(_ in g)i[_+"PathSegment"]=b("pathname",g[_]),i[_+"UrnPathSegment"]=b("urnpath",g[_]);var E=function(e,t,n){return function(r){var o;o=n?function(e){return i[t](i[n](e))}:i[t];for(var s=(r+"").split(e),a=0,u=s.length;a<u;a++)s[a]=o(s[a]);return s.join(e)}};function O(e){return function(t,n){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!n),this)}}function w(e,t){return function(n,r){return void 0===n?this._parts[e]||"":(null!==n&&(n+="").charAt(0)===t&&(n=n.substring(1)),this._parts[e]=n,this.build(!r),this)}}i.decodePath=E("/","decodePathSegment"),i.decodeUrnPath=E(":","decodeUrnPathSegment"),i.recodePath=E("/","encodePathSegment","decode"),i.recodeUrnPath=E(":","encodeUrnPathSegment","decode"),i.encodeReserved=b("reserved","encode"),i.parse=function(e,t){var n;return t||(t={preventInvalidHostname:i.preventInvalidHostname}),(n=(e=(e=e.replace(i.leading_whitespace_expression,"")).replace(i.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(n+1)||null,e=e.substring(0,n)),(n=e.indexOf("?"))>-1&&(t.query=e.substring(n+1)||null,e=e.substring(0,n)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=i.parseAuthority(e,t)):(n=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,n)||null,t.protocol&&!t.protocol.match(i.protocol_expression)?t.protocol=void 0:"//"===e.substring(n+1,n+3).replace(/\\/g,"/")?(e=e.substring(n+3),e=i.parseAuthority(e,t)):(e=e.substring(n+1),t.urn=!0)),t.path=e,t},i.parseHost=function(e,t){e||(e="");var n,r,o=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===o&&(o=e.length),"["===e.charAt(0))n=e.indexOf("]"),t.hostname=e.substring(1,n)||null,t.port=e.substring(n+2,o)||null,"/"===t.port&&(t.port=null);else{var s=e.indexOf(":"),a=e.indexOf("/"),u=e.indexOf(":",s+1);-1!==u&&(-1===a||u<a)?(t.hostname=e.substring(0,o)||null,t.port=null):(r=e.substring(0,o).split(":"),t.hostname=r[0]||null,t.port=r[1]||null)}return t.hostname&&"/"!==e.substring(o).charAt(0)&&(o++,e="/"+e),t.preventInvalidHostname&&i.ensureValidHostname(t.hostname,t.protocol),t.port&&i.ensureValidPort(t.port),e.substring(o)||"/"},i.parseAuthority=function(e,t){return e=i.parseUserinfo(e,t),i.parseHost(e,t)},i.parseUserinfo=function(e,t){var n=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var r,o=e.indexOf("/"),s=e.lastIndexOf("@",o>-1?o:e.length-1);return s>-1&&(-1===o||s<o)?(r=e.substring(0,s).split(":"),t.username=r[0]?i.decode(r[0]):null,r.shift(),t.password=r[0]?i.decode(r.join(":")):null,e=n.substring(s+1)):(t.username=null,t.password=null),e},i.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,o,s={},u=e.split("&"),c=u.length,l=0;l<c;l++)n=u[l].split("="),r=i.decodeQuery(n.shift(),t),o=n.length?i.decodeQuery(n.join("="),t):null,"__proto__"!==r&&(a.call(s,r)?("string"!=typeof s[r]&&null!==s[r]||(s[r]=[s[r]]),s[r].push(o)):s[r]=o);return s},i.build=function(e){var t="",n=!1;return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//",n=!0),t+=i.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&n&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},i.buildHost=function(e){var t="";return e.hostname?(i.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},i.buildAuthority=function(e){return i.buildUserinfo(e)+i.buildHost(e)},i.buildUserinfo=function(e){var t="";return e.username&&(t+=i.encode(e.username)),e.password&&(t+=":"+i.encode(e.password)),t&&(t+="@"),t},i.buildQuery=function(e,t,n){var r,o,s,u,c="";for(o in e)if("__proto__"!==o&&a.call(e,o))if(l(e[o]))for(r={},s=0,u=e[o].length;s<u;s++)void 0!==e[o][s]&&void 0===r[e[o][s]+""]&&(c+="&"+i.buildQueryParameter(o,e[o][s],n),!0!==t&&(r[e[o][s]+""]=!0));else void 0!==e[o]&&(c+="&"+i.buildQueryParameter(o,e[o],n));return c.substring(1)},i.buildQueryParameter=function(e,t,n){return i.encodeQuery(e,n)+(null!==t?"="+i.encodeQuery(t,n):"")},i.addQuery=function(e,t,n){if("object"==typeof t)for(var r in t)a.call(t,r)&&i.addQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=n);"string"==typeof e[t]&&(e[t]=[e[t]]),l(n)||(n=[n]),e[t]=(e[t]||[]).concat(n)}},i.setQuery=function(e,t,n){if("object"==typeof t)for(var r in t)a.call(t,r)&&i.setQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===n?null:n}},i.removeQuery=function(e,t,n){var r,o,s;if(l(t))for(r=0,o=t.length;r<o;r++)e[t[r]]=void 0;else if("RegExp"===c(t))for(s in e)t.test(s)&&(e[s]=void 0);else if("object"==typeof t)for(s in t)a.call(t,s)&&i.removeQuery(e,s,t[s]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===c(n)?!l(e[t])&&n.test(e[t])?e[t]=void 0:e[t]=f(e[t],n):e[t]!==String(n)||l(n)&&1!==n.length?l(e[t])&&(e[t]=f(e[t],n)):e[t]=void 0:e[t]=void 0}},i.hasQuery=function(e,t,n,r){switch(c(t)){case"String":break;case"RegExp":for(var o in e)if(a.call(e,o)&&t.test(o)&&(void 0===n||i.hasQuery(e,o,n)))return!0;return!1;case"Object":for(var s in t)if(a.call(t,s)&&!i.hasQuery(e,s,t[s]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(c(n)){case"Undefined":return t in e;case"Boolean":return n===Boolean(l(e[t])?e[t].length:e[t]);case"Function":return!!n(e[t],t,e);case"Array":return!!l(e[t])&&(r?p:h)(e[t],n);case"RegExp":return l(e[t])?!!r&&p(e[t],n):Boolean(e[t]&&e[t].match(n));case"Number":n=String(n);case"String":return l(e[t])?!!r&&p(e[t],n):e[t]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},i.joinPaths=function(){for(var e=[],t=[],n=0,r=0;r<arguments.length;r++){var o=new i(arguments[r]);e.push(o);for(var s=o.segment(),a=0;a<s.length;a++)"string"==typeof s[a]&&t.push(s[a]),s[a]&&n++}if(!t.length||!n)return new i("");var u=new i("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||u.path("/"+u.path()),u.normalize()},i.commonPath=function(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n++)if(e.charAt(n)!==t.charAt(n)){n--;break}return n<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(n)&&"/"===t.charAt(n)||(n=e.substring(0,n).lastIndexOf("/")),e.substring(0,n+1))},i.withinString=function(e,t,n){n||(n={});var r=n.start||i.findUri.start,o=n.end||i.findUri.end,s=n.trim||i.findUri.trim,a=n.parens||i.findUri.parens,u=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var c=r.exec(e);if(!c)break;var l=c.index;if(n.ignoreHtml){var f=e.slice(Math.max(l-3,0),l);if(f&&u.test(f))continue}for(var p=l+e.slice(l).search(o),h=e.slice(l,p),d=-1;;){var m=a.exec(h);if(!m)break;var y=m.index+m[0].length;d=Math.max(d,y)}if(!((h=d>-1?h.slice(0,d)+h.slice(d).replace(s,""):h.replace(s,"")).length<=c[0].length||n.ignore&&n.ignore.test(h))){var _=t(h,l,p=l+h.length,e);void 0!==_?(_=String(_),e=e.slice(0,l)+_+e.slice(p),r.lastIndex=l+_.length):r.lastIndex=p}}return r.lastIndex=0,e},i.ensureValidHostname=function(t,n){var r=!!t,o=!1;if(!!n&&(o=p(i.hostProtocols,n)),o&&!r)throw new TypeError("Hostname cannot be empty, if protocol is "+n);if(t&&t.match(i.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(i.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},i.ensureValidPort=function(e){if(e){var t=Number(e);if(!(/^[0-9]+$/.test(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},i.noConflict=function(e){if(e){var t={URI:this.noConflict()};return r.URITemplate&&"function"==typeof r.URITemplate.noConflict&&(t.URITemplate=r.URITemplate.noConflict()),r.IPv6&&"function"==typeof r.IPv6.noConflict&&(t.IPv6=r.IPv6.noConflict()),r.SecondLevelDomains&&"function"==typeof r.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=r.SecondLevelDomains.noConflict()),t}return r.URI===this&&(r.URI=o),this},s.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=i.build(this._parts),this._deferred_build=!1),this},s.clone=function(){return new i(this)},s.valueOf=s.toString=function(){return this.build(!1)._string},s.protocol=O("protocol"),s.username=O("username"),s.password=O("password"),s.hostname=O("hostname"),s.port=O("port"),s.query=w("query","?"),s.fragment=w("fragment","#"),s.search=function(e,t){var n=this.query(e,t);return"string"==typeof n&&n.length?"?"+n:n},s.hash=function(e,t){var n=this.fragment(e,t);return"string"==typeof n&&n.length?"#"+n:n},s.pathname=function(e,t){if(void 0===e||!0===e){var n=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?i.decodeUrnPath:i.decodePath)(n):n}return this._parts.urn?this._parts.path=e?i.recodeUrnPath(e):"":this._parts.path=e?i.recodePath(e):"/",this.build(!t),this},s.path=s.pathname,s.href=function(e,t){var n;if(void 0===e)return this.toString();this._string="",this._parts=i._parts();var r=e instanceof i,o="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName&&(e=e[i.getDomAttribute(e)]||"",o=!1),!r&&o&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=i.parse(String(e),this._parts);else{if(!r&&!o)throw new TypeError("invalid input");var s=r?e._parts:e;for(n in s)"query"!==n&&a.call(this._parts,n)&&(this._parts[n]=s[n]);s.query&&this.query(s.query,!1)}return this.build(!t),this},s.is=function(e){var t=!1,r=!1,o=!1,s=!1,a=!1,u=!1,c=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,r=i.ip4_expression.test(this._parts.hostname),o=i.ip6_expression.test(this._parts.hostname),a=(s=!(t=r||o))&&n&&n.has(this._parts.hostname),u=s&&i.idn_expression.test(this._parts.hostname),c=s&&i.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return s;case"sld":return a;case"ip":return t;case"ip4":case"ipv4":case"inet4":return r;case"ip6":case"ipv6":case"inet6":return o;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var v=s.protocol,T=s.port,x=s.hostname;s.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(i.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return v.call(this,e,t)},s.scheme=s.protocol,s.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),i.ensureValidPort(e))),T.call(this,e,t))},s.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var n={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==i.parseHost(e,n))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=n.hostname,this._parts.preventInvalidHostname&&i.ensureValidHostname(e,this._parts.protocol)}return x.call(this,e,t)},s.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=this.protocol();return this.authority()?(n?n+"://":"")+this.authority():""}var r=i(e);return this.protocol(r.protocol()).authority(r.authority()).build(!t),this},s.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildHost(this._parts):"";if("/"!==i.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},s.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildAuthority(this._parts):"";if("/"!==i.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},s.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=i.buildUserinfo(this._parts);return n?n.substring(0,n.length-1):n}return"@"!==e[e.length-1]&&(e+="@"),i.parseUserinfo(e,this._parts),this.build(!t),this},s.resource=function(e,t){var n;return void 0===e?this.path()+this.search()+this.hash():(n=i.parse(e),this._parts.path=n.path,this._parts.query=n.query,this._parts.fragment=n.fragment,this.build(!t),this)},s.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,n)||""}var r=this._parts.hostname.length-this.domain().length,o=this._parts.hostname.substring(0,r),s=new RegExp("^"+u(o));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&i.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(s,e),this.build(!t),this},s.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.match(/\./g);if(n&&n.length<2)return this._parts.hostname;var r=this._parts.hostname.length-this.tld(t).length-1;return r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(i.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var o=new RegExp(u(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},s.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.lastIndexOf("."),o=this._parts.hostname.substring(r+1);return!0!==t&&n&&n.list[o.toLowerCase()]&&n.get(this._parts.hostname)||o}var i;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!n||!n.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');i=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");i=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}return this.build(!t),this},s.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,n)||(this._parts.hostname?"/":"");return e?i.decodePath(r):r}var o=this._parts.path.length-this.filename().length,s=this._parts.path.substring(0,o),a=new RegExp("^"+u(s));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=i.recodePath(e),this._parts.path=this._parts.path.replace(a,e),this.build(!t),this},s.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(n+1);return e?i.decodePathSegment(r):r}var o=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(o=!0);var s=new RegExp(u(this.filename())+"$");return e=i.recodePath(e),this._parts.path=this._parts.path.replace(s,e),o?this.normalizePath(t):this.build(!t),this},s.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var n,r,o=this.filename(),s=o.lastIndexOf(".");return-1===s?"":(n=o.substring(s+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",e?i.decodePathSegment(r):r)}"."===e.charAt(0)&&(e=e.substring(1));var a,c=this.suffix();if(c)a=e?new RegExp(u(c)+"$"):new RegExp(u("."+c)+"$");else{if(!e)return this;this._parts.path+="."+i.recodePath(e)}return a&&(e=i.recodePath(e),this._parts.path=this._parts.path.replace(a,e)),this.build(!t),this},s.segment=function(e,t,n){var r=this._parts.urn?":":"/",o=this.path(),i="/"===o.substring(0,1),s=o.split(r);if(void 0!==e&&"number"!=typeof e&&(n=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(i&&s.shift(),e<0&&(e=Math.max(s.length+e,0)),void 0===t)return void 0===e?s:s[e];if(null===e||void 0===s[e])if(l(t)){s=[];for(var a=0,u=t.length;a<u;a++)(t[a].length||s.length&&s[s.length-1].length)&&(s.length&&!s[s.length-1].length&&s.pop(),s.push(d(t[a])))}else(t||"string"==typeof t)&&(t=d(t),""===s[s.length-1]?s[s.length-1]=t:s.push(t));else t?s[e]=d(t):s.splice(e,1);return i&&s.unshift(""),this.path(s.join(r),n)},s.segmentCoded=function(e,t,n){var r,o,s;if("number"!=typeof e&&(n=t,t=e,e=void 0),void 0===t){if(l(r=this.segment(e,t,n)))for(o=0,s=r.length;o<s;o++)r[o]=i.decode(r[o]);else r=void 0!==r?i.decode(r):void 0;return r}if(l(t))for(o=0,s=t.length;o<s;o++)t[o]=i.encode(t[o]);else t="string"==typeof t||t instanceof String?i.encode(t):t;return this.segment(e,t,n)};var R=s.query;return s.query=function(e,t){if(!0===e)return i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace),r=e.call(this,n);return this._parts.query=i.buildQuery(r||n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=i.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):R.call(this,e,t)},s.setQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)r[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var o in e)a.call(e,o)&&(r[o]=e[o])}return this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},s.addQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.addQuery(r,e,void 0===t?null:t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},s.removeQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.removeQuery(r,e,t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},s.hasQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.hasQuery(r,e,t,n)},s.setSearch=s.setQuery,s.addSearch=s.addQuery,s.removeSearch=s.removeQuery,s.hasSearch=s.hasQuery,s.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},s.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},s.normalizeHostname=function(n){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!n)),this},s.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},s.normalizePath=function(e){var t,n=this._parts.path;if(!n)return this;if(this._parts.urn)return this._parts.path=i.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var r,o,s="";for("/"!==(n=i.recodePath(n)).charAt(0)&&(t=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),t&&(s=n.substring(1).match(/^(\.\.\/)+/)||"")&&(s=s[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)0!==r?(-1===(o=n.substring(0,r).lastIndexOf("/"))&&(o=r),n=n.substring(0,o)+n.substring(r+3)):n=n.substring(3);return t&&this.is("relative")&&(n=s+n.substring(1)),this._parts.path=n,this.build(!e),this},s.normalizePathname=s.normalizePath,s.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},s.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},s.normalizeSearch=s.normalizeQuery,s.normalizeHash=s.normalizeFragment,s.iso8859=function(){var e=i.encode,t=i.decode;i.encode=escape,i.decode=decodeURIComponent;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},s.unicode=function(){var e=i.encode,t=i.decode;i.encode=y,i.decode=unescape;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},s.readable=function(){var t=this.clone();t.username("").password("").normalize();var n="";if(t._parts.protocol&&(n+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(n+=e.toUnicode(t._parts.hostname),t._parts.port&&(n+=":"+t._parts.port)):n+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(n+="/"),n+=t.path(!0),t._parts.query){for(var r="",o=0,s=t._parts.query.split("&"),a=s.length;o<a;o++){var u=(s[o]||"").split("=");r+="&"+i.decodeQuery(u[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==u[1]&&(r+="="+i.decodeQuery(u[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}n+="?"+r.substring(1)}return n+=i.decodeQuery(t.hash(),!0)},s.absoluteTo=function(e){var t,n,r,o=this.clone(),s=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof i||(e=new i(e)),o._parts.protocol)return o;if(o._parts.protocol=e._parts.protocol,this._parts.hostname)return o;for(n=0;r=s[n];n++)o._parts[r]=e._parts[r];return o._parts.path?(".."===o._parts.path.substring(-2)&&(o._parts.path+="/"),"/"!==o.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),o._parts.path=(t?t+"/":"")+o._parts.path,o.normalizePath())):(o._parts.path=e._parts.path,o._parts.query||(o._parts.query=e._parts.query)),o.build(),o},s.relativeTo=function(e){var t,n,r,o,s,a=this.clone().normalize();if(a._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new i(e).normalize(),t=a._parts,n=e._parts,o=a.path(),s=e.path(),"/"!==o.charAt(0))throw new Error("URI is already relative");if("/"!==s.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===n.protocol&&(t.protocol=null),t.username!==n.username||t.password!==n.password)return a.build();if(null!==t.protocol||null!==t.username||null!==t.password)return a.build();if(t.hostname!==n.hostname||t.port!==n.port)return a.build();if(t.hostname=null,t.port=null,o===s)return t.path="",a.build();if(!(r=i.commonPath(o,s)))return a.build();var u=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=u+t.path.substring(r.length)||"./",a.build()},s.equals=function(e){var t,n,r,o,s,u=this.clone(),c=new i(e),f={};if(u.normalize(),c.normalize(),u.toString()===c.toString())return!0;if(r=u.query(),o=c.query(),u.query(""),c.query(""),u.toString()!==c.toString())return!1;if(r.length!==o.length)return!1;for(s in t=i.parseQuery(r,this._parts.escapeQuerySpace),n=i.parseQuery(o,this._parts.escapeQuerySpace),t)if(a.call(t,s)){if(l(t[s])){if(!h(t[s],n[s]))return!1}else if(t[s]!==n[s])return!1;f[s]=!0}for(s in n)if(a.call(n,s)&&!f[s])return!1;return!0},s.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},s.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},s.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},i},e.exports?e.exports=r((Wt||(Wt=1,function(e,n){!function(r){var o=n&&!n.nodeType&&n,i=e&&!e.nodeType&&e,s="object"==typeof t&&t;s.global!==s&&s.window!==s&&s.self!==s||(r=s);var a,u,c=2147483647,l=36,f=/^xn--/,p=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,y=String.fromCharCode;function _(e){throw new RangeError(d[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function b(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(h,".")).split("."),t).join(".")}function E(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function O(e){return g(e,(function(e){var t="";return e>65535&&(t+=y((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+y(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function v(e,t,n){var r=0;for(e=n?m(e/700):e>>1,e+=m(e/t);e>455;r+=l)e=m(e/35);return m(r+36*e/(e+38))}function T(e){var t,n,r,o,i,s,a,u,f,p,h,d=[],y=e.length,g=0,b=128,E=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&_("not-basic"),d.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<y;){for(i=g,s=1,a=l;o>=y&&_("invalid-input"),((u=(h=e.charCodeAt(o++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:l)>=l||u>m((c-g)/s))&&_("overflow"),g+=u*s,!(u<(f=a<=E?1:a>=E+26?26:a-E));a+=l)s>m(c/(p=l-f))&&_("overflow"),s*=p;E=v(g-i,t=d.length+1,0==i),m(g/t)>c-b&&_("overflow"),b+=m(g/t),g%=t,d.splice(g++,0,b)}return O(d)}function x(e){var t,n,r,o,i,s,a,u,f,p,h,d,g,b,O,T=[];for(d=(e=E(e)).length,t=128,n=0,i=72,s=0;s<d;++s)(h=e[s])<128&&T.push(y(h));for(r=o=T.length,o&&T.push("-");r<d;){for(a=c,s=0;s<d;++s)(h=e[s])>=t&&h<a&&(a=h);for(a-t>m((c-n)/(g=r+1))&&_("overflow"),n+=(a-t)*g,t=a,s=0;s<d;++s)if((h=e[s])<t&&++n>c&&_("overflow"),h==t){for(u=n,f=l;!(u<(p=f<=i?1:f>=i+26?26:f-i));f+=l)O=u-p,b=l-p,T.push(y(w(p+O%b,0))),u=m(O/b);T.push(y(w(u,0))),i=v(n,g,r==o),n=0,++r}++n,++t}return T.join("")}if(a={version:"1.3.2",ucs2:{decode:E,encode:O},decode:T,encode:x,toASCII:function(e){return b(e,(function(e){return p.test(e)?"xn--"+x(e):e}))},toUnicode:function(e){return b(e,(function(e){return f.test(e)?T(e.slice(4).toLowerCase()):e}))}},o&&i)if(e.exports==o)i.exports=a;else for(u in a)a.hasOwnProperty(u)&&(o[u]=a[u]);else r.punycode=a}(Yt)}($t,$t.exports)),$t.exports),(Zt||(Zt=1,function(e){var t,n;t=Kt,n=function(e){var t=e&&e.IPv6;return{best:function(e){var t,n,r=e.toLowerCase().split(":"),o=r.length,i=8;for(""===r[0]&&""===r[1]&&""===r[2]?(r.shift(),r.shift()):""===r[0]&&""===r[1]?r.shift():""===r[o-1]&&""===r[o-2]&&r.pop(),-1!==r[(o=r.length)-1].indexOf(".")&&(i=7),t=0;t<o&&""!==r[t];t++);if(t<i)for(r.splice(t,1,"0000");r.length<i;)r.splice(t,0,"0000");for(var s=0;s<i;s++){n=r[s].split("");for(var a=0;a<3&&"0"===n[0]&&n.length>1;a++)n.splice(0,1);r[s]=n.join("")}var u=-1,c=0,l=0,f=-1,p=!1;for(s=0;s<i;s++)p?"0"===r[s]?l+=1:(p=!1,l>c&&(u=f,c=l)):"0"===r[s]&&(p=!0,f=s,l=1);l>c&&(u=f,c=l),c>1&&r.splice(u,c,""),o=r.length;var h="";for(""===r[0]&&(h=":"),s=0;s<o&&(h+=r[s],s!==o-1);s++)h+=":";return""===r[o-1]&&(h+=":"),h},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}},e.exports?e.exports=n():t.IPv6=n(t)}(Qt)),Qt.exports),(Jt||(Jt=1,function(e){var t,n;t=tn,n=function(e){var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var r=e.lastIndexOf(".",t-1);if(r<=0||r>=t-1)return!1;var o=n.list[e.slice(t+1)];return!!o&&o.indexOf(" "+e.slice(r+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var r=n.list[e.slice(t+1)];return!!r&&r.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var r=e.lastIndexOf(".",t-1);if(r<=0||r>=t-1)return null;var o=n.list[e.slice(t+1)];return o?o.indexOf(" "+e.slice(r+1,t)+" ")<0?null:e.slice(r+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n},e.exports?e.exports=n():t.SecondLevelDomains=n(t)}(en)),en.exports)):n.URI=r(n.punycode,n.IPv6,n.SecondLevelDomains,n)}(Xt)),Xt.exports),sn=n(on);function an(){let e,t;const n=new Promise((function(n,r){e=n,t=r}));return{resolve:e,reject:t,promise:n}}function un(e,t){let n;return"undefined"!=typeof document&&(n=document),un._implementation(e,t,n)}un._implementation=function(e,t,n){if(!g(e))throw new b("relative uri is required.");if(!g(t)){if(void 0===n)return e;t=_(n.baseURI,n.location.href)}const r=new sn(e);return""!==r.scheme()?r.toString():r.absoluteTo(t).toString()};const cn={};function ln(e,t,n){g(t)||(t=e.width),g(n)||(n=e.height);let r=cn[t];g(r)||(r={},cn[t]=r);let o=r[n];if(!g(o)){const e=document.createElement("canvas");e.width=t,e.height=n,o=e.getContext("2d",{willReadFrequently:!0}),o.globalCompositeOperation="copy",r[n]=o}return o.drawImage(e,0,0,t,n),o.getImageData(0,0,t,n).data}const fn=/^blob:/i;function pn(e){return j.typeOf.string("uri",e),fn.test(e)}let hn;const dn=/^data:/i;function mn(e){return j.typeOf.string("uri",e),dn.test(e)}var yn=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5});var _n=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3});function gn(e){e=_(e,_.EMPTY_OBJECT);const t=_(e.throttleByServer,!1),n=_(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=_(e.priority,0),this.throttle=n,this.throttleByServer=t,this.type=_(e.type,_n.OTHER),this.serverKey=e.serverKey,this.state=yn.UNISSUED,this.deferred=void 0,this.cancelled=!1}function bn(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){const t={};if(!e)return t;const n=e.split("\r\n");for(let e=0;e<n.length;++e){const r=n[e],o=r.indexOf(": ");if(o>0){const e=r.substring(0,o),n=r.substring(o+2);t[e]=n}}return t}(this.responseHeaders))}function En(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function On(e,t){return t-e}function wn(e){j.typeOf.object("options",e),j.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function vn(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}gn.prototype.cancel=function(){this.cancelled=!0},gn.prototype.clone=function(e){return g(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=yn.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new gn(this)},bn.prototype.toString=function(){let e="Request has failed.";return g(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e},Object.defineProperties(En.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),En.prototype.addEventListener=function(e,t){j.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);const n=this;return function(){n.removeEventListener(e,t)}},En.prototype.removeEventListener=function(e,t){j.typeOf.func("listener",e);const n=this._listeners,r=this._scopes;let o=-1;for(let i=0;i<n.length;i++)if(n[i]===e&&r[i]===t){o=i;break}return-1!==o&&(this._insideRaiseEvent?(this._toRemove.push(o),n[o]=void 0,r[o]=void 0):(n.splice(o,1),r.splice(o,1)),!0)},En.prototype.raiseEvent=function(){let e;this._insideRaiseEvent=!0;const t=this._listeners,n=this._scopes;let r=t.length;for(e=0;e<r;e++){g(t[e])&&t[e].apply(n[e],arguments)}const o=this._toRemove;if(r=o.length,r>0){for(o.sort(On),e=0;e<r;e++){const r=o[e];t.splice(r,1),n.splice(r,1)}o.length=0}this._insideRaiseEvent=!1},Object.defineProperties(wn.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){j.typeOf.number.greaterThanOrEquals("maximumLength",e,0);const t=this._length;if(e<t){const n=this._array;for(let r=e;r<t;++r)n[r]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}}),wn.prototype.reserve=function(e){e=_(e,this._length),this._array.length=e},wn.prototype.heapify=function(e){e=_(e,0);const t=this._length,n=this._comparator,r=this._array;let o=-1,i=!0;for(;i;){const s=2*(e+1),a=s-1;o=a<t&&n(r[a],r[e])<0?a:e,s<t&&n(r[s],r[o])<0&&(o=s),o!==e?(vn(r,o,e),e=o):i=!1}},wn.prototype.resort=function(){const e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},wn.prototype.insert=function(e){j.defined("element",e);const t=this._array,n=this._comparator,r=this._maximumLength;let o,i=this._length++;for(i<t.length?t[i]=e:t.push(e);0!==i;){const e=Math.floor((i-1)/2);if(!(n(t[i],t[e])<0))break;vn(t,i,e),i=e}return g(r)&&this._length>r&&(o=t[r],this._length=r),o},wn.prototype.pop=function(e){if(e=_(e,0),0===this._length)return;j.typeOf.number.lessThan("index",e,this._length);const t=this._array,n=t[e];return vn(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};const Tn={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0};let xn=20;const Rn=new wn({comparator:function(e,t){return e.priority-t.priority}});Rn.maximumLength=xn,Rn.reserve(xn);const An=[];let Sn={};const In="undefined"!=typeof document?new sn(document.location.href):new sn,Nn=new En;function Cn(){}function Pn(e){g(e.priorityFunction)&&(e.priority=e.priorityFunction())}function Mn(e){return e.state===yn.UNISSUED&&(e.state=yn.ISSUED,e.deferred=an()),e.deferred.promise}function jn(e){const t=Mn(e);return e.state=yn.ACTIVE,An.push(e),++Tn.numberOfActiveRequests,++Tn.numberOfActiveRequestsEver,++Sn[e.serverKey],e.requestFunction().then(function(e){return function(t){if(e.state===yn.CANCELLED)return;const n=e.deferred;--Tn.numberOfActiveRequests,--Sn[e.serverKey],Nn.raiseEvent(),e.state=yn.RECEIVED,e.deferred=void 0,n.resolve(t)}}(e)).catch(function(e){return function(t){e.state!==yn.CANCELLED&&(++Tn.numberOfFailedRequests,--Tn.numberOfActiveRequests,--Sn[e.serverKey],Nn.raiseEvent(t),e.state=yn.FAILED,e.deferred.reject(t))}}(e)),t}function Un(e){const t=e.state===yn.ACTIVE;if(e.state=yn.CANCELLED,++Tn.numberOfCancelledRequests,g(e.deferred)){const t=e.deferred;e.deferred=void 0,t.reject()}t&&(--Tn.numberOfActiveRequests,--Sn[e.serverKey],++Tn.numberOfCancelledActiveRequests),g(e.cancelFunction)&&e.cancelFunction()}Cn.maximumRequests=50,Cn.maximumRequestsPerServer=18,Cn.requestsByServer={},Cn.throttleRequests=!0,Cn.debugShowStatistics=!1,Cn.requestCompletedEvent=Nn,Object.defineProperties(Cn,{statistics:{get:function(){return Tn}},priorityHeapLength:{get:function(){return xn},set:function(e){if(e<xn)for(;Rn.length>e;){Un(Rn.pop())}xn=e,Rn.maximumLength=e,Rn.reserve(e)}}}),Cn.serverHasOpenSlots=function(e,t){t=_(t,1);const n=_(Cn.requestsByServer[e],Cn.maximumRequestsPerServer);return Sn[e]+t<=n},Cn.heapHasOpenSlots=function(e){return Rn.length+e<=xn},Cn.update=function(){let e,t,n=0;const r=An.length;for(e=0;e<r;++e)t=An[e],t.cancelled&&Un(t),t.state===yn.ACTIVE?n>0&&(An[e-n]=t):++n;An.length-=n;const o=Rn.internalArray,i=Rn.length;for(e=0;e<i;++e)Pn(o[e]);Rn.resort();const s=Math.max(Cn.maximumRequests-An.length,0);let a=0;for(;a<s&&Rn.length>0;)t=Rn.pop(),t.cancelled?Un(t):!t.throttleByServer||Cn.serverHasOpenSlots(t.serverKey)?(jn(t),++a):Un(t);!function(){if(!Cn.debugShowStatistics)return;0===Tn.numberOfActiveRequests&&Tn.lastNumberOfActiveRequests>0&&(Tn.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${Tn.numberOfAttemptedRequests}`),Tn.numberOfAttemptedRequests=0),Tn.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${Tn.numberOfCancelledRequests}`),Tn.numberOfCancelledRequests=0),Tn.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${Tn.numberOfCancelledActiveRequests}`),Tn.numberOfCancelledActiveRequests=0),Tn.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${Tn.numberOfFailedRequests}`),Tn.numberOfFailedRequests=0));Tn.lastNumberOfActiveRequests=Tn.numberOfActiveRequests}()},Cn.getServerKey=function(e){j.typeOf.string("url",e);let t=new sn(e);""===t.scheme()&&(t=t.absoluteTo(In),t.normalize());let n=t.authority();/:/.test(n)||(n=`${n}:${"https"===t.scheme()?"443":"80"}`);return g(Sn[n])||(Sn[n]=0),n},Cn.request=function(e){if(j.typeOf.object("request",e),j.typeOf.string("request.url",e.url),j.typeOf.func("request.requestFunction",e.requestFunction),mn(e.url)||pn(e.url))return Nn.raiseEvent(),e.state=yn.RECEIVED,e.requestFunction();if(++Tn.numberOfAttemptedRequests,g(e.serverKey)||(e.serverKey=Cn.getServerKey(e.url)),Cn.throttleRequests&&e.throttleByServer&&!Cn.serverHasOpenSlots(e.serverKey))return;if(!Cn.throttleRequests||!e.throttle)return jn(e);if(An.length>=Cn.maximumRequests)return;Pn(e);const t=Rn.insert(e);if(g(t)){if(t===e)return;Un(t)}return Mn(e)},Cn.clearForSpecs=function(){for(;Rn.length>0;){Un(Rn.pop())}const e=An.length;for(let t=0;t<e;++t)Un(An[t]);An.length=0,Sn={},Tn.numberOfAttemptedRequests=0,Tn.numberOfActiveRequests=0,Tn.numberOfCancelledRequests=0,Tn.numberOfCancelledActiveRequests=0,Tn.numberOfFailedRequests=0,Tn.numberOfActiveRequestsEver=0,Tn.lastNumberOfActiveRequests=0},Cn.numberOfActiveRequestsByServer=function(e){return Sn[e]},Cn.requestHeap=Rn;const Fn={};let qn={};Fn.add=function(e,t){if(!g(e))throw new b("host is required.");if(!g(t)||t<=0)throw new b("port is required to be greater than 0.");const n=`${e.toLowerCase()}:${t}`;g(qn[n])||(qn[n]=!0)},Fn.remove=function(e,t){if(!g(e))throw new b("host is required.");if(!g(t)||t<=0)throw new b("port is required to be greater than 0.");const n=`${e.toLowerCase()}:${t}`;g(qn[n])&&delete qn[n]},Fn.contains=function(e){if(!g(e))throw new b("url is required.");const t=function(e){const t=new sn(e);t.normalize();let n=t.authority();if(0!==n.length){if(t.authority(n),-1!==n.indexOf("@")){const e=n.split("@");n=e[1]}if(-1===n.indexOf(":")){let e=t.scheme();if(0===e.length&&(e=window.location.protocol,e=e.substring(0,e.length-1)),"http"===e)n+=":80";else{if("https"!==e)return;n+=":443"}}return n}}(e);return!(!g(t)||!g(qn[t]))},Fn.clear=function(){qn={}};const Ln=function(){try{const e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function Dn(e){"string"==typeof(e=_(e,_.EMPTY_OBJECT))&&(e={url:e}),j.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=Bn(e.templateValues,{}),this._queryParameters=Bn(e.queryParameters,{}),this.headers=Bn(e.headers,{}),this.request=_(e.request,new gn),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=_(e.retryAttempts,0),this._retryCount=0;_(e.parseUrl,!0)?this.parseUrl(e.url,!0,!0):this._url=e.url,this._credits=e.credits}function Bn(e,t){return g(e)?B(e):t}let zn;function kn(e,t,n){if(!n)return z(e,t);const r=B(e,!0);for(const e in t)if(t.hasOwnProperty(e)){let n=r[e];const o=t[e];g(n)?(Array.isArray(n)||(n=r[e]=[n]),r[e]=n.concat(o)):r[e]=Array.isArray(o)?o.slice():o}return r}function Gn(e){const t=e.resource,n=e.flipY,r=e.skipColorSpaceConversion,o=e.preferImageBitmap,i=t.request;i.url=t.url,i.requestFunction=function(){let e=!1;t.isDataUri||t.isBlobUri||(e=t.isCrossOriginUrl);const s=an();return Dn._Implementations.createImage(i,e,s,n,r,o),s.promise};const s=Cn.request(i);if(g(s))return s.catch((function(e){return i.state!==yn.FAILED?Promise.reject(e):t.retryOnError(e).then((function(s){return s?(i.state=yn.UNISSUED,i.deferred=void 0,Gn({resource:t,flipY:n,skipColorSpaceConversion:r,preferImageBitmap:o})):Promise.reject(e)}))}))}function Vn(e,t,n){const r={};r[t]=n,e.setQueryParameters(r);const o=e.request,i=e.url;o.url=i,o.requestFunction=function(){const e=an();return window[n]=function(t){e.resolve(t);try{delete window[n]}catch(e){window[n]=void 0}},Dn._Implementations.loadAndExecuteScript(i,n,e),e.promise};const s=Cn.request(o);if(g(s))return s.catch((function(r){return o.state!==yn.FAILED?Promise.reject(r):e.retryOnError(r).then((function(i){return i?(o.state=yn.UNISSUED,o.deferred=void 0,Vn(e,t,n)):Promise.reject(r)}))}))}function Hn(e){if(e.state===yn.ISSUED||e.state===yn.ACTIVE)throw new Ae("The Resource is already being fetched.");e.state=yn.UNISSUED,e.deferred=void 0}Dn.createIfNeeded=function(e){return e instanceof Dn?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new Dn({url:e})},Dn.supportsImageBitmapOptions=function(){if(g(zn))return zn;if("function"!=typeof createImageBitmap)return zn=Promise.resolve(!1),zn;return zn=Dn.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC"}).then((function(e){return Promise.all([createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"}),createImageBitmap(e)])})).then((function(e){const t=ln(e[0]),n=ln(e[1]);return t[1]!==n[1]})).catch((function(){return!1})),zn},Object.defineProperties(Dn,{isBlobSupported:{get:function(){return Ln}}}),Object.defineProperties(Dn.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){this.parseUrl(e,!1,!1)}},extension:{get:function(){return function(e){if(!g(e))throw new b("uri is required.");const t=new sn(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return-1!==r&&(n=n.substr(r+1)),r=n.lastIndexOf("."),n=-1===r?"":n.substr(r+1),n}(this._url)}},isDataUri:{get:function(){return mn(this._url)}},isBlobUri:{get:function(){return pn(this._url)}},isCrossOriginUrl:{get:function(){return function(e){g(hn)||(hn=document.createElement("a")),hn.href=window.location.href;const t=hn.host,n=hn.protocol;return hn.href=e,hn.href=hn.href,n!==hn.protocol||t!==hn.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}},credits:{get:function(){return this._credits}}}),Dn.prototype.toString=function(){return this.getUrlComponent(!0,!0)},Dn.prototype.parseUrl=function(e,t,n,r){let o=new sn(e);const i=function(e){if(0===e.length)return{};if(-1===e.indexOf("="))return{[e]:void 0};return function(e){if(!g(e))throw new b("queryString is required.");const t={};if(""===e)return t;const n=e.replace(/\+/g,"%20").split(/[&;]/);for(let e=0,r=n.length;e<r;++e){const r=n[e].split("="),o=decodeURIComponent(r[0]);let i=r[1];i=g(i)?decodeURIComponent(i):"";const s=t[o];"string"==typeof s?t[o]=[s,i]:Array.isArray(s)?s.push(i):t[o]=i}return t}(e)}(o.query());this._queryParameters=t?kn(i,this.queryParameters,n):i,o.search(""),o.fragment(""),g(r)&&""===o.scheme()&&(o=o.absoluteTo(un(r))),this._url=o.toString()},Dn.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=this._url;e&&(n=`${n}${function(e){const t=Object.keys(e);if(0===t.length)return"";if(1===t.length&&!g(e[t[0]]))return`?${t[0]}`;return`?${function(e){if(!g(e))throw new b("obj is required.");let t="";for(const n in e)if(e.hasOwnProperty(n)){const r=e[n],o=`${encodeURIComponent(n)}=`;if(Array.isArray(r))for(let e=0,n=r.length;e<n;++e)t+=`${o+encodeURIComponent(r[e])}&`;else t+=`${o+encodeURIComponent(r)}&`}return t=t.slice(0,-1),t}(e)}`}(this.queryParameters)}`),n=n.replace(/%7B/g,"{").replace(/%7D/g,"}");const r=this._templateValues;return Object.keys(r).length>0&&(n=n.replace(/{(.*?)}/g,(function(e,t){const n=r[t];return g(n)?encodeURIComponent(n):e}))),t&&g(this.proxy)&&(n=this.proxy.getURL(n)),n},Dn.prototype.setQueryParameters=function(e,t){this._queryParameters=t?kn(this._queryParameters,e,!1):kn(e,this._queryParameters,!1)},Dn.prototype.appendQueryParameters=function(e){this._queryParameters=kn(e,this._queryParameters,!0)},Dn.prototype.setTemplateValues=function(e,t){this._templateValues=t?z(this._templateValues,e):z(e,this._templateValues)},Dn.prototype.getDerivedResource=function(e){const t=this.clone();if(t._retryCount=0,g(e.url)){const n=_(e.preserveQueryParameters,!1);t.parseUrl(e.url,!0,n,this._url)}return g(e.queryParameters)&&(t._queryParameters=z(e.queryParameters,t.queryParameters)),g(e.templateValues)&&(t._templateValues=z(e.templateValues,t.templateValues)),g(e.headers)&&(t.headers=z(e.headers,t.headers)),g(e.proxy)&&(t.proxy=e.proxy),g(e.request)&&(t.request=e.request),g(e.retryCallback)&&(t.retryCallback=e.retryCallback),g(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},Dn.prototype.retryOnError=function(e){const t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);const n=this;return Promise.resolve(t(this,e)).then((function(e){return++n._retryCount,e}))},Dn.prototype.clone=function(e){return g(e)?(e._url=this._url,e._queryParameters=B(this._queryParameters),e._templateValues=B(this._templateValues),e.headers=B(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e):new Dn({url:this._url,queryParameters:this.queryParameters,templateValues:this.templateValues,headers:this.headers,proxy:this.proxy,retryCallback:this.retryCallback,retryAttempts:this.retryAttempts,request:this.request.clone(),parseUrl:!1,credits:g(this.credits)?this.credits.slice():void 0})},Dn.prototype.getBaseUri=function(e){return function(e,t){if(!g(e))throw new b("uri is required.");let n="";const r=e.lastIndexOf("/");return-1!==r&&(n=e.substring(0,r+1)),t?(0!==(e=new sn(e)).query().length&&(n+=`?${e.query()}`),0!==e.fragment().length&&(n+=`#${e.fragment()}`),n):n}(this.getUrlComponent(e),e)},Dn.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e=`${e}/`),e)},Dn.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},Dn.fetchArrayBuffer=function(e){return new Dn(e).fetchArrayBuffer()},Dn.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},Dn.fetchBlob=function(e){return new Dn(e).fetchBlob()},Dn.prototype.fetchImage=function(e){e=_(e,_.EMPTY_OBJECT);const t=_(e.preferImageBitmap,!1),n=_(e.preferBlob,!1),r=_(e.flipY,!1),o=_(e.skipColorSpaceConversion,!1);if(Hn(this.request),!Ln||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return Gn({resource:this,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:t});const i=this.fetchBlob();if(!g(i))return;let s,a,u,c;return Dn.supportsImageBitmapOptions().then((function(e){return s=e,a=s&&t,i})).then((function(e){if(!g(e))return;if(c=e,a)return Dn.createImageBitmapFromBlob(e,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});const t=window.URL.createObjectURL(e);return u=new Dn({url:t}),Gn({resource:u,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:!1})})).then((function(e){if(g(e))return e.blob=c,a||window.URL.revokeObjectURL(u.url),e})).catch((function(e){return g(u)&&window.URL.revokeObjectURL(u.url),e.blob=c,Promise.reject(e)}))},Dn.fetchImage=function(e){return new Dn(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},Dn.prototype.fetchText=function(){return this.fetch({responseType:"text"})},Dn.fetchText=function(e){return new Dn(e).fetchText()},Dn.prototype.fetchJson=function(){const e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(g(e))return e.then((function(e){if(g(e))return JSON.parse(e)}))},Dn.fetchJson=function(e){return new Dn(e).fetchJson()},Dn.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},Dn.fetchXML=function(e){return new Dn(e).fetchXML()},Dn.prototype.fetchJsonp=function(e){let t;e=_(e,"callback"),Hn(this.request);do{t=`loadJsonp${F.nextRandomNumber().toString().substring(2,8)}`}while(g(window[t]));return Vn(this,e,t)},Dn.fetchJsonp=function(e){return new Dn(e).fetchJsonp(e.callbackParameterName)},Dn.prototype._makeRequest=function(e){const t=this;Hn(t.request);const n=t.request,r=t.url;n.url=r,n.requestFunction=function(){const o=e.responseType,i=z(e.headers,t.headers),s=e.overrideMimeType,a=e.method,u=e.data,c=an(),l=Dn._Implementations.loadWithXhr(r,o,a,u,i,c,s);return g(l)&&g(l.abort)&&(n.cancelFunction=function(){l.abort()}),c.promise};const o=Cn.request(n);if(g(o))return o.then((function(e){return n.cancelFunction=void 0,e})).catch((function(r){return n.cancelFunction=void 0,n.state!==yn.FAILED?Promise.reject(r):t.retryOnError(r).then((function(o){return o?(n.state=yn.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(r)}))}))};const Wn=/^data:(.*?)(;base64)?,(.*)$/;function Xn(e,t){const n=decodeURIComponent(t);return e?atob(n):n}function $n(e,t){const n=Xn(e,t),r=new ArrayBuffer(n.length),o=new Uint8Array(r);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);return r}Dn.prototype.fetch=function(e){return(e=Bn(e,{})).method="GET",this._makeRequest(e)},Dn.fetch=function(e){return new Dn(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Dn.prototype.delete=function(e){return(e=Bn(e,{})).method="DELETE",this._makeRequest(e)},Dn.delete=function(e){return new Dn(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},Dn.prototype.head=function(e){return(e=Bn(e,{})).method="HEAD",this._makeRequest(e)},Dn.head=function(e){return new Dn(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Dn.prototype.options=function(e){return(e=Bn(e,{})).method="OPTIONS",this._makeRequest(e)},Dn.options=function(e){return new Dn(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Dn.prototype.post=function(e,t){return j.defined("data",e),(t=Bn(t,{})).method="POST",t.data=e,this._makeRequest(t)},Dn.post=function(e){return new Dn(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Dn.prototype.put=function(e,t){return j.defined("data",e),(t=Bn(t,{})).method="PUT",t.data=e,this._makeRequest(t)},Dn.put=function(e){return new Dn(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Dn.prototype.patch=function(e,t){return j.defined("data",e),(t=Bn(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},Dn.patch=function(e){return new Dn(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Dn._Implementations={},Dn._Implementations.loadImageElement=function(e,t,n){const r=new Image;r.onload=function(){0===r.naturalWidth&&0===r.naturalHeight&&0===r.width&&0===r.height&&(r.width=300,r.height=150),n.resolve(r)},r.onerror=function(e){n.reject(e)},t&&(Fn.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e},Dn._Implementations.createImage=function(e,t,n,r,o,i){const s=e.url;Dn.supportsImageBitmapOptions().then((function(a){if(!a||!i)return void Dn._Implementations.loadImageElement(s,t,n);const u=an(),c=Dn._Implementations.loadWithXhr(s,"blob","GET",void 0,void 0,u,void 0,void 0,void 0);return g(c)&&g(c.abort)&&(e.cancelFunction=function(){c.abort()}),u.promise.then((function(e){if(g(e))return Dn.createImageBitmapFromBlob(e,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});n.reject(new Ae(`Successfully retrieved ${s} but it contained no content.`))})).then((function(e){n.resolve(e)}))})).catch((function(e){n.reject(e)}))},Dn.createImageBitmapFromBlob=function(e,t){return j.defined("options",t),j.typeOf.bool("options.flipY",t.flipY),j.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),j.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};const Yn="undefined"==typeof XMLHttpRequest;function Zn(e){e=_(e,_.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._addNewLeapSeconds=_(e.addNewLeapSeconds,!0),g(e.data)?Kn(this,e.data):Kn(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function Qn(e,t){return Vt.compare(e.julianDate,t)}function Kn(e,t){if(!g(t.columnNames))throw new Ae("Error in loaded EOP data: The columnNames property is required.");if(!g(t.samples))throw new Ae("Error in loaded EOP data: The samples property is required.");const n=t.columnNames.indexOf("modifiedJulianDateUtc"),r=t.columnNames.indexOf("xPoleWanderRadians"),o=t.columnNames.indexOf("yPoleWanderRadians"),i=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),a=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||r<0||o<0||i<0||s<0||a<0||u<0)throw new Ae("Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");const c=e._samples=t.samples,l=e._dates=[];let f;e._dateColumn=n,e._xPoleWanderRadiansColumn=r,e._yPoleWanderRadiansColumn=o,e._ut1MinusUtcSecondsColumn=i,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=a,e._taiMinusUtcSecondsColumn=u,e._columnCount=t.columnNames.length,e._lastIndex=void 0;const p=e._addNewLeapSeconds;for(let t=0,r=c.length;t<r;t+=e._columnCount){const e=c[t+n],r=c[t+u],o=new Vt(e+Tt.MODIFIED_JULIAN_DATE_DIFFERENCE,r,xt.TAI);if(l.push(o),p){if(r!==f&&g(f)){const e=Vt.leapSeconds,t=gt(e,o,Qn);if(t<0){const n=new vt(o,r);e.splice(~t,0,n)}}f=r}}}function Jn(e,t,n,r,o){const i=n*r;o.xPoleWander=t[i+e._xPoleWanderRadiansColumn],o.yPoleWander=t[i+e._yPoleWanderRadiansColumn],o.xPoleOffset=t[i+e._xCelestialPoleOffsetRadiansColumn],o.yPoleOffset=t[i+e._yCelestialPoleOffsetRadiansColumn],o.ut1MinusUtc=t[i+e._ut1MinusUtcSecondsColumn]}function er(e,t,n){return t+e*(n-t)}function tr(e,t,n,r,o,i,s){const a=e._columnCount;if(i>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;const u=t[o],c=t[i];if(u.equals(c)||r.equals(u))return Jn(e,n,o,a,s),s;if(r.equals(c))return Jn(e,n,i,a,s),s;const l=Vt.secondsDifference(r,u)/Vt.secondsDifference(c,u),f=o*a,p=i*a;let h=n[f+e._ut1MinusUtcSecondsColumn],d=n[p+e._ut1MinusUtcSecondsColumn];const m=d-h;if(m>.5||m<-.5){const t=n[f+e._taiMinusUtcSecondsColumn],o=n[p+e._taiMinusUtcSecondsColumn];t!==o&&(c.equals(r)?h=d:d-=o-t)}return s.xPoleWander=er(l,n[f+e._xPoleWanderRadiansColumn],n[p+e._xPoleWanderRadiansColumn]),s.yPoleWander=er(l,n[f+e._yPoleWanderRadiansColumn],n[p+e._yPoleWanderRadiansColumn]),s.xPoleOffset=er(l,n[f+e._xCelestialPoleOffsetRadiansColumn],n[p+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=er(l,n[f+e._yCelestialPoleOffsetRadiansColumn],n[p+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=er(l,h,d),s}function nr(e,t,n){this.heading=_(e,0),this.pitch=_(t,0),this.roll=_(n,0)}Dn._Implementations.loadWithXhr=function(e,t,n,r,o,i,s){const a=Wn.exec(e);if(null!==a)return void i.resolve(function(e,t){t=_(t,"");const n=e[1],r=!!e[2],o=e[3];let i,s;switch(t){case"":case"text":return Xn(r,o);case"arraybuffer":return $n(r,o);case"blob":return i=$n(r,o),new Blob([i],{type:n});case"document":return s=new DOMParser,s.parseFromString(Xn(r,o),n);case"json":return JSON.parse(Xn(r,o));default:throw new b(`Unhandled responseType: ${t}`)}}(a,t));if(Yn)return void function(e,t,n,r,o,i){fetch(e,{method:n,headers:o}).then((async e=>{if(!e.ok){const t={};return e.headers.forEach(((e,n)=>{t[n]=e})),void i.reject(new bn(e.status,e,t))}switch(t){case"text":i.resolve(e.text());break;case"json":i.resolve(e.json());break;default:i.resolve(new Uint8Array(await e.arrayBuffer()).buffer)}})).catch((()=>{i.reject(new bn)}))}(e,t,n,0,o,i);const u=new XMLHttpRequest;if(Fn.contains(e)&&(u.withCredentials=!0),u.open(n,e,!0),g(s)&&g(u.overrideMimeType)&&u.overrideMimeType(s),g(o))for(const e in o)o.hasOwnProperty(e)&&u.setRequestHeader(e,o[e]);g(t)&&(u.responseType=t);let c=!1;return"string"==typeof e&&(c=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),u.onload=function(){if((u.status<200||u.status>=300)&&(!c||0!==u.status))return void i.reject(new bn(u.status,u.response,u.getAllResponseHeaders()));const e=u.response,r=u.responseType;if("HEAD"===n||"OPTIONS"===n){const e=u.getAllResponseHeaders().trim().split(/[\r\n]+/),t={};return e.forEach((function(e){const n=e.split(": "),r=n.shift();t[r]=n.join(": ")})),void i.resolve(t)}if(204===u.status)i.resolve(void 0);else if(!g(e)||g(t)&&r!==t)if("json"===t&&"string"==typeof e)try{i.resolve(JSON.parse(e))}catch(e){i.reject(e)}else(""===r||"document"===r)&&g(u.responseXML)&&u.responseXML.hasChildNodes()?i.resolve(u.responseXML):""!==r&&"text"!==r||!g(u.responseText)?i.reject(new Ae("Invalid XMLHttpRequest response type.")):i.resolve(u.responseText);else i.resolve(e)},u.onerror=function(e){i.reject(new bn)},u.send(r),u},Dn._Implementations.loadAndExecuteScript=function(e,t,n){return function(e){const t=document.createElement("script");return t.async=!0,t.src=e,new Promise(((e,n)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");const r=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,r.removeChild(t),e()},t.onerror=function(e){n(e)},r.appendChild(t)}))}(e).catch((function(e){n.reject(e)}))},Dn._DefaultImplementations={},Dn._DefaultImplementations.createImage=Dn._Implementations.createImage,Dn._DefaultImplementations.loadWithXhr=Dn._Implementations.loadWithXhr,Dn._DefaultImplementations.loadAndExecuteScript=Dn._Implementations.loadAndExecuteScript,Dn.DEFAULT=Object.freeze(new Dn({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),Zn.fromUrl=async function(e,t){j.defined("url",e),t=_(t,_.EMPTY_OBJECT);const n=Dn.createIfNeeded(e);let r;try{r=await n.fetchJson()}catch(e){throw new Ae(`An error occurred while retrieving the EOP data from the URL ${n.url}.`)}return new Zn({addNewLeapSeconds:t.addNewLeapSeconds,data:r})},Zn.NONE=Object.freeze({compute:function(e,t){return g(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new bt(0,0,0,0,0),t}}),Zn.prototype.compute=function(e,t){if(!g(this._samples))return;if(g(t)||(t=new bt(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;const n=this._dates,r=this._lastIndex;let o=0,i=0;if(g(r)){const s=n[r],a=n[r+1],u=Vt.lessThanOrEquals(s,e),c=!g(a),l=c||Vt.greaterThanOrEquals(a,e);if(u&&l)return o=r,!c&&a.equals(e)&&++o,i=o+1,tr(this,n,this._samples,e,o,i,t),t}let s=gt(n,e,Vt.compare,this._dateColumn);return s>=0?(s<n.length-1&&n[s+1].equals(e)&&++s,o=s,i=s):(i=~s,o=i-1,o<0&&(o=0)),this._lastIndex=o,tr(this,n,this._samples,e,o,i,t),t},nr.fromQuaternion=function(e,t){if(!g(e))throw new b("quaternion is required");g(t)||(t=new nr);const n=2*(e.w*e.y-e.z*e.x),r=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),i=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,i),t.roll=Math.atan2(o,r),t.pitch=-F.asinClamped(n),t},nr.fromDegrees=function(e,t,n,r){if(!g(e))throw new b("heading is required");if(!g(t))throw new b("pitch is required");if(!g(n))throw new b("roll is required");return g(r)||(r=new nr),r.heading=e*F.RADIANS_PER_DEGREE,r.pitch=t*F.RADIANS_PER_DEGREE,r.roll=n*F.RADIANS_PER_DEGREE,r},nr.clone=function(e,t){if(g(e))return g(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new nr(e.heading,e.pitch,e.roll)},nr.equals=function(e,t){return e===t||g(e)&&g(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},nr.equalsEpsilon=function(e,t,n,r){return e===t||g(e)&&g(t)&&F.equalsEpsilon(e.heading,t.heading,n,r)&&F.equalsEpsilon(e.pitch,t.pitch,n,r)&&F.equalsEpsilon(e.roll,t.roll,n,r)},nr.prototype.clone=function(e){return nr.clone(this,e)},nr.prototype.equals=function(e){return nr.equals(this,e)},nr.prototype.equalsEpsilon=function(e,t,n){return nr.equalsEpsilon(this,e,t,n)},nr.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};const rr=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;let or,ir,sr;function ar(e){return"undefined"==typeof document?e:(g(or)||(or=document.createElement("a")),or.href=e,or.href)}function ur(){if(g(ir))return ir;let t;if(t="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:g("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("obj2gltf.min.js",document.baseURI).href)?un(".","undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("obj2gltf.min.js",document.baseURI).href):"object"==typeof define&&g(define.amd)&&!define.amd.toUrlUndefined&&g(require.toUrl)?un("..",fr("Core/buildModuleUrl.js")):function(){const e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){const n=e[t].getAttribute("src"),r=rr.exec(n);if(null!==r)return r[1]}}(),!g(t))throw new b("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return ir=new Dn({url:ar(t)}),ir.appendForwardSlash(),ir}function cr(e){return ar(require.toUrl(`../${e}`))}function lr(e){return ur().getDerivedResource({url:e}).url}function fr(e){g(sr)||(sr="object"==typeof define&&g(define.amd)&&!define.amd.toUrlUndefined&&g(require.toUrl)?cr:lr);return sr(e)}function pr(e,t,n){this.x=e,this.y=t,this.s=n}function hr(e){e=_(e,_.EMPTY_OBJECT),this._xysFileUrlTemplate=Dn.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=_(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=_(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new Vt(this._sampleZeroJulianEphemerisDate,0,xt.TAI),this._stepSizeDays=_(e.stepSizeDays,1),this._samplesPerXysFile=_(e.samplesPerXysFile,1e3),this._totalSamples=_(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];const t=this._interpolationOrder,n=this._denominators=new Array(t+1),r=this._xTable=new Array(t+1),o=Math.pow(this._stepSizeDays,t);for(let e=0;e<=t;++e){n[e]=o,r[e]=e*this._stepSizeDays;for(let r=0;r<=t;++r)r!==e&&(n[e]*=e-r);n[e]=1/n[e]}this._work=new Array(t+1),this._coef=new Array(t+1)}fr._cesiumScriptRegex=rr,fr._buildModuleUrlFromBaseUrl=lr,fr._clearBaseResource=function(){ir=void 0},fr.setBaseUrl=function(e){ir=Dn.DEFAULT.getDerivedResource({url:e})},fr.getCesiumBaseUrl=ur;const dr=new Vt(0,0,xt.TAI);function mr(e,t,n){const r=dr;return r.dayNumber=t,r.secondsOfDay=n,Vt.daysDifference(r,e._sampleZeroDateTT)}function yr(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n;const r=e._xysFileUrlTemplate;n=g(r)?r.getDerivedResource({templateValues:{0:t}}):new Dn({url:fr(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});const o=n.fetchJson().then((function(n){e._chunkDownloadsInProgress[t]=!1;const r=e._samples,o=n.samples,i=t*e._samplesPerXysFile*3;for(let e=0,t=o.length;e<t;++e)r[i+e]=o[e]}));return e._chunkDownloadsInProgress[t]=o,o}let _r;hr.prototype.preload=function(e,t,n,r){const o=mr(this,e,t),i=mr(this,n,r);let s=o/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);let a=i/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;a>=this._totalSamples&&(a=this._totalSamples-1);const u=s/this._samplesPerXysFile|0,c=a/this._samplesPerXysFile|0,l=[];for(let e=u;e<=c;++e)l.push(yr(this,e));return Promise.all(l)},hr.prototype.computeXysRadians=function(e,t,n){const r=mr(this,e,t);if(r<0)return;const o=r/this._stepSizeDays|0;if(o>=this._totalSamples)return;const i=this._interpolationOrder;let s=o-(i/2|0);s<0&&(s=0);let a=s+i;a>=this._totalSamples&&(a=this._totalSamples-1,s=a-i,s<0&&(s=0));let u=!1;const c=this._samples;if(g(c[3*s])||(yr(this,s/this._samplesPerXysFile|0),u=!0),g(c[3*a])||(yr(this,a/this._samplesPerXysFile|0),u=!0),u)return;g(n)?(n.x=0,n.y=0,n.s=0):n=new pr(0,0,0);const l=r-s*this._stepSizeDays,f=this._work,p=this._denominators,h=this._coef,d=this._xTable;let m,y;for(m=0;m<=i;++m)f[m]=l-d[m];for(m=0;m<=i;++m){for(h[m]=1,y=0;y<=i;++y)y!==m&&(h[m]*=f[y]);h[m]*=p[m];let e=3*(s+m);n.x+=h[m]*c[e++],n.y+=h[m]*c[e++],n.s+=h[m]*c[e]}return n};const gr={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},br={};let Er,Or,wr,vr,Tr,xr,Rr,Ar,Sr,Ir,Nr,Cr,Pr,Mr,jr,Ur,Fr,qr;function Lr(e){const t=e.split(".");for(let e=0,n=t.length;e<n;++e)t[e]=parseInt(t[e],10);return t}function Dr(){if(!g(Or)&&(Or=!1,!Gr())){const e=/ Chrome\/([\.0-9]+)/.exec(Er.userAgent);null!==e&&(Or=!0,wr=Lr(e[1]))}return Or}function Br(){if(!g(vr)&&(vr=!1,!Dr()&&!Gr()&&/ Safari\/[\.0-9]+/.test(Er.userAgent))){const e=/ Version\/([\.0-9]+)/.exec(Er.userAgent);null!==e&&(vr=!0,Tr=Lr(e[1]))}return vr}function zr(){if(!g(xr)){xr=!1;const e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(Er.userAgent);null!==e&&(xr=!0,Rr=Lr(e[1]),Rr.isNightly=!!e[2])}return xr}function kr(){if(!g(Ar)){let e;Ar=!1,"Microsoft Internet Explorer"===Er.appName?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(Er.userAgent),null!==e&&(Ar=!0,Sr=Lr(e[1]))):"Netscape"===Er.appName&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(Er.userAgent),null!==e&&(Ar=!0,Sr=Lr(e[1])))}return Ar}function Gr(){if(!g(Ir)){Ir=!1;const e=/ Edg\/([\.0-9]+)/.exec(Er.userAgent);null!==e&&(Ir=!0,Nr=Lr(e[1]))}return Ir}function Vr(){if(!g(Cr)){Cr=!1;const e=/Firefox\/([\.0-9]+)/.exec(Er.userAgent);null!==e&&(Cr=!0,Pr=Lr(e[1]))}return Cr}function Hr(){if(!g(qr)){const e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");const t=e.style.imageRendering;qr=g(t)&&""!==t,qr&&(Fr=t)}return qr}function Wr(){if(!Wr.initialized)throw new b("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return Wr._result}Object.defineProperties(br,{element:{get:function(){if(br.supportsFullscreen())return document[gr.fullscreenElement]}},changeEventName:{get:function(){if(br.supportsFullscreen())return gr.fullscreenchange}},errorEventName:{get:function(){if(br.supportsFullscreen())return gr.fullscreenerror}},enabled:{get:function(){if(br.supportsFullscreen())return document[gr.fullscreenEnabled]}},fullscreen:{get:function(){if(br.supportsFullscreen())return null!==br.element}}}),br.supportsFullscreen=function(){if(g(_r))return _r;_r=!1;const e=document.body;if("function"==typeof e.requestFullscreen)return gr.requestFullscreen="requestFullscreen",gr.exitFullscreen="exitFullscreen",gr.fullscreenEnabled="fullscreenEnabled",gr.fullscreenElement="fullscreenElement",gr.fullscreenchange="fullscreenchange",gr.fullscreenerror="fullscreenerror",_r=!0,_r;const t=["webkit","moz","o","ms","khtml"];let n;for(let r=0,o=t.length;r<o;++r){const o=t[r];n=`${o}RequestFullscreen`,"function"==typeof e[n]?(gr.requestFullscreen=n,_r=!0):(n=`${o}RequestFullScreen`,"function"==typeof e[n]&&(gr.requestFullscreen=n,_r=!0)),n=`${o}ExitFullscreen`,"function"==typeof document[n]?gr.exitFullscreen=n:(n=`${o}CancelFullScreen`,"function"==typeof document[n]&&(gr.exitFullscreen=n)),n=`${o}FullscreenEnabled`,void 0!==document[n]?gr.fullscreenEnabled=n:(n=`${o}FullScreenEnabled`,void 0!==document[n]&&(gr.fullscreenEnabled=n)),n=`${o}FullscreenElement`,void 0!==document[n]?gr.fullscreenElement=n:(n=`${o}FullScreenElement`,void 0!==document[n]&&(gr.fullscreenElement=n)),n=`${o}fullscreenchange`,void 0!==document[`on${n}`]&&("ms"===o&&(n="MSFullscreenChange"),gr.fullscreenchange=n),n=`${o}fullscreenerror`,void 0!==document[`on${n}`]&&("ms"===o&&(n="MSFullscreenError"),gr.fullscreenerror=n)}return _r},br.requestFullscreen=function(e,t){br.supportsFullscreen()&&e[gr.requestFullscreen]({vrDisplay:t})},br.exitFullscreen=function(){br.supportsFullscreen()&&document[gr.exitFullscreen]()},br._names=gr,Er="undefined"!=typeof navigator?navigator:{},Wr._promise=void 0,Wr._result=void 0,Wr.initialize=function(){return g(Wr._promise)||(Wr._promise=new Promise((e=>{const t=new Image;t.onload=function(){Wr._result=t.width>0&&t.height>0,e(Wr._result)},t.onerror=function(){Wr._result=!1,e(Wr._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"}))),Wr._promise},Object.defineProperties(Wr,{initialized:{get:function(){return g(Wr._result)}}});const Xr=[];"undefined"!=typeof ArrayBuffer&&(Xr.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&Xr.push(Uint8ClampedArray),"undefined"!=typeof Uint8ClampedArray&&Xr.push(Uint8ClampedArray),"undefined"!=typeof BigInt64Array&&Xr.push(BigInt64Array),"undefined"!=typeof BigUint64Array&&Xr.push(BigUint64Array));const $r={isChrome:Dr,chromeVersion:function(){return Dr()&&wr},isSafari:Br,safariVersion:function(){return Br()&&Tr},isWebkit:zr,webkitVersion:function(){return zr()&&Rr},isInternetExplorer:kr,internetExplorerVersion:function(){return kr()&&Sr},isEdge:Gr,edgeVersion:function(){return Gr()&&Nr},isFirefox:Vr,firefoxVersion:function(){return Vr()&&Pr},isWindows:function(){return g(Mr)||(Mr=/Windows/i.test(Er.appVersion)),Mr},isIPadOrIOS:function(){return g(jr)||(jr="iPhone"===navigator.platform||"iPod"===navigator.platform||"iPad"===navigator.platform),jr},hardwareConcurrency:_(Er.hardwareConcurrency,3),supportsPointerEvents:function(){return g(Ur)||(Ur=!Vr()&&"undefined"!=typeof PointerEvent&&(!g(Er.pointerEnabled)||Er.pointerEnabled)),Ur},supportsImageRenderingPixelated:Hr,supportsWebP:Wr,imageRenderingValue:function(){return Hr()?Fr:void 0},typedArrayTypes:Xr};function Yr(e,t,n,r){this.x=_(e,0),this.y=_(t,0),this.z=_(n,0),this.w=_(r,0)}$r.supportsBasis=function(e){return $r.supportsWebAssembly()&&e.context.supportsBasis},$r.supportsFullscreen=function(){return br.supportsFullscreen()},$r.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},$r.supportsBigInt64Array=function(){return"undefined"!=typeof BigInt64Array},$r.supportsBigUint64Array=function(){return"undefined"!=typeof BigUint64Array},$r.supportsBigInt=function(){return"undefined"!=typeof BigInt},$r.supportsWebWorkers=function(){return"undefined"!=typeof Worker},$r.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly},$r.supportsWebgl2=function(e){return j.defined("scene",e),e.context.webgl2},$r.supportsEsmWebWorkers=function(){return!Vr()||parseInt(Pr)>=114};let Zr=new Q;Yr.fromAxisAngle=function(e,t,n){j.typeOf.object("axis",e),j.typeOf.number("angle",t);const r=t/2,o=Math.sin(r);Zr=Q.normalize(e,Zr);const i=Zr.x*o,s=Zr.y*o,a=Zr.z*o,u=Math.cos(r);return g(n)?(n.x=i,n.y=s,n.z=a,n.w=u,n):new Yr(i,s,a,u)};const Qr=[1,2,0],Kr=new Array(3);Yr.fromRotationMatrix=function(e,t){let n,r,o,i,s;j.typeOf.object("matrix",e);const a=e[ie.COLUMN0ROW0],u=e[ie.COLUMN1ROW1],c=e[ie.COLUMN2ROW2],l=a+u+c;if(l>0)n=Math.sqrt(l+1),s=.5*n,n=.5/n,r=(e[ie.COLUMN1ROW2]-e[ie.COLUMN2ROW1])*n,o=(e[ie.COLUMN2ROW0]-e[ie.COLUMN0ROW2])*n,i=(e[ie.COLUMN0ROW1]-e[ie.COLUMN1ROW0])*n;else{const t=Qr;let l=0;u>a&&(l=1),c>a&&c>u&&(l=2);const f=t[l],p=t[f];n=Math.sqrt(e[ie.getElementIndex(l,l)]-e[ie.getElementIndex(f,f)]-e[ie.getElementIndex(p,p)]+1);const h=Kr;h[l]=.5*n,n=.5/n,s=(e[ie.getElementIndex(p,f)]-e[ie.getElementIndex(f,p)])*n,h[f]=(e[ie.getElementIndex(f,l)]+e[ie.getElementIndex(l,f)])*n,h[p]=(e[ie.getElementIndex(p,l)]+e[ie.getElementIndex(l,p)])*n,r=-h[0],o=-h[1],i=-h[2]}return g(t)?(t.x=r,t.y=o,t.z=i,t.w=s,t):new Yr(r,o,i,s)};const Jr=new Yr;let eo=new Yr,to=new Yr,no=new Yr;Yr.fromHeadingPitchRoll=function(e,t){return j.typeOf.object("headingPitchRoll",e),no=Yr.fromAxisAngle(Q.UNIT_X,e.roll,Jr),to=Yr.fromAxisAngle(Q.UNIT_Y,-e.pitch,t),t=Yr.multiply(to,no,to),eo=Yr.fromAxisAngle(Q.UNIT_Z,-e.heading,Jr),Yr.multiply(eo,t,t)};const ro=new Q,oo=new Q,io=new Yr,so=new Yr,ao=new Yr;Yr.packedLength=4,Yr.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},Yr.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new Yr),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n},Yr.packedInterpolationLength=3,Yr.convertPackedArrayForInterpolation=function(e,t,n,r){Yr.unpack(e,4*n,ao),Yr.conjugate(ao,ao);for(let o=0,i=n-t+1;o<i;o++){const n=3*o;Yr.unpack(e,4*(t+o),io),Yr.multiply(io,ao,io),io.w<0&&Yr.negate(io,io),Yr.computeAxis(io,ro);const i=Yr.computeAngle(io);g(r)||(r=[]),r[n]=ro.x*i,r[n+1]=ro.y*i,r[n+2]=ro.z*i}},Yr.unpackInterpolationResult=function(e,t,n,r,o){g(o)||(o=new Yr),Q.fromArray(e,0,oo);const i=Q.magnitude(oo);return Yr.unpack(t,4*r,so),0===i?Yr.clone(Yr.IDENTITY,io):Yr.fromAxisAngle(oo,i,io),Yr.multiply(io,so,o)},Yr.clone=function(e,t){if(g(e))return g(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new Yr(e.x,e.y,e.z,e.w)},Yr.conjugate=function(e,t){return j.typeOf.object("quaternion",e),j.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},Yr.magnitudeSquared=function(e){return j.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},Yr.magnitude=function(e){return Math.sqrt(Yr.magnitudeSquared(e))},Yr.normalize=function(e,t){j.typeOf.object("result",t);const n=1/Yr.magnitude(e),r=e.x*n,o=e.y*n,i=e.z*n,s=e.w*n;return t.x=r,t.y=o,t.z=i,t.w=s,t},Yr.inverse=function(e,t){j.typeOf.object("result",t);const n=Yr.magnitudeSquared(e);return t=Yr.conjugate(e,t),Yr.multiplyByScalar(t,1/n,t)},Yr.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},Yr.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},Yr.negate=function(e,t){return j.typeOf.object("quaternion",e),j.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},Yr.dot=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},Yr.multiply=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=e.w,a=t.x,u=t.y,c=t.z,l=t.w,f=s*a+r*l+o*c-i*u,p=s*u-r*c+o*l+i*a,h=s*c+r*u-o*a+i*l,d=s*l-r*a-o*u-i*c;return n.x=f,n.y=p,n.z=h,n.w=d,n},Yr.multiplyByScalar=function(e,t,n){return j.typeOf.object("quaternion",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},Yr.divideByScalar=function(e,t,n){return j.typeOf.object("quaternion",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},Yr.computeAxis=function(e,t){j.typeOf.object("quaternion",e),j.typeOf.object("result",t);const n=e.w;if(Math.abs(n-1)<F.EPSILON6||Math.abs(n+1)<F.EPSILON6)return t.x=1,t.y=t.z=0,t;const r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t},Yr.computeAngle=function(e){return j.typeOf.object("quaternion",e),Math.abs(e.w-1)<F.EPSILON6?0:2*Math.acos(e.w)};let uo=new Yr;Yr.lerp=function(e,t,n,r){return j.typeOf.object("start",e),j.typeOf.object("end",t),j.typeOf.number("t",n),j.typeOf.object("result",r),uo=Yr.multiplyByScalar(t,n,uo),r=Yr.multiplyByScalar(e,1-n,r),Yr.add(uo,r,r)};let co=new Yr,lo=new Yr,fo=new Yr;Yr.slerp=function(e,t,n,r){j.typeOf.object("start",e),j.typeOf.object("end",t),j.typeOf.number("t",n),j.typeOf.object("result",r);let o=Yr.dot(e,t),i=t;if(o<0&&(o=-o,i=co=Yr.negate(t,co)),1-o<F.EPSILON6)return Yr.lerp(e,i,n,r);const s=Math.acos(o);return lo=Yr.multiplyByScalar(e,Math.sin((1-n)*s),lo),fo=Yr.multiplyByScalar(i,Math.sin(n*s),fo),r=Yr.add(lo,fo,r),Yr.multiplyByScalar(r,1/Math.sin(s),r)},Yr.log=function(e,t){j.typeOf.object("quaternion",e),j.typeOf.object("result",t);const n=F.acosClamped(e.w);let r=0;return 0!==n&&(r=n/Math.sin(n)),Q.multiplyByScalar(e,r,t)},Yr.exp=function(e,t){j.typeOf.object("cartesian",e),j.typeOf.object("result",t);const n=Q.magnitude(e);let r=0;return 0!==n&&(r=Math.sin(n)/n),t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t.w=Math.cos(n),t};const po=new Q,ho=new Q,mo=new Yr,yo=new Yr;Yr.computeInnerQuadrangle=function(e,t,n,r){j.typeOf.object("q0",e),j.typeOf.object("q1",t),j.typeOf.object("q2",n),j.typeOf.object("result",r);const o=Yr.conjugate(t,mo);Yr.multiply(o,n,yo);const i=Yr.log(yo,po);Yr.multiply(o,e,yo);const s=Yr.log(yo,ho);return Q.add(i,s,i),Q.multiplyByScalar(i,.25,i),Q.negate(i,i),Yr.exp(i,mo),Yr.multiply(t,mo,r)},Yr.squad=function(e,t,n,r,o,i){j.typeOf.object("q0",e),j.typeOf.object("q1",t),j.typeOf.object("s0",n),j.typeOf.object("s1",r),j.typeOf.number("t",o),j.typeOf.object("result",i);const s=Yr.slerp(e,t,o,mo),a=Yr.slerp(n,r,o,yo);return Yr.slerp(s,a,2*o*(1-o),i)};const _o=new Yr,go=1.9011074535173003,bo=$r.supportsTypedArrays()?new Float32Array(8):[],Eo=$r.supportsTypedArrays()?new Float32Array(8):[],Oo=$r.supportsTypedArrays()?new Float32Array(8):[],wo=$r.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){const t=e+1,n=2*t+1;bo[e]=1/(t*n),Eo[e]=t/n}bo[7]=go/136,Eo[7]=8*go/17,Yr.fastSlerp=function(e,t,n,r){j.typeOf.object("start",e),j.typeOf.object("end",t),j.typeOf.number("t",n),j.typeOf.object("result",r);let o,i=Yr.dot(e,t);i>=0?o=1:(o=-1,i=-i);const s=i-1,a=1-n,u=n*n,c=a*a;for(let e=7;e>=0;--e)Oo[e]=(bo[e]*u-Eo[e])*s,wo[e]=(bo[e]*c-Eo[e])*s;const l=o*n*(1+Oo[0]*(1+Oo[1]*(1+Oo[2]*(1+Oo[3]*(1+Oo[4]*(1+Oo[5]*(1+Oo[6]*(1+Oo[7])))))))),f=a*(1+wo[0]*(1+wo[1]*(1+wo[2]*(1+wo[3]*(1+wo[4]*(1+wo[5]*(1+wo[6]*(1+wo[7])))))))),p=Yr.multiplyByScalar(e,f,_o);return Yr.multiplyByScalar(t,l,r),Yr.add(p,r,r)},Yr.fastSquad=function(e,t,n,r,o,i){j.typeOf.object("q0",e),j.typeOf.object("q1",t),j.typeOf.object("s0",n),j.typeOf.object("s1",r),j.typeOf.number("t",o),j.typeOf.object("result",i);const s=Yr.fastSlerp(e,t,o,mo),a=Yr.fastSlerp(n,r,o,yo);return Yr.fastSlerp(s,a,2*o*(1-o),i)},Yr.equals=function(e,t){return e===t||g(e)&&g(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},Yr.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n},Yr.ZERO=Object.freeze(new Yr(0,0,0,0)),Yr.IDENTITY=Object.freeze(new Yr(0,0,0,1)),Yr.prototype.clone=function(e){return Yr.clone(this,e)},Yr.prototype.equals=function(e){return Yr.equals(this,e)},Yr.prototype.equalsEpsilon=function(e,t){return Yr.equalsEpsilon(this,e,t)},Yr.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const vo={},To={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},xo={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Ro={},Ao={east:new Q,north:new Q,up:new Q,west:new Q,south:new Q,down:new Q};let So=new Q,Io=new Q,No=new Q;vo.localFrameToFixedFrameGenerator=function(e,t){if(!To.hasOwnProperty(e)||!To[e].hasOwnProperty(t))throw new b("firstAxis and secondAxis must be east, north, up, west, south or down.");const n=To[e][t];let r;const o=e+t;return g(Ro[o])?r=Ro[o]:(r=function(r,o,i){if(!g(r))throw new b("origin is required.");if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z))throw new b("origin has a NaN component");if(g(i)||(i=new Se),Q.equalsEpsilon(r,Q.ZERO,F.EPSILON14))Q.unpack(xo[e],0,So),Q.unpack(xo[t],0,Io),Q.unpack(xo[n],0,No);else if(F.equalsEpsilon(r.x,0,F.EPSILON14)&&F.equalsEpsilon(r.y,0,F.EPSILON14)){const o=F.sign(r.z);Q.unpack(xo[e],0,So),"east"!==e&&"west"!==e&&Q.multiplyByScalar(So,o,So),Q.unpack(xo[t],0,Io),"east"!==t&&"west"!==t&&Q.multiplyByScalar(Io,o,Io),Q.unpack(xo[n],0,No),"east"!==n&&"west"!==n&&Q.multiplyByScalar(No,o,No)}else{(o=_(o,it.default)).geodeticSurfaceNormal(r,Ao.up);const i=Ao.up,s=Ao.east;s.x=-r.y,s.y=r.x,s.z=0,Q.normalize(s,Ao.east),Q.cross(i,s,Ao.north),Q.multiplyByScalar(Ao.up,-1,Ao.down),Q.multiplyByScalar(Ao.east,-1,Ao.west),Q.multiplyByScalar(Ao.north,-1,Ao.south),So=Ao[e],Io=Ao[t],No=Ao[n]}return i[0]=So.x,i[1]=So.y,i[2]=So.z,i[3]=0,i[4]=Io.x,i[5]=Io.y,i[6]=Io.z,i[7]=0,i[8]=No.x,i[9]=No.y,i[10]=No.z,i[11]=0,i[12]=r.x,i[13]=r.y,i[14]=r.z,i[15]=1,i},Ro[o]=r),r},vo.eastNorthUpToFixedFrame=vo.localFrameToFixedFrameGenerator("east","north"),vo.northEastDownToFixedFrame=vo.localFrameToFixedFrameGenerator("north","east"),vo.northUpEastToFixedFrame=vo.localFrameToFixedFrameGenerator("north","up"),vo.northWestUpToFixedFrame=vo.localFrameToFixedFrameGenerator("north","west");const Co=new Yr,Po=new Q(1,1,1),Mo=new Se;vo.headingPitchRollToFixedFrame=function(e,t,n,r,o){j.typeOf.object("HeadingPitchRoll",t),r=_(r,vo.eastNorthUpToFixedFrame);const i=Yr.fromHeadingPitchRoll(t,Co),s=Se.fromTranslationQuaternionRotationScale(Q.ZERO,i,Po,Mo);return o=r(e,n,o),Se.multiply(o,s,o)};const jo=new Se,Uo=new ie;vo.headingPitchRollQuaternion=function(e,t,n,r,o){j.typeOf.object("HeadingPitchRoll",t);const i=vo.headingPitchRollToFixedFrame(e,t,n,r,jo),s=Se.getMatrix3(i,Uo);return Yr.fromRotationMatrix(s,o)};const Fo=new Q(1,1,1),qo=new Q,Lo=new Se,Do=new Se,Bo=new ie,zo=new Yr;vo.fixedFrameToHeadingPitchRoll=function(e,t,n,r){j.defined("transform",e),t=_(t,it.default),n=_(n,vo.eastNorthUpToFixedFrame),g(r)||(r=new nr);const o=Se.getTranslation(e,qo);if(Q.equals(o,Q.ZERO))return r.heading=0,r.pitch=0,r.roll=0,r;let i=Se.inverseTransformation(n(o,t,Lo),Lo),s=Se.setScale(e,Fo,Do);s=Se.setTranslation(s,Q.ZERO,s),i=Se.multiply(i,s,i);let a=Yr.fromRotationMatrix(Se.getMatrix3(i,Bo),zo);return a=Yr.normalize(a,a),nr.fromQuaternion(a,r)};const ko=F.TWO_PI/86400;let Go=new Vt;vo.computeIcrfToCentralBodyFixedMatrix=function(e,t){let n=vo.computeIcrfToFixedMatrix(e,t);return g(n)||(n=vo.computeTemeToPseudoFixedMatrix(e,t)),n},vo.computeTemeToPseudoFixedMatrix=function(e,t){if(!g(e))throw new b("date is required.");Go=Vt.addSeconds(e,-Vt.computeTaiMinusUtc(e),Go);const n=Go.dayNumber,r=Go.secondsOfDay;let o;const i=n-2451545;o=r>=43200?(i+.5)/Tt.DAYS_PER_JULIAN_CENTURY:(i-.5)/Tt.DAYS_PER_JULIAN_CENTURY;const s=(24110.54841+o*(8640184.812866+o*(.093104+-62e-7*o)))*ko%F.TWO_PI+(72921158553e-15+11772758384668e-32*(n-2451545.5))*((r+.5*Tt.SECONDS_PER_DAY)%Tt.SECONDS_PER_DAY),a=Math.cos(s),u=Math.sin(s);return g(t)?(t[0]=a,t[1]=-u,t[2]=0,t[3]=u,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new ie(a,u,0,-u,a,0,0,0,1)},vo.iau2006XysData=new hr,vo.earthOrientationParameters=Zn.NONE;const Vo=32.184;vo.preloadIcrfFixed=function(e){const t=e.start.dayNumber,n=e.start.secondsOfDay+Vo,r=e.stop.dayNumber,o=e.stop.secondsOfDay+Vo;return vo.iau2006XysData.preload(t,n,r,o)},vo.computeIcrfToFixedMatrix=function(e,t){if(!g(e))throw new b("date is required.");g(t)||(t=new ie);const n=vo.computeFixedToIcrfMatrix(e,t);if(g(n))return ie.transpose(n,t)};const Ho=new nr,Wo=new ie,Xo=new Vt;vo.computeMoonFixedToIcrfMatrix=function(e,t){if(!g(e))throw new b("date is required.");const n=Vt.addSeconds(e,32.184,Xo),r=Vt.totalDays(n)-2451545,o=F.toRadians(12.112)-F.toRadians(.052992)*r,i=F.toRadians(24.224)-F.toRadians(.105984)*r,s=F.toRadians(227.645)+F.toRadians(13.012)*r,a=F.toRadians(261.105)+F.toRadians(13.340716)*r,u=F.toRadians(358)+F.toRadians(.9856)*r;return Ho.pitch=F.toRadians(180)-F.toRadians(3.878)*Math.sin(o)-F.toRadians(.12)*Math.sin(i)+F.toRadians(.07)*Math.sin(s)-F.toRadians(.017)*Math.sin(a),Ho.roll=F.toRadians(-23.47)+F.toRadians(1.543)*Math.cos(o)+F.toRadians(.24)*Math.cos(i)-F.toRadians(.028)*Math.cos(s)+F.toRadians(.007)*Math.cos(a),Ho.heading=F.toRadians(154.375)+F.toRadians(13.17635831)*r+F.toRadians(3.558)*Math.sin(o)+F.toRadians(.121)*Math.sin(i)-F.toRadians(.064)*Math.sin(s)+F.toRadians(.016)*Math.sin(a)+F.toRadians(.025)*Math.sin(u),ie.fromHeadingPitchRoll(Ho,Wo)},vo.computeIcrfToMoonFixedMatrix=function(e,t){if(!g(e))throw new b("date is required.");g(t)||(t=new ie);const n=vo.computeMoonFixedToIcrfMatrix(e,t);if(g(n))return ie.transpose(n,t)};const $o=new pr(0,0,0),Yo=new bt(0,0,0,0,0),Zo=new ie,Qo=new ie;vo.computeFixedToIcrfMatrix=function(e,t){if(!g(e))throw new b("date is required.");g(t)||(t=new ie);const n=vo.earthOrientationParameters.compute(e,Yo);if(!g(n))return;const r=e.dayNumber,o=e.secondsOfDay+Vo,i=vo.iau2006XysData.computeXysRadians(r,o,$o);if(!g(i))return;const s=i.x+n.xPoleOffset,a=i.y+n.yPoleOffset,u=1/(1+Math.sqrt(1-s*s-a*a)),c=Zo;c[0]=1-u*s*s,c[3]=-u*s*a,c[6]=s,c[1]=-u*s*a,c[4]=1-u*a*a,c[7]=a,c[2]=-s,c[5]=-a,c[8]=1-u*(s*s+a*a);const l=ie.fromRotationZ(-i.s,Qo),f=ie.multiply(c,l,Zo),p=e.dayNumber-2451545,h=(e.secondsOfDay-Vt.computeTaiMinusUtc(e)+n.ut1MinusUtc)/Tt.SECONDS_PER_DAY;let d=.779057273264+h+.00273781191135448*(p+h);d=d%1*F.TWO_PI;const m=ie.fromRotationZ(d,Qo),y=ie.multiply(f,m,Zo),_=Math.cos(n.xPoleWander),E=Math.cos(n.yPoleWander),O=Math.sin(n.xPoleWander),w=Math.sin(n.yPoleWander);let v=r-2451545+o/Tt.SECONDS_PER_DAY;v/=36525;const T=-47e-6*v*F.RADIANS_PER_DEGREE/3600,x=Math.cos(T),R=Math.sin(T),A=Qo;return A[0]=_*x,A[1]=_*R,A[2]=O,A[3]=-E*R+w*O*x,A[4]=E*x+w*O*R,A[5]=-w*_,A[6]=-w*R-E*O*x,A[7]=w*x-E*O*R,A[8]=E*_,ie.multiply(y,A,t)};const Ko=new be;vo.pointToWindowCoordinates=function(e,t,n,r){return(r=vo.pointToGLWindowCoordinates(e,t,n,r)).y=2*t[5]-r.y,r},vo.pointToGLWindowCoordinates=function(e,t,n,r){if(!g(e))throw new b("modelViewProjectionMatrix is required.");if(!g(t))throw new b("viewportTransformation is required.");if(!g(n))throw new b("point is required.");g(r)||(r=new He);const o=Ko;return Se.multiplyByVector(e,be.fromElements(n.x,n.y,n.z,1,o),o),be.multiplyByScalar(o,1/o.w,o),Se.multiplyByVector(t,o,o),He.fromCartesian4(o,r)};const Jo=new Q,ei=new Q,ti=new Q;vo.rotationMatrixFromPositionVelocity=function(e,t,n,r){if(!g(e))throw new b("position is required.");if(!g(t))throw new b("velocity is required.");const o=_(n,it.default).geodeticSurfaceNormal(e,Jo);let i=Q.cross(t,o,ei);Q.equalsEpsilon(i,Q.ZERO,F.EPSILON6)&&(i=Q.clone(Q.UNIT_X,i));const s=Q.cross(i,t,ti);return Q.normalize(s,s),Q.cross(t,s,i),Q.negate(i,i),Q.normalize(i,i),g(r)||(r=new ie),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=i.x,r[4]=i.y,r[5]=i.z,r[6]=s.x,r[7]=s.y,r[8]=s.z,r};const ni=new Se(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),ri=new et,oi=new Q,ii=new Q,si=new ie,ai=new Se,ui=new Se;function ci(e,t,n,r){this.west=_(e,0),this.south=_(t,0),this.east=_(n,0),this.north=_(r,0)}vo.basisTo2D=function(e,t,n){if(!g(e))throw new b("projection is required.");if(!g(t))throw new b("matrix is required.");if(!g(n))throw new b("result is required.");const r=Se.getTranslation(t,ii),o=e.ellipsoid;let i;if(Q.equals(r,Q.ZERO))i=Q.clone(Q.ZERO,oi);else{const t=o.cartesianToCartographic(r,ri);i=e.project(t,oi),Q.fromElements(i.z,i.x,i.y,i)}const s=vo.eastNorthUpToFixedFrame(r,o,ai),a=Se.inverseTransformation(s,ui),u=Se.getMatrix3(t,si),c=Se.multiplyByMatrix3(a,u,n);return Se.multiply(ni,c,n),Se.setTranslation(n,i,n),n},vo.ellipsoidTo2DModelMatrix=function(e,t,n){if(!g(e))throw new b("projection is required.");if(!g(t))throw new b("center is required.");if(!g(n))throw new b("result is required.");const r=e.ellipsoid,o=vo.eastNorthUpToFixedFrame(t,r,ai),i=Se.inverseTransformation(o,ui),s=r.cartesianToCartographic(t,ri),a=e.project(s,oi);Q.fromElements(a.z,a.x,a.y,a);const u=Se.fromTranslation(a,ai);return Se.multiply(ni,i,n),Se.multiply(u,n,n),n},Object.defineProperties(ci.prototype,{width:{get:function(){return ci.computeWidth(this)}},height:{get:function(){return ci.computeHeight(this)}}}),ci.packedLength=4,ci.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t},ci.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new ci),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n},ci.computeWidth=function(e){j.typeOf.object("rectangle",e);let t=e.east;const n=e.west;return t<n&&(t+=F.TWO_PI),t-n},ci.computeHeight=function(e){return j.typeOf.object("rectangle",e),e.north-e.south},ci.fromDegrees=function(e,t,n,r,o){return e=F.toRadians(_(e,0)),t=F.toRadians(_(t,0)),n=F.toRadians(_(n,0)),r=F.toRadians(_(r,0)),g(o)?(o.west=e,o.south=t,o.east=n,o.north=r,o):new ci(e,t,n,r)},ci.fromRadians=function(e,t,n,r,o){return g(o)?(o.west=_(e,0),o.south=_(t,0),o.east=_(n,0),o.north=_(r,0),o):new ci(e,t,n,r)},ci.fromCartographicArray=function(e,t){j.defined("cartographics",e);let n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE;for(let t=0,u=e.length;t<u;t++){const u=e[t];n=Math.min(n,u.longitude),r=Math.max(r,u.longitude),s=Math.min(s,u.latitude),a=Math.max(a,u.latitude);const c=u.longitude>=0?u.longitude:u.longitude+F.TWO_PI;o=Math.min(o,c),i=Math.max(i,c)}return r-n>i-o&&(n=o,r=i,r>F.PI&&(r-=F.TWO_PI),n>F.PI&&(n-=F.TWO_PI)),g(t)?(t.west=n,t.south=s,t.east=r,t.north=a,t):new ci(n,s,r,a)},ci.fromCartesianArray=function(e,t,n){j.defined("cartesians",e),t=_(t,it.default);let r=Number.MAX_VALUE,o=-Number.MAX_VALUE,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let n=0,c=e.length;n<c;n++){const c=t.cartesianToCartographic(e[n]);r=Math.min(r,c.longitude),o=Math.max(o,c.longitude),a=Math.min(a,c.latitude),u=Math.max(u,c.latitude);const l=c.longitude>=0?c.longitude:c.longitude+F.TWO_PI;i=Math.min(i,l),s=Math.max(s,l)}return o-r>s-i&&(r=i,o=s,o>F.PI&&(o-=F.TWO_PI),r>F.PI&&(r-=F.TWO_PI)),g(n)?(n.west=r,n.south=a,n.east=o,n.north=u,n):new ci(r,a,o,u)};const li=new Q,fi=new Q,pi=new Q,hi=new Q,di=new Q,mi=new Array(5);for(let e=0;e<mi.length;++e)mi[e]=new Q;ci.fromBoundingSphere=function(e,t,n){j.typeOf.object("boundingSphere",e);const r=e.center,o=e.radius;if(g(t)||(t=it.default),g(n)||(n=new ci),Q.equals(r,Q.ZERO))return ci.clone(ci.MAX_VALUE,n),n;const i=vo.eastNorthUpToFixedFrame(r,t,li),s=Se.multiplyByPointAsVector(i,Q.UNIT_X,fi);Q.normalize(s,s);const a=Se.multiplyByPointAsVector(i,Q.UNIT_Y,pi);Q.normalize(a,a),Q.multiplyByScalar(a,o,a),Q.multiplyByScalar(s,o,s);const u=Q.negate(a,di),c=Q.negate(s,hi),l=mi;let f=l[0];return Q.add(r,a,f),f=l[1],Q.add(r,c,f),f=l[2],Q.add(r,u,f),f=l[3],Q.add(r,s,f),l[4]=r,ci.fromCartesianArray(l,t,n)},ci.clone=function(e,t){if(g(e))return g(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new ci(e.west,e.south,e.east,e.north)},ci.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n},ci.prototype.clone=function(e){return ci.clone(this,e)},ci.prototype.equals=function(e){return ci.equals(this,e)},ci.equals=function(e,t){return e===t||g(e)&&g(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},ci.prototype.equalsEpsilon=function(e,t){return ci.equalsEpsilon(this,e,t)},ci._validate=function(e){j.typeOf.object("rectangle",e);const t=e.north;j.typeOf.number.greaterThanOrEquals("north",t,-F.PI_OVER_TWO),j.typeOf.number.lessThanOrEquals("north",t,F.PI_OVER_TWO);const n=e.south;j.typeOf.number.greaterThanOrEquals("south",n,-F.PI_OVER_TWO),j.typeOf.number.lessThanOrEquals("south",n,F.PI_OVER_TWO);const r=e.west;j.typeOf.number.greaterThanOrEquals("west",r,-Math.PI),j.typeOf.number.lessThanOrEquals("west",r,Math.PI);const o=e.east;j.typeOf.number.greaterThanOrEquals("east",o,-Math.PI),j.typeOf.number.lessThanOrEquals("east",o,Math.PI)},ci.southwest=function(e,t){return j.typeOf.object("rectangle",e),g(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new et(e.west,e.south)},ci.northwest=function(e,t){return j.typeOf.object("rectangle",e),g(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new et(e.west,e.north)},ci.northeast=function(e,t){return j.typeOf.object("rectangle",e),g(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new et(e.east,e.north)},ci.southeast=function(e,t){return j.typeOf.object("rectangle",e),g(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new et(e.east,e.south)},ci.center=function(e,t){j.typeOf.object("rectangle",e);let n=e.east;const r=e.west;n<r&&(n+=F.TWO_PI);const o=F.negativePiToPi(.5*(r+n)),i=.5*(e.south+e.north);return g(t)?(t.longitude=o,t.latitude=i,t.height=0,t):new et(o,i)},ci.intersection=function(e,t,n){j.typeOf.object("rectangle",e),j.typeOf.object("otherRectangle",t);let r=e.east,o=e.west,i=t.east,s=t.west;r<o&&i>0?r+=F.TWO_PI:i<s&&r>0&&(i+=F.TWO_PI),r<o&&s<0?s+=F.TWO_PI:i<s&&o<0&&(o+=F.TWO_PI);const a=F.negativePiToPi(Math.max(o,s)),u=F.negativePiToPi(Math.min(r,i));if((e.west<e.east||t.west<t.east)&&u<=a)return;const c=Math.max(e.south,t.south),l=Math.min(e.north,t.north);return c>=l?void 0:g(n)?(n.west=a,n.south=c,n.east=u,n.north=l,n):new ci(a,c,u,l)},ci.simpleIntersection=function(e,t,n){j.typeOf.object("rectangle",e),j.typeOf.object("otherRectangle",t);const r=Math.max(e.west,t.west),o=Math.max(e.south,t.south),i=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(o>=s||r>=i))return g(n)?(n.west=r,n.south=o,n.east=i,n.north=s,n):new ci(r,o,i,s)},ci.union=function(e,t,n){j.typeOf.object("rectangle",e),j.typeOf.object("otherRectangle",t),g(n)||(n=new ci);let r=e.east,o=e.west,i=t.east,s=t.west;r<o&&i>0?r+=F.TWO_PI:i<s&&r>0&&(i+=F.TWO_PI),r<o&&s<0?s+=F.TWO_PI:i<s&&o<0&&(o+=F.TWO_PI);const a=F.negativePiToPi(Math.min(o,s)),u=F.negativePiToPi(Math.max(r,i));return n.west=a,n.south=Math.min(e.south,t.south),n.east=u,n.north=Math.max(e.north,t.north),n},ci.expand=function(e,t,n){return j.typeOf.object("rectangle",e),j.typeOf.object("cartographic",t),g(n)||(n=new ci),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n},ci.contains=function(e,t){j.typeOf.object("rectangle",e),j.typeOf.object("cartographic",t);let n=t.longitude;const r=t.latitude,o=e.west;let i=e.east;return i<o&&(i+=F.TWO_PI,n<0&&(n+=F.TWO_PI)),(n>o||F.equalsEpsilon(n,o,F.EPSILON14))&&(n<i||F.equalsEpsilon(n,i,F.EPSILON14))&&r>=e.south&&r<=e.north};const yi=new et;function _i(e,t){this.center=Q.clone(_(e,Q.ZERO)),this.radius=_(t,0)}ci.subsample=function(e,t,n,r){j.typeOf.object("rectangle",e),t=_(t,it.default),n=_(n,0),g(r)||(r=[]);let o=0;const i=e.north,s=e.south,a=e.east,u=e.west,c=yi;c.height=n,c.longitude=u,c.latitude=i,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=s,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=i<0?i:s>0?s:0;for(let n=1;n<8;++n)c.longitude=-Math.PI+n*F.PI_OVER_TWO,ci.contains(e,c)&&(r[o]=t.cartographicToCartesian(c,r[o]),o++);return 0===c.latitude&&(c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++),r.length=o,r},ci.subsection=function(e,t,n,r,o,i){if(j.typeOf.object("rectangle",e),j.typeOf.number.greaterThanOrEquals("westLerp",t,0),j.typeOf.number.lessThanOrEquals("westLerp",t,1),j.typeOf.number.greaterThanOrEquals("southLerp",n,0),j.typeOf.number.lessThanOrEquals("southLerp",n,1),j.typeOf.number.greaterThanOrEquals("eastLerp",r,0),j.typeOf.number.lessThanOrEquals("eastLerp",r,1),j.typeOf.number.greaterThanOrEquals("northLerp",o,0),j.typeOf.number.lessThanOrEquals("northLerp",o,1),j.typeOf.number.lessThanOrEquals("westLerp",t,r),j.typeOf.number.lessThanOrEquals("southLerp",n,o),g(i)||(i=new ci),e.west<=e.east){const n=e.east-e.west;i.west=e.west+t*n,i.east=e.west+r*n}else{const n=F.TWO_PI+e.east-e.west;i.west=F.negativePiToPi(e.west+t*n),i.east=F.negativePiToPi(e.west+r*n)}const s=e.north-e.south;return i.south=e.south+n*s,i.north=e.south+o*s,1===t&&(i.west=e.east),1===r&&(i.east=e.east),1===n&&(i.south=e.north),1===o&&(i.north=e.north),i},ci.MAX_VALUE=Object.freeze(new ci(-Math.PI,-F.PI_OVER_TWO,Math.PI,F.PI_OVER_TWO));const gi=new Q,bi=new Q,Ei=new Q,Oi=new Q,wi=new Q,vi=new Q,Ti=new Q,xi=new Q,Ri=new Q,Ai=new Q,Si=new Q,Ii=new Q,Ni=4/3*F.PI;_i.fromPoints=function(e,t){if(g(t)||(t=new _i),!g(e)||0===e.length)return t.center=Q.clone(Q.ZERO,t.center),t.radius=0,t;const n=Q.clone(e[0],Ti),r=Q.clone(n,gi),o=Q.clone(n,bi),i=Q.clone(n,Ei),s=Q.clone(n,Oi),a=Q.clone(n,wi),u=Q.clone(n,vi),c=e.length;let l;for(l=1;l<c;l++){Q.clone(e[l],n);const t=n.x,c=n.y,f=n.z;t<r.x&&Q.clone(n,r),t>s.x&&Q.clone(n,s),c<o.y&&Q.clone(n,o),c>a.y&&Q.clone(n,a),f<i.z&&Q.clone(n,i),f>u.z&&Q.clone(n,u)}const f=Q.magnitudeSquared(Q.subtract(s,r,xi)),p=Q.magnitudeSquared(Q.subtract(a,o,xi)),h=Q.magnitudeSquared(Q.subtract(u,i,xi));let d=r,m=s,y=f;p>y&&(y=p,d=o,m=a),h>y&&(y=h,d=i,m=u);const _=Ri;_.x=.5*(d.x+m.x),_.y=.5*(d.y+m.y),_.z=.5*(d.z+m.z);let b=Q.magnitudeSquared(Q.subtract(m,_,xi)),E=Math.sqrt(b);const O=Ai;O.x=r.x,O.y=o.y,O.z=i.z;const w=Si;w.x=s.x,w.y=a.y,w.z=u.z;const v=Q.midpoint(O,w,Ii);let T=0;for(l=0;l<c;l++){Q.clone(e[l],n);const t=Q.magnitude(Q.subtract(n,v,xi));t>T&&(T=t);const r=Q.magnitudeSquared(Q.subtract(n,_,xi));if(r>b){const e=Math.sqrt(r);E=.5*(E+e),b=E*E;const t=e-E;_.x=(E*_.x+t*n.x)/e,_.y=(E*_.y+t*n.y)/e,_.z=(E*_.z+t*n.z)/e}}return E<T?(Q.clone(_,t.center),t.radius=E):(Q.clone(v,t.center),t.radius=T),t};const Ci=new mt,Pi=new Q,Mi=new Q,ji=new et,Ui=new et;_i.fromRectangle2D=function(e,t,n){return _i.fromRectangleWithHeights2D(e,t,0,0,n)},_i.fromRectangleWithHeights2D=function(e,t,n,r,o){if(g(o)||(o=new _i),!g(e))return o.center=Q.clone(Q.ZERO,o.center),o.radius=0,o;Ci._ellipsoid=it.default,t=_(t,Ci),ci.southwest(e,ji),ji.height=n,ci.northeast(e,Ui),Ui.height=r;const i=t.project(ji,Pi),s=t.project(Ui,Mi),a=s.x-i.x,u=s.y-i.y,c=s.z-i.z;o.radius=.5*Math.sqrt(a*a+u*u+c*c);const l=o.center;return l.x=i.x+.5*a,l.y=i.y+.5*u,l.z=i.z+.5*c,o};const Fi=[];_i.fromRectangle3D=function(e,t,n,r){if(t=_(t,it.default),n=_(n,0),g(r)||(r=new _i),!g(e))return r.center=Q.clone(Q.ZERO,r.center),r.radius=0,r;const o=ci.subsample(e,t,n,Fi);return _i.fromPoints(o,r)},_i.fromVertices=function(e,t,n,r){if(g(r)||(r=new _i),!g(e)||0===e.length)return r.center=Q.clone(Q.ZERO,r.center),r.radius=0,r;t=_(t,Q.ZERO),n=_(n,3),j.typeOf.number.greaterThanOrEquals("stride",n,3);const o=Ti;o.x=e[0]+t.x,o.y=e[1]+t.y,o.z=e[2]+t.z;const i=Q.clone(o,gi),s=Q.clone(o,bi),a=Q.clone(o,Ei),u=Q.clone(o,Oi),c=Q.clone(o,wi),l=Q.clone(o,vi),f=e.length;let p;for(p=0;p<f;p+=n){const n=e[p]+t.x,r=e[p+1]+t.y,f=e[p+2]+t.z;o.x=n,o.y=r,o.z=f,n<i.x&&Q.clone(o,i),n>u.x&&Q.clone(o,u),r<s.y&&Q.clone(o,s),r>c.y&&Q.clone(o,c),f<a.z&&Q.clone(o,a),f>l.z&&Q.clone(o,l)}const h=Q.magnitudeSquared(Q.subtract(u,i,xi)),d=Q.magnitudeSquared(Q.subtract(c,s,xi)),m=Q.magnitudeSquared(Q.subtract(l,a,xi));let y=i,b=u,E=h;d>E&&(E=d,y=s,b=c),m>E&&(E=m,y=a,b=l);const O=Ri;O.x=.5*(y.x+b.x),O.y=.5*(y.y+b.y),O.z=.5*(y.z+b.z);let w=Q.magnitudeSquared(Q.subtract(b,O,xi)),v=Math.sqrt(w);const T=Ai;T.x=i.x,T.y=s.y,T.z=a.z;const x=Si;x.x=u.x,x.y=c.y,x.z=l.z;const R=Q.midpoint(T,x,Ii);let A=0;for(p=0;p<f;p+=n){o.x=e[p]+t.x,o.y=e[p+1]+t.y,o.z=e[p+2]+t.z;const n=Q.magnitude(Q.subtract(o,R,xi));n>A&&(A=n);const r=Q.magnitudeSquared(Q.subtract(o,O,xi));if(r>w){const e=Math.sqrt(r);v=.5*(v+e),w=v*v;const t=e-v;O.x=(v*O.x+t*o.x)/e,O.y=(v*O.y+t*o.y)/e,O.z=(v*O.z+t*o.z)/e}}return v<A?(Q.clone(O,r.center),r.radius=v):(Q.clone(R,r.center),r.radius=A),r},_i.fromEncodedCartesianVertices=function(e,t,n){if(g(n)||(n=new _i),!g(e)||!g(t)||e.length!==t.length||0===e.length)return n.center=Q.clone(Q.ZERO,n.center),n.radius=0,n;const r=Ti;r.x=e[0]+t[0],r.y=e[1]+t[1],r.z=e[2]+t[2];const o=Q.clone(r,gi),i=Q.clone(r,bi),s=Q.clone(r,Ei),a=Q.clone(r,Oi),u=Q.clone(r,wi),c=Q.clone(r,vi),l=e.length;let f;for(f=0;f<l;f+=3){const n=e[f]+t[f],l=e[f+1]+t[f+1],p=e[f+2]+t[f+2];r.x=n,r.y=l,r.z=p,n<o.x&&Q.clone(r,o),n>a.x&&Q.clone(r,a),l<i.y&&Q.clone(r,i),l>u.y&&Q.clone(r,u),p<s.z&&Q.clone(r,s),p>c.z&&Q.clone(r,c)}const p=Q.magnitudeSquared(Q.subtract(a,o,xi)),h=Q.magnitudeSquared(Q.subtract(u,i,xi)),d=Q.magnitudeSquared(Q.subtract(c,s,xi));let m=o,y=a,_=p;h>_&&(_=h,m=i,y=u),d>_&&(_=d,m=s,y=c);const b=Ri;b.x=.5*(m.x+y.x),b.y=.5*(m.y+y.y),b.z=.5*(m.z+y.z);let E=Q.magnitudeSquared(Q.subtract(y,b,xi)),O=Math.sqrt(E);const w=Ai;w.x=o.x,w.y=i.y,w.z=s.z;const v=Si;v.x=a.x,v.y=u.y,v.z=c.z;const T=Q.midpoint(w,v,Ii);let x=0;for(f=0;f<l;f+=3){r.x=e[f]+t[f],r.y=e[f+1]+t[f+1],r.z=e[f+2]+t[f+2];const n=Q.magnitude(Q.subtract(r,T,xi));n>x&&(x=n);const o=Q.magnitudeSquared(Q.subtract(r,b,xi));if(o>E){const e=Math.sqrt(o);O=.5*(O+e),E=O*O;const t=e-O;b.x=(O*b.x+t*r.x)/e,b.y=(O*b.y+t*r.y)/e,b.z=(O*b.z+t*r.z)/e}}return O<x?(Q.clone(b,n.center),n.radius=O):(Q.clone(T,n.center),n.radius=x),n},_i.fromCornerPoints=function(e,t,n){j.typeOf.object("corner",e),j.typeOf.object("oppositeCorner",t),g(n)||(n=new _i);const r=Q.midpoint(e,t,n.center);return n.radius=Q.distance(r,t),n},_i.fromEllipsoid=function(e,t){return j.typeOf.object("ellipsoid",e),g(t)||(t=new _i),Q.clone(Q.ZERO,t.center),t.radius=e.maximumRadius,t};const qi=new Q;_i.fromBoundingSpheres=function(e,t){if(g(t)||(t=new _i),!g(e)||0===e.length)return t.center=Q.clone(Q.ZERO,t.center),t.radius=0,t;const n=e.length;if(1===n)return _i.clone(e[0],t);if(2===n)return _i.union(e[0],e[1],t);const r=[];let o;for(o=0;o<n;o++)r.push(e[o].center);const i=(t=_i.fromPoints(r,t)).center;let s=t.radius;for(o=0;o<n;o++){const t=e[o];s=Math.max(s,Q.distance(i,t.center,qi)+t.radius)}return t.radius=s,t};const Li=new Q,Di=new Q,Bi=new Q;_i.fromOrientedBoundingBox=function(e,t){j.defined("orientedBoundingBox",e),g(t)||(t=new _i);const n=e.halfAxes,r=ie.getColumn(n,0,Li),o=ie.getColumn(n,1,Di),i=ie.getColumn(n,2,Bi);return Q.add(r,o,r),Q.add(r,i,r),t.center=Q.clone(e.center,t.center),t.radius=Q.magnitude(r),t};const zi=new Q,ki=new Q;_i.fromTransformation=function(e,t){j.typeOf.object("transformation",e),g(t)||(t=new _i);const n=Se.getTranslation(e,zi),r=Se.getScale(e,ki),o=.5*Q.magnitude(r);return t.center=Q.clone(n,t.center),t.radius=o,t},_i.clone=function(e,t){if(g(e))return g(t)?(t.center=Q.clone(e.center,t.center),t.radius=e.radius,t):new _i(e.center,e.radius)},_i.packedLength=4,_i.pack=function(e,t,n){j.typeOf.object("value",e),j.defined("array",t),n=_(n,0);const r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t},_i.unpack=function(e,t,n){j.defined("array",e),t=_(t,0),g(n)||(n=new _i);const r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};const Gi=new Q,Vi=new Q;_i.union=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),g(n)||(n=new _i);const r=e.center,o=e.radius,i=t.center,s=t.radius,a=Q.subtract(i,r,Gi),u=Q.magnitude(a);if(o>=u+s)return e.clone(n),n;if(s>=u+o)return t.clone(n),n;const c=.5*(o+u+s),l=Q.multiplyByScalar(a,(-o+c)/u,Vi);return Q.add(l,r,l),Q.clone(l,n.center),n.radius=c,n};const Hi=new Q;_i.expand=function(e,t,n){j.typeOf.object("sphere",e),j.typeOf.object("point",t),n=_i.clone(e,n);const r=Q.magnitude(Q.subtract(t,n.center,Hi));return r>n.radius&&(n.radius=r),n},_i.intersectPlane=function(e,t){j.typeOf.object("sphere",e),j.typeOf.object("plane",t);const n=e.center,r=e.radius,o=t.normal,i=Q.dot(o,n)+t.distance;return i<-r?yt.OUTSIDE:i<r?yt.INTERSECTING:yt.INSIDE},_i.transform=function(e,t,n){return j.typeOf.object("sphere",e),j.typeOf.object("transform",t),g(n)||(n=new _i),n.center=Se.multiplyByPoint(t,e.center,n.center),n.radius=Se.getMaximumScale(t)*e.radius,n};const Wi=new Q;_i.distanceSquaredTo=function(e,t){j.typeOf.object("sphere",e),j.typeOf.object("cartesian",t);const n=Q.subtract(e.center,t,Wi),r=Q.magnitude(n)-e.radius;return r<=0?0:r*r},_i.transformWithoutScale=function(e,t,n){return j.typeOf.object("sphere",e),j.typeOf.object("transform",t),g(n)||(n=new _i),n.center=Se.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};const Xi=new Q;_i.computePlaneDistances=function(e,t,n,r){j.typeOf.object("sphere",e),j.typeOf.object("position",t),j.typeOf.object("direction",n),g(r)||(r=new _t);const o=Q.subtract(e.center,t,Xi),i=Q.dot(n,o);return r.start=i-e.radius,r.stop=i+e.radius,r};const $i=new Q,Yi=new Q,Zi=new Q,Qi=new Q,Ki=new Q,Ji=new et,es=new Array(8);for(let e=0;e<8;++e)es[e]=new Q;const ts=new mt;function ns(e,t,n){this.minimum=Q.clone(_(e,Q.ZERO)),this.maximum=Q.clone(_(t,Q.ZERO)),n=g(n)?Q.clone(n):Q.midpoint(this.minimum,this.maximum,new Q),this.center=n}_i.projectTo2D=function(e,t,n){j.typeOf.object("sphere",e),ts._ellipsoid=it.default;const r=(t=_(t,ts)).ellipsoid;let o=e.center;const i=e.radius;let s;s=Q.equals(o,Q.ZERO)?Q.clone(Q.UNIT_X,$i):r.geodeticSurfaceNormal(o,$i);const a=Q.cross(Q.UNIT_Z,s,Yi);Q.normalize(a,a);const u=Q.cross(s,a,Zi);Q.normalize(u,u),Q.multiplyByScalar(s,i,s),Q.multiplyByScalar(u,i,u),Q.multiplyByScalar(a,i,a);const c=Q.negate(u,Ki),l=Q.negate(a,Qi),f=es;let p=f[0];Q.add(s,u,p),Q.add(p,a,p),p=f[1],Q.add(s,u,p),Q.add(p,l,p),p=f[2],Q.add(s,c,p),Q.add(p,l,p),p=f[3],Q.add(s,c,p),Q.add(p,a,p),Q.negate(s,s),p=f[4],Q.add(s,u,p),Q.add(p,a,p),p=f[5],Q.add(s,u,p),Q.add(p,l,p),p=f[6],Q.add(s,c,p),Q.add(p,l,p),p=f[7],Q.add(s,c,p),Q.add(p,a,p);const h=f.length;for(let e=0;e<h;++e){const n=f[e];Q.add(o,n,n);const i=r.cartesianToCartographic(n,Ji);t.project(i,n)}o=(n=_i.fromPoints(f,n)).center;const d=o.x,m=o.y,y=o.z;return o.x=y,o.y=d,o.z=m,n},_i.isOccluded=function(e,t){return j.typeOf.object("sphere",e),j.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},_i.equals=function(e,t){return e===t||g(e)&&g(t)&&Q.equals(e.center,t.center)&&e.radius===t.radius},_i.prototype.intersectPlane=function(e){return _i.intersectPlane(this,e)},_i.prototype.distanceSquaredTo=function(e){return _i.distanceSquaredTo(this,e)},_i.prototype.computePlaneDistances=function(e,t,n){return _i.computePlaneDistances(this,e,t,n)},_i.prototype.isOccluded=function(e){return _i.isOccluded(this,e)},_i.prototype.equals=function(e){return _i.equals(this,e)},_i.prototype.clone=function(e){return _i.clone(this,e)},_i.prototype.volume=function(){const e=this.radius;return Ni*e*e*e},ns.fromCorners=function(e,t,n){return j.defined("minimum",e),j.defined("maximum",t),g(n)||(n=new ns),n.minimum=Q.clone(e,n.minimum),n.maximum=Q.clone(t,n.maximum),n.center=Q.midpoint(e,t,n.center),n},ns.fromPoints=function(e,t){if(g(t)||(t=new ns),!g(e)||0===e.length)return t.minimum=Q.clone(Q.ZERO,t.minimum),t.maximum=Q.clone(Q.ZERO,t.maximum),t.center=Q.clone(Q.ZERO,t.center),t;let n=e[0].x,r=e[0].y,o=e[0].z,i=e[0].x,s=e[0].y,a=e[0].z;const u=e.length;for(let t=1;t<u;t++){const u=e[t],c=u.x,l=u.y,f=u.z;n=Math.min(c,n),i=Math.max(c,i),r=Math.min(l,r),s=Math.max(l,s),o=Math.min(f,o),a=Math.max(f,a)}const c=t.minimum;c.x=n,c.y=r,c.z=o;const l=t.maximum;return l.x=i,l.y=s,l.z=a,t.center=Q.midpoint(c,l,t.center),t},ns.clone=function(e,t){if(g(e))return g(t)?(t.minimum=Q.clone(e.minimum,t.minimum),t.maximum=Q.clone(e.maximum,t.maximum),t.center=Q.clone(e.center,t.center),t):new ns(e.minimum,e.maximum,e.center)},ns.equals=function(e,t){return e===t||g(e)&&g(t)&&Q.equals(e.center,t.center)&&Q.equals(e.minimum,t.minimum)&&Q.equals(e.maximum,t.maximum)};let rs=new Q;ns.intersectPlane=function(e,t){j.defined("box",e),j.defined("plane",t),rs=Q.subtract(e.maximum,e.minimum,rs);const n=Q.multiplyByScalar(rs,.5,rs),r=t.normal,o=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),i=Q.dot(e.center,r)+t.distance;return i-o>0?yt.INSIDE:i+o<0?yt.OUTSIDE:yt.INTERSECTING},ns.prototype.clone=function(e){return ns.clone(this,e)},ns.prototype.intersectPlane=function(e){return ns.intersectPlane(this,e)},ns.prototype.equals=function(e){return ns.equals(this,e)};const os={};function is(e,t,n){const r=e+t;return F.sign(e)!==F.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}os.computeDiscriminant=function(e,t,n){if("number"!=typeof e)throw new b("a is a required number.");if("number"!=typeof t)throw new b("b is a required number.");if("number"!=typeof n)throw new b("c is a required number.");return t*t-4*e*n},os.computeRealRoots=function(e,t,n){if("number"!=typeof e)throw new b("a is a required number.");if("number"!=typeof t)throw new b("b is a required number.");if("number"!=typeof n)throw new b("c is a required number.");let r;if(0===e)return 0===t?[]:[-n/t];if(0===t){if(0===n)return[0,0];const t=Math.abs(n),o=Math.abs(e);if(t<o&&t/o<F.EPSILON14)return[0,0];if(t>o&&o/t<F.EPSILON14)return[];if(r=-n/e,r<0)return[];const i=Math.sqrt(r);return[-i,i]}if(0===n)return r=-t/e,r<0?[r,0]:[0,r];const o=is(t*t,-(4*e*n),F.EPSILON14);if(o<0)return[];const i=-.5*is(t,F.sign(t)*Math.sqrt(o),F.EPSILON14);return t>0?[i/e,n/i]:[n/i,i/e]};const ss={};function as(e,t,n,r){const o=e,i=t/3,s=n/3,a=r,u=o*s,c=i*a,l=i*i,f=s*s,p=o*s-l,h=o*a-i*s,d=i*a-f,m=4*p*d-h*h;let y,_;if(m<0){let e,t,n;l*c>=u*f?(e=o,t=p,n=-2*i*p+o*h):(e=a,t=d,n=-a*h+2*s*d);const r=-(n<0?-1:1)*Math.abs(e)*Math.sqrt(-m);_=-n+r;const g=_/2,b=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),E=_===r?-b:-t/b;return y=t<=0?b+E:-n/(b*b+E*E+t),l*c>=u*f?[(y-i)/o]:[-a/(y+s)]}const g=p,b=-2*i*p+o*h,E=d,O=-a*h+2*s*d,w=Math.sqrt(m),v=Math.sqrt(3)/2;let T=Math.abs(Math.atan2(o*w,-b)/3);y=2*Math.sqrt(-g);let x=Math.cos(T);_=y*x;let R=y*(-x/2-v*Math.sin(T));const A=_+R>2*i?_-i:R-i,S=o,I=A/S;T=Math.abs(Math.atan2(a*w,-O)/3),y=2*Math.sqrt(-E),x=Math.cos(T),_=y*x,R=y*(-x/2-v*Math.sin(T));const N=-a,C=_+R<2*s?_+s:R+s,P=N/C,M=-A*C-S*N,j=(s*M-i*(A*N))/(-i*M+s*(S*C));return I<=j?I<=P?j<=P?[I,j,P]:[I,P,j]:[P,I,j]:I<=P?[j,I,P]:j<=P?[j,P,I]:[P,j,I]}ss.computeDiscriminant=function(e,t,n,r){if("number"!=typeof e)throw new b("a is a required number.");if("number"!=typeof t)throw new b("b is a required number.");if("number"!=typeof n)throw new b("c is a required number.");if("number"!=typeof r)throw new b("d is a required number.");const o=t*t,i=n*n;return 18*e*t*n*r+o*i-27*(e*e)*(r*r)-4*(e*i*n+o*t*r)},ss.computeRealRoots=function(e,t,n,r){if("number"!=typeof e)throw new b("a is a required number.");if("number"!=typeof t)throw new b("b is a required number.");if("number"!=typeof n)throw new b("c is a required number.");if("number"!=typeof r)throw new b("d is a required number.");let o,i;if(0===e)return os.computeRealRoots(t,n,r);if(0===t){if(0===n){if(0===r)return[0,0,0];i=-r/e;const t=i<0?-Math.pow(-i,1/3):Math.pow(i,1/3);return[t,t,t]}return 0===r?(o=os.computeRealRoots(e,0,n),0===o.Length?[0]:[o[0],0,o[1]]):as(e,0,n,r)}return 0===n?0===r?(i=-t/e,i<0?[i,0,0]:[0,0,i]):as(e,t,0,r):0===r?(o=os.computeRealRoots(e,t,n),0===o.length?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]):as(e,t,n,r)};const us={};function cs(e,t,n,r){const o=e*e,i=t-3*o/8,s=n-t*e/2+o*e/8,a=r-n*e/4+t*o/16-3*o*o/256,u=ss.computeRealRoots(1,2*i,i*i-4*a,-s*s);if(u.length>0){const t=-e/4,n=u[u.length-1];if(Math.abs(n)<F.EPSILON14){const e=os.computeRealRoots(1,i,a);if(2===e.length){const n=e[0],r=e[1];let o;if(n>=0&&r>=0){const e=Math.sqrt(n),o=Math.sqrt(r);return[t-o,t-e,t+e,t+o]}if(n>=0&&r<0)return o=Math.sqrt(n),[t-o,t+o];if(n<0&&r>=0)return o=Math.sqrt(r),[t-o,t+o]}return[]}if(n>0){const e=Math.sqrt(n),r=(i+n-s/e)/2,o=(i+n+s/e)/2,a=os.computeRealRoots(1,e,r),u=os.computeRealRoots(1,-e,o);return 0!==a.length?(a[0]+=t,a[1]+=t,0!==u.length?(u[0]+=t,u[1]+=t,a[1]<=u[0]?[a[0],a[1],u[0],u[1]]:u[1]<=a[0]?[u[0],u[1],a[0],a[1]]:a[0]>=u[0]&&a[1]<=u[1]?[u[0],a[0],a[1],u[1]]:u[0]>=a[0]&&u[1]<=a[1]?[a[0],u[0],u[1],a[1]]:a[0]>u[0]&&a[0]<u[1]?[u[0],a[0],u[1],a[1]]:[a[0],u[0],a[1],u[1]]):a):0!==u.length?(u[0]+=t,u[1]+=t,u):[]}}return[]}function ls(e,t,n,r){const o=e*e,i=-2*t,s=n*e+t*t-4*r,a=o*r-n*t*e+n*n,u=ss.computeRealRoots(1,i,s,a);if(u.length>0){const i=u[0],s=t-i,a=s*s,c=e/2,l=s/2,f=a-4*r,p=a+4*Math.abs(r),h=o-4*i,d=o+4*Math.abs(i);let m,y,_,g,b,E;if(i<0||f*d<h*p){const t=Math.sqrt(h);m=t/2,y=0===t?0:(e*l-n)/t}else{const t=Math.sqrt(f);m=0===t?0:(e*l-n)/t,y=t/2}0===c&&0===m?(_=0,g=0):F.sign(c)===F.sign(m)?(_=c+m,g=i/_):(g=c-m,_=i/g),0===l&&0===y?(b=0,E=0):F.sign(l)===F.sign(y)?(b=l+y,E=r/b):(E=l-y,b=r/E);const O=os.computeRealRoots(1,_,b),w=os.computeRealRoots(1,g,E);if(0!==O.length)return 0!==w.length?O[1]<=w[0]?[O[0],O[1],w[0],w[1]]:w[1]<=O[0]?[w[0],w[1],O[0],O[1]]:O[0]>=w[0]&&O[1]<=w[1]?[w[0],O[0],O[1],w[1]]:w[0]>=O[0]&&w[1]<=O[1]?[O[0],w[0],w[1],O[1]]:O[0]>w[0]&&O[0]<w[1]?[w[0],O[0],w[1],O[1]]:[O[0],w[0],O[1],w[1]]:O;if(0!==w.length)return w}return[]}function fs(e,t){t=Q.clone(_(t,Q.ZERO)),Q.equals(t,Q.ZERO)||Q.normalize(t,t),this.origin=Q.clone(_(e,Q.ZERO)),this.direction=t}us.computeDiscriminant=function(e,t,n,r,o){if("number"!=typeof e)throw new b("a is a required number.");if("number"!=typeof t)throw new b("b is a required number.");if("number"!=typeof n)throw new b("c is a required number.");if("number"!=typeof r)throw new b("d is a required number.");if("number"!=typeof o)throw new b("e is a required number.");const i=e*e,s=t*t,a=s*t,u=n*n,c=u*n,l=r*r,f=l*r,p=o*o;return s*u*l-4*a*f-4*e*c*l+18*e*t*n*f-27*i*l*l+256*(i*e)*(p*o)+o*(18*a*n*r-4*s*c+16*e*u*u-80*e*t*u*r-6*e*s*l+144*i*n*l)+p*(144*e*s*n-27*s*s-128*i*u-192*i*t*r)},us.computeRealRoots=function(e,t,n,r,o){if("number"!=typeof e)throw new b("a is a required number.");if("number"!=typeof t)throw new b("b is a required number.");if("number"!=typeof n)throw new b("c is a required number.");if("number"!=typeof r)throw new b("d is a required number.");if("number"!=typeof o)throw new b("e is a required number.");if(Math.abs(e)<F.EPSILON15)return ss.computeRealRoots(t,n,r,o);const i=t/e,s=n/e,a=r/e,u=o/e;let c=i<0?1:0;switch(c+=s<0?c+1:c,c+=a<0?c+1:c,c+=u<0?c+1:c,c){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return cs(i,s,a,u);case 1:case 2:case 5:case 8:case 11:return ls(i,s,a,u);default:return}},fs.clone=function(e,t){if(g(e))return g(t)?(t.origin=Q.clone(e.origin),t.direction=Q.clone(e.direction),t):new fs(e.origin,e.direction)},fs.getPoint=function(e,t,n){return j.typeOf.object("ray",e),j.typeOf.number("t",t),g(n)||(n=new Q),n=Q.multiplyByScalar(e.direction,t,n),Q.add(e.origin,n,n)};const ps={rayPlane:function(e,t,n){if(!g(e))throw new b("ray is required.");if(!g(t))throw new b("plane is required.");g(n)||(n=new Q);const r=e.origin,o=e.direction,i=t.normal,s=Q.dot(i,o);if(Math.abs(s)<F.EPSILON15)return;const a=(-t.distance-Q.dot(i,r))/s;return a<0?void 0:(n=Q.multiplyByScalar(o,a,n),Q.add(r,n,n))}},hs=new Q,ds=new Q,ms=new Q,ys=new Q,_s=new Q;ps.rayTriangleParametric=function(e,t,n,r,o){if(!g(e))throw new b("ray is required.");if(!g(t))throw new b("p0 is required.");if(!g(n))throw new b("p1 is required.");if(!g(r))throw new b("p2 is required.");o=_(o,!1);const i=e.origin,s=e.direction,a=Q.subtract(n,t,hs),u=Q.subtract(r,t,ds),c=Q.cross(s,u,ms),l=Q.dot(a,c);let f,p,h,d,m;if(o){if(l<F.EPSILON6)return;if(f=Q.subtract(i,t,ys),h=Q.dot(f,c),h<0||h>l)return;if(p=Q.cross(f,a,_s),d=Q.dot(s,p),d<0||h+d>l)return;m=Q.dot(u,p)/l}else{if(Math.abs(l)<F.EPSILON6)return;const e=1/l;if(f=Q.subtract(i,t,ys),h=Q.dot(f,c)*e,h<0||h>1)return;if(p=Q.cross(f,a,_s),d=Q.dot(s,p)*e,d<0||h+d>1)return;m=Q.dot(u,p)*e}return m},ps.rayTriangle=function(e,t,n,r,o,i){const s=ps.rayTriangleParametric(e,t,n,r,o);if(g(s)&&!(s<0))return g(i)||(i=new Q),Q.multiplyByScalar(e.direction,s,i),Q.add(e.origin,i,i)};const gs=new fs;ps.lineSegmentTriangle=function(e,t,n,r,o,i,s){if(!g(e))throw new b("v0 is required.");if(!g(t))throw new b("v1 is required.");if(!g(n))throw new b("p0 is required.");if(!g(r))throw new b("p1 is required.");if(!g(o))throw new b("p2 is required.");const a=gs;Q.clone(e,a.origin),Q.subtract(t,e,a.direction),Q.normalize(a.direction,a.direction);const u=ps.rayTriangleParametric(a,n,r,o,i);if(!(!g(u)||u<0||u>Q.distance(e,t)))return g(s)||(s=new Q),Q.multiplyByScalar(a.direction,u,s),Q.add(a.origin,s,s)};const bs={root0:0,root1:0};function Es(e,t,n){g(n)||(n=new _t);const r=e.origin,o=e.direction,i=t.center,s=t.radius*t.radius,a=Q.subtract(r,i,ms),u=function(e,t,n,r){const o=t*t-4*e*n;if(o<0)return;if(o>0){const n=1/(2*e),i=Math.sqrt(o),s=(-t+i)*n,a=(-t-i)*n;return s<a?(r.root0=s,r.root1=a):(r.root0=a,r.root1=s),r}const i=-t/(2*e);return 0!==i?(r.root0=r.root1=i,r):void 0}(Q.dot(o,o),2*Q.dot(o,a),Q.magnitudeSquared(a)-s,bs);if(g(u))return n.start=u.root0,n.stop=u.root1,n}ps.raySphere=function(e,t,n){if(!g(e))throw new b("ray is required.");if(!g(t))throw new b("sphere is required.");if(g(n=Es(e,t,n))&&!(n.stop<0))return n.start=Math.max(n.start,0),n};const Os=new fs;ps.lineSegmentSphere=function(e,t,n,r){if(!g(e))throw new b("p0 is required.");if(!g(t))throw new b("p1 is required.");if(!g(n))throw new b("sphere is required.");const o=Os;Q.clone(e,o.origin);const i=Q.subtract(t,e,o.direction),s=Q.magnitude(i);if(Q.normalize(i,i),!(!g(r=Es(o,n,r))||r.stop<0||r.start>s))return r.start=Math.max(r.start,0),r.stop=Math.min(r.stop,s),r};const ws=new Q,vs=new Q;function Ts(e,t,n){const r=e+t;return F.sign(e)!==F.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}ps.rayEllipsoid=function(e,t){if(!g(e))throw new b("ray is required.");if(!g(t))throw new b("ellipsoid is required.");const n=t.oneOverRadii,r=Q.multiplyComponents(n,e.origin,ws),o=Q.multiplyComponents(n,e.direction,vs),i=Q.magnitudeSquared(r),s=Q.dot(r,o);let a,u,c,l,f;if(i>1){if(s>=0)return;const e=s*s;if(a=i-1,u=Q.magnitudeSquared(o),c=u*a,e<c)return;if(e>c){l=s*s-c,f=-s+Math.sqrt(l);const e=f/u,t=a/f;return e<t?new _t(e,t):{start:t,stop:e}}const t=Math.sqrt(a/u);return new _t(t,t)}return i<1?(a=i-1,u=Q.magnitudeSquared(o),c=u*a,l=s*s-c,f=-s+Math.sqrt(l),new _t(0,f/u)):s<0?(u=Q.magnitudeSquared(o),new _t(0,-s/u)):void 0},ps.quadraticVectorExpression=function(e,t,n,r,o){const i=r*r,s=o*o,a=(e[ie.COLUMN1ROW1]-e[ie.COLUMN2ROW2])*s,u=o*(r*Ts(e[ie.COLUMN1ROW0],e[ie.COLUMN0ROW1],F.EPSILON15)+t.y),c=e[ie.COLUMN0ROW0]*i+e[ie.COLUMN2ROW2]*s+r*t.x+n,l=s*Ts(e[ie.COLUMN2ROW1],e[ie.COLUMN1ROW2],F.EPSILON15),f=o*(r*Ts(e[ie.COLUMN2ROW0],e[ie.COLUMN0ROW2])+t.z);let p;const h=[];if(0===f&&0===l){if(p=os.computeRealRoots(a,u,c),0===p.length)return h;const e=p[0],t=Math.sqrt(Math.max(1-e*e,0));if(h.push(new Q(r,o*e,o*-t)),h.push(new Q(r,o*e,o*t)),2===p.length){const e=p[1],t=Math.sqrt(Math.max(1-e*e,0));h.push(new Q(r,o*e,o*-t)),h.push(new Q(r,o*e,o*t))}return h}const d=f*f,m=l*l,y=f*l,_=a*a+m,g=2*(u*a+y),b=2*c*a+u*u-m+d,E=2*(c*u-y),O=c*c-d;if(0===_&&0===g&&0===b&&0===E)return h;p=us.computeRealRoots(_,g,b,E,O);const w=p.length;if(0===w)return h;for(let e=0;e<w;++e){const t=p[e],n=t*t,i=Math.max(1-n,0),s=Math.sqrt(i);let d;d=F.sign(a)===F.sign(c)?Ts(a*n+c,u*t,F.EPSILON12):F.sign(c)===F.sign(u*t)?Ts(a*n,u*t+c,F.EPSILON12):Ts(a*n+u*t,c,F.EPSILON12);const m=d*Ts(l*t,f,F.EPSILON15);m<0?h.push(new Q(r,o*t,o*s)):m>0?h.push(new Q(r,o*t,o*-s)):0!==s?(h.push(new Q(r,o*t,o*-s)),h.push(new Q(r,o*t,o*s)),++e):h.push(new Q(r,o*t,o*s))}return h};const xs=new Q,Rs=new Q,As=new Q,Ss=new Q,Is=new Q,Ns=new ie,Cs=new ie,Ps=new ie,Ms=new ie,js=new ie,Us=new ie,Fs=new ie,qs=new Q,Ls=new Q,Ds=new et;ps.grazingAltitudeLocation=function(e,t){if(!g(e))throw new b("ray is required.");if(!g(t))throw new b("ellipsoid is required.");const n=e.origin,r=e.direction;if(!Q.equals(n,Q.ZERO)){const e=t.geodeticSurfaceNormal(n,xs);if(Q.dot(r,e)>=0)return n}const o=g(this.rayEllipsoid(e,t)),i=t.transformPositionToScaledSpace(r,xs),s=Q.normalize(i,i),a=Q.mostOrthogonalAxis(i,Ss),u=Q.normalize(Q.cross(a,s,Rs),Rs),c=Q.normalize(Q.cross(s,u,As),As),l=Ns;l[0]=s.x,l[1]=s.y,l[2]=s.z,l[3]=u.x,l[4]=u.y,l[5]=u.z,l[6]=c.x,l[7]=c.y,l[8]=c.z;const f=ie.transpose(l,Cs),p=ie.fromScale(t.radii,Ps),h=ie.fromScale(t.oneOverRadii,Ms),d=js;d[0]=0,d[1]=-r.z,d[2]=r.y,d[3]=r.z,d[4]=0,d[5]=-r.x,d[6]=-r.y,d[7]=r.x,d[8]=0;const m=ie.multiply(ie.multiply(f,h,Us),d,Us),y=ie.multiply(ie.multiply(m,p,Fs),l,Fs),_=ie.multiplyByVector(m,n,Is),E=ps.quadraticVectorExpression(y,Q.negate(_,xs),0,0,1);let O,w;const v=E.length;if(v>0){let e=Q.clone(Q.ZERO,Ls),i=Number.NEGATIVE_INFINITY;for(let t=0;t<v;++t){O=ie.multiplyByVector(p,ie.multiplyByVector(l,E[t],qs),qs);const o=Q.normalize(Q.subtract(O,n,Ss),Ss),s=Q.dot(o,r);s>i&&(i=s,e=Q.clone(O,e))}const s=t.cartesianToCartographic(e,Ds);return i=F.clamp(i,0,1),w=Q.magnitude(Q.subtract(e,n,Ss))*Math.sqrt(1-i*i),w=o?-w:w,s.height=w,t.cartographicToCartesian(s,new Q)}};const Bs=new Q;function zs(e,t){if(j.typeOf.object("normal",e),!F.equalsEpsilon(Q.magnitude(e),1,F.EPSILON6))throw new b("normal must be normalized.");j.typeOf.number("distance",t),this.normal=Q.clone(e),this.distance=t}ps.lineSegmentPlane=function(e,t,n,r){if(!g(e))throw new b("endPoint0 is required.");if(!g(t))throw new b("endPoint1 is required.");if(!g(n))throw new b("plane is required.");g(r)||(r=new Q);const o=Q.subtract(t,e,Bs),i=n.normal,s=Q.dot(i,o);if(Math.abs(s)<F.EPSILON6)return;const a=Q.dot(i,e),u=-(n.distance+a)/s;return u<0||u>1?void 0:(Q.multiplyByScalar(o,u,r),Q.add(e,r,r),r)},ps.trianglePlaneIntersection=function(e,t,n,r){if(!(g(e)&&g(t)&&g(n)&&g(r)))throw new b("p0, p1, p2, and plane are required.");const o=r.normal,i=r.distance,s=Q.dot(o,e)+i<0,a=Q.dot(o,t)+i<0,u=Q.dot(o,n)+i<0;let c,l,f=0;if(f+=s?1:0,f+=a?1:0,f+=u?1:0,1!==f&&2!==f||(c=new Q,l=new Q),1===f){if(s)return ps.lineSegmentPlane(e,t,r,c),ps.lineSegmentPlane(e,n,r,l),{positions:[e,t,n,c,l],indices:[0,3,4,1,2,4,1,4,3]};if(a)return ps.lineSegmentPlane(t,n,r,c),ps.lineSegmentPlane(t,e,r,l),{positions:[e,t,n,c,l],indices:[1,3,4,2,0,4,2,4,3]};if(u)return ps.lineSegmentPlane(n,e,r,c),ps.lineSegmentPlane(n,t,r,l),{positions:[e,t,n,c,l],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===f){if(!s)return ps.lineSegmentPlane(t,e,r,c),ps.lineSegmentPlane(n,e,r,l),{positions:[e,t,n,c,l],indices:[1,2,4,1,4,3,0,3,4]};if(!a)return ps.lineSegmentPlane(n,t,r,c),ps.lineSegmentPlane(e,t,r,l),{positions:[e,t,n,c,l],indices:[2,0,4,2,4,3,1,3,4]};if(!u)return ps.lineSegmentPlane(e,n,r,c),ps.lineSegmentPlane(t,n,r,l),{positions:[e,t,n,c,l],indices:[0,1,4,0,4,3,2,3,4]}}},zs.fromPointNormal=function(e,t,n){if(j.typeOf.object("point",e),j.typeOf.object("normal",t),!F.equalsEpsilon(Q.magnitude(t),1,F.EPSILON6))throw new b("normal must be normalized.");const r=-Q.dot(t,e);return g(n)?(Q.clone(t,n.normal),n.distance=r,n):new zs(t,r)};const ks=new Q;zs.fromCartesian4=function(e,t){j.typeOf.object("coefficients",e);const n=Q.fromCartesian4(e,ks),r=e.w;if(!F.equalsEpsilon(Q.magnitude(n),1,F.EPSILON6))throw new b("normal must be normalized.");return g(t)?(Q.clone(n,t.normal),t.distance=r,t):new zs(n,r)},zs.getPointDistance=function(e,t){return j.typeOf.object("plane",e),j.typeOf.object("point",t),Q.dot(e.normal,t)+e.distance};const Gs=new Q;zs.projectPointOntoPlane=function(e,t,n){j.typeOf.object("plane",e),j.typeOf.object("point",t),g(n)||(n=new Q);const r=zs.getPointDistance(e,t),o=Q.multiplyByScalar(e.normal,r,Gs);return Q.subtract(t,o,n)};const Vs=new Se,Hs=new be,Ws=new Q;zs.transform=function(e,t,n){j.typeOf.object("plane",e),j.typeOf.object("transform",t);const r=e.normal,o=e.distance,i=Se.inverseTranspose(t,Vs);let s=be.fromElements(r.x,r.y,r.z,o,Hs);s=Se.multiplyByVector(i,s,s);const a=Q.fromCartesian4(s,Ws);return s=be.divideByScalar(s,Q.magnitude(a),s),zs.fromCartesian4(s,n)},zs.clone=function(e,t){return j.typeOf.object("plane",e),g(t)?(Q.clone(e.normal,t.normal),t.distance=e.distance,t):new zs(e.normal,e.distance)},zs.equals=function(e,t){return j.typeOf.object("left",e),j.typeOf.object("right",t),e.distance===t.distance&&Q.equals(e.normal,t.normal)},zs.ORIGIN_XY_PLANE=Object.freeze(new zs(Q.UNIT_Z,0)),zs.ORIGIN_YZ_PLANE=Object.freeze(new zs(Q.UNIT_X,0)),zs.ORIGIN_ZX_PLANE=Object.freeze(new zs(Q.UNIT_Y,0));const Xs=new be;function $s(e,t){if(j.defined("origin",e),!g(e=(t=_(t,it.default)).scaleToGeodeticSurface(e)))throw new b("origin must not be at the center of the ellipsoid.");const n=vo.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=Q.fromCartesian4(Se.getColumn(n,0,Xs)),this._yAxis=Q.fromCartesian4(Se.getColumn(n,1,Xs));const r=Q.fromCartesian4(Se.getColumn(n,2,Xs));this._plane=zs.fromPointNormal(e,r)}Object.defineProperties($s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});const Ys=new ns;$s.fromPoints=function(e,t){j.defined("cartesians",e);return new $s(ns.fromPoints(e,Ys).center,t)};const Zs=new fs,Qs=new Q;$s.prototype.projectPointOntoPlane=function(e,t){j.defined("cartesian",e);const n=Zs;n.origin=e,Q.normalize(e,n.direction);let r=ps.rayPlane(n,this._plane,Qs);if(g(r)||(Q.negate(n.direction,n.direction),r=ps.rayPlane(n,this._plane,Qs)),g(r)){const e=Q.subtract(r,this._origin,r),n=Q.dot(this._xAxis,e),o=Q.dot(this._yAxis,e);return g(t)?(t.x=n,t.y=o,t):new He(n,o)}},$s.prototype.projectPointsOntoPlane=function(e,t){j.defined("cartesians",e),g(t)||(t=[]);let n=0;const r=e.length;for(let o=0;o<r;o++){const r=this.projectPointOntoPlane(e[o],t[n]);g(r)&&(t[n]=r,n++)}return t.length=n,t},$s.prototype.projectPointToNearestOnPlane=function(e,t){j.defined("cartesian",e),g(t)||(t=new He);const n=Zs;n.origin=e,Q.clone(this._plane.normal,n.direction);let r=ps.rayPlane(n,this._plane,Qs);g(r)||(Q.negate(n.direction,n.direction),r=ps.rayPlane(n,this._plane,Qs));const o=Q.subtract(r,this._origin,r),i=Q.dot(this._xAxis,o),s=Q.dot(this._yAxis,o);return t.x=i,t.y=s,t},$s.prototype.projectPointsToNearestOnPlane=function(e,t){j.defined("cartesians",e),g(t)||(t=[]);const n=e.length;t.length=n;for(let r=0;r<n;r++)t[r]=this.projectPointToNearestOnPlane(e[r],t[r]);return t};const Ks=new Q;function Js(e,t){this.center=Q.clone(_(e,Q.ZERO)),this.halfAxes=ie.clone(_(t,ie.ZERO))}$s.prototype.projectPointOntoEllipsoid=function(e,t){j.defined("cartesian",e),g(t)||(t=new Q);const n=this._ellipsoid,r=this._origin,o=this._xAxis,i=this._yAxis,s=Ks;return Q.multiplyByScalar(o,e.x,s),t=Q.add(r,s,t),Q.multiplyByScalar(i,e.y,s),Q.add(t,s,t),n.scaleToGeocentricSurface(t,t),t},$s.prototype.projectPointsOntoEllipsoid=function(e,t){j.defined("cartesians",e);const n=e.length;g(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.projectPointOntoEllipsoid(e[r],t[r]);return t},Js.packedLength=Q.packedLength+ie.packedLength,Js.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),Q.pack(e.center,t,n),ie.pack(e.halfAxes,t,n+Q.packedLength),t},Js.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new Js),Q.unpack(e,t,n.center),ie.unpack(e,t+Q.packedLength,n.halfAxes),n};const ea=new Q,ta=new Q,na=new Q,ra=new Q,oa=new Q,ia=new Q,sa=new ie,aa={unitary:new ie,diagonal:new ie};Js.fromPoints=function(e,t){if(g(t)||(t=new Js),!g(e)||0===e.length)return t.halfAxes=ie.ZERO,t.center=Q.ZERO,t;let n;const r=e.length,o=Q.clone(e[0],ea);for(n=1;n<r;n++)Q.add(o,e[n],o);const i=1/r;Q.multiplyByScalar(o,i,o);let s,a=0,u=0,c=0,l=0,f=0,p=0;for(n=0;n<r;n++)s=Q.subtract(e[n],o,ta),a+=s.x*s.x,u+=s.x*s.y,c+=s.x*s.z,l+=s.y*s.y,f+=s.y*s.z,p+=s.z*s.z;a*=i,u*=i,c*=i,l*=i,f*=i,p*=i;const h=sa;h[0]=a,h[1]=u,h[2]=c,h[3]=u,h[4]=l,h[5]=f,h[6]=c,h[7]=f,h[8]=p;const d=ie.computeEigenDecomposition(h,aa),m=ie.clone(d.unitary,t.halfAxes);let y=ie.getColumn(m,0,ra),_=ie.getColumn(m,1,oa),b=ie.getColumn(m,2,ia),E=-Number.MAX_VALUE,O=-Number.MAX_VALUE,w=-Number.MAX_VALUE,v=Number.MAX_VALUE,T=Number.MAX_VALUE,x=Number.MAX_VALUE;for(n=0;n<r;n++)s=e[n],E=Math.max(Q.dot(y,s),E),O=Math.max(Q.dot(_,s),O),w=Math.max(Q.dot(b,s),w),v=Math.min(Q.dot(y,s),v),T=Math.min(Q.dot(_,s),T),x=Math.min(Q.dot(b,s),x);y=Q.multiplyByScalar(y,.5*(v+E),y),_=Q.multiplyByScalar(_,.5*(T+O),_),b=Q.multiplyByScalar(b,.5*(x+w),b);const R=Q.add(y,_,t.center);Q.add(R,b,R);const A=na;return A.x=E-v,A.y=O-T,A.z=w-x,Q.multiplyByScalar(A,.5,A),ie.multiplyByScale(t.halfAxes,A,t.halfAxes),t};const ua=new Q,ca=new Q;function la(e,t,n,r,o,i,s,a,u,c,l){if(!(g(o)&&g(i)&&g(s)&&g(a)&&g(u)&&g(c)))throw new b("all extents (minimum/maximum X/Y/Z) are required.");g(l)||(l=new Js);const f=l.halfAxes;ie.setColumn(f,0,t,f),ie.setColumn(f,1,n,f),ie.setColumn(f,2,r,f);let p=ua;p.x=(o+i)/2,p.y=(s+a)/2,p.z=(u+c)/2;const h=ca;h.x=(i-o)/2,h.y=(a-s)/2,h.z=(c-u)/2;const d=l.center;return p=ie.multiplyByVector(f,p,p),Q.add(e,p,d),ie.multiplyByScale(f,h,f),l}const fa=new et,pa=new Q,ha=new et,da=new et,ma=new et,ya=new et,_a=new et,ga=new Q,ba=new Q,Ea=new Q,Oa=new Q,wa=new Q,va=new He,Ta=new He,xa=new He,Ra=new He,Aa=new He,Sa=new Q,Ia=new Q,Na=new Q,Ca=new Q,Pa=new He,Ma=new Q,ja=new Q,Ua=new Q,Fa=new zs(Q.UNIT_X,0);Js.fromRectangle=function(e,t,n,r,o){if(!g(e))throw new b("rectangle is required");if(e.width<0||e.width>F.TWO_PI)throw new b("Rectangle width must be between 0 and 2 * pi");if(e.height<0||e.height>F.PI)throw new b("Rectangle height must be between 0 and pi");if(g(r)&&!F.equalsEpsilon(r.radii.x,r.radii.y,F.EPSILON15))throw new b("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");let i,s,a,u,c,l,f;if(t=_(t,0),n=_(n,0),r=_(r,it.default),e.width<=F.PI){const p=ci.center(e,fa),h=new $s(r.cartographicToCartesian(p,pa),r);f=h.plane;const d=p.longitude,m=e.south<0&&e.north>0?0:p.latitude,y=et.fromRadians(d,e.north,n,ha),_=et.fromRadians(e.west,e.north,n,da),g=et.fromRadians(e.west,m,n,ma),b=et.fromRadians(e.west,e.south,n,ya),E=et.fromRadians(d,e.south,n,_a),O=r.cartographicToCartesian(y,ga);let w=r.cartographicToCartesian(_,ba);const v=r.cartographicToCartesian(g,Ea);let T=r.cartographicToCartesian(b,Oa);const x=r.cartographicToCartesian(E,wa),R=h.projectPointToNearestOnPlane(O,va),A=h.projectPointToNearestOnPlane(w,Ta),S=h.projectPointToNearestOnPlane(v,xa),I=h.projectPointToNearestOnPlane(T,Ra),N=h.projectPointToNearestOnPlane(x,Aa);return i=Math.min(A.x,S.x,I.x),s=-i,u=Math.max(A.y,R.y),a=Math.min(I.y,N.y),_.height=b.height=t,w=r.cartographicToCartesian(_,ba),T=r.cartographicToCartesian(b,Oa),c=Math.min(zs.getPointDistance(f,w),zs.getPointDistance(f,T)),l=n,la(h.origin,h.xAxis,h.yAxis,h.zAxis,i,s,a,u,c,l,o)}const p=e.south>0,h=e.north<0,d=p?e.south:h?e.north:0,m=ci.center(e,fa).longitude,y=Q.fromRadians(m,d,n,r,Sa);y.z=0;const E=Math.abs(y.x)<F.EPSILON10&&Math.abs(y.y)<F.EPSILON10?Q.UNIT_X:Q.normalize(y,Ia),O=Q.UNIT_Z,w=Q.cross(E,O,Na);f=zs.fromPointNormal(y,E,Fa);const v=Q.fromRadians(m+F.PI_OVER_TWO,d,n,r,Ca);s=Q.dot(zs.projectPointOntoPlane(f,v,Pa),w),i=-s,u=Q.fromRadians(0,e.north,h?t:n,r,Ma).z,a=Q.fromRadians(0,e.south,p?t:n,r,ja).z;const T=Q.fromRadians(e.east,d,n,r,Ua);return c=zs.getPointDistance(f,T),l=0,la(y,w,O,E,i,s,a,u,c,l,o)},Js.fromTransformation=function(e,t){return j.typeOf.object("transformation",e),g(t)||(t=new Js),t.center=Se.getTranslation(e,t.center),t.halfAxes=Se.getMatrix3(e,t.halfAxes),t.halfAxes=ie.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},Js.clone=function(e,t){if(g(e))return g(t)?(Q.clone(e.center,t.center),ie.clone(e.halfAxes,t.halfAxes),t):new Js(e.center,e.halfAxes)},Js.intersectPlane=function(e,t){if(!g(e))throw new b("box is required.");if(!g(t))throw new b("plane is required.");const n=e.center,r=t.normal,o=e.halfAxes,i=r.x,s=r.y,a=r.z,u=Math.abs(i*o[ie.COLUMN0ROW0]+s*o[ie.COLUMN0ROW1]+a*o[ie.COLUMN0ROW2])+Math.abs(i*o[ie.COLUMN1ROW0]+s*o[ie.COLUMN1ROW1]+a*o[ie.COLUMN1ROW2])+Math.abs(i*o[ie.COLUMN2ROW0]+s*o[ie.COLUMN2ROW1]+a*o[ie.COLUMN2ROW2]),c=Q.dot(r,n)+t.distance;return c<=-u?yt.OUTSIDE:c>=u?yt.INSIDE:yt.INTERSECTING};const qa=new Q,La=new Q,Da=new Q,Ba=new Q,za=new Q,ka=new Q;Js.distanceSquaredTo=function(e,t){if(!g(e))throw new b("box is required.");if(!g(t))throw new b("cartesian is required.");const n=Q.subtract(t,e.center,ua),r=e.halfAxes;let o=ie.getColumn(r,0,qa),i=ie.getColumn(r,1,La),s=ie.getColumn(r,2,Da);const a=Q.magnitude(o),u=Q.magnitude(i),c=Q.magnitude(s);let l=!0,f=!0,p=!0;a>0?Q.divideByScalar(o,a,o):l=!1,u>0?Q.divideByScalar(i,u,i):f=!1,c>0?Q.divideByScalar(s,c,s):p=!1;const h=!l+!f+!p;let d,m,y;if(1===h){let e=o;d=i,m=s,f?p||(e=s,m=o):(e=i,d=o),y=Q.cross(d,m,za),e===o?o=y:e===i?i=y:e===s&&(s=y)}else if(2===h){d=o,f?d=i:p&&(d=s);let e=Q.UNIT_Y;e.equalsEpsilon(d,F.EPSILON3)&&(e=Q.UNIT_X),m=Q.cross(d,e,Ba),Q.normalize(m,m),y=Q.cross(d,m,za),Q.normalize(y,y),d===o?(i=m,s=y):d===i?(s=m,o=y):d===s&&(o=m,i=y)}else 3===h&&(o=Q.UNIT_X,i=Q.UNIT_Y,s=Q.UNIT_Z);const _=ka;_.x=Q.dot(n,o),_.y=Q.dot(n,i),_.z=Q.dot(n,s);let E,O=0;return _.x<-a?(E=_.x+a,O+=E*E):_.x>a&&(E=_.x-a,O+=E*E),_.y<-u?(E=_.y+u,O+=E*E):_.y>u&&(E=_.y-u,O+=E*E),_.z<-c?(E=_.z+c,O+=E*E):_.z>c&&(E=_.z-c,O+=E*E),O};const Ga=new Q,Va=new Q;Js.computePlaneDistances=function(e,t,n,r){if(!g(e))throw new b("box is required.");if(!g(t))throw new b("position is required.");if(!g(n))throw new b("direction is required.");g(r)||(r=new _t);let o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const s=e.center,a=e.halfAxes,u=ie.getColumn(a,0,qa),c=ie.getColumn(a,1,La),l=ie.getColumn(a,2,Da),f=Q.add(u,c,Ga);Q.add(f,l,f),Q.add(f,s,f);const p=Q.subtract(f,t,Va);let h=Q.dot(n,p);return o=Math.min(h,o),i=Math.max(h,i),Q.add(s,u,f),Q.add(f,c,f),Q.subtract(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Q.add(s,u,f),Q.subtract(f,c,f),Q.add(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Q.add(s,u,f),Q.subtract(f,c,f),Q.subtract(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Q.subtract(s,u,f),Q.add(f,c,f),Q.add(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Q.subtract(s,u,f),Q.add(f,c,f),Q.subtract(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Q.subtract(s,u,f),Q.subtract(f,c,f),Q.add(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Q.subtract(s,u,f),Q.subtract(f,c,f),Q.subtract(f,l,f),Q.subtract(f,t,p),h=Q.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),r.start=o,r.stop=i,r};const Ha=new Q,Wa=new Q,Xa=new Q;Js.computeCorners=function(e,t){j.typeOf.object("box",e),g(t)||(t=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q]);const n=e.center,r=e.halfAxes,o=ie.getColumn(r,0,Ha),i=ie.getColumn(r,1,Wa),s=ie.getColumn(r,2,Xa);return Q.clone(n,t[0]),Q.subtract(t[0],o,t[0]),Q.subtract(t[0],i,t[0]),Q.subtract(t[0],s,t[0]),Q.clone(n,t[1]),Q.subtract(t[1],o,t[1]),Q.subtract(t[1],i,t[1]),Q.add(t[1],s,t[1]),Q.clone(n,t[2]),Q.subtract(t[2],o,t[2]),Q.add(t[2],i,t[2]),Q.subtract(t[2],s,t[2]),Q.clone(n,t[3]),Q.subtract(t[3],o,t[3]),Q.add(t[3],i,t[3]),Q.add(t[3],s,t[3]),Q.clone(n,t[4]),Q.add(t[4],o,t[4]),Q.subtract(t[4],i,t[4]),Q.subtract(t[4],s,t[4]),Q.clone(n,t[5]),Q.add(t[5],o,t[5]),Q.subtract(t[5],i,t[5]),Q.add(t[5],s,t[5]),Q.clone(n,t[6]),Q.add(t[6],o,t[6]),Q.add(t[6],i,t[6]),Q.subtract(t[6],s,t[6]),Q.clone(n,t[7]),Q.add(t[7],o,t[7]),Q.add(t[7],i,t[7]),Q.add(t[7],s,t[7]),t};const $a=new ie;Js.computeTransformation=function(e,t){j.typeOf.object("box",e),g(t)||(t=new Se);const n=e.center,r=ie.multiplyByUniformScale(e.halfAxes,2,$a);return Se.fromRotationTranslation(r,n,t)};const Ya=new _i;Js.isOccluded=function(e,t){if(!g(e))throw new b("box is required.");if(!g(t))throw new b("occluder is required.");const n=_i.fromOrientedBoundingBox(e,Ya);return!t.isBoundingSphereVisible(n)},Js.prototype.intersectPlane=function(e){return Js.intersectPlane(this,e)},Js.prototype.distanceSquaredTo=function(e){return Js.distanceSquaredTo(this,e)},Js.prototype.computePlaneDistances=function(e,t,n){return Js.computePlaneDistances(this,e,t,n)},Js.prototype.computeCorners=function(e){return Js.computeCorners(this,e)},Js.prototype.computeTransformation=function(e){return Js.computeTransformation(this,e)},Js.prototype.isOccluded=function(e){return Js.isOccluded(this,e)},Js.equals=function(e,t){return e===t||g(e)&&g(t)&&Q.equals(e.center,t.center)&&ie.equals(e.halfAxes,t.halfAxes)},Js.prototype.clone=function(e){return Js.clone(this,e)},Js.prototype.equals=function(e){return Js.equals(this,e)};const Za={},Qa=new Q,Ka=new Q,Ja=new Q,eu=new Q,tu=new Js;function nu(e,t,n,r,o){const i=Q.subtract(e,t,Qa),s=Q.dot(n,i),a=Q.dot(r,i);return He.fromElements(s,a,o)}function ru(e,t,n=2){const r=t&&t.length,o=r?t[0]*n:e.length;let i=ou(e,0,o,n,!0);const s=[];if(!i||i.next===i.prev)return s;let a,u,c;if(r&&(i=function(e,t,n,r){const o=[];for(let n=0,i=t.length;n<i;n++){const s=ou(e,t[n]*r,n<i-1?t[n+1]*r:e.length,r,!1);s===s.next&&(s.steiner=!0),o.push(mu(s))}o.sort(fu);for(let e=0;e<o.length;e++)n=pu(o[e],n);return n}(e,t,i,n)),e.length>80*n){a=1/0,u=1/0;let t=-1/0,r=-1/0;for(let i=n;i<o;i+=n){const n=e[i],o=e[i+1];n<a&&(a=n),o<u&&(u=o),n>t&&(t=n),o>r&&(r=o)}c=Math.max(t-a,r-u),c=0!==c?32767/c:0}return su(i,s,n,a,u,c,0),s}function ou(e,t,n,r,o){let i;if(o===function(e,t,n,r){let o=0;for(let i=t,s=n-r;i<n;i+=r)o+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return o}(e,t,n,r)>0)for(let o=t;o<n;o+=r)i=xu(o/r|0,e[o],e[o+1],i);else for(let o=n-r;o>=t;o-=r)i=xu(o/r|0,e[o],e[o+1],i);return i&&bu(i,i.next)&&(Ru(i),i=i.next),i}function iu(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!bu(r,r.next)&&0!==gu(r.prev,r,r.next))r=r.next;else{if(Ru(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function su(e,t,n,r,o,i,s){if(!e)return;!s&&i&&function(e,t,n,r){let o=e;do{0===o.z&&(o.z=du(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){let t,n=1;do{let r,o=e;e=null;let i=null;for(t=0;o;){t++;let s=o,a=0;for(let e=0;e<n&&(a++,s=s.nextZ,s);e++);let u=n;for(;a>0||u>0&&s;)0!==a&&(0===u||!s||o.z<=s.z)?(r=o,o=o.nextZ,a--):(r=s,s=s.nextZ,u--),i?i.nextZ=r:e=r,r.prevZ=i,i=r;o=s}i.nextZ=null,n*=2}while(t>1)}(o)}(e,r,o,i);let a=e;for(;e.prev!==e.next;){const u=e.prev,c=e.next;if(i?uu(e,r,o,i):au(e))t.push(u.i,e.i,c.i),Ru(e),e=c.next,a=c.next;else if((e=c)===a){s?1===s?su(e=cu(iu(e),t),t,n,r,o,i,2):2===s&&lu(e,t,n,r,o,i):su(iu(e),t,n,r,o,i,1);break}}}function au(e){const t=e.prev,n=e,r=e.next;if(gu(t,n,r)>=0)return!1;const o=t.x,i=n.x,s=r.x,a=t.y,u=n.y,c=r.y,l=o<i?o<s?o:s:i<s?i:s,f=a<u?a<c?a:c:u<c?u:c,p=o>i?o>s?o:s:i>s?i:s,h=a>u?a>c?a:c:u>c?u:c;let d=r.next;for(;d!==t;){if(d.x>=l&&d.x<=p&&d.y>=f&&d.y<=h&&yu(o,a,i,u,s,c,d.x,d.y)&&gu(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function uu(e,t,n,r){const o=e.prev,i=e,s=e.next;if(gu(o,i,s)>=0)return!1;const a=o.x,u=i.x,c=s.x,l=o.y,f=i.y,p=s.y,h=a<u?a<c?a:c:u<c?u:c,d=l<f?l<p?l:p:f<p?f:p,m=a>u?a>c?a:c:u>c?u:c,y=l>f?l>p?l:p:f>p?f:p,_=du(h,d,t,n,r),g=du(m,y,t,n,r);let b=e.prevZ,E=e.nextZ;for(;b&&b.z>=_&&E&&E.z<=g;){if(b.x>=h&&b.x<=m&&b.y>=d&&b.y<=y&&b!==o&&b!==s&&yu(a,l,u,f,c,p,b.x,b.y)&&gu(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,E.x>=h&&E.x<=m&&E.y>=d&&E.y<=y&&E!==o&&E!==s&&yu(a,l,u,f,c,p,E.x,E.y)&&gu(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;b&&b.z>=_;){if(b.x>=h&&b.x<=m&&b.y>=d&&b.y<=y&&b!==o&&b!==s&&yu(a,l,u,f,c,p,b.x,b.y)&&gu(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;E&&E.z<=g;){if(E.x>=h&&E.x<=m&&E.y>=d&&E.y<=y&&E!==o&&E!==s&&yu(a,l,u,f,c,p,E.x,E.y)&&gu(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function cu(e,t){let n=e;do{const r=n.prev,o=n.next.next;!bu(r,o)&&Eu(r,n,n.next,o)&&vu(r,o)&&vu(o,r)&&(t.push(r.i,n.i,o.i),Ru(n),Ru(n.next),n=e=o),n=n.next}while(n!==e);return iu(n)}function lu(e,t,n,r,o,i){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&_u(s,e)){let a=Tu(s,e);return s=iu(s,s.next),a=iu(a,a.next),su(s,t,n,r,o,i,0),void su(a,t,n,r,o,i,0)}e=e.next}s=s.next}while(s!==e)}function fu(e,t){return e.x-t.x}function pu(e,t){const n=function(e,t){let n=t;const r=e.x,o=e.y;let i,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const e=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s&&(s=e,i=n.x<n.next.x?n:n.next,e===r))return i}n=n.next}while(n!==t);if(!i)return null;const a=i,u=i.x,c=i.y;let l=1/0;n=i;do{if(r>=n.x&&n.x>=u&&r!==n.x&&yu(o<c?r:s,o,u,c,o<c?s:r,o,n.x,n.y)){const t=Math.abs(o-n.y)/(r-n.x);vu(n,e)&&(t<l||t===l&&(n.x>i.x||n.x===i.x&&hu(i,n)))&&(i=n,l=t)}n=n.next}while(n!==a);return i}(e,t);if(!n)return t;const r=Tu(n,e);return iu(r,r.next),iu(n,n.next)}function hu(e,t){return gu(e.prev,e,t.prev)<0&&gu(t.next,e,e.next)<0}function du(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function mu(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function yu(e,t,n,r,o,i,s,a){return(o-s)*(t-a)>=(e-s)*(i-a)&&(e-s)*(r-a)>=(n-s)*(t-a)&&(n-s)*(i-a)>=(o-s)*(r-a)}function _u(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Eu(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(vu(e,t)&&vu(t,e)&&function(e,t){let n=e,r=!1;const o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(gu(e.prev,e,t.prev)||gu(e,t.prev,t))||bu(e,t)&&gu(e.prev,e,e.next)>0&&gu(t.prev,t,t.next)>0)}function gu(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function bu(e,t){return e.x===t.x&&e.y===t.y}function Eu(e,t,n,r){const o=wu(gu(e,t,n)),i=wu(gu(e,t,r)),s=wu(gu(n,r,e)),a=wu(gu(n,r,t));return o!==i&&s!==a||(!(0!==o||!Ou(e,n,t))||(!(0!==i||!Ou(e,r,t))||(!(0!==s||!Ou(n,e,r))||!(0!==a||!Ou(n,t,r)))))}function Ou(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function wu(e){return e>0?1:e<0?-1:0}function vu(e,t){return gu(e.prev,e,e.next)<0?gu(e,t,e.next)>=0&&gu(e,e.prev,t)>=0:gu(e,t,e.prev)<0||gu(e,e.next,t)<0}function Tu(e,t){const n=Au(e.i,e.x,e.y),r=Au(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function xu(e,t,n,r){const o=Au(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Ru(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Au(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Su(e,t,n){if(0===e)return t*n;const r=e*e,o=r*r,i=o*r,s=i*r,a=s*r,u=a*r,c=n;return t*((1-r/4-3*o/64-5*i/256-175*s/16384-441*a/65536-4851*u/1048576)*c-(3*r/8+3*o/32+45*i/1024+105*s/4096+2205*a/131072+6237*u/524288)*Math.sin(2*c)+(15*o/256+45*i/1024+525*s/16384+1575*a/65536+155925*u/8388608)*Math.sin(4*c)-(35*i/3072+175*s/12288+3675*a/262144+13475*u/1048576)*Math.sin(6*c)+(315*s/131072+2205*a/524288+43659*u/8388608)*Math.sin(8*c)-(693*a/1310720+6237*u/5242880)*Math.sin(10*c)+1001*u/8388608*Math.sin(12*c))}function Iu(e,t){if(0===e)return Math.log(Math.tan(.5*(F.PI_OVER_TWO+t)));const n=e*Math.sin(t);return Math.log(Math.tan(.5*(F.PI_OVER_TWO+t)))-e/2*Math.log((1+n)/(1-n))}Za.validOutline=function(e){j.defined("positions",e);const t=Js.fromPoints(e,tu).halfAxes,n=ie.getColumn(t,0,Ka),r=ie.getColumn(t,1,Ja),o=ie.getColumn(t,2,eu),i=Q.magnitude(n),s=Q.magnitude(r),a=Q.magnitude(o);return!(0===i&&(0===s||0===a)||0===s&&0===a)},Za.computeProjectTo2DArguments=function(e,t,n,r){j.defined("positions",e),j.defined("centerResult",t),j.defined("planeAxis1Result",n),j.defined("planeAxis2Result",r);const o=Js.fromPoints(e,tu),i=o.halfAxes,s=ie.getColumn(i,0,Ka),a=ie.getColumn(i,1,Ja),u=ie.getColumn(i,2,eu),c=Q.magnitude(s),l=Q.magnitude(a),f=Q.magnitude(u),p=Math.min(c,l,f);if(0===c&&(0===l||0===f)||0===l&&0===f)return!1;let h,d;return p!==l&&p!==f||(h=s),p===c?h=a:p===f&&(d=a),p!==c&&p!==l||(d=u),Q.normalize(h,n),Q.normalize(d,r),Q.clone(o.center,t),!0},Za.createProjectPointsTo2DFunction=function(e,t,n){return function(r){const o=new Array(r.length);for(let i=0;i<r.length;i++)o[i]=nu(r[i],e,t,n);return o}},Za.createProjectPointTo2DFunction=function(e,t,n){return function(r,o){return nu(r,e,t,n,o)}};const Nu=new Q,Cu=new Q;function Pu(e,t,n,r){const o=Q.normalize(r.cartographicToCartesian(t,Cu),Nu),i=Q.normalize(r.cartographicToCartesian(n,Cu),Cu);j.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(Q.angleBetween(o,i))-Math.PI),.0125);const s=r.maximumRadius,a=r.minimumRadius,u=s*s,c=a*a;e._ellipticitySquared=(u-c)/u,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=et.clone(t,e._start),e._start.height=0,e._end=et.clone(n,e._end),e._end.height=0,e._heading=function(e,t,n,r,o){const i=Iu(e._ellipticity,n),s=Iu(e._ellipticity,o);return Math.atan2(F.negativePiToPi(r-t),s-i)}(e,t.longitude,t.latitude,n.longitude,n.latitude),e._distance=function(e,t,n,r,o,i,s){const a=e._heading,u=i-r;let c=0;if(F.equalsEpsilon(Math.abs(a),F.PI_OVER_TWO,F.EPSILON8))if(t===n)c=t*Math.cos(o)*F.negativePiToPi(u);else{const n=Math.sin(o);c=t*Math.cos(o)*F.negativePiToPi(u)/Math.sqrt(1-e._ellipticitySquared*n*n)}else{const n=Su(e._ellipticity,t,o);c=(Su(e._ellipticity,t,s)-n)/Math.cos(a)}return Math.abs(c)}(e,r.maximumRadius,r.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude)}function Mu(e,t,n,r,o,i){if(0===n)return et.clone(e,i);const s=o*o;let a,u,c;if(Math.abs(F.PI_OVER_TWO-Math.abs(t))>F.EPSILON8){if(u=function(e,t,n){const r=e/n;if(0===t)return r;const o=r*r,i=o*r,s=i*r,a=t*t,u=a*a,c=u*a,l=c*a,f=l*a,p=f*a,h=Math.sin(2*r),d=Math.cos(2*r),m=Math.sin(4*r),y=Math.cos(4*r),_=Math.sin(6*r),g=Math.cos(6*r),b=Math.sin(8*r),E=Math.cos(8*r),O=Math.sin(10*r);return r+r*a/4+7*r*u/64+15*r*c/256+579*r*l/16384+1515*r*f/65536+16837*r*p/1048576+(3*r*u/16+45*r*c/256-r*(32*o-561)*l/4096-r*(232*o-1677)*f/16384+r*(399985-90560*o+512*s)*p/5242880)*d+(21*r*c/256+483*r*l/4096-r*(224*o-1969)*f/16384-r*(33152*o-112599)*p/1048576)*y+(151*r*l/4096+4681*r*f/65536+1479*r*p/16384-453*i*p/32768)*g+(1097*r*f/65536+42783*r*p/1048576)*E+8011*r*p/1048576*Math.cos(10*r)+(3*a/8+3*u/16+213*c/2048-3*o*c/64+255*l/4096-33*o*l/512+20861*f/524288-33*o*f/512+s*f/1024+28273*p/1048576-471*o*p/8192+9*s*p/4096)*h+(21*u/256+21*c/256+533*l/8192-21*o*l/512+197*f/4096-315*o*f/4096+584039*p/16777216-12517*o*p/131072+7*s*p/2048)*m+(151*c/6144+151*l/4096+5019*f/131072-453*o*f/16384+26965*p/786432-8607*o*p/131072)*_+(1097*l/131072+1097*f/65536+225797*p/10485760-1097*o*p/65536)*b+(8011*f/2621440+8011*p/1048576)*O+293393*p/251658240*Math.sin(12*r)}(Su(o,r,e.latitude)+n*Math.cos(t),o,r),Math.abs(t)<F.EPSILON10)a=F.negativePiToPi(e.longitude);else{const n=Iu(o,e.latitude),r=Iu(o,u);c=Math.tan(t)*(r-n),a=F.negativePiToPi(e.longitude+c)}}else{let i;if(u=e.latitude,0===o)i=r*Math.cos(e.latitude);else{const t=Math.sin(e.latitude);i=r*Math.cos(e.latitude)/Math.sqrt(1-s*t*t)}c=n/i,a=t>0?F.negativePiToPi(e.longitude+c):F.negativePiToPi(e.longitude-c)}return g(i)?(i.longitude=a,i.latitude=u,i.height=0,i):new et(a,u,0)}function ju(e,t,n){const r=_(n,it.default);this._ellipsoid=r,this._start=new et,this._end=new et,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,g(e)&&g(t)&&Pu(this,e,t,r)}Object.defineProperties(ju.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return j.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return j.defined("distance",this._distance),this._heading}}}),ju.fromStartHeadingDistance=function(e,t,n,r,o){j.defined("start",e),j.defined("heading",t),j.defined("distance",n),j.typeOf.number.greaterThan("distance",n,0);const i=_(r,it.default),s=i.maximumRadius,a=i.minimumRadius,u=s*s,c=a*a,l=Math.sqrt((u-c)/u),f=Mu(e,t=F.negativePiToPi(t),n,i.maximumRadius,l);return!g(o)||g(r)&&!r.equals(o.ellipsoid)?new ju(e,f,i):(o.setEndPoints(e,f),o)},ju.prototype.setEndPoints=function(e,t){j.defined("start",e),j.defined("end",t),Pu(this,e,t,this._ellipsoid)},ju.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)},ju.prototype.interpolateUsingSurfaceDistance=function(e,t){if(j.typeOf.number("distance",e),!g(this._distance)||0===this._distance)throw new b("EllipsoidRhumbLine must have distinct start and end set.");return Mu(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)},ju.prototype.findIntersectionWithLongitude=function(e,t){if(j.typeOf.number("intersectionLongitude",e),!g(this._distance)||0===this._distance)throw new b("EllipsoidRhumbLine must have distinct start and end set.");const n=this._ellipticity,r=this._heading,o=Math.abs(r),i=this._start;if(e=F.negativePiToPi(e),F.equalsEpsilon(Math.abs(e),Math.PI,F.EPSILON14)&&(e=F.sign(i.longitude)*Math.PI),g(t)||(t=new et),Math.abs(F.PI_OVER_TWO-o)<=F.EPSILON8)return t.longitude=e,t.latitude=i.latitude,t.height=0,t;if(F.equalsEpsilon(Math.abs(F.PI_OVER_TWO-o),F.PI_OVER_TWO,F.EPSILON8)){if(F.equalsEpsilon(e,i.longitude,F.EPSILON12))return;return t.longitude=e,t.latitude=F.PI_OVER_TWO*F.sign(F.PI_OVER_TWO-r),t.height=0,t}const s=i.latitude,a=n*Math.sin(s),u=Math.tan(.5*(F.PI_OVER_TWO+s))*Math.exp((e-i.longitude)/Math.tan(r)),c=(1+a)/(1-a);let l,f=i.latitude;do{l=f;const e=n*Math.sin(l),t=(1+e)/(1-e);f=2*Math.atan(u*Math.pow(t/c,n/2))-F.PI_OVER_TWO}while(!F.equalsEpsilon(f,l,F.EPSILON12));return t.longitude=e,t.latitude=f,t.height=0,t},ju.prototype.findIntersectionWithLatitude=function(e,t){if(j.typeOf.number("intersectionLatitude",e),!g(this._distance)||0===this._distance)throw new b("EllipsoidRhumbLine must have distinct start and end set.");const n=this._ellipticity,r=this._heading,o=this._start;if(F.equalsEpsilon(Math.abs(r),F.PI_OVER_TWO,F.EPSILON8))return;const i=Iu(n,o.latitude),s=Iu(n,e),a=Math.tan(r)*(s-i),u=F.negativePiToPi(o.longitude+a);return g(t)?(t.longitude=u,t.latitude=e,t.height=0,t):new et(u,e,0)};var Uu=Object.freeze({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3});function Fu(e,t,n,r){this[0]=_(e,0),this[1]=_(n,0),this[2]=_(t,0),this[3]=_(r,0)}Fu.packedLength=4,Fu.pack=function(e,t,n){return j.typeOf.object("value",e),j.defined("array",t),n=_(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t},Fu.unpack=function(e,t,n){return j.defined("array",e),t=_(t,0),g(n)||(n=new Fu),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n},Fu.packArray=function(e,t){j.defined("array",e);const n=e.length,r=4*n;if(g(t)){if(!Array.isArray(t)&&t.length!==r)throw new b("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)Fu.pack(e[r],t,4*r);return t},Fu.unpackArray=function(e,t){if(j.defined("array",e),j.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new b("array length must be a multiple of 4.");const n=e.length;g(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;t[n]=Fu.unpack(e,r,t[n])}return t},Fu.clone=function(e,t){if(g(e))return g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new Fu(e[0],e[2],e[1],e[3])},Fu.fromArray=Fu.unpack,Fu.fromColumnMajorArray=function(e,t){return j.defined("values",e),Fu.clone(e,t)},Fu.fromRowMajorArray=function(e,t){return j.defined("values",e),g(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new Fu(e[0],e[1],e[2],e[3])},Fu.fromScale=function(e,t){return j.typeOf.object("scale",e),g(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new Fu(e.x,0,0,e.y)},Fu.fromUniformScale=function(e,t){return j.typeOf.number("scale",e),g(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new Fu(e,0,0,e)},Fu.fromRotation=function(e,t){j.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return g(t)?(t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t):new Fu(n,-r,r,n)},Fu.toArray=function(e,t){return j.typeOf.object("matrix",e),g(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},Fu.getElementIndex=function(e,t){return j.typeOf.number.greaterThanOrEquals("row",t,0),j.typeOf.number.lessThanOrEquals("row",t,1),j.typeOf.number.greaterThanOrEquals("column",e,0),j.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},Fu.getColumn=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,1),j.typeOf.object("result",n);const r=2*t,o=e[r],i=e[r+1];return n.x=o,n.y=i,n},Fu.setColumn=function(e,t,n,r){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,1),j.typeOf.object("cartesian",n),j.typeOf.object("result",r);const o=2*t;return(r=Fu.clone(e,r))[o]=n.x,r[o+1]=n.y,r},Fu.getRow=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,1),j.typeOf.object("result",n);const r=e[t],o=e[t+2];return n.x=r,n.y=o,n},Fu.setRow=function(e,t,n,r){return j.typeOf.object("matrix",e),j.typeOf.number.greaterThanOrEquals("index",t,0),j.typeOf.number.lessThanOrEquals("index",t,1),j.typeOf.object("cartesian",n),j.typeOf.object("result",r),(r=Fu.clone(e,r))[t]=n.x,r[t+2]=n.y,r};const qu=new He;Fu.setScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("scale",t),j.typeOf.object("result",n);const r=Fu.getScale(e,qu),o=t.x/r.x,i=t.y/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*i,n[3]=e[3]*i,n};const Lu=new He;Fu.setUniformScale=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.number("scale",t),j.typeOf.object("result",n);const r=Fu.getScale(e,Lu),o=t/r.x,i=t/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*i,n[3]=e[3]*i,n};const Du=new He;Fu.getScale=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t.x=He.magnitude(He.fromElements(e[0],e[1],Du)),t.y=He.magnitude(He.fromElements(e[2],e[3],Du)),t};const Bu=new He;Fu.getMaximumScale=function(e){return Fu.getScale(e,Bu),He.maximumComponent(Bu)};const zu=new He;Fu.setRotation=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("result",n);const r=Fu.getScale(e,zu);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.y,n[3]=t[3]*r.y,n};const ku=new He;Fu.getRotation=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=Fu.getScale(e,ku);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t},Fu.multiply=function(e,t,n){j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n);const r=e[0]*t[0]+e[2]*t[1],o=e[0]*t[2]+e[2]*t[3],i=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return n[0]=r,n[1]=i,n[2]=o,n[3]=s,n},Fu.add=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},Fu.subtract=function(e,t,n){return j.typeOf.object("left",e),j.typeOf.object("right",t),j.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},Fu.multiplyByVector=function(e,t,n){j.typeOf.object("matrix",e),j.typeOf.object("cartesian",t),j.typeOf.object("result",n);const r=e[0]*t.x+e[2]*t.y,o=e[1]*t.x+e[3]*t.y;return n.x=r,n.y=o,n},Fu.multiplyByScalar=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.number("scalar",t),j.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},Fu.multiplyByScale=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.object("scale",t),j.typeOf.object("result",n),n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n},Fu.multiplyByUniformScale=function(e,t,n){return j.typeOf.object("matrix",e),j.typeOf.number("scale",t),j.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},Fu.negate=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},Fu.transpose=function(e,t){j.typeOf.object("matrix",e),j.typeOf.object("result",t);const n=e[0],r=e[2],o=e[1],i=e[3];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t},Fu.abs=function(e,t){return j.typeOf.object("matrix",e),j.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},Fu.equals=function(e,t){return e===t||g(e)&&g(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},Fu.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]},Fu.equalsEpsilon=function(e,t,n){return n=_(n,0),e===t||g(e)&&g(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n},Fu.IDENTITY=Object.freeze(new Fu(1,0,0,1)),Fu.ZERO=Object.freeze(new Fu(0,0,0,0)),Fu.COLUMN0ROW0=0,Fu.COLUMN0ROW1=1,Fu.COLUMN1ROW0=2,Fu.COLUMN1ROW1=3,Object.defineProperties(Fu.prototype,{length:{get:function(){return Fu.packedLength}}}),Fu.prototype.clone=function(e){return Fu.clone(this,e)},Fu.prototype.equals=function(e){return Fu.equals(this,e)},Fu.prototype.equalsEpsilon=function(e,t){return Fu.equalsEpsilon(this,e,t)},Fu.prototype.toString=function(){return`(${this[0]}, ${this[2]})\n(${this[1]}, ${this[3]})`};const Gu={POINTS:E.POINTS,LINES:E.LINES,LINE_LOOP:E.LINE_LOOP,LINE_STRIP:E.LINE_STRIP,TRIANGLES:E.TRIANGLES,TRIANGLE_STRIP:E.TRIANGLE_STRIP,TRIANGLE_FAN:E.TRIANGLE_FAN,isLines:function(e){return e===Gu.LINES||e===Gu.LINE_LOOP||e===Gu.LINE_STRIP},isTriangles:function(e){return e===Gu.TRIANGLES||e===Gu.TRIANGLE_STRIP||e===Gu.TRIANGLE_FAN},validate:function(e){return e===Gu.POINTS||e===Gu.LINES||e===Gu.LINE_LOOP||e===Gu.LINE_STRIP||e===Gu.TRIANGLES||e===Gu.TRIANGLE_STRIP||e===Gu.TRIANGLE_FAN}};var Vu=Object.freeze(Gu);function Hu(e){e=_(e,_.EMPTY_OBJECT),j.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=_(e.primitiveType,Vu.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=_(e.geometryType,Uu.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}Hu.computeNumberOfVertices=function(e){j.typeOf.object("geometry",e);let t=-1;for(const n in e.attributes)if(e.attributes.hasOwnProperty(n)&&g(e.attributes[n])&&g(e.attributes[n].values)){const r=e.attributes[n],o=r.values.length/r.componentsPerAttribute;if(t!==o&&-1!==t)throw new b("All attribute lists must have the same number of attributes.");t=o}return t};const Wu=new et,Xu=new Q,$u=new Se,Yu=[new et,new et,new et],Zu=[new He,new He,new He],Qu=[new He,new He,new He],Ku=new Q,Ju=new Yr,ec=new Se,tc=new Fu;function nc(e){if(!g((e=_(e,_.EMPTY_OBJECT)).componentDatatype))throw new b("options.componentDatatype is required.");if(!g(e.componentsPerAttribute))throw new b("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||e.componentsPerAttribute>4)throw new b("options.componentsPerAttribute must be between 1 and 4.");if(!g(e.values))throw new b("options.values is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=_(e.normalize,!1),this.values=e.values}Hu._textureCoordinateRotationPoints=function(e,t,n,r){let o;const i=ci.center(r,Wu),s=et.toCartesian(i,n,Xu),a=vo.eastNorthUpToFixedFrame(s,n,$u),u=Se.inverse(a,$u),c=Zu,l=Yu;l[0].longitude=r.west,l[0].latitude=r.south,l[1].longitude=r.west,l[1].latitude=r.north,l[2].longitude=r.east,l[2].latitude=r.south;let f=Ku;for(o=0;o<3;o++)et.toCartesian(l[o],n,f),f=Se.multiplyByPointAsVector(u,f,f),c[o].x=f.x,c[o].y=f.y;const p=Yr.fromAxisAngle(Q.UNIT_Z,-t,Ju),h=ie.fromQuaternion(p,ec),d=e.length;let m=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(o=0;o<d;o++)f=Se.multiplyByPointAsVector(u,e[o],f),f=ie.multiplyByVector(h,f,f),m=Math.min(m,f.x),y=Math.min(y,f.y),_=Math.max(_,f.x),g=Math.max(g,f.y);const b=Fu.fromRotation(t,tc),E=Qu;E[0].x=m,E[0].y=y,E[1].x=m,E[1].y=g,E[2].x=_,E[2].y=y;const O=c[0],w=c[2].x-O.x,v=c[1].y-O.y;for(o=0;o<3;o++){const e=E[o];Fu.multiplyByVector(b,e,e),e.x=(e.x-O.x)/w,e.y=(e.y-O.y)/v}const T=E[0],x=E[1],R=E[2],A=new Array(6);return He.pack(T,A),He.pack(x,A,2),He.pack(R,A,4),A};const rc={CLOCKWISE:E.CW,COUNTER_CLOCKWISE:E.CCW,validate:function(e){return e===rc.CLOCKWISE||e===rc.COUNTER_CLOCKWISE}};var oc=Object.freeze(rc);const ic=new Q,sc=new Q,ac={computeArea2D:function(e){j.defined("positions",e),j.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);const t=e.length;let n=0;for(let r=t-1,o=0;o<t;r=o++){const t=e[r],i=e[o];n+=t.x*i.y-i.x*t.y}return.5*n},computeWindingOrder2D:function(e){return ac.computeArea2D(e)>0?oc.COUNTER_CLOCKWISE:oc.CLOCKWISE},triangulate:function(e,t){j.defined("positions",e);return ru(He.packArray(e),t,2)}},uc=new Q,cc=new Q,lc=new Q,fc=new Q,pc=new Q,hc=new Q,dc=new Q,mc=new He,yc=new He,_c=new He,gc=new He;ac.computeSubdivision=function(e,t,n,r,o){o=_(o,F.RADIANS_PER_DEGREE);const i=g(r);j.typeOf.object("ellipsoid",e),j.defined("positions",t),j.defined("indices",n),j.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),j.typeOf.number.equals("indices.length % 3","0",n.length%3,0),j.typeOf.number.greaterThan("granularity",o,0);const s=n.slice(0);let a;const u=t.length,c=new Array(3*u),l=new Array(2*u);let f=0,p=0;for(a=0;a<u;a++){const e=t[a];if(c[f++]=e.x,c[f++]=e.y,c[f++]=e.z,i){const e=r[a];l[p++]=e.x,l[p++]=e.y}}const h=[],d={},m=e.maximumRadius,y=F.chordLength(o,m),b=y*y;for(;s.length>0;){const e=s.pop(),t=s.pop(),n=s.pop(),r=Q.fromArray(c,3*n,uc),o=Q.fromArray(c,3*t,cc),u=Q.fromArray(c,3*e,lc);let f,p,y;i&&(f=He.fromArray(l,2*n,mc),p=He.fromArray(l,2*t,yc),y=He.fromArray(l,2*e,_c));const _=Q.multiplyByScalar(Q.normalize(r,fc),m,fc),E=Q.multiplyByScalar(Q.normalize(o,pc),m,pc),O=Q.multiplyByScalar(Q.normalize(u,hc),m,hc),w=Q.magnitudeSquared(Q.subtract(_,E,dc)),v=Q.magnitudeSquared(Q.subtract(E,O,dc)),T=Q.magnitudeSquared(Q.subtract(O,_,dc)),x=Math.max(w,v,T);let R,A,S;x>b?w===x?(R=`${Math.min(n,t)} ${Math.max(n,t)}`,a=d[R],g(a)||(A=Q.add(r,o,dc),Q.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),a=c.length/3-1,d[R]=a,i&&(S=He.add(f,p,gc),He.multiplyByScalar(S,.5,S),l.push(S.x,S.y))),s.push(n,a,e),s.push(a,t,e)):v===x?(R=`${Math.min(t,e)} ${Math.max(t,e)}`,a=d[R],g(a)||(A=Q.add(o,u,dc),Q.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),a=c.length/3-1,d[R]=a,i&&(S=He.add(p,y,gc),He.multiplyByScalar(S,.5,S),l.push(S.x,S.y))),s.push(t,a,n),s.push(a,e,n)):T===x&&(R=`${Math.min(e,n)} ${Math.max(e,n)}`,a=d[R],g(a)||(A=Q.add(u,r,dc),Q.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),a=c.length/3-1,d[R]=a,i&&(S=He.add(y,f,gc),He.multiplyByScalar(S,.5,S),l.push(S.x,S.y))),s.push(e,a,t),s.push(a,n,t)):(h.push(n),h.push(t),h.push(e))}const E={attributes:{position:new nc({componentDatatype:w.DOUBLE,componentsPerAttribute:3,values:c})},indices:h,primitiveType:Vu.TRIANGLES};return i&&(E.attributes.st=new nc({componentDatatype:w.FLOAT,componentsPerAttribute:2,values:l})),new Hu(E)};const bc=new et,Ec=new et,Oc=new et,wc=new et;function vc(){this.name=void 0,this.meshes=[]}function Tc(){this.name=void 0,this.primitives=[]}function xc(){this.material=void 0,this.indices=new v(w.UNSIGNED_INT),this.positions=new v(w.FLOAT),this.normals=new v(w.FLOAT),this.uvs=new v(w.FLOAT)}ac.computeRhumbLineSubdivision=function(e,t,n,r,o){o=_(o,F.RADIANS_PER_DEGREE);const i=g(r);j.typeOf.object("ellipsoid",e),j.defined("positions",t),j.defined("indices",n),j.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),j.typeOf.number.equals("indices.length % 3","0",n.length%3,0),j.typeOf.number.greaterThan("granularity",o,0);const s=n.slice(0);let a;const u=t.length,c=new Array(3*u),l=new Array(2*u);let f=0,p=0;for(a=0;a<u;a++){const e=t[a];if(c[f++]=e.x,c[f++]=e.y,c[f++]=e.z,i){const e=r[a];l[p++]=e.x,l[p++]=e.y}}const h=[],d={},m=e.maximumRadius,y=F.chordLength(o,m),b=new ju(void 0,void 0,e),E=new ju(void 0,void 0,e),O=new ju(void 0,void 0,e);for(;s.length>0;){const t=s.pop(),n=s.pop(),r=s.pop(),o=Q.fromArray(c,3*r,uc),u=Q.fromArray(c,3*n,cc),f=Q.fromArray(c,3*t,lc);let p,m,_;i&&(p=He.fromArray(l,2*r,mc),m=He.fromArray(l,2*n,yc),_=He.fromArray(l,2*t,_c));const w=e.cartesianToCartographic(o,bc),v=e.cartesianToCartographic(u,Ec),T=e.cartesianToCartographic(f,Oc);b.setEndPoints(w,v);const x=b.surfaceDistance;E.setEndPoints(v,T);const R=E.surfaceDistance;O.setEndPoints(T,w);const A=O.surfaceDistance,S=Math.max(x,R,A);let I,N,C,P,M;S>y?x===S?(I=`${Math.min(r,n)} ${Math.max(r,n)}`,a=d[I],g(a)||(N=b.interpolateUsingFraction(.5,wc),C=.5*(w.height+v.height),P=Q.fromRadians(N.longitude,N.latitude,C,e,dc),c.push(P.x,P.y,P.z),a=c.length/3-1,d[I]=a,i&&(M=He.add(p,m,gc),He.multiplyByScalar(M,.5,M),l.push(M.x,M.y))),s.push(r,a,t),s.push(a,n,t)):R===S?(I=`${Math.min(n,t)} ${Math.max(n,t)}`,a=d[I],g(a)||(N=E.interpolateUsingFraction(.5,wc),C=.5*(v.height+T.height),P=Q.fromRadians(N.longitude,N.latitude,C,e,dc),c.push(P.x,P.y,P.z),a=c.length/3-1,d[I]=a,i&&(M=He.add(m,_,gc),He.multiplyByScalar(M,.5,M),l.push(M.x,M.y))),s.push(n,a,r),s.push(a,t,r)):A===S&&(I=`${Math.min(t,r)} ${Math.max(t,r)}`,a=d[I],g(a)||(N=O.interpolateUsingFraction(.5,wc),C=.5*(T.height+w.height),P=Q.fromRadians(N.longitude,N.latitude,C,e,dc),c.push(P.x,P.y,P.z),a=c.length/3-1,d[I]=a,i&&(M=He.add(_,p,gc),He.multiplyByScalar(M,.5,M),l.push(M.x,M.y))),s.push(t,a,n),s.push(a,r,n)):(h.push(r),h.push(n),h.push(t))}const v={attributes:{position:new nc({componentDatatype:w.DOUBLE,componentsPerAttribute:3,values:c})},indices:h,primitiveType:Vu.TRIANGLES};return i&&(v.attributes.st=new nc({componentDatatype:w.FLOAT,componentsPerAttribute:2,values:l})),new Hu(v)},ac.scaleToGeodeticHeight=function(e,t,n,r){n=_(n,it.default);let o=ic,i=sc;if(t=_(t,0),r=_(r,!0),g(e)){const s=e.length;for(let a=0;a<s;a+=3)Q.fromArray(e,a,i),r&&(i=n.scaleToGeodeticSurface(i,i)),0!==t&&(o=n.geodeticSurfaceNormal(i,o),Q.multiplyByScalar(o,t,o),Q.add(i,o,i)),e[a]=i.x,e[a+1]=i.y,e[a+2]=i.z}return e};const Rc=/v(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Ac=/vn(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Sc=/vt(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Ic=/(-?\d+)\/?(-?\d*)\/?(-?\d*)/g,Nc=new Q;function Cc(e,t){const n=function(e,t){if("X"===e&&"Y"===t)return Ve.X_UP_TO_Y_UP;if("X"===e&&"Z"===t)return Ve.X_UP_TO_Z_UP;if("Y"===e&&"X"===t)return Ve.Y_UP_TO_X_UP;if("Y"===e&&"Z"===t)return Ve.Y_UP_TO_Z_UP;if("Z"===e&&"X"===t)return Ve.Z_UP_TO_X_UP;if("Z"===e&&"Y"===t)return Ve.Z_UP_TO_Y_UP}(t.inputUpAxis,t.outputUpAxis);let r,o,i,s,a=new v(w.FLOAT),u=new v(w.FLOAT),c=new v(w.FLOAT);const l=[];let f={};let p=0,h=0,m=[],b="";const E=[],O=[],T=[],x=[];function R(){f={},p=0}function A(e){return""===e?void 0:e}function S(e){r=new vc,r.name=A(e),l.push(r),N()}function N(e){o=new Tc,o.name=A(e),r.meshes.push(o),C()}function C(){i=new xc,i.material=s,o.primitives.push(i),R(),h=0}function P(e){const t=o.primitives,n=t.length;for(let r=0;r<n;++r)if(t[r].material===s&&(!g(e)||e(t[r])))return i=t[r],R(),void(h=i.positions.length/3);C()}function M(e,t,n){const r=g(e[0]),o=g(t[0]),i=n.uvs.length>0,s=n.normals.length>0;return i===r&&s===o}function j(e,t,n){const r=parseInt(e);return r<0?t.length/n+r:r-1}function U(e,t,n){const r=e.length;for(let o=0;o<r;++o)0===e[o].length?e[o]=void 0:e[o]=j(e[o],t,n)}function F(e,t,n,r){let o=f[e];return g(o)||(o=h++,f[e]=o,function(e,t,n){if(g(e)&&a.length>0){if(3*e>=a.length)throw new Ae(`Position index ${e} is out of bounds`);const t=a.get(3*e),n=a.get(3*e+1),r=a.get(3*e+2);i.positions.push(t),i.positions.push(n),i.positions.push(r)}if(g(n)&&u.length>0){if(3*n>=u.length)throw new Ae(`Normal index ${n} is out of bounds`);const e=u.get(3*n),t=u.get(3*n+1),r=u.get(3*n+2);i.normals.push(e),i.normals.push(t),i.normals.push(r)}if(g(t)&&c.length>0){if(2*t>=c.length)throw new Ae(`UV index ${t} is out of bounds`);const e=c.get(2*t),n=c.get(2*t+1);i.uvs.push(e),i.uvs.push(n)}}(t,n,r),p++,p>1e6&&R()),o}function q(e,t){const n=a.get(3*e),r=a.get(3*e+1),o=a.get(3*e+2);return Q.fromElements(n,r,o,t)}const L=new Q,D=new Q,B=new Q,z=new Q,G=new Q,V=new Q,H=new Q,W=new Q,X=new Q,$=[new Q,new Q,new Q,new Q],Y=[],Z=[];function K(e,t,n,r){if(!g(r))return!0;const o=function(e,t){const n=u.get(3*e),r=u.get(3*e+1),o=u.get(3*e+2);return Q.fromElements(n,r,o,t)}(r,X),i=q(e,L),s=q(t,D),a=q(n,B),c=Q.subtract(s,i,z),l=Q.subtract(a,i,G),f=Q.cross(c,l,B);return Q.dot(o,f)>=0}function J(e,t,n,r){r?(i.indices.push(e),i.indices.push(t),i.indices.push(n)):(i.indices.push(e),i.indices.push(n),i.indices.push(t))}function ee(e,t,n,r,o){if(U(t,a,3),U(r,u,3),U(n,c,2),function(e,t,n,r){const o=e.length;for(let i=0;i<o;++i)e[i]=`${_(t[i],"")}/${_(n[i],"")}/${_(r[i],"")}`}(e,t,n,r),function(e,t){0===i.indices.length||M(e,t,i)||P((function(n){return M(e,t,n)}))}(n,x),3===e.length){const i=!o||K(t[0],t[1],t[2],r[0]);J(F(e[0],t[0],n[0],r[0]),F(e[1],t[1],n[1],r[1]),F(e[2],t[2],n[2],r[2]),i)}else{const o=Z,i=Y;o.length=0,i.length=0;for(let s=0;s<e.length;++s){const a=F(e[s],t[s],n[s],r[s]);i.push(a),s===$.length&&$.push(new Q),o.push(q(t[s],$[s]))}if(!Za.computeProjectTo2DArguments(o,V,H,W))return;const s=Za.createProjectPointsTo2DFunction(V,H,W)(o),a=ac.triangulate(s),u=ac.computeWindingOrder2D(s)!==oc.CLOCKWISE;for(let e=0;e<a.length-2;e+=3)J(i[a[e]],i[a[e+1]],i[a[e+2]],u)}}return S(),I(e,(function(e){let r;if(0===(e=e.trim()).length||"#"===e.charAt(0));else if(/^o\s/i.test(e)){S(e.substring(2).trim())}else if(/^g\s/i.test(e)){N(e.substring(2).trim())}else if(/^usemtl/i.test(e)){const t=e.substring(7).trim();s=A(t),P()}else if(/^mtllib/i.test(e)){const t=e.substring(7).trim();m=m.concat(function(e){const t=[];e=e.replace(/^"(.+)"$/,"$1");const n=e.split(" "),r=n.length;let o=0;for(let e=0;e<r;++e){if(".mtl"!==d.extname(n[e]))continue;const r=n.slice(o,e+1).join(" ");t.push(r),o=e+1}return t}(t))}else if(null!==(r=Rc.exec(e))){const e=Nc;e.x=parseFloat(r[1]),e.y=parseFloat(r[2]),e.z=parseFloat(r[3]),g(n)&&Se.multiplyByPoint(n,e,e),a.push(e.x),a.push(e.y),a.push(e.z)}else if(null!==(r=Ac.exec(e))){const e=Q.fromElements(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]),X);Q.equals(e,Q.ZERO)?Q.clone(Q.UNIT_Z,e):Q.normalize(e,e),g(n)&&Se.multiplyByPointAsVector(n,e,e),u.push(e.x),u.push(e.y),u.push(e.z)}else if(null!==(r=Sc.exec(e)))c.push(parseFloat(r[1])),c.push(1-parseFloat(r[2]));else{if("\\"===e.slice(-1))return void(b+=e.substring(0,e.length-1));if(b+=e,"f "===b.substring(0,2)){for(;null!==(r=Ic.exec(b));)E.push(r[0]),O.push(r[1]),T.push(r[2]),x.push(r[3]);E.length>2&&ee(E,O,T,x,t.triangleWindingOrderSanitization),E.length=0,O.length=0,x.length=0,T.length=0}b=""}})).then((function(){return a=void 0,u=void 0,c=void 0,function(e,t,n,r,o){if(e=function(e){return e=function(e){const t=[],n=e.length;for(let r=0;r<n;++r){const n=e[r],o=Pc(n.meshes);if(0!==o.length)if(n.meshes=o,!g(n.name)&&Mc(o)){const e=o.length;for(let n=0;n<e;++n){const e=o[n],r=new vc;r.name=e.name,r.meshes=[e],t.push(r)}}else t.push(n)}return t}(e),function(e){const t={};jc(e,"Node",t);const n=e.length;for(let r=0;r<n;++r){const n=e[r];jc(n.meshes,`${n.name}-Mesh`,t)}}(e),e}(e),0===e.length)throw new Ae(`${n} does not have any geometry data`);const i=d.basename(n,d.extname(n));return function(e,t,n){const r=d.dirname(t);let o=[];return e=e.filter((function(e,t,n){return n.indexOf(e)===t})),y.Promise.map(e,(function(e){const t=d.join(r,d.basename(e));return k(t,n).then((function(e){o=o.concat(e)})).catch((function(e){n.logger(e.message),n.logger(`Could not read material file at ${t}. Using default material instead.`)}))}),{concurrency:10}).then((function(){return o}))}(t,n,o).then((function(t){return t.length>0&&!r&&function(e,t){const n=t[0].name,r=e.length;for(let t=0;t<r;++t){const r=e[t].meshes,o=r.length;for(let e=0;e<o;++e){const t=r[e].primitives,o=t.length;for(let e=0;e<o;++e){const r=t[e];r.material=_(r.material,n)}}}}(e,t),function(e,t){const n=t.find((function(e){return 0===e.name.length}));if(!g(n))return;const r=e.length;for(let t=0;t<r;++t){const r=e[t].meshes,o=r.length;for(let e=0;e<o;++e){const t=r[e].primitives,o=t.length;for(let e=0;e<o;++e){const r=t[e];g(r.material)||(r.material=n.name)}}}}(e,t),{nodes:e,materials:t,name:i}}))}(l,m,e,g(s),t)}))}function Pc(e){return e.filter((function(e){return e.primitives=e.primitives.filter((function(e){return e.indices.length>0&&e.positions.length>0})),e.primitives.length>0}))}function Mc(e){const t=e.length;for(let n=0;n<t;++n)if(g(e[n].name))return!0;return!1}function jc(e,t,n){const r=e.length;for(let o=0;o<r;++o){const r=e[o];let i=_(r.name,t);const s=n[i];g(s)?(n[i]++,i=`${i}_${s}`):n[i]=1,r.name=i}}const Uc=k.getDefaultMaterial;function Fc(e,t){const n=e.nodes;let r=e.materials;const o=e.name;r=function(e,t,n){const r=[],o={},i=e.length;for(let s=0;s<i;++s){const i=e[s].meshes,a=i.length;for(let e=0;e<a;++e){const s=i[e].primitives,a=s.length;for(let e=0;e<a;++e){const i=s[e],a=i.uvs.length>0,u={hasUvs:a,hasNormals:i.normals.length>0},c=_(i.material,"default"),l=Wc(c,u,o);i.material=l,o[l]=u;let f=Vc(r,l);if(g(f))continue;const p=Vc(t,c);f=g(p)?zc(p,!a):Uc(n),f.name=l,r.push(f)}}}return r}(n,r,t);const i={accessors:[],asset:{},buffers:[],bufferViews:[],extensionsUsed:[],extensionsRequired:[],images:[],materials:[],meshes:[],nodes:[],samplers:[],scene:0,scenes:[],textures:[]};i.asset={generator:"obj2gltf",version:"2.0"},i.scenes.push({nodes:[]});const s={positionBuffers:[],normalBuffers:[],uvBuffers:[],indexBuffers:[],positionAccessors:[],normalAccessors:[],uvAccessors:[],indexAccessors:[]},a=function(e){const t=e.length;for(let n=0;n<t;++n){const t=e[n].meshes,r=t.length;for(let e=0;e<r;++e){const n=t[e].primitives,r=n.length;for(let e=0;e<r;++e){if(n[e].positions.length/3>65534)return!0}}}return!1}(n),u=n.length;for(let e=0;e<u;++e){const o=n[e],u=o.meshes,c=u.length;if(1===c){const e=Yc(i,r,s,a,u[0],t);Zc(i,o.name,e,void 0)}else{const e=Zc(i,o.name);for(let n=0;n<c;++n){const o=u[n],c=Yc(i,r,s,a,o,t);Zc(i,o.name,c,e)}}}return i.images.length>0&&i.samplers.push({wrapS:E.REPEAT,wrapT:E.REPEAT}),function(e,t,n,r){const o=t.positionBuffers.concat(t.normalBuffers,t.uvBuffers,t.indexBuffers),i=o.length;let s=0;for(let e=0;e<i;++e)s+=o[e].length;r?function(e,t,n){Dc(e,t.positionBuffers,t.positionAccessors,12,E.ARRAY_BUFFER,n),Dc(e,t.normalBuffers,t.normalAccessors,12,E.ARRAY_BUFFER,n),Dc(e,t.uvBuffers,t.uvAccessors,8,E.ARRAY_BUFFER,n),Dc(e,t.indexBuffers,t.indexAccessors,void 0,E.ELEMENT_ARRAY_BUFFER,n)}(e,t,n):function(e,t,n){qc(e,t.positionBuffers,t.positionAccessors,12,E.ARRAY_BUFFER),qc(e,t.normalBuffers,t.normalAccessors,12,E.ARRAY_BUFFER),qc(e,t.uvBuffers,t.uvAccessors,8,E.ARRAY_BUFFER),qc(e,t.indexBuffers,t.indexAccessors,void 0,E.ELEMENT_ARRAY_BUFFER);let r=[];r=r.concat(t.positionBuffers,t.normalBuffers,t.uvBuffers,t.indexBuffers);const o=function(e){const t=e.length%4;if(0===t)return e;const n=0===t?0:4-t,r=Buffer.alloc(n);return Buffer.concat([e,r])}(Buffer.concat(r));e.buffers.push({name:n,byteLength:o.length,extras:{_obj2gltf:{source:o}}})}(e,t,n)}(i,s,o,t.separate),t.specularGlossiness&&(i.extensionsUsed.push("KHR_materials_pbrSpecularGlossiness"),i.extensionsRequired.push("KHR_materials_pbrSpecularGlossiness")),t.unlit&&(i.extensionsUsed.push("KHR_materials_unlit"),i.extensionsRequired.push("KHR_materials_unlit")),i}function qc(e,t,n,r,o){const i=t.length;if(0===i)return;const s=e.bufferViews.length,a=e.bufferViews[s-1],u=g(a)?a.byteOffset+a.byteLength:0;let c=0;for(let r=0;r<i;++r){const o=e.accessors[n[r]];o.bufferView=s,o.byteOffset=c,c+=t[r].length}e.bufferViews.push({name:`bufferView_${s}`,buffer:0,byteLength:c,byteOffset:u,byteStride:r,target:o})}function Lc(e,t,n,r,o,i){const s=e.buffers.length,a=e.bufferViews.length;e.buffers.push({name:`${i}_${s}`,byteLength:t.length,extras:{_obj2gltf:{source:t}}}),e.bufferViews.push({buffer:s,byteLength:t.length,byteOffset:0,byteStride:r,target:o}),e.accessors[n].bufferView=a,e.accessors[n].byteOffset=0}function Dc(e,t,n,r,o,i){const s=t.length;for(let a=0;a<s;++a)Lc(e,t[a],n[a],r,o,i)}function Bc(e,t){let n;const r=e.images,o=r.length;for(let e=0;e<o;++e)if(r[e].extras._obj2gltf===t){n=e;break}return g(n)||(n=function(e,t){const n=t.name,r=t.name,o=e.images.length,i=e.textures.length;return e.images.push({name:n,extras:{_obj2gltf:t}}),e.textures.push({name:r,sampler:0,source:o}),i}(e,t)),{index:n}}function zc(e,t){if("object"!=typeof e)return e;if(e instanceof x){if(t)return;return e}if(Array.isArray(e)){const n=e.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=zc(e[o],t);return r}const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=zc(e[r],t));return n}function kc(e,t){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];r instanceof x?t[n]=Bc(e,r):Array.isArray(r)||"object"!=typeof r||kc(e,r)}}function Gc(e,t,n){kc(e,t);const r=e.materials.length;return n.unlit&&(g(t.extensions)||(t.extensions={}),t.extensions.KHR_materials_unlit={}),e.materials.push(t),r}function Vc(e,t){const n=e.length;for(let r=0;r<n;++r)if(e[r].name===t)return e[r]}function Hc(e,t){return e.hasUvs===t.hasUvs&&e.hasNormals===t.hasNormals}function Wc(e,t,n){let r=e,o=2;for(;g(n[r])&&!Hc(t,n[r]);)r=`${e}-${o++}`;return r}function Xc(e,t,n,r){const o=t.length/n,i=t.getMinMax(n),s=3===n?"VEC3":"VEC2",a={name:r,componentType:E.FLOAT,count:o,min:i.min,max:i.max,type:s},u=e.accessors.length;return e.accessors.push(a),u}function $c(e,t,n,r,o,i,s,a){const u=i.positions.length>0,c=i.normals.length>0,l=i.uvs.length>0,f={};if(u){const t=Xc(e,i.positions,3,`${o.name}_${s}_positions`);f.POSITION=t,n.positionBuffers.push(i.positions.toFloatBuffer()),n.positionAccessors.push(t)}if(c){const t=Xc(e,i.normals,3,`${o.name}_${s}_normals`);f.NORMAL=t,n.normalBuffers.push(i.normals.toFloatBuffer()),n.normalAccessors.push(t)}if(l){const t=Xc(e,i.uvs,2,`${o.name}_${s}_texcoords`);f.TEXCOORD_0=t,n.uvBuffers.push(i.uvs.toFloatBuffer()),n.uvAccessors.push(t)}const p=function(e,t,n,r){const o=n?E.UNSIGNED_INT:E.UNSIGNED_SHORT,i=t.length,s=t.getMinMax(1),a={name:r,componentType:o,count:i,min:s.min,max:s.max,type:"SCALAR"},u=e.accessors.length;return e.accessors.push(a),u}(e,i.indices,r,`${o.name}_${s}_indices`),h=r?i.indices.toUint32Buffer():i.indices.toUint16Buffer();n.indexBuffers.push(h),n.indexAccessors.push(p),i.positions=void 0,i.normals=void 0,i.uvs=void 0,i.indices=void 0;const d=function(e,t,n,r){const o=Vc(t,n);let i=function(e,t){const n=e.length;for(let r=0;r<n;++r)if(e[r].name===t)return r}(e.materials,n);return g(i)||(i=Gc(e,o,r)),i}(e,t,i.material,a);return{attributes:f,indices:p,material:d,mode:E.TRIANGLES}}function Yc(e,t,n,r,o,i){const s=[],a=o.primitives,u=a.length;for(let c=0;c<u;++c)s.push($c(e,t,n,r,o,a[c],c,i));const c={name:o.name,primitives:s},l=e.meshes.length;return e.meshes.push(c),l}function Zc(e,t,n,r){const o={name:t,mesh:n},i=e.nodes.length;if(e.nodes.push(o),g(r)){const t=e.nodes[r];g(t.children)||(t.children=[]),t.children.push(i)}else e.scenes[e.scene].nodes.push(i);return i}function Qc(e,t){return function(e){const t=[],n=e.images,r=n.length;for(let e=0;e<r;++e)t.push(Kc(n[e].extras._obj2gltf));return y.Promise.all(t)}(e).then((function(){const t=[];return t.push(function(e){const t=e.images;return y.Promise.map(t,(function(e){const t=e.extras._obj2gltf,n=e.name+t.extension;return e.uri=n,e}),{concurrency:10})}(e)),function(e){const t=e.buffers[0],n=t.extras._obj2gltf.source;if(n.length>201326580)throw new Ae("Buffer is too large to embed in the glTF. Use the --separate flag instead.");t.uri=`data:application/octet-stream;base64,${n.toString("base64")}`}(e),y.Promise.all(t).then((function(){return function(e){const t=e.buffers,n=t.length;for(let e=0;e<n;++e)delete t[e].extras;const r=e.images,o=r.length;for(let e=0;e<o;++e)delete r[e].extras}(e),Jc(e),e}))}))}function Kc(e){if(!g(e.source)&&g(e.pixels)&&".png"===e.extension)return function(e){const t=new PNG({width:e.width,height:e.height,colorType:e.transparent?6:2,inputColorType:6,inputHasAlpha:!0});return t.data=e.pixels,new y.Promise((function(e,n){const r=[],o=t.pack();o.on("data",(function(e){r.push(e)})),o.on("end",(function(){e(Buffer.concat(r))})),o.on("error",n)}))}(e).then((function(t){e.source=t}))}function Jc(e){Object.keys(e).forEach((function(t){!g(e[t])||Array.isArray(e[t])&&0===e[t].length?delete e[t]:"object"==typeof e[t]&&Jc(e[t])}))}function el(e,t){const n=el.defaults;if((t=_(t,{})).binary=_(t.binary,n.binary),t.separate=_(t.separate,n.separate),t.separateTextures=_(t.separateTextures,n.separateTextures)||t.separate,t.checkTransparency=_(t.checkTransparency,n.checkTransparency),t.doubleSidedMaterial=_(t.doubleSidedMaterial,n.doubleSidedMaterial),t.secure=_(t.secure,n.secure),t.packOcclusion=_(t.packOcclusion,n.packOcclusion),t.metallicRoughness=_(t.metallicRoughness,n.metallicRoughness),t.specularGlossiness=_(t.specularGlossiness,n.specularGlossiness),t.unlit=_(t.unlit,n.unlit),t.overridingTextures=_(t.overridingTextures,_.EMPTY_OBJECT),t.logger=_(t.logger,(function(e){console.log(e)})),t.inputUpAxis=_(t.inputUpAxis,n.inputUpAxis),t.outputUpAxis=_(t.outputUpAxis,n.outputUpAxis),t.triangleWindingOrderSanitization=_(t.triangleWindingOrderSanitization,n.triangleWindingOrderSanitization),!g(e))throw new b("objPath is required");if(t.metallicRoughness+t.specularGlossiness+t.unlit>1)throw new b("Only one material type may be set from [metallicRoughness, specularGlossiness, unlit].");if(g(t.overridingTextures.metallicRoughnessOcclusionTexture)&&g(t.overridingTextures.specularGlossinessTexture))throw new b("metallicRoughnessOcclusionTexture and specularGlossinessTexture cannot both be defined.");return g(t.overridingTextures.metallicRoughnessOcclusionTexture)&&(t.metallicRoughness=!0,t.specularGlossiness=!1,t.packOcclusion=!0),g(t.overridingTextures.specularGlossinessTexture)&&(t.metallicRoughness=!1,t.specularGlossiness=!0),Cc(e,t).then((function(e){return Fc(e,t)})).then((function(e){return Qc(e)}))}return el.defaults={binary:!1,separate:!1,separateTextures:!1,checkTransparency:!1,doubleSidedMaterial:!1,secure:!1,packOcclusion:!1,metallicRoughness:!1,specularGlossiness:!1,unlit:!1,inputUpAxis:"Y",outputUpAxis:"Y",windingOrderSanitization:!1},el}));
