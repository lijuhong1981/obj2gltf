var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var n,r,o={exports:{}},i={};var s,a,c,u={exports:{}};function l(){return a||(a=1,function(e){var o=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(c(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),a=r[n];n<i;a=r[++n])E(a)||!b(a)?s+=" "+a:s+=" "+c(a);return s},e.deprecate=function(n,r){if(T(t.process))return function(){return e.deprecate(n,r).apply(this,arguments)};if(!0===process.noDeprecation)return n;var o=!1;return function(){if(!o){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,a={};function c(t,n){var r={seen:[],stylize:f};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),T(r.showHidden)&&(r.showHidden=!1),T(r.depth)&&(r.depth=2),T(r.colors)&&(r.colors=!1),T(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),p(r,t,r.depth)}function l(t,e){var n=c.styles[e];return n?"["+c.colors[n][0]+"m"+t+"["+c.colors[n][1]+"m":t}function f(t,e){return t}function p(t,n,r){if(t.customInspect&&n&&A(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return g(o)||(o=p(t,o,r)),o}var i=function(t,e){if(T(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(E(e))return t.stylize("null","null")}(t,n);if(i)return i;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),R(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(A(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(O(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(v(n))return t.stylize(Date.prototype.toString.call(n),"date");if(R(n))return h(n)}var u,l="",f=!1,b=["{","}"];(y(n)&&(f=!0,b=["[","]"]),A(n))&&(l=" [Function"+(n.name?": "+n.name:"")+"]");return O(n)&&(l=" "+RegExp.prototype.toString.call(n)),v(n)&&(l=" "+Date.prototype.toUTCString.call(n)),R(n)&&(l=" "+h(n)),0!==s.length||f&&0!=n.length?r<0?O(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=f?function(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)N(e,String(s))?i.push(_(t,e,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(_(t,e,n,r,o,!0))})),i}(t,n,r,a,s):s.map((function(e){return _(t,n,r,a,e,f)})),t.seen.pop(),function(t,e,n){var r=t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,l,b)):b[0]+l+b[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function _(t,e,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),N(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(c.value)<0?(a=E(n)?p(t,c.value,null):p(t,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),T(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function y(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function E(t){return null===t}function m(t){return"number"==typeof t}function g(t){return"string"==typeof t}function T(t){return void 0===t}function O(t){return b(t)&&"[object RegExp]"===x(t)}function b(t){return"object"==typeof t&&null!==t}function v(t){return b(t)&&"[object Date]"===x(t)}function R(t){return b(t)&&("[object Error]"===x(t)||t instanceof Error)}function A(t){return"function"==typeof t}function x(t){return Object.prototype.toString.call(t)}function w(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(T(i)&&(i=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=process.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=y,e.isBoolean=d,e.isNull=E,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=T,e.isRegExp=O,e.isObject=b,e.isDate=v,e.isError=R,e.isFunction=A,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r?n:(r=1,n=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8});var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[w(t.getHours()),w(t.getMinutes()),w(t.getSeconds())].join(":"),[t.getDate(),S[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=(s||(s=1,"function"==typeof Object.create?u.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:u.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}),u.exports),e._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}(i)),i}var f,p=function(){if(c)return o.exports;c=1;var t="win32"===process.platform,e=l();function n(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():e&&n.push(".."):n.push(o))}return n}function r(t){for(var e=t.length-1,n=0;n<=e&&!t[n];n++);for(var r=e;r>=0&&!t[r];r--);return 0===n&&r===e?t:n>r?[]:t.slice(n,r+1)}var i=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,s=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,a={};function u(t){var e=i.exec(t),n=(e[1]||"")+(e[2]||""),r=e[3]||"",o=s.exec(r);return[n,o[1],o[2],o[3]]}function f(t){var e=i.exec(t),n=e[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!e[2],tail:e[3]}}function p(t){return"\\\\"+t.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}a.resolve=function(){for(var t="",r="",o=!1,i=arguments.length-1;i>=-1;i--){var s;if(i>=0?s=arguments[i]:t?(s=process.env["="+t])&&s.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(s=t+"\\"):s=process.cwd(),!e.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var a=f(s),c=a.device,u=a.isUnc,l=a.isAbsolute,h=a.tail;if((!c||!t||c.toLowerCase()===t.toLowerCase())&&(t||(t=c),o||(r=h+"\\"+r,o=l),t&&o))break}}return u&&(t=p(t)),t+(o?"\\":"")+(r=n(r.split(/[\\\/]+/),!o).join("\\"))||"."},a.normalize=function(t){var e=f(t),r=e.device,o=e.isUnc,i=e.isAbsolute,s=e.tail,a=/[\\\/]$/.test(s);return(s=n(s.split(/[\\\/]+/),!i).join("\\"))||i||(s="."),s&&a&&(s+="\\"),o&&(r=p(r)),r+(i?"\\":"")+s},a.isAbsolute=function(t){return f(t).isAbsolute},a.join=function(){for(var t=[],n=0;n<arguments.length;n++){var r=arguments[n];if(!e.isString(r))throw new TypeError("Arguments to path.join must be strings");r&&t.push(r)}var o=t.join("\\");return/^[\\\/]{2}[^\\\/]/.test(t[0])||(o=o.replace(/^[\\\/]{2,}/,"\\")),a.normalize(o)},a.relative=function(t,e){t=a.resolve(t),e=a.resolve(e);for(var n=t.toLowerCase(),o=e.toLowerCase(),i=r(e.split("\\")),s=r(n.split("\\")),c=r(o.split("\\")),u=Math.min(s.length,c.length),l=u,f=0;f<u;f++)if(s[f]!==c[f]){l=f;break}if(0==l)return e;var p=[];for(f=l;f<s.length;f++)p.push("..");return(p=p.concat(i.slice(l))).join("\\")},a._makeLong=function(t){if(!e.isString(t))return t;if(!t)return"";var n=a.resolve(t);return/^[a-zA-Z]\:\\/.test(n)?"\\\\?\\"+n:/^\\\\[^?.]/.test(n)?"\\\\?\\UNC\\"+n.substring(2):t},a.dirname=function(t){var e=u(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},a.basename=function(t,e){var n=u(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},a.extname=function(t){return u(t)[3]},a.format=function(t){if(!e.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var n=t.root||"";if(!e.isString(n))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);var r=t.dir,o=t.base||"";return r?r[r.length-1]===a.sep?r+o:r+a.sep+o:o},a.parse=function(t){if(!e.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var n=u(t);if(!n||4!==n.length)throw new TypeError("Invalid path '"+t+"'");return{root:n[0],dir:n[0]+n[1].slice(0,-1),base:n[2],ext:n[3],name:n[2].slice(0,n[2].length-n[3].length)}},a.sep="\\",a.delimiter=";";var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,_={};function y(t){return h.exec(t).slice(1)}return _.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var i=o>=0?arguments[o]:process.cwd();if(!e.isString(i))throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,r="/"===i[0])}return(r?"/":"")+(t=n(t.split("/"),!r).join("/"))||"."},_.normalize=function(t){var e=_.isAbsolute(t),r=t&&"/"===t[t.length-1];return(t=n(t.split("/"),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t},_.isAbsolute=function(t){return"/"===t.charAt(0)},_.join=function(){for(var t="",n=0;n<arguments.length;n++){var r=arguments[n];if(!e.isString(r))throw new TypeError("Arguments to path.join must be strings");r&&(t+=t?"/"+r:r)}return _.normalize(t)},_.relative=function(t,e){t=_.resolve(t).substr(1),e=_.resolve(e).substr(1);for(var n=r(t.split("/")),o=r(e.split("/")),i=Math.min(n.length,o.length),s=i,a=0;a<i;a++)if(n[a]!==o[a]){s=a;break}var c=[];for(a=s;a<n.length;a++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},_._makeLong=function(t){return t},_.dirname=function(t){var e=y(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},_.basename=function(t,e){var n=y(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},_.extname=function(t){return y(t)[3]},_.format=function(t){if(!e.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var n=t.root||"";if(!e.isString(n))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);return(t.dir?t.dir+_.sep:"")+(t.base||"")},_.parse=function(t){if(!e.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var n=y(t);if(!n||4!==n.length)throw new TypeError("Invalid path '"+t+"'");return n[1]=n[1]||"",n[2]=n[2]||"",n[3]=n[3]||"",{root:n[0],dir:n[0]+n[1].slice(0,-1),base:n[2],ext:n[3],name:n[2].slice(0,n[2].length-n[3].length)}},_.sep="/",_.delimiter=":",o.exports=t?a:_,o.exports.posix=_,o.exports.win32=a,o.exports}(),h=e(p),_={exports:{}};var y=(f||(f=1,_.exports=function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof _dereq_&&_dereq_;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,(function(t){var n=e[s][1][t];return o(n||t)}),l,l.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(t,e,n){var r;try{throw new Error}catch(t){r=t}var o=t("./schedule"),i=t("./queue");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._haveDrainedQueues=!1;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=o}function a(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function c(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function u(t){this._normalQueue._pushOne(t),this._queueTick()}function l(t){for(;t.length()>0;)f(t)}function f(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var n=t.shift(),r=t.shift();e.call(n,r)}}s.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},s.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.prototype.invokeLater=a,s.prototype.invoke=c,s.prototype.settlePromises=u,s.prototype._drainQueues=function(){l(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,l(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},e.exports=s,e.exports.firstLineError=r},{"./queue":26,"./schedule":29}],3:[function(t,e,n){e.exports=function(t,e,n,r){var o=!1,i=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(i,i,null,this,t)},a=function(t,e){50397184&this._bitField||this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(i){o||(o=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var u=n(i),l=new t(e);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(u),u instanceof t){var p={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:u};f._then(e,s,void 0,l,p),u._then(a,c,void 0,l,p),l._setOnCancel(u)}else l._resolveCallback(f);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return!(2097152&~this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){var r;function o(){try{Promise===i&&(Promise=r)}catch(t){}return i}"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=o,e.exports=i},{"./promise":22}],5:[function(t,e,n){var r=Object.create;if(r){var o=r(null),i=r(null);o[" size"]=i[" size"]=0}e.exports=function(e){var n,r=t("./util"),o=r.canEvaluate;function i(t,n){var o;if(null!=t&&(o=t[n]),"function"!=typeof o){var i="Object "+r.classString(t)+" has no method '"+r.toString(n)+"'";throw new e.TypeError(i)}return o}function s(t){return i(t,this.pop()).apply(t,this)}function a(t){return t[this]}function c(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}r.isIdentifier,e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(s,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=c;else if(o){var r=n(t);e=null!==r?r:a}else e=a;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){e.exports=function(e,n,r,o){var i=t("./util"),s=i.tryCatch,a=i.errorObj,c=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(i.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){e.exports=function(e){var n=t("./util"),r=t("./es5").keys,o=n.tryCatch,i=n.errorObj;function s(t,s,a){return function(c){var u=a._boundValue();t:for(var l=0;l<t.length;++l){var f=t[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(c instanceof f)return o(s).call(u,c)}else if("function"==typeof f){var p=o(f).call(u,c);if(p===i)return p;if(p)return o(s).call(u,c)}else if(n.isObject(c)){for(var h=r(f),_=0;_<h.length;++_){var y=h[_];if(f[y]!=c[y])continue t}return o(s).call(u,c)}}return e}}return s}},{"./es5":13,"./util":36}],8:[function(t,e,n){e.exports=function(t){var e=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function o(){if(e)return new r}function i(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},r.CapturedTrace=null,r.create=o,r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,c=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=c,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},r}},{}],9:[function(t,e,n){e.exports=function(e,n,r,o){var i,s,a,c,u=e._async,l=t("./errors").Warning,f=t("./util"),p=t("./es5"),h=f.canAttachTrace,_=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,y=/\((?:timers\.js):\d+:\d+\)/,d=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,E=null,m=null,g=!1,T=!(0==f.env("BLUEBIRD_DEBUG")),O=!(0==f.env("BLUEBIRD_WARNINGS")||!T&&!f.env("BLUEBIRD_WARNINGS")),b=!(0==f.env("BLUEBIRD_LONG_STACK_TRACES")||!T&&!f.env("BLUEBIRD_LONG_STACK_TRACES")),v=0!=f.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(O||!!f.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var t=[];function n(){for(var e=0;e<t.length;++e)t[e]._notifyUnhandledRejection();r()}function r(){t.length=0}c=function(e){t.push(e),setTimeout(n,1)},p.defineProperty(e,"_unhandledRejectionCheck",{value:n}),p.defineProperty(e,"_unhandledRejectionClear",{value:r})}(),e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){524288&this._bitField||(this._setRejectionIsUnhandled(),c(this))},e.prototype._notifyUnhandledRejectionIsHandled=function(){tt("rejectionHandled",i,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return!!(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),tt("unhandledRejection",s,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return q(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var n=e._getContext();s=f.contextBind(n,t)},e.onUnhandledRejectionHandled=function(t){var n=e._getContext();i=f.contextBind(n,t)};var R=function(){};e.longStackTraces=function(){if(u.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!lt.longStackTraces&&rt()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace,o=e.prototype._dereferenceTrace;lt.longStackTraces=!0,R=function(){if(u.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,e.prototype._dereferenceTrace=o,n.deactivateLongStackTraces(),lt.longStackTraces=!1},e.prototype._captureStackTrace=z,e.prototype._attachExtraTrace=G,e.prototype._dereferenceTrace=H,n.activateLongStackTraces()}},e.hasLongStackTraces=function(){return lt.longStackTraces&&rt()};var A={unhandledrejection:{before:function(){var t=f.global.onunhandledrejection;return f.global.onunhandledrejection=null,t},after:function(t){f.global.onunhandledrejection=t}},rejectionhandled:{before:function(){var t=f.global.onrejectionhandled;return f.global.onrejectionhandled=null,t},after:function(t){f.global.onrejectionhandled=t}}},x=function(){var t=function(t,e){if(!t)return!f.global.dispatchEvent(e);var n;try{return n=t.before(),!f.global.dispatchEvent(e)}finally{t.after(n)}};try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return f.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new CustomEvent(e,{detail:n,cancelable:!0});return p.defineProperty(r,"promise",{value:n.promise}),p.defineProperty(r,"reason",{value:n.reason}),t(A[e],r)}}return"function"==typeof Event?(e=new Event("CustomEvent"),f.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new Event(e,{cancelable:!0});return r.detail=n,p.defineProperty(r,"promise",{value:n.promise}),p.defineProperty(r,"reason",{value:n.reason}),t(A[e],r)}):((e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),f.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),t(A[e],r)})}catch(t){}return function(){return!1}}(),w=f.isNode?function(){return process.emit.apply(process,arguments)}:f.global?function(t){var e="on"+t.toLowerCase(),n=f.global[e];return!!n&&(n.apply(f.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function S(t,e){return{promise:e}}var N={promiseCreated:S,promiseFulfilled:S,promiseRejected:S,promiseResolved:S,promiseCancelled:S,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:S},C=function(t){var e=!1;try{e=w.apply(null,arguments)}catch(t){u.throwLater(t),e=!0}var n=!1;try{n=x(t,N[t].apply(null,arguments))}catch(t){u.throwLater(t),n=!0}return n||e};function I(){return!1}function j(t,e,n){var r=this;try{t(e,n,(function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+f.toString(t));r._attachCancellationCallback(t)}))}catch(t){return t}}function M(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?f.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function F(){return this._onCancelField}function U(t){this._onCancelField=t}function P(){this._cancellationParent=void 0,this._onCancelField=void 0}function L(t,e){if(1&e){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}2&e&&t._isBound()&&this._setBoundTo(t._boundTo)}function B(t,e){2&e&&t._isBound()&&this._setBoundTo(t._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&R()),"warnings"in t){var n=t.warnings;lt.warnings=!!n,v=lt.warnings,f.isObject(n)&&"wForgottenReturn"in n&&(v=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!lt.cancellation){if(u.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=P,e.prototype._propagateFrom=L,e.prototype._onCancel=F,e.prototype._setOnCancel=U,e.prototype._attachCancellationCallback=M,e.prototype._execute=j,D=L,lt.cancellation=!0}if("monitoring"in t&&(t.monitoring&&!lt.monitoring?(lt.monitoring=!0,e.prototype._fireEvent=C):!t.monitoring&&lt.monitoring&&(lt.monitoring=!1,e.prototype._fireEvent=I)),"asyncHooks"in t&&f.nodeSupportsAsyncResource){var i=lt.asyncHooks,s=!!t.asyncHooks;i!==s&&(lt.asyncHooks=s,s?r():o())}return e},e.prototype._fireEvent=I,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var D=B;function k(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function z(){this._trace=new ct(this._peekContext())}function G(t,e){if(h(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=Q(t);f.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),f.notEnumerableProp(t,"__stackCleaned__",!0)}}}function H(){this._trace=void 0}function V(t,e,n,r,o){if(void 0===t&&null!==e&&v){if(void 0!==o&&o._returnedNonUndefined())return;if(!(65535&r._bitField))return;n&&(n+=" ");var i="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),c=K(a),u=c.length-1;u>=0;--u){var l=c[u];if(!y.test(l)){var f=l.match(d);f&&(i="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(c.length>0){var p=c[0];for(u=0;u<a.length;++u)if(a[u]===p){u>0&&(s="\n"+a[u-1]);break}}}var h="a promise was created in a "+n+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(h,!0,e)}}function X(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),q(n)}function q(t,n,r){if(lt.warnings){var o,i=new l(t);if(n)r._attachExtraTrace(i);else if(lt.longStackTraces&&(o=e._peekContext()))o.attachExtraTrace(i);else{var s=Q(i);i.stack=s.message+"\n"+s.stack.join("\n")}C("warning",i)||J(i,"",!0)}}function Y(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function W(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function $(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],o=e.length-1,i=e[o],s=-1,a=r.length-1;a>=0;--a)if(r[a]===i){s=a;break}for(a=s;a>=0;--a){var c=r[a];if(e[o]!==c)break;e.pop(),o--}e=r}}function K(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],o="    (No stack trace)"===r||E.test(r),i=o&&ot(r);o&&!i&&(g&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function Z(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||E.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function Q(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?Z(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:K(e)}}function J(t,e,n){if("undefined"!=typeof console){var r;if(f.isObject(t)){var o=t.stack;r=e+m(o,t)}else r=e+String(t);"function"==typeof a?a(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function tt(t,e,n,r){var o=!1;try{"function"==typeof e&&(o=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){u.throwLater(t)}"unhandledRejection"===t?C(t,n,r)||o||J(n,"Unhandled rejection "):C(t,r)}function et(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{if(e=t&&"function"==typeof t.toString?t.toString():f.toString(t),/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+nt(e)+">, no stack trace)"}function nt(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function rt(){return"function"==typeof ut}var ot=function(){return!1},it=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function st(t){var e=t.match(it);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function at(t,e){if(rt()){for(var n,r,o=(t.stack||"").split("\n"),i=(e.stack||"").split("\n"),s=-1,a=-1,c=0;c<o.length;++c)if(u=st(o[c])){n=u.fileName,s=u.line;break}for(c=0;c<i.length;++c){var u;if(u=st(i[c])){r=u.fileName,a=u.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||(ot=function(t){if(_.test(t))return!0;var e=st(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}}function ct(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);ut(this,ct),e>32&&this.uncycle()}f.inherits(ct,Error),n.CapturedTrace=ct,ct.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,o=this;void 0!==o;++r)e.push(o),o=o._parent;for(r=(t=this._length=r)-1;r>=0;--r){var i=e[r].stack;void 0===n[i]&&(n[i]=r)}for(r=0;r<t;++r){var s=n[e[r].stack];if(void 0!==s&&s!==r){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var a=r>0?e[r-1]:this;s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var c=a._length+1,u=r-2;u>=0;--u)e[u]._length=c,c++;return}}}},ct.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=Q(t),n=e.message,r=[e.stack],o=this;void 0!==o;)r.push(K(o.stack.split("\n"))),o=o._parent;$(r),W(r),f.notEnumerableProp(t,"stack",Y(n,r)),f.notEnumerableProp(t,"__stackCleaned__",!0)}};var ut=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():et(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,E=t,m=e;var n=Error.captureStackTrace;return ot=function(t){return _.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return E=/@/,m=e,g=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r="stack"in t}return!("stack"in o)&&r&&"number"==typeof Error.stackTraceLimit?(E=t,m=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6}):(m=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?et(e):e.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(a=function(t){console.warn(t)},f.isNode&&process.stderr.isTTY?a=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:f.isNode||"string"!=typeof(new Error).stack||(a=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var lt={warnings:O,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return b&&e.longStackTraces(),{asyncHooks:function(){return lt.asyncHooks},longStackTraces:function(){return lt.longStackTraces},warnings:function(){return lt.warnings},cancellation:function(){return lt.cancellation},monitoring:function(){return lt.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return k},checkForgottenReturns:V,setBounds:at,warn:q,deprecated:X,CapturedTrace:ct,fireDomEvent:x,fireGlobalEvent:w}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(t,e,n){e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var o=function(){return r};return this.caught(n,o)}}},{}],11:[function(t,e,n){e.exports=function(t,e){var n=t.reduce,r=t.all;function o(){return r(this)}function i(t,r){return n(t,r,e,e)}t.prototype.each=function(t){return n(this,t,e,0)._then(o,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,r){return n(t,r,e,0)._then(o,void 0,void 0,t,void 0)},t.mapSeries=i}},{}],12:[function(t,e,n){var r,o,i=t("./es5"),s=i.freeze,a=t("./util"),c=a.inherits,u=a.notEnumerableProp;function l(t,e){function n(r){if(!(this instanceof n))return new n(r);u(this,"message","string"==typeof r?r:e),u(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return c(n,Error),n}var f=l("Warning","warning"),p=l("CancellationError","cancellation error"),h=l("TimeoutError","timeout error"),_=l("AggregateError","aggregate error");try{r=TypeError,o=RangeError}catch(t){r=l("TypeError","type error"),o=l("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),d=0;d<y.length;++d)"function"==typeof Array.prototype[y[d]]&&(_.prototype[y[d]]=Array.prototype[y[d]]);i.defineProperty(_.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),_.prototype.isOperational=!0;var E=0;function m(t){if(!(this instanceof m))return new m(t);u(this,"name","OperationalError"),u(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(u(this,"message",t.message),u(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_.prototype.toString=function(){var t=Array(4*E+1).join(" "),e="\n"+t+"AggregateError of:\n";E++,t=Array(4*E+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",o=r.split("\n"),i=0;i<o.length;++i)o[i]=t+o[i];e+=(r=o.join("\n"))+"\n"}return E--,e},c(m,Error);var g=Error.__BluebirdErrorTypes__;g||(g=s({CancellationError:p,TimeoutError:h,OperationalError:m,RejectionError:m,AggregateError:_}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:o,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,i={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)o.call(t,n)&&e.push(n);return e},c=function(t,e){return{value:t[e]}},u=function(t,e,n){return t[e]=n.value,t},l=function(t){return t},f=function(t){try{return Object(t).constructor.prototype}catch(t){return s}},p=function(t){try{return"[object Array]"===i.call(t)}catch(t){return!1}};e.exports={isArray:p,keys:a,names:a,defineProperty:u,getDescriptor:c,freeze:l,getPrototypeOf:f,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,o){return n(t,r,o,e)}}},{}],15:[function(t,e,n){e.exports=function(e,n,r){var o=t("./util"),i=e.CancellationError,s=o.errorObj,a=t("./catch_filter")(r);function c(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function u(t){this.finallyHandler=t}function l(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function f(){return h.call(this,this.promise._target()._settledValue())}function p(t){if(!l(this,t))return s.e=t,s}function h(t){var o=this.promise,a=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?a.call(o._boundValue()):a.call(o._boundValue(),t);if(c===r)return c;if(void 0!==c){o._setReturnedNonUndefined();var h=n(c,o);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var _=new i("late cancellation observer");return o._attachExtraTrace(_),s.e=_,s}h.isPending()&&h._attachCancellationCallback(new u(this))}return h._then(f,p,void 0,this,void 0)}}}return o.isRejected()?(l(this),s.e=t,s):(l(this),t)}return c.prototype.isFinallyHandler=function(){return 0===this.type},u.prototype._resultCancelled=function(){l(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new c(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,h,h)},e.prototype.tap=function(t){return this._passThrough(t,1,h)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,h);var r,i=new Array(n-1),s=0;for(r=0;r<n-1;++r){var c=arguments[r];if(!o.isObject(c))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(c)));i[s++]=c}i.length=s;var u=arguments[r];return this._passThrough(a(i,u,this),1,void 0,h)},c}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){e.exports=function(e,n,r,o,i,s){var a=t("./errors").TypeError,c=t("./util"),u=c.errorObj,l=c.tryCatch,f=[];function p(t,n,r){for(var i=0;i<n.length;++i){r._pushContext();var s=l(n[i])(t);if(r._popContext(),s===u){r._pushContext();var a=e.reject(u.e);return r._popContext(),a}var c=o(s,r);if(c instanceof e)return c}return null}function h(t,n,o,i){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly((function(){return c})),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new e(r))._captureStackTrace();this._stack=i,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}c.inherits(h,i),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=l(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},h.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=l(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=l(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(t){var n=this._promise;if(t===u)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var i=o(r,this._promise);if(i instanceof e||null!==(i=p(i,this._yieldHandlers,this._promise))){var s=(i=i._target())._bitField;50397184&s?33554432&s?e._async.invoke(this._promiseFulfilled,this,i._value()):16777216&s?e._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled():(this._yieldedPromise=i,i._proxy(this,null))}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=h,o=(new Error).stack;return function(){var e=t.apply(this,arguments),i=new r(void 0,void 0,n,o),s=i.promise();return i._generator=e,i._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new a("expecting a function but got "+c.classString(t));f.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new h(t,this),o=r.promise();return r._run(e.spawn),o}}},{"./errors":12,"./util":36}],17:[function(t,e,n){e.exports=function(e,n,r,o,i){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj,e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var o=new n(r).promise();return void 0!==t?o.spread(t):o}}},{"./util":36}],18:[function(t,e,n){e.exports=function(e,n,r,o,i,s){var a=t("./util"),c=a.tryCatch,u=a.errorObj,l=e._async;function f(t,n,r,o){this.constructor$(t),this._promise._captureStackTrace();var s=e._getContext();if(this._callback=a.contextBind(s,n),this._preservedValues=o===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0),a.isArray(t))for(var c=0;c<t.length;++c){var u=t[c];u instanceof e&&u.suppressUnhandledRejections()}}function p(t,n,o,i){if("function"!=typeof n)return r("expecting a function but got "+a.classString(n));var s=0;if(void 0!==o){if("object"!=typeof o||null===o)return e.reject(new TypeError("options argument must be an object but it is "+a.classString(o)));if("number"!=typeof o.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(o.concurrency)));s=o.concurrency}return new f(t,n,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,i).promise()}a.inherits(f,n),f.prototype._asyncInit=function(){this._init$(void 0,-2)},f.prototype._init=function(){},f.prototype._promiseFulfilled=function(t,n){var r=this._values,i=this.length(),a=this._preservedValues,l=this._limit;if(n<0){if(r[n=-1*n-1]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var f=this._promise,p=this._callback,h=f._boundValue();f._pushContext();var _=c(p).call(h,t,n,i),y=f._popContext();if(s.checkForgottenReturns(_,y,null!==a?"Promise.filter":"Promise.map",f),_===u)return this._reject(_.e),!0;var d=o(_,this._promise);if(d instanceof e){var E=(d=d._target())._bitField;if(!(50397184&E))return l>=1&&this._inFlight++,r[n]=d,d._proxy(this,-1*(n+1)),!1;if(!(33554432&E))return 16777216&E?(this._reject(d._reason()),!0):(this._cancel(),!0);_=d._value()}r[n]=_}return++this._totalResolved>=i&&(null!==a?this._filter(r,a):this._resolve(r),!0)},f.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},f.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),o=0,i=0;i<n;++i)t[i]&&(r[o++]=e[i]);r.length=o,this._resolve(r)},f.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return p(this,t,e,null)},e.map=function(t,e,n,r){return p(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){e.exports=function(e,n,r,o,i){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var o=a(t).apply(this,arguments),s=r._popContext();return i.checkForgottenReturns(o,s,"Promise.method",r),r._resolveFromSyncValue(o),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return o("expecting a function but got "+s.classString(t));var r,c=new e(n);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];r=s.isArray(u)?a(t).apply(l,u):a(t).call(l,u)}else r=a(t)();var f=c._popContext();return i.checkForgottenReturns(r,f,"Promise.try",c),c._resolveFromSyncValue(r),c},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){var r=t("./util"),o=r.maybeWrapAsError,i=t("./errors").OperationalError,s=t("./es5");function a(t){return t instanceof Error&&s.getPrototypeOf(t)===Error.prototype}var c=/^(?:name|message|stack|cause)$/;function u(t){var e;if(a(t)){(e=new i(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=s.keys(t),o=0;o<n.length;++o){var u=n[o];c.test(u)||(e[u]=t[u])}return e}return r.markAsOriginatingFromRejection(t),t}function l(t,e){return function(n,r){if(null!==t){if(n){var i=u(o(n));t._attachExtraTrace(i),t._reject(i)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}e.exports=l},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){e.exports=function(e){var n=t("./util"),r=e._async,o=n.tryCatch,i=n.errorObj;function s(t,e){var s=this;if(!n.isArray(t))return a.call(s,t,e);var c=o(e).apply(s._boundValue(),[null].concat(t));c===i&&r.throwLater(c.e)}function a(t,e){var n=this._boundValue(),s=void 0===t?o(e).call(n,null):o(e).call(n,null,t);s===i&&r.throwLater(s.e)}function c(t,e){var n=this;if(!t){var s=new Error(t+"");s.cause=t,t=s}var a=o(e).call(n._boundValue(),t);a===i&&r.throwLater(a.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=a;void 0!==e&&Object(e).spread&&(n=s),this._then(n,c,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){e.exports=function(){var n=function(){return new T("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},r=function(){return new P.PromiseInspection(this._target())},o=function(t){return P.reject(new T(t))};function i(){}var s={},a=t("./util");a.setReflectHandler(r);var c=function(){var t=process.domain;return void 0===t?null:t},u=function(){return null},l=function(){return{domain:c(),async:null}},f=a.isNode&&a.nodeSupportsAsyncResource?t("async_hooks").AsyncResource:null,p=function(){return{domain:c(),async:new f("Bluebird::Promise")}},h=a.isNode?l:u;a.notEnumerableProp(P,"_getContext",h);var _=function(){h=p,a.notEnumerableProp(P,"_getContext",p)},y=function(){h=l,a.notEnumerableProp(P,"_getContext",l)},d=t("./es5"),E=t("./async"),m=new E;d.defineProperty(P,"_async",{value:m});var g=t("./errors"),T=P.TypeError=g.TypeError;P.RangeError=g.RangeError;var O=P.CancellationError=g.CancellationError;P.TimeoutError=g.TimeoutError,P.OperationalError=g.OperationalError,P.RejectionError=g.OperationalError,P.AggregateError=g.AggregateError;var b=function(){},v={},R={},A=t("./thenables")(P,b),x=t("./promise_array")(P,b,A,o,i),w=t("./context")(P),S=w.create,N=t("./debuggability")(P,w,_,y);N.CapturedTrace;var C=t("./finally")(P,A,R),I=t("./catch_filter")(R),j=t("./nodeback"),M=a.errorObj,F=a.tryCatch;function U(t,e){if(null==t||t.constructor!==P)throw new T("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new T("expecting a function but got "+a.classString(e))}function P(t){t!==b&&U(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function L(t){this.promise._resolveCallback(t)}function B(t){this.promise._rejectCallback(t,!1)}function D(t){var e=new P(b);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return P.prototype.toString=function(){return"[object Promise]"},P.prototype.caught=P.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;n<e-1;++n){var s=arguments[n];if(!a.isObject(s))return o("Catch statement predicate: expecting an object but got "+a.classString(s));r[i++]=s}if(r.length=i,"function"!=typeof(t=arguments[n]))throw new T("The last argument to .catch() must be a function, got "+a.toString(t));return this.then(void 0,I(r,t,this))}return this.then(void 0,t)},P.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},P.prototype.then=function(t,e){if(N.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+a.classString(t);arguments.length>1&&(n+=", "+a.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},P.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},P.prototype.spread=function(t){return"function"!=typeof t?o("expecting a function but got "+a.classString(t)):this.all()._then(t,void 0,void 0,v,void 0)},P.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},P.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new x(this).promise()},P.prototype.error=function(t){return this.caught(a.originatesFromRejection,t)},P.getNewLibraryCopy=e.exports,P.is=function(t){return t instanceof P},P.fromNode=P.fromCallback=function(t){var e=new P(b);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=F(t)(j(e,n));return r===M&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},P.all=function(t){return new x(t).promise()},P.cast=function(t){var e=A(t);return e instanceof P||((e=new P(b))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},P.resolve=P.fulfilled=P.cast,P.reject=P.rejected=function(t){var e=new P(b);return e._captureStackTrace(),e._rejectCallback(t,!0),e},P.setScheduler=function(t){if("function"!=typeof t)throw new T("expecting a function but got "+a.classString(t));return m.setScheduler(t)},P.prototype._then=function(t,e,n,r,o){var i=void 0!==o,s=i?o:new P(b),c=this._target(),u=c._bitField;i||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&2097152&this._bitField&&(r=50397184&u?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=h();if(50397184&u){var f,p,_=c._settlePromiseCtx;33554432&u?(p=c._rejectionHandler0,f=t):16777216&u?(p=c._fulfillmentHandler0,f=e,c._unsetRejectionIsUnhandled()):(_=c._settlePromiseLateCancellationObserver,p=new O("late cancellation observer"),c._attachExtraTrace(p),f=e),m.invoke(_,c,{handler:a.contextBind(l,f),promise:s,receiver:r,value:p})}else c._addCallbacks(t,e,s,r,l);return s},P.prototype._length=function(){return 65535&this._bitField},P.prototype._isFateSealed=function(){return!!(117506048&this._bitField)},P.prototype._isFollowing=function(){return!(67108864&~this._bitField)},P.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},P.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},P.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},P.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},P.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},P.prototype._isFinal=function(){return(4194304&this._bitField)>0},P.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},P.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},P.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},P.prototype._setAsyncGuaranteed=function(){if(!m.hasCustomScheduler()){var t=this._bitField;this._bitField=t|(536870912&t)>>2^134217728}},P.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&this._bitField|536870912},P.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==s)return void 0===e&&this._isBound()?this._boundValue():e},P.prototype._promiseAt=function(t){return this[4*t-4+2]},P.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},P.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},P.prototype._boundValue=function(){},P.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,o=t._receiverAt(0);void 0===o&&(o=s),this._addCallbacks(e,n,r,o,null)},P.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),o=t._promiseAt(e),i=t._receiverAt(e);void 0===i&&(i=s),this._addCallbacks(n,r,o,i,null)},P.prototype._addCallbacks=function(t,e,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=a.contextBind(o,t)),"function"==typeof e&&(this._rejectionHandler0=a.contextBind(o,e));else{var s=4*i-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=a.contextBind(o,t)),"function"==typeof e&&(this[s+1]=a.contextBind(o,e))}return this._setLength(i+1),i},P.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},P.prototype._resolveCallback=function(t,e){if(!(117506048&this._bitField)){if(t===this)return this._rejectCallback(n(),!1);var r=A(t,this);if(!(r instanceof P))return this._fulfill(t);e&&this._propagateFrom(r,2);var o=r._target();if(o!==this){var i=o._bitField;if(50397184&i)if(33554432&i)this._fulfill(o._value());else if(16777216&i)this._reject(o._reason());else{var s=new O("late cancellation observer");o._attachExtraTrace(s),this._reject(s)}else{var a=this._length();a>0&&o._migrateCallback0(this);for(var c=1;c<a;++c)o._migrateCallbackAt(this,c);this._setFollowing(),this._setLength(0),this._setFollowee(r)}}else this._reject(n())}},P.prototype._rejectCallback=function(t,e,n){var r=a.ensureErrorObject(t),o=r===t;if(!o&&!n&&N.warnings()){var i="a promise was rejected with a non-error: "+a.classString(t);this._warn(i,!0)}this._attachExtraTrace(r,!!e&&o),this._reject(t)},P.prototype._resolveFromExecutor=function(t){if(t!==b){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,(function(t){e._resolveCallback(t)}),(function(t){e._rejectCallback(t,n)}));n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},P.prototype._settlePromiseFromHandler=function(t,e,n,r){var o=r._bitField;if(!(65536&o)){var i;r._pushContext(),e===v?n&&"number"==typeof n.length?i=F(t).apply(this._boundValue(),n):(i=M).e=new T("cannot .spread() a non-array: "+a.classString(n)):i=F(t).call(e,n);var s=r._popContext();65536&(o=r._bitField)||(i===R?r._reject(n):i===M?r._rejectCallback(i.e,!1):(N.checkForgottenReturns(i,s,"",r,this),r._resolveCallback(i)))}},P.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},P.prototype._followee=function(){return this._rejectionHandler0},P.prototype._setFollowee=function(t){this._rejectionHandler0=t},P.prototype._settlePromise=function(t,e,n,o){var s=t instanceof P,a=this._bitField,c=!!(134217728&a);65536&a?(s&&t._invokeInternalOnCancel(),n instanceof C&&n.isFinallyHandler()?(n.cancelPromise=t,F(e).call(n,o)===M&&t._reject(M.e)):e===r?t._fulfill(r.call(n)):n instanceof i?n._promiseCancelled(t):s||t instanceof x?t._cancel():n.cancel()):"function"==typeof e?s?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,o,t)):e.call(n,o,t):n instanceof i?n._isResolved()||(33554432&a?n._promiseFulfilled(o,t):n._promiseRejected(o,t)):s&&(c&&t._setAsyncGuaranteed(),33554432&a?t._fulfill(o):t._reject(o))},P.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,o=t.value;"function"==typeof e?n instanceof P?this._settlePromiseFromHandler(e,r,o,n):e.call(r,o,n):n instanceof P&&n._reject(o)},P.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},P.prototype._settlePromise0=function(t,e,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,o,e)},P.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},P.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(134217728&e?this._settlePromises():m.settlePromises(this),this._dereferenceTrace())}},P.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return m.fatalError(t,a.isNode);(65535&e)>0?m.settlePromises(this):this._ensurePossibleRejectionHandled()}},P.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,e)}},P.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,e)}},P.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(16842752&t){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},P.prototype._settledValue=function(){var t=this._bitField;return 33554432&t?this._rejectionHandler0:16777216&t?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&d.defineProperty(P.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),P.defer=P.pending=function(){return N.deprecated("Promise.defer","new Promise"),{promise:new P(b),resolve:L,reject:B}},a.notEnumerableProp(P,"_makeSelfResolutionError",n),t("./method")(P,b,A,o,N),t("./bind")(P,b,A,N),t("./cancel")(P,x,o,N),t("./direct_resolve")(P),t("./synchronous_inspection")(P),t("./join")(P,x,A,b,m),P.Promise=P,P.version="3.7.2",t("./call_get.js")(P),t("./generators.js")(P,o,b,A,i,N),t("./map.js")(P,x,o,A,b,N),t("./nodeify.js")(P),t("./promisify.js")(P,b),t("./props.js")(P,x,A,o),t("./race.js")(P,b,A,o),t("./reduce.js")(P,x,o,A,b,N),t("./settle.js")(P,x,N),t("./some.js")(P,x,o),t("./timers.js")(P,b,N),t("./using.js")(P,o,A,S,b,N),t("./any.js")(P),t("./each.js")(P,b),t("./filter.js")(P,b),a.toFastProperties(P),a.toFastProperties(P.prototype),D({a:1}),D({b:2}),D({c:3}),D(1),D((function(){})),D(void 0),D(!1),D(new P(b)),N.setBounds(E.firstLineError,a.lastLineError),P}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(t,e,n){e.exports=function(e,n,r,o,i){var s=t("./util");function a(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function c(t){var r=this._promise=new e(n);t instanceof e&&(r._propagateFrom(t,3),t.suppressUnhandledRejections()),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.isArray,s.inherits(c,i),c.prototype.length=function(){return this._length},c.prototype.promise=function(){return this._promise},c.prototype._init=function t(n,i){var c=r(this._values,this._promise);if(c instanceof e){var u=(c=c._target())._bitField;if(this._values=c,!(50397184&u))return this._promise._setAsyncGuaranteed(),c._then(t,this._reject,void 0,this,i);if(!(33554432&u))return 16777216&u?this._reject(c._reason()):this._cancel();c=c._value()}if(null!==(c=s.asArray(c)))0!==c.length?this._iterate(c):-5===i?this._resolveEmptyArray():this._resolve(a(i));else{var l=o("expecting an array or an iterable object but got "+s.classString(c)).reason();this._promise._rejectCallback(l,!1)}},c.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,s=null,a=0;a<n;++a){var c=r(t[a],o);s=c instanceof e?(c=c._target())._bitField:null,i?null!==s&&c.suppressUnhandledRejections():null!==s?50397184&s?i=33554432&s?this._promiseFulfilled(c._value(),a):16777216&s?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):(c._proxy(this,a),this._values[a]=c):i=this._promiseFulfilled(c,a)}i||o._setAsyncGuaranteed()},c.prototype._isResolved=function(){return null===this._values},c.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},c.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},c.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},c.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},c.prototype._promiseCancelled=function(){return this._cancel(),!0},c.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},c.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},c.prototype.shouldCopyValues=function(){return!0},c.prototype.getActualLength=function(t){return t},c}},{"./util":36}],24:[function(t,e,n){e.exports=function(e,n){var r={},o=t("./util"),i=t("./nodeback"),s=o.withAppended,a=o.maybeWrapAsError,c=o.canEvaluate,u=t("./errors").TypeError,l="Async",f={__isPromisified__:!0},p=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(t){return o.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function _(t){return!p.test(t)}function y(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function d(t,e,n){var r=o.getDataPropertyOrDefault(t,e+n,f);return!!r&&y(r)}function E(t,e,n){for(var r=0;r<t.length;r+=2){var o=t[r];if(n.test(o))for(var i=o.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===i)throw new u("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function m(t,e,n,r){for(var i=o.inheritedDataKeys(t),s=[],a=0;a<i.length;++a){var c=i[a],u=t[c],l=r===h||h(c);"function"!=typeof u||y(u)||d(t,c,e)||!r(c,u,t,l)||s.push(c,u)}return E(s,e,n),s}var g,T=function(t){return t.replace(/([$])/,"\\$")};function O(t,c,u,l,f,p){var h=function(){return this}(),_=t;function y(){var o=c;c===r&&(o=this);var u=new e(n);u._captureStackTrace();var l="string"==typeof _&&this!==h?this[_]:t,f=i(u,p);try{l.apply(o,s(arguments,f))}catch(t){u._rejectCallback(a(t),!0,!0)}return u._isFateSealed()||u._setAsyncGuaranteed(),u}return"string"==typeof _&&(t=l),o.notEnumerableProp(y,"__isPromisified__",!0),y}var b=c?g:O;function v(t,e,n,i,s){for(var a=new RegExp(T(e)+"$"),c=m(t,e,a,n),u=0,l=c.length;u<l;u+=2){var f=c[u],p=c[u+1],h=f+e;if(i===b)t[h]=b(f,r,f,p,e,s);else{var _=i(p,(function(){return b(f,r,f,p,e,s)}));o.notEnumerableProp(_,"__isPromisified__",!0),t[h]=_}}return o.toFastProperties(t),t}function R(t,e,n){return b(t,e,void 0,t,null,n)}e.promisify=function(t,e){if("function"!=typeof t)throw new u("expecting a function but got "+o.classString(t));if(y(t))return t;var n=R(t,void 0===(e=Object(e)).context?r:e.context,!!e.multiArgs);return o.copyDescriptors(t,n,_),n},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new u("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,r=e.suffix;"string"!=typeof r&&(r=l);var i=e.filter;"function"!=typeof i&&(i=h);var s=e.promisifier;if("function"!=typeof s&&(s=b),!o.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=o.inheritedDataKeys(t),c=0;c<a.length;++c){var f=t[a[c]];"constructor"!==a[c]&&o.isClass(f)&&(v(f.prototype,r,i,s,n),v(f,r,i,s,n))}return v(t,r,i,s,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){e.exports=function(e,n,r,o){var i,s=t("./util"),a=s.isObject,c=t("./es5");"function"==typeof Map&&(i=Map);var u=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var o=new Array(2*r.size);return r.forEach(n,o),o}}(),l=function(t){for(var e=new i,n=t.length/2|0,r=0;r<n;++r){var o=t[n+r],s=t[r];e.set(o,s)}return e};function f(t){var e,n=!1;if(void 0!==i&&t instanceof i)e=u(t),n=!0;else{var r=c.keys(t),o=r.length;e=new Array(2*o);for(var s=0;s<o;++s){var a=r[s];e[s]=t[a],e[s+o]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function p(t){var n,i=r(t);return a(i)?(n=i instanceof e?i._then(e.props,void 0,void 0,void 0,void 0):new f(i).promise(),i instanceof e&&n._propagateFrom(i,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(f,n),f.prototype._init=function(){},f.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=l(this._values);else{n={};for(var r=this.length(),o=0,i=this.length();o<i;++o)n[this._values[o+r]]=this._values[o]}return this._resolve(n),!0}return!1},f.prototype.shouldCopyValues=function(){return!1},f.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return p(this)},e.props=function(t){return p(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){function r(t,e,n,r,o){for(var i=0;i<o;++i)n[i+r]=t[i+e],t[i+e]=void 0}function o(t){this._capacity=t,this._length=0,this._front=0}o.prototype._willBeOverCapacity=function(t){return this._capacity<t},o.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},o.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=t,this[o+1&i]=e,this[o+2&i]=n,this._length=r},o.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},o.prototype.length=function(){return this._length},o.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},o.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,r(this,0,this,e,this._front+this._length&e-1)},e.exports=o},{}],27:[function(t,e,n){e.exports=function(e,n,r,o){var i=t("./util"),s=function(t){return t.then((function(e){return a(e,t)}))};function a(t,a){var c=r(t);if(c instanceof e)return s(c);if(null===(t=i.asArray(t)))return o("expecting an array or an iterable object but got "+i.classString(t));var u=new e(n);void 0!==a&&u._propagateFrom(a,3);for(var l=u._fulfill,f=u._reject,p=0,h=t.length;p<h;++p){var _=t[p];(void 0!==_||p in t)&&e.cast(_)._then(l,f,void 0,u,null)}return u}e.race=function(t){return a(t,void 0)},e.prototype.race=function(){return a(this,void 0)}}},{"./util":36}],28:[function(t,e,n){e.exports=function(e,n,r,o,i,s){var a=t("./util"),c=a.tryCatch;function u(t,n,r,o){this.constructor$(t);var s=e._getContext();this._fn=a.contextBind(s,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function f(t,e,n,o){return"function"!=typeof e?r("expecting a function but got "+a.classString(e)):new u(t,e,n,o).promise()}function p(t){this.accum=t,this.array._gotAccum(t);var n=o(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(h,void 0,void 0,this,void 0)):h.call(this,n)}function h(t){var n,r=this.array,o=r._promise,i=c(r._fn);o._pushContext(),(n=void 0!==r._eachValues?i.call(o._boundValue(),t,this.index,this.length):i.call(o._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var a=o._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",o),n}a.inherits(u,n),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==i&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(t){var n,r;this._values=t;var o=t.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n;for(var i=r;i<o;++i){var s=t[i];s instanceof e&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;r<o;++r){var a={accum:null,value:t[r],index:r,length:o,array:this};n=n._then(p,void 0,void 0,a,void 0),127&r||n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},e.prototype.reduce=function(t,e){return f(this,t,e,null)},e.reduce=function(t,e,n,r){return f(t,e,n,r)}}},{"./util":36}],29:[function(e,n,r){var o,i=e("./util"),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},a=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var c=t.setImmediate,u=process.nextTick;o=i.isRecentNode?function(e){c.call(t,e)}:function(t){u.call(process,t)}}else if("function"==typeof a&&"function"==typeof a.resolve){var l=a.resolve();o=function(t){l.then(t)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:s:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver((function(){t.classList.toggle("foo"),n=!1})).observe(r,e);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver((function(){r.disconnect(),n()}));r.observe(t,e),o()}}();n.exports=o},{"./util":36}],30:[function(t,e,n){e.exports=function(e,n,r){var o=e.PromiseInspection;function i(t){this.constructor$(t)}t("./util").inherits(i,n),i.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},i.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new i(t).promise()},e.allSettled=function(t){return new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){e.exports=function(e,n,r){var o=t("./util"),i=t("./errors").RangeError,s=t("./errors").AggregateError,a=o.isArray,c={};function u(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new u(t),o=n.promise();return n.setHowMany(e),n.init(),o}o.inherits(u,n),u.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=a(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(t){this._howMany=t},u.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},u.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},u.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},u.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(t){this._values.push(t)},u.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new i(e)},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return l(t,e)},e.prototype.some=function(t){return l(this,t)},e._SomePromiseArray=u}},{"./errors":12,"./util":36}],32:[function(t,e,n){e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=e.prototype.isFulfilled=function(){return!!(33554432&this._bitField)},i=e.prototype.isRejected=function(){return!!(16777216&this._bitField)},s=e.prototype.isPending=function(){return!(50397184&this._bitField)},a=e.prototype.isResolved=function(){return!!(50331648&this._bitField)};e.prototype.isCancelled=function(){return!!(8454144&this._bitField)},t.prototype.__isCancelled=function(){return!(65536&~this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return!!(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return i.call(this._target())},t.prototype.isFulfilled=function(){return o.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){e.exports=function(e,n){var r=t("./util"),o=r.errorObj,i=r.isObject;function s(t,r){if(i(t)){if(t instanceof e)return t;var s=c(t);if(s===o){r&&r._pushContext();var a=e.reject(s.e);return r&&r._popContext(),a}if("function"==typeof s)return l(t)?(a=new e(n),t._then(a._fulfill,a._reject,void 0,a,null),a):f(t,s,r)}return t}function a(t){return t.then}function c(t){try{return a(t)}catch(t){return o.e=t,o}}var u={}.hasOwnProperty;function l(t){try{return u.call(t,"_promise0")}catch(t){return!1}}function f(t,i,s){var a=new e(n),c=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var u=!0,l=r.tryCatch(i).call(t,f,p);function f(t){a&&(a._resolveCallback(t),a=null)}function p(t){a&&(a._rejectCallback(t,u,!0),a=null)}return u=!1,a&&l===o&&(a._rejectCallback(l.e,!0,!0),a=null),c}return s}},{"./util":36}],34:[function(t,e,n){e.exports=function(e,n,r){var o=t("./util"),i=e.TimeoutError;function s(t){this.handle=t}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(t){return c(+this).thenReturn(t)},c=e.delay=function(t,o){var i,c;return void 0!==o?(i=e.resolve(o)._then(a,null,null,t,void 0),r.cancellation()&&o instanceof e&&i._setOnCancel(o)):(i=new e(n),c=setTimeout((function(){i._fulfill()}),+t),r.cancellation()&&i._setOnCancel(new s(c)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};e.prototype.delay=function(t){return c(t,this)};var u=function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new i("operation timed out"):new i(e),o.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()};function l(t){return clearTimeout(this.handle),t}function f(t){throw clearTimeout(this.handle),t}e.prototype.timeout=function(t,e){var n,o;t=+t;var i=new s(setTimeout((function(){n.isPending()&&u(n,e,o)}),t));return r.cancellation()?(o=this.then(),(n=o._then(l,f,void 0,i,void 0))._setOnCancel(i)):n=this._then(l,f,void 0,i,void 0),n}}},{"./util":36}],35:[function(t,e,n){e.exports=function(e,n,r,o,i,s){var a=t("./util"),c=t("./errors").TypeError,u=t("./util").inherits,l=a.errorObj,f=a.tryCatch,p={};function h(t){setTimeout((function(){throw t}),0)}function _(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function y(t,n){var o=0,s=t.length,a=new e(i);function c(){if(o>=s)return a._fulfill();var i=_(t[o++]);if(i instanceof e&&i._isDisposable()){try{i=r(i._getDisposer().tryDispose(n),t.promise)}catch(t){return h(t)}if(i instanceof e)return i._then(c,h,null,null,null)}c()}return c(),a}function d(t,e,n){this._data=t,this._promise=e,this._context=n}function E(t,e,n){this.constructor$(t,e,n)}function m(t){return d.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function g(t){this.length=t,this.promise=null,this[t-1]=null}d.prototype.data=function(){return this._data},d.prototype.promise=function(){return this._promise},d.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():p},d.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==p?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},d.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},u(E,d),E.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},g.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var o,i=arguments[t-1];if("function"!=typeof i)return n("expecting a function but got "+a.classString(i));var c=!0;2===t&&Array.isArray(arguments[0])?(t=(o=arguments[0]).length,c=!1):(o=arguments,t--);for(var u=new g(t),p=0;p<t;++p){var h=o[p];if(d.isDisposer(h)){var _=h;(h=h.promise())._setDisposable(_)}else{var E=r(h);E instanceof e&&(h=E._then(m,null,null,{resources:u,index:p},void 0))}u[p]=h}var T=new Array(u.length);for(p=0;p<T.length;++p)T[p]=e.resolve(u[p]).reflect();var O=e.all(T).then((function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return l.e=n.error(),l;if(!n.isFulfilled())return void O.cancel();t[e]=n.value()}b._pushContext(),i=f(i);var r=c?i.apply(void 0,t):i(t),o=b._popContext();return s.checkForgottenReturns(r,o,"Promise.using",b),r})),b=O.lastly((function(){var t=new e.PromiseInspection(O);return y(u,t)}));return u.promise=b,b._setOnCancel(u),b},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new E(t,this,o());throw new c}}},{"./errors":12,"./util":36}],36:[function(e,n,r){var o,i=e("./es5"),s="undefined"==typeof navigator,a={e:{}},c="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==this?this:null;function u(){try{var t=o;return o=null,t.apply(this,arguments)}catch(t){return a.e=t,a}}function l(t){return o=t,u}var f=function(t,e){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}return r.prototype=e.prototype,t.prototype=new r,t.prototype};function p(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function h(t){return"function"==typeof t||"object"==typeof t&&null!==t}function _(t){return p(t)?new Error(x(t)):t}function y(t,e){var n,r=t.length,o=new Array(r+1);for(n=0;n<r;++n)o[n]=t[n];return o[n]=e,o}function d(t,e,n){if(!i.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function E(t,e,n){if(p(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return i.defineProperty(t,e,r),t}function m(t){throw t}var g=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(i.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],o=Object.create(null);null!=t&&!e(t);){var s;try{s=n(t)}catch(t){return r}for(var a=0;a<s.length;++a){var c=s[a];if(!o[c]){o[c]=!0;var u=Object.getOwnPropertyDescriptor(t,c);null!=u&&null==u.get&&null==u.set&&r.push(c)}}t=i.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var o=[];t:for(var i in n)if(r.call(n,i))o.push(i);else{for(var s=0;s<t.length;++s)if(r.call(t[s],i))continue t;o.push(i)}return o}}(),T=/this\s*\.\s*\S+\s*=/;function O(t){try{if("function"==typeof t){var e=i.names(t.prototype),n=i.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),o=T.test(t+"")&&i.names(t).length>0;if(n||r||o)return!0}return!1}catch(t){return!1}}function b(t){function e(){}e.prototype=t;var n=new e;function r(){return typeof n.foo}return r(),r(),t}var v=/^[a-z$_][a-z$_0-9]*$/i;function R(t){return v.test(t)}function A(t,e,n){for(var r=new Array(t),o=0;o<t;++o)r[o]=e+o+n;return r}function x(t){try{return t+""}catch(t){return"[no string representation]"}}function w(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function S(t){try{E(t,"isOperational",!0)}catch(t){}}function N(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function C(t){return w(t)&&i.propertyIsWritable(t,"stack")}var I="stack"in new Error?function(t){return C(t)?t:new Error(x(t))}:function(t){if(C(t))return t;try{throw new Error(x(t))}catch(t){return t}};function j(t){return{}.toString.call(t)}function M(t,e,n){for(var r=i.names(t),o=0;o<r.length;++o){var s=r[o];if(n(s))try{i.defineProperty(e,s,i.getDescriptor(t,s))}catch(t){}}}var F=function(t){return i.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var U="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};F=function(t){return i.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?U(t):null}}var P,L="undefined"!=typeof process&&"[object process]"===j(process).toLowerCase(),B="undefined"!=typeof process&&void 0!==process.env;function D(t){return B?process.env[t]:void 0}function k(){if("function"==typeof Promise)try{if("[object Promise]"===j(new Promise((function(){}))))return Promise}catch(t){}}function z(t,e){if(null===t||"function"!=typeof e||e===P)return e;null!==t.domain&&(e=t.domain.bind(e));var n=t.async;if(null!==n){var r=e;e=function(){var t=new Array(2).concat([].slice.call(arguments));return t[0]=r,t[1]=this,n.runInAsyncScope.apply(n,t)}}return e}var G,H={setReflectHandler:function(t){P=t},isClass:O,isIdentifier:R,inheritedDataKeys:g,getDataPropertyOrDefault:d,thrower:m,isArray:i.isArray,asArray:F,notEnumerableProp:E,isPrimitive:p,isObject:h,isError:w,canEvaluate:s,errorObj:a,tryCatch:l,inherits:f,withAppended:y,maybeWrapAsError:_,toFastProperties:b,filledRange:A,toString:x,canAttachTrace:C,ensureErrorObject:I,originatesFromRejection:N,markAsOriginatingFromRejection:S,classString:j,copyDescriptors:M,isNode:L,hasEnvVariables:B,env:D,global:c,getNativePromise:k,contextBind:z};H.isRecentNode=H.isNode&&(process.versions&&process.versions.node?G=process.versions.node.split(".").map(Number):process.version&&(G=process.version.split(".").map(Number)),0===G[0]&&G[1]>10||G[0]>0),H.nodeSupportsAsyncResource=H.isNode&&function(){var t=!1;try{t="function"==typeof e("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(e){t=!1}return t}(),H.isNode&&H.toFastProperties(process);try{throw new Error}catch(t){H.lastLineError=t}n.exports=H},{"./es5":13,async_hooks:void 0}]},{},[4])(4),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)),_.exports);function d(t){return null!=t}function E(t){let e;this.name="DeveloperError",this.message=t;try{throw new Error}catch(t){e=t.stack}this.stack=e}d(Object.create)&&(E.prototype=Object.create(Error.prototype),E.prototype.constructor=E),E.prototype.toString=function(){let t=`${this.name}: ${this.message}`;return d(this.stack)&&(t+=`\n${this.stack.toString()}`),t},E.throwInstantiationError=function(){throw new E("This function defines an interface and should not be called directly.")};var m=Object.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047});const g={BYTE:m.BYTE,UNSIGNED_BYTE:m.UNSIGNED_BYTE,SHORT:m.SHORT,UNSIGNED_SHORT:m.UNSIGNED_SHORT,INT:m.INT,UNSIGNED_INT:m.UNSIGNED_INT,FLOAT:m.FLOAT,DOUBLE:m.DOUBLE,getSizeInBytes:function(t){if(!d(t))throw new E("value is required.");switch(t){case g.BYTE:return Int8Array.BYTES_PER_ELEMENT;case g.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case g.SHORT:return Int16Array.BYTES_PER_ELEMENT;case g.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case g.INT:return Int32Array.BYTES_PER_ELEMENT;case g.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case g.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case g.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new E("componentDatatype is not a valid value.")}},fromTypedArray:function(t){if(t instanceof Int8Array)return g.BYTE;if(t instanceof Uint8Array)return g.UNSIGNED_BYTE;if(t instanceof Int16Array)return g.SHORT;if(t instanceof Uint16Array)return g.UNSIGNED_SHORT;if(t instanceof Int32Array)return g.INT;if(t instanceof Uint32Array)return g.UNSIGNED_INT;if(t instanceof Float32Array)return g.FLOAT;if(t instanceof Float64Array)return g.DOUBLE;throw new E("array must be an Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, Uint32Array, Float32Array, or Float64Array.")},validate:function(t){return d(t)&&(t===g.BYTE||t===g.UNSIGNED_BYTE||t===g.SHORT||t===g.UNSIGNED_SHORT||t===g.INT||t===g.UNSIGNED_INT||t===g.FLOAT||t===g.DOUBLE)},createTypedArray:function(t,e){if(!d(t))throw new E("componentDatatype is required.");if(!d(e))throw new E("valuesOrLength is required.");switch(t){case g.BYTE:return new Int8Array(e);case g.UNSIGNED_BYTE:return new Uint8Array(e);case g.SHORT:return new Int16Array(e);case g.UNSIGNED_SHORT:return new Uint16Array(e);case g.INT:return new Int32Array(e);case g.UNSIGNED_INT:return new Uint32Array(e);case g.FLOAT:return new Float32Array(e);case g.DOUBLE:return new Float64Array(e);default:throw new E("componentDatatype is not a valid value.")}},createArrayBufferView:function(t,e,n,r){if(!d(t))throw new E("componentDatatype is required.");if(!d(e))throw new E("buffer is required.");switch(n=n??0,r=r??(e.byteLength-n)/g.getSizeInBytes(t),t){case g.BYTE:return new Int8Array(e,n,r);case g.UNSIGNED_BYTE:return new Uint8Array(e,n,r);case g.SHORT:return new Int16Array(e,n,r);case g.UNSIGNED_SHORT:return new Uint16Array(e,n,r);case g.INT:return new Int32Array(e,n,r);case g.UNSIGNED_INT:return new Uint32Array(e,n,r);case g.FLOAT:return new Float32Array(e,n,r);case g.DOUBLE:return new Float64Array(e,n,r);default:throw new E("componentDatatype is not a valid value.")}},fromName:function(t){switch(t){case"BYTE":return g.BYTE;case"UNSIGNED_BYTE":return g.UNSIGNED_BYTE;case"SHORT":return g.SHORT;case"UNSIGNED_SHORT":return g.UNSIGNED_SHORT;case"INT":return g.INT;case"UNSIGNED_INT":return g.UNSIGNED_INT;case"FLOAT":return g.FLOAT;case"DOUBLE":return g.DOUBLE;default:throw new E("name is not a valid value.")}}};var T=Object.freeze(g);function O(t){this.componentDatatype=t,this.typedArray=T.createTypedArray(t,0),this.length=0}function b(t,e){const n=T.createTypedArray(t.componentDatatype,e);n.set(t.typedArray),t.typedArray=n}O.prototype.push=function(t){const e=this.length,n=this.typedArray.length;0===e?b(this,1024):e===n&&b(this,e<33554432?2*n:n+33554432),this.typedArray[this.length++]=t},O.prototype.get=function(t){return this.typedArray[t]};function v(){this.transparent=!1,this.source=void 0,this.name=void 0,this.extension=void 0,this.path=void 0,this.pixels=void 0,this.width=void 0,this.height=void 0}function R(t,e){return null!=t?t:e}function A(t,e){return(e=R(e,{})).checkTransparency=R(e.checkTransparency,!1),e.decode=R(e.decode,!1),e.keepSource=R(e.keepSource,!1),new y.Promise((function(e,n){const r=h.basename(t,h.extname(t)),o=h.extname(t).toLowerCase(),i=new v;i.name=r,i.extension=o,i.path=t,".png"===o?i.transparent=!0:".jpg"!==o&&".jpeg"!==o||(i.transparent=!1),e(i)}))}async function x(t,e){try{const n=await async function(t,e){if("string"!=typeof t)throw new Error("fetch url "+t+" is illegal. ");try{const n=await fetch(t,e);if(n.ok)return n;throw new Error("fetch url "+t+" failed, status="+n.status+" ;statusText="+n.statusText)}catch(t){throw t}}(t,e),r=await n.text();if(r)return r;throw new Error("fetchText result is null. ")}catch(t){throw t}}function w(t,e,n){return new Promise(((r,o)=>{function i(t){const n=t.split(/\r\n|\r|\n/g);let i=0;const s=n.length;n.forEach((t=>{if(e)try{e(t,i,s)}catch(t){o(t)}i++})),r()}if(t instanceof Blob)!function(t,e,n,r){new Promise(((o,i)=>{const s=new FileReader;s.onload=function(){e&&e(s.result),o(s.result)},s.onerror=function(t){console.error("readAsText failed.",t),n&&n(t),i(t)},s.readAsText(t,r)}))}(t,(t=>{i(t)}),(t=>{o(t)}),n);else if(t instanceof ArrayBuffer){i(new TextDecode(n).decode(t))}else if("string"==typeof t){i(t)}else o(new Error("unsupported data."+t))}))}function S(t,e){return new Promise((function(n,r){x(t).then((t=>{w(t,e).then((()=>{n()})).catch((t=>{r(t)}))})).catch((t=>{r(t)}))}))}var N,C;O.prototype.toUint16Buffer=function(){const t=this.length,e=this.typedArray,n=t+(t%2==0?0:1),r=Buffer.alloc(2*n);for(let n=0;n<t;++n)r.writeUInt16LE(e[n],2*n);return r},O.prototype.toUint32Buffer=function(){const t=this.length,e=this.typedArray,n=Buffer.alloc(4*t);for(let r=0;r<t;++r)n.writeUInt32LE(e[r],4*r);return n},O.prototype.toFloatBuffer=function(){const t=this.length,e=this.typedArray,n=Buffer.alloc(4*t);for(let r=0;r<t;++r)n.writeFloatLE(e[r],4*r);return n},O.prototype.getMinMax=function(t){const e=this.length,n=this.typedArray,r=e/t,o=new Array(t).fill(Number.POSITIVE_INFINITY),i=new Array(t).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<r;++e)for(let r=0;r<t;++r){const s=n[e*t+r];o[r]=Math.min(o[r],s),i[r]=Math.max(i[r],s)}return{min:o,max:i}};var I=function(){if(C)return N;C=1;var t=function(t){null==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,t.constructor==Array?this.init_by_array(t,t.length):this.init_seed(t)};return t.prototype.init_seed=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},t.prototype.init_by_array=function(t,e){var n,r,o;for(this.init_seed(19650218),n=1,r=0,o=this.N>e?this.N:e;o;o--){var i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&i)>>>16)<<16)+1664525*(65535&i))+t[r]+r,this.mt[n]>>>=0,r++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=e&&(r=0)}for(o=this.N-1;o;o--){i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1566083941*((4294901760&i)>>>16)<<16)+1566083941*(65535&i))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648},t.prototype.random_int=function(){var t,e=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)t=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^t>>>1^e[1&t];for(;n<this.N-1;n++)t=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^t>>>1^e[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^e[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0},t.prototype.random_int31=function(){return this.random_int()>>>1},t.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},t.prototype.random=function(){return this.random_int()*(1/4294967296)},t.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},t.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},N=t}(),j=e(I);const M={};function F(t,e,n){return`Expected ${n} to be typeof ${e}, actual typeof was ${t}`}M.typeOf={},M.defined=function(t,e){if(!d(e))throw new E(function(t){return`${t} is required, actual value was undefined`}(t))},M.typeOf.func=function(t,e){if("function"!=typeof e)throw new E(F(typeof e,"function",t))},M.typeOf.string=function(t,e){if("string"!=typeof e)throw new E(F(typeof e,"string",t))},M.typeOf.number=function(t,e){if("number"!=typeof e)throw new E(F(typeof e,"number",t))},M.typeOf.number.lessThan=function(t,e,n){if(M.typeOf.number(t,e),e>=n)throw new E(`Expected ${t} to be less than ${n}, actual value was ${e}`)},M.typeOf.number.lessThanOrEquals=function(t,e,n){if(M.typeOf.number(t,e),e>n)throw new E(`Expected ${t} to be less than or equal to ${n}, actual value was ${e}`)},M.typeOf.number.greaterThan=function(t,e,n){if(M.typeOf.number(t,e),e<=n)throw new E(`Expected ${t} to be greater than ${n}, actual value was ${e}`)},M.typeOf.number.greaterThanOrEquals=function(t,e,n){if(M.typeOf.number(t,e),e<n)throw new E(`Expected ${t} to be greater than or equal to ${n}, actual value was ${e}`)},M.typeOf.object=function(t,e){if("object"!=typeof e)throw new E(F(typeof e,"object",t))},M.typeOf.bool=function(t,e){if("boolean"!=typeof e)throw new E(F(typeof e,"boolean",t))},M.typeOf.bigint=function(t,e){if("bigint"!=typeof e)throw new E(F(typeof e,"bigint",t))},M.typeOf.number.equals=function(t,e,n,r){if(M.typeOf.number(t,n),M.typeOf.number(e,r),n!==r)throw new E(`${t} must be equal to ${e}, the actual values are ${n} and ${r}`)};const U={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};U.sign=Math.sign??function(t){return 0===(t=+t)||t!=t?t:t>0?1:-1},U.signNotZero=function(t){return t<0?-1:1},U.toSNorm=function(t,e){return e=e??255,Math.round((.5*U.clamp(t,-1,1)+.5)*e)},U.fromSNorm=function(t,e){return e=e??255,U.clamp(t,0,e)/e*2-1},U.normalize=function(t,e,n){return 0===(n=Math.max(n-e,0))?0:U.clamp((t-e)/n,0,1)},U.sinh=Math.sinh??function(t){return(Math.exp(t)-Math.exp(-t))/2},U.cosh=Math.cosh??function(t){return(Math.exp(t)+Math.exp(-t))/2},U.lerp=function(t,e,n){return(1-n)*t+n*e},U.PI=Math.PI,U.ONE_OVER_PI=1/Math.PI,U.PI_OVER_TWO=Math.PI/2,U.PI_OVER_THREE=Math.PI/3,U.PI_OVER_FOUR=Math.PI/4,U.PI_OVER_SIX=Math.PI/6,U.THREE_PI_OVER_TWO=3*Math.PI/2,U.TWO_PI=2*Math.PI,U.ONE_OVER_TWO_PI=1/(2*Math.PI),U.RADIANS_PER_DEGREE=Math.PI/180,U.DEGREES_PER_RADIAN=180/Math.PI,U.RADIANS_PER_ARCSECOND=U.RADIANS_PER_DEGREE/3600,U.toRadians=function(t){if(!d(t))throw new E("degrees is required.");return t*U.RADIANS_PER_DEGREE},U.toDegrees=function(t){if(!d(t))throw new E("radians is required.");return t*U.DEGREES_PER_RADIAN},U.convertLongitudeRange=function(t){if(!d(t))throw new E("angle is required.");const e=U.TWO_PI,n=t-Math.floor(t/e)*e;return n<-Math.PI?n+e:n>=Math.PI?n-e:n},U.clampToLatitudeRange=function(t){if(!d(t))throw new E("angle is required.");return U.clamp(t,-1*U.PI_OVER_TWO,U.PI_OVER_TWO)},U.negativePiToPi=function(t){if(!d(t))throw new E("angle is required.");return t>=-U.PI&&t<=U.PI?t:U.zeroToTwoPi(t+U.PI)-U.PI},U.zeroToTwoPi=function(t){if(!d(t))throw new E("angle is required.");if(t>=0&&t<=U.TWO_PI)return t;const e=U.mod(t,U.TWO_PI);return Math.abs(e)<U.EPSILON14&&Math.abs(t)>U.EPSILON14?U.TWO_PI:e},U.mod=function(t,e){if(!d(t))throw new E("m is required.");if(!d(e))throw new E("n is required.");if(0===e)throw new E("divisor cannot be 0.");return U.sign(t)===U.sign(e)&&Math.abs(t)<Math.abs(e)?t:(t%e+e)%e},U.equalsEpsilon=function(t,e,n,r){if(!d(t))throw new E("left is required.");if(!d(e))throw new E("right is required.");n=n??0,r=r??n;const o=Math.abs(t-e);return o<=r||o<=n*Math.max(Math.abs(t),Math.abs(e))},U.lessThan=function(t,e,n){if(!d(t))throw new E("first is required.");if(!d(e))throw new E("second is required.");if(!d(n))throw new E("absoluteEpsilon is required.");return t-e<-n},U.lessThanOrEquals=function(t,e,n){if(!d(t))throw new E("first is required.");if(!d(e))throw new E("second is required.");if(!d(n))throw new E("absoluteEpsilon is required.");return t-e<n},U.greaterThan=function(t,e,n){if(!d(t))throw new E("first is required.");if(!d(e))throw new E("second is required.");if(!d(n))throw new E("absoluteEpsilon is required.");return t-e>n},U.greaterThanOrEquals=function(t,e,n){if(!d(t))throw new E("first is required.");if(!d(e))throw new E("second is required.");if(!d(n))throw new E("absoluteEpsilon is required.");return t-e>-n};const P=[1];U.factorial=function(t){if("number"!=typeof t||t<0)throw new E("A number greater than or equal to 0 is required.");const e=P.length;if(t>=e){let n=P[e-1];for(let r=e;r<=t;r++){const t=n*r;P.push(t),n=t}}return P[t]},U.incrementWrap=function(t,e,n){if(n=n??0,!d(t))throw new E("n is required.");if(e<=n)throw new E("maximumValue must be greater than minimumValue.");return++t>e&&(t=n),t},U.isPowerOfTwo=function(t){if("number"!=typeof t||t<0||t>4294967295)throw new E("A number between 0 and (2^32)-1 is required.");return 0!==t&&!(t&t-1)},U.nextPowerOfTwo=function(t){if("number"!=typeof t||t<0||t>2147483648)throw new E("A number between 0 and 2^31 is required.");return--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},U.previousPowerOfTwo=function(t){if("number"!=typeof t||t<0||t>4294967295)throw new E("A number between 0 and (2^32)-1 is required.");return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t=((t|=t>>32)>>>0)-(t>>>1)},U.clamp=function(t,e,n){return M.typeOf.number("value",t),M.typeOf.number("min",e),M.typeOf.number("max",n),t<e?e:t>n?n:t};let L,B=new j;function D(t,e){if(null===t||"object"!=typeof t)return t;e=e??!1;const n=new t.constructor;for(const r in t)if(t.hasOwnProperty(r)){let o=t[r];e&&(o=D(o,e)),n[r]=o}return n}function k(t,e,n){n=n??!1;const r={},o=d(t),i=d(e);let s,a,c;if(o)for(s in t)t.hasOwnProperty(s)&&(a=t[s],i&&n&&"object"==typeof a&&e.hasOwnProperty(s)?(c=e[s],r[s]="object"==typeof c?k(a,c,n):a):r[s]=a);if(i)for(s in e)e.hasOwnProperty(s)&&!r.hasOwnProperty(s)&&(c=e[s],r[s]=c);return r}function z(t,e){let n,r,o;const i=h.dirname(t),s=[],a={},c=[],u=e.overridingTextures,l=R(u.metallicRoughnessOcclusionTexture,u.specularGlossinessTexture),f=R(u.metallicRoughnessOcclusionTexture,u.specularGlossinessTexture),p=R(u.metallicRoughnessOcclusionTexture,u.occlusionTexture),_=u.normalTexture,E=u.baseColorTexture,m=u.emissiveTexture,g=u.alphaTexture,T={decode:!0},O={checkTransparency:e.checkTransparency},b=d(p)?void 0:e.packOcclusion?T:void 0,v=d(l)?void 0:T,x=d(f)?void 0:T,w={decode:!0};function N(t,e){t=t.replace(/^"(.+)"$/,"$1");return/-(bm|t|s|o|blendu|blendv|boost|mm|texres|clamp|imfchan|type)/.test(t)&&(t=t.split(/\s+/).pop()),t=t.replace(/\\/g,"/"),h.normalize(h.resolve(e,t))}function C(t){const n=d(t.alphaTexture)?w:O;t.diffuseTexture===t.ambientTexture&&(t.ambientTexture=void 0);const r=["diffuseTexture","ambientTexture","emissiveTexture","specularTexture","specularShininessTexture","normalTexture","alphaTexture"],o=[n,b,undefined,v,x,undefined,w],s={};r.forEach((function(e,n){const r=t[e],i=o[n];if(d(r)&&d(i)){d(s[r])||(s[r]=D(i));const t=s[r];t.checkTransparency=t.checkTransparency||i.checkTransparency,t.decode=t.decode||i.decode,t.keepSource=t.keepSource||!i.decode||!i.checkTransparency}})),r.forEach((function(n){const r=t[n];d(r)&&function(t,e,n,r,o,i,s){const a=t[e];if(!d(a))return;let c=o[a];if(!d(c)){const t=h.join(r,h.basename(a));c=A(a,n).catch((function(e){return s.logger(e.message),s.logger(`Could not read texture file at ${a}. Attempting to read the texture file from within the obj directory instead.`),A(t,n)})).catch((function(e){s.logger(e.message),s.logger(`Could not read texture file at ${t}. This texture will be ignored.`)})),o[a]=c}i.push(c.then((function(n){t[e]=n})))}(t,n,s[r],i,a,c,e)}))}return S(t,(function(t){if(t=t.trim(),/^newmtl/i.test(t)){!function(t){n=new H,n.name=t,n.specularShininess=e.metallicRoughness?1:0,n.specularTexture=l,n.specularShininessTexture=f,n.diffuseTexture=E,n.ambientTexture=p,n.normalTexture=_,n.emissiveTexture=m,n.alphaTexture=g,s.push(n)}(t.substring(7).trim())}else/^Ka /i.test(t)?(r=t.substring(3).trim().split(" "),n.ambientColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ke /i.test(t)?(r=t.substring(3).trim().split(" "),n.emissiveColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Kd /i.test(t)?(r=t.substring(3).trim().split(" "),n.diffuseColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ks /i.test(t)?(r=t.substring(3).trim().split(" "),n.specularColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ns /i.test(t)?(o=t.substring(3).trim(),n.specularShininess=parseFloat(o)):/^d /i.test(t)?(o=t.substring(2).trim(),n.alpha=G(parseFloat(o))):/^Tr /i.test(t)?(o=t.substring(3).trim(),n.alpha=G(1-parseFloat(o))):/^map_Ka /i.test(t)?d(p)||(n.ambientTexture=N(t.substring(7).trim(),i)):/^map_Ke /i.test(t)?d(m)||(n.emissiveTexture=N(t.substring(7).trim(),i)):/^map_Kd /i.test(t)?d(E)||(n.diffuseTexture=N(t.substring(7).trim(),i)):/^map_Ks /i.test(t)?d(l)||(n.specularTexture=N(t.substring(7).trim(),i)):/^map_Ns /i.test(t)?d(f)||(n.specularShininessTexture=N(t.substring(7).trim(),i)):/^map_Bump /i.test(t)?d(_)||(n.normalTexture=N(t.substring(9).trim(),i)):/^map_d /i.test(t)&&(d(g)||(n.alphaTexture=N(t.substring(6).trim(),i)))})).then((function(){const t=s.length;for(let e=0;e<t;++e)C(s[e]);return y.Promise.all(c)})).then((function(){return function(t,e){return t.map((function(t){return V(t,e)}))}(s,e)}))}function G(t){return 0===t?1:t}function H(){this.name=void 0,this.ambientColor=[0,0,0,1],this.emissiveColor=[0,0,0,1],this.diffuseColor=[.5,.5,.5,1],this.specularColor=[0,0,0,1],this.specularShininess=0,this.alpha=1,this.ambientTexture=void 0,this.emissiveTexture=void 0,this.diffuseTexture=void 0,this.specularTexture=void 0,this.specularShininessTexture=void 0,this.normalTexture=void 0,this.alphaTexture=void 0}function V(t,e){return e.specularGlossiness?function(t,e){const n=t.emissiveTexture,r=t.normalTexture,o=t.ambientTexture,i=t.diffuseTexture,s=t.alphaTexture,a=t.specularTexture,c=t.specularShininessTexture,u=function(t,e,n){if(d(n.overridingTextures.specularGlossinessTexture))return t;const r=d(t),o=d(e);if(!r&&!o)return;if(r&&!d(t.pixels))return void n.logger(`Could not get decoded texture data for ${t.path}. The material will be created without a specularGlossiness texture.`);if(o&&!d(e.pixels))return void n.logger(`Could not get decoded texture data for ${e.path}. The material will be created without a specularGlossiness texture.`);const i=[t,e].filter((function(t){return d(t)&&d(t.pixels)})),s=Y(i,n),a=s[0],c=s[1],u=a*c,l=Buffer.alloc(4*u,255),f=Buffer.alloc(u);if(r){q(l,X(t,0,a,c,f),0);q(l,X(t,1,a,c,f),1);q(l,X(t,2,a,c,f),2)}if(o){q(l,X(e,0,a,c,f),3)}const p=i.length,h=new Array(p);for(let t=0;t<p;++t)h[t]=i[t].name;const _=h.join("_"),y=new v;return y.name=_,y.extension=".png",y.pixels=l,y.width=a,y.height=c,y}(a,c,e),l=W(i,s,e);let f=t.emissiveColor.slice(0,3),p=t.diffuseColor,h=t.specularColor.slice(0,3),_=t.specularShininess;d(n)&&(f=[1,1,1]);d(i)&&(p=[1,1,1,1]);d(a)&&(h=[1,1,1]);d(c)&&(_=1);let y=!1;if(d(s))y=!0;else{const e=t.alpha;p[3]=e,y=e<1}d(i)&&(y=y||i.transparent);const E=y||e.doubleSidedMaterial,m=y?"BLEND":"OPAQUE";return{name:t.name,extensions:{KHR_materials_pbrSpecularGlossiness:{diffuseTexture:l,specularGlossinessTexture:u,diffuseFactor:p,specularFactor:h,glossinessFactor:_}},emissiveTexture:n,normalTexture:r,occlusionTexture:o,emissiveFactor:f,alphaMode:m,doubleSided:E}}(t,e):(e.metallicRoughness||function(t){const e=(n=t.specularColor,.2125*n[0]+.7154*n[1]+.0721*n[2]);var n;let r=t.specularShininess;r/=1e3,r=1-r,r=U.clamp(r,0,1),e<.1&&(r*=1-e);const o=0;t.specularColor=[o,o,o,1],t.specularShininess=r}(t),$(t,e))}function X(t,e,n,r,o){const i=t.pixels,s=t.width,a=t.height,c=s*a,u=n*r;let l=o;c>u&&((!d(L)||c>L.length)&&(L=Buffer.alloc(c)),l=L);for(let t=0;t<c;++t){const n=i.readUInt8(4*t+e);l.writeUInt8(n,t)}return c>u&&function(t,e,n,r,o,i){const s=e/o,a=n/i;for(let n=0;n<i;++n)for(let i=0;i<o;++i){const c=n*o+i,u=Math.round(n*a)*e+Math.round(i*s),l=t.readUInt8(u);r.writeUInt8(l,c)}}(l,s,a,o,n,r),o}function q(t,e,n){const r=t.length/4;for(let o=0;o<r;++o){const r=e.readUInt8(o);t.writeUInt8(r,4*o+n)}}function Y(t,e){let n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;const o=t.length;for(let e=0;e<o;++e){const o=t[e];n=Math.min(o.width,n),r=Math.min(o.height,r)}for(let i=0;i<o;++i){const o=t[i];o.width===n&&o.height===r||e.logger(`Texture ${o.path} will be scaled from ${o.width}x${o.height} to ${n}x${r}.`)}return[n,r]}function W(t,e,n){const r=d(t),o=d(e);if(!r)return;if(!o)return t;if(t===e)return t;if(!d(t.pixels)||!d(e.pixels))return n.logger(`Could not get decoded texture data for ${t.path} or ${e.path}. The material will be created without an alpha texture.`),t;const i=Y([t,e],n),s=i[0],a=i[1],c=s*a,u=Buffer.alloc(4*c,255),l=Buffer.alloc(c);q(u,X(t,0,s,a,l),0);q(u,X(t,1,s,a,l),1);q(u,X(t,2,s,a,l),2);let f=X(e,3,s,a,l);(function(t){const e=t.readUInt8(0),n=t.length;for(let r=1;r<n;++r)if(t[r]!==e)return!1;return!0})(f)&&(f=X(e,0,s,a,l)),q(u,f,3);const p=new v;return p.name=t.name,p.extension=".png",p.pixels=u,p.width=s,p.height=a,p.transparent=!0,p}function $(t,e){const n=t.emissiveTexture,r=t.normalTexture;let o=t.ambientTexture;const i=t.diffuseTexture,s=t.alphaTexture,a=t.specularTexture,c=t.specularShininessTexture,u=function(t,e,n,r){if(d(r.overridingTextures.metallicRoughnessOcclusionTexture))return t;const o=d(t),i=d(e),s=d(n)&&r.packOcclusion;if(!o&&!i)return;if(o&&!d(t.pixels))return void r.logger(`Could not get decoded texture data for ${t.path}. The material will be created without a metallicRoughness texture.`);if(i&&!d(e.pixels))return void r.logger(`Could not get decoded texture data for ${e.path}. The material will be created without a metallicRoughness texture.`);if(s&&!d(n.pixels))return void r.logger(`Could not get decoded texture data for ${n.path}. The occlusion texture will not be packed in the metallicRoughness texture.`);const a=[t,e,n].filter((function(t){return d(t)&&d(t.pixels)})),c=Y(a,r),u=c[0],l=c[1],f=u*l,p=Buffer.alloc(4*f,255),h=Buffer.alloc(f);o&&q(p,X(t,0,u,l,h),2);i&&q(p,X(e,0,u,l,h),1);s&&q(p,X(n,0,u,l,h),0);const _=a.length,y=new Array(_);for(let t=0;t<_;++t)y[t]=a[t].name;const E=y.join("_"),m=new v;return m.name=E,m.extension=".png",m.pixels=p,m.width=u,m.height=l,m}(a,c,o,e),l=W(i,s,e);e.packOcclusion&&(o=u);let f=t.emissiveColor.slice(0,3),p=t.diffuseColor,h=t.specularColor[0],_=t.specularShininess;d(n)&&(f=[1,1,1]),d(i)&&(p=[1,1,1,1]),d(a)&&(h=1),d(c)&&(_=1);let y=!1;if(d(s))y=!0;else{const e=t.alpha;p[3]=e,y=e<1}d(i)&&(y=y||i.transparent);const E=y||e.doubleSidedMaterial,m=y?"BLEND":"OPAQUE";return{name:t.name,pbrMetallicRoughness:{baseColorTexture:l,metallicRoughnessTexture:u,baseColorFactor:p,metallicFactor:h,roughnessFactor:_},emissiveTexture:n,normalTexture:r,occlusionTexture:o,emissiveFactor:f,alphaMode:m,doubleSided:E}}function K(t,e,n){this.x=t??0,this.y=e??0,this.z=n??0}U.setRandomNumberSeed=function(t){if(!d(t))throw new E("seed is required.");B=new j(t)},U.nextRandomNumber=function(){return B.random()},U.randomBetween=function(t,e){return U.nextRandomNumber()*(e-t)+t},U.acosClamped=function(t){if(!d(t))throw new E("value is required.");return Math.acos(U.clamp(t,-1,1))},U.asinClamped=function(t){if(!d(t))throw new E("value is required.");return Math.asin(U.clamp(t,-1,1))},U.chordLength=function(t,e){if(!d(t))throw new E("angle is required.");if(!d(e))throw new E("radius is required.");return 2*e*Math.sin(.5*t)},U.logBase=function(t,e){if(!d(t))throw new E("number is required.");if(!d(e))throw new E("base is required.");return Math.log(t)/Math.log(e)},U.cbrt=Math.cbrt??function(t){const e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},U.log2=Math.log2??function(t){return Math.log(t)*Math.LOG2E},U.fog=function(t,e){const n=t*e;return 1-Math.exp(-n*n)},U.fastApproximateAtan=function(t){return M.typeOf.number("x",t),t*(-.1784*Math.abs(t)-.0663*t*t+1.0301)},U.fastApproximateAtan2=function(t,e){let n;M.typeOf.number("x",t),M.typeOf.number("y",e);let r=Math.abs(t);n=Math.abs(e);const o=Math.max(r,n);n=Math.min(r,n);const i=n/o;if(isNaN(i))throw new E("either x or y must be nonzero");return r=U.fastApproximateAtan(i),r=Math.abs(e)>Math.abs(t)?U.PI_OVER_TWO-r:r,r=t<0?U.PI-r:r,r=e<0?-r:r,r},z.getDefaultMaterial=function(t){return V(new H,t)},z._createMaterial=function(t,e){return V(k(t,new H),e)},K.fromSpherical=function(t,e){M.typeOf.object("spherical",t),d(e)||(e=new K);const n=t.clock,r=t.cone,o=t.magnitude??1,i=o*Math.sin(r);return e.x=i*Math.cos(n),e.y=i*Math.sin(n),e.z=o*Math.cos(r),e},K.fromElements=function(t,e,n,r){return d(r)?(r.x=t,r.y=e,r.z=n,r):new K(t,e,n)},K.clone=function(t,e){if(d(t))return d(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e):new K(t.x,t.y,t.z)},K.fromCartesian4=K.clone,K.packedLength=3,K.pack=function(t,e,n){return M.typeOf.object("value",t),M.defined("array",e),n=n??0,e[n++]=t.x,e[n++]=t.y,e[n]=t.z,e},K.unpack=function(t,e,n){return M.defined("array",t),e=e??0,d(n)||(n=new K),n.x=t[e++],n.y=t[e++],n.z=t[e],n},K.packArray=function(t,e){M.defined("array",t);const n=t.length,r=3*n;if(d(e)){if(!Array.isArray(e)&&e.length!==r)throw new E("If result is a typed array, it must have exactly array.length * 3 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(let r=0;r<n;++r)K.pack(t[r],e,3*r);return e},K.unpackArray=function(t,e){if(M.defined("array",t),M.typeOf.number.greaterThanOrEquals("array.length",t.length,3),t.length%3!=0)throw new E("array length must be a multiple of 3.");const n=t.length;d(e)?e.length=n/3:e=new Array(n/3);for(let r=0;r<n;r+=3){const n=r/3;e[n]=K.unpack(t,r,e[n])}return e},K.fromArray=K.unpack,K.maximumComponent=function(t){return M.typeOf.object("cartesian",t),Math.max(t.x,t.y,t.z)},K.minimumComponent=function(t){return M.typeOf.object("cartesian",t),Math.min(t.x,t.y,t.z)},K.minimumByComponent=function(t,e,n){return M.typeOf.object("first",t),M.typeOf.object("second",e),M.typeOf.object("result",n),n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.z=Math.min(t.z,e.z),n},K.maximumByComponent=function(t,e,n){return M.typeOf.object("first",t),M.typeOf.object("second",e),M.typeOf.object("result",n),n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.z=Math.max(t.z,e.z),n},K.clamp=function(t,e,n,r){M.typeOf.object("value",t),M.typeOf.object("min",e),M.typeOf.object("max",n),M.typeOf.object("result",r);const o=U.clamp(t.x,e.x,n.x),i=U.clamp(t.y,e.y,n.y),s=U.clamp(t.z,e.z,n.z);return r.x=o,r.y=i,r.z=s,r},K.magnitudeSquared=function(t){return M.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y+t.z*t.z},K.magnitude=function(t){return Math.sqrt(K.magnitudeSquared(t))};const Z=new K;K.distance=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),K.subtract(t,e,Z),K.magnitude(Z)},K.distanceSquared=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),K.subtract(t,e,Z),K.magnitudeSquared(Z)},K.normalize=function(t,e){M.typeOf.object("cartesian",t),M.typeOf.object("result",e);const n=K.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,isNaN(e.x)||isNaN(e.y)||isNaN(e.z))throw new E("normalized result is not a number");return e},K.dot=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),t.x*e.x+t.y*e.y+t.z*e.z},K.multiplyComponents=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n},K.divideComponents=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n},K.add=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},K.subtract=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},K.multiplyByScalar=function(t,e,n){return M.typeOf.object("cartesian",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},K.divideByScalar=function(t,e,n){return M.typeOf.object("cartesian",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n},K.negate=function(t,e){return M.typeOf.object("cartesian",t),M.typeOf.object("result",e),e.x=-t.x,e.y=-t.y,e.z=-t.z,e},K.abs=function(t,e){return M.typeOf.object("cartesian",t),M.typeOf.object("result",e),e.x=Math.abs(t.x),e.y=Math.abs(t.y),e.z=Math.abs(t.z),e};const Q=new K;K.lerp=function(t,e,n,r){return M.typeOf.object("start",t),M.typeOf.object("end",e),M.typeOf.number("t",n),M.typeOf.object("result",r),K.multiplyByScalar(e,n,Q),r=K.multiplyByScalar(t,1-n,r),K.add(Q,r,r)};const J=new K,tt=new K;K.angleBetween=function(t,e){M.typeOf.object("left",t),M.typeOf.object("right",e),K.normalize(t,J),K.normalize(e,tt);const n=K.dot(J,tt),r=K.magnitude(K.cross(J,tt,J));return Math.atan2(r,n)};const et=new K;K.mostOrthogonalAxis=function(t,e){M.typeOf.object("cartesian",t),M.typeOf.object("result",e);const n=K.normalize(t,et);return K.abs(n,n),e=n.x<=n.y?n.x<=n.z?K.clone(K.UNIT_X,e):K.clone(K.UNIT_Z,e):n.y<=n.z?K.clone(K.UNIT_Y,e):K.clone(K.UNIT_Z,e)},K.projectVector=function(t,e,n){M.defined("a",t),M.defined("b",e),M.defined("result",n);const r=K.dot(t,e)/K.dot(e,e);return K.multiplyByScalar(e,r,n)},K.equals=function(t,e){return t===e||d(t)&&d(e)&&t.x===e.x&&t.y===e.y&&t.z===e.z},K.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]&&t.z===e[n+2]},K.equalsEpsilon=function(t,e,n,r){return t===e||d(t)&&d(e)&&U.equalsEpsilon(t.x,e.x,n,r)&&U.equalsEpsilon(t.y,e.y,n,r)&&U.equalsEpsilon(t.z,e.z,n,r)},K.cross=function(t,e,n){M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e.x,a=e.y,c=e.z,u=o*c-i*a,l=i*s-r*c,f=r*a-o*s;return n.x=u,n.y=l,n.z=f,n},K.midpoint=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=.5*(t.x+e.x),n.y=.5*(t.y+e.y),n.z=.5*(t.z+e.z),n},K.fromDegrees=function(t,e,n,r,o){return M.typeOf.number("longitude",t),M.typeOf.number("latitude",e),t=U.toRadians(t),e=U.toRadians(e),K.fromRadians(t,e,n,r,o)};let nt=new K,rt=new K;function ot(t,e,n,r,o,i,s,a,c){this[0]=t??0,this[1]=r??0,this[2]=s??0,this[3]=e??0,this[4]=o??0,this[5]=a??0,this[6]=n??0,this[7]=i??0,this[8]=c??0}K._ellipsoidRadiiSquared=new K(40680631590769,40680631590769,40408299984661.445),K.fromRadians=function(t,e,n,r,o){M.typeOf.number("longitude",t),M.typeOf.number("latitude",e),n=n??0;const i=d(r)?r.radiiSquared:K._ellipsoidRadiiSquared,s=Math.cos(e);nt.x=s*Math.cos(t),nt.y=s*Math.sin(t),nt.z=Math.sin(e),nt=K.normalize(nt,nt),K.multiplyComponents(i,nt,rt);const a=Math.sqrt(K.dot(nt,rt));return rt=K.divideByScalar(rt,a,rt),nt=K.multiplyByScalar(nt,n,nt),d(o)||(o=new K),K.add(rt,nt,o)},K.fromDegreesArray=function(t,e,n){if(M.defined("coordinates",t),t.length<2||t.length%2!=0)throw new E("the number of coordinates must be a multiple of 2 and at least 2");const r=t.length;d(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=t[o],i=t[o+1],s=o/2;n[s]=K.fromDegrees(r,i,0,e,n[s])}return n},K.fromRadiansArray=function(t,e,n){if(M.defined("coordinates",t),t.length<2||t.length%2!=0)throw new E("the number of coordinates must be a multiple of 2 and at least 2");const r=t.length;d(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=t[o],i=t[o+1],s=o/2;n[s]=K.fromRadians(r,i,0,e,n[s])}return n},K.fromDegreesArrayHeights=function(t,e,n){if(M.defined("coordinates",t),t.length<3||t.length%3!=0)throw new E("the number of coordinates must be a multiple of 3 and at least 3");const r=t.length;d(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=t[o],i=t[o+1],s=t[o+2],a=o/3;n[a]=K.fromDegrees(r,i,s,e,n[a])}return n},K.fromRadiansArrayHeights=function(t,e,n){if(M.defined("coordinates",t),t.length<3||t.length%3!=0)throw new E("the number of coordinates must be a multiple of 3 and at least 3");const r=t.length;d(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=t[o],i=t[o+1],s=t[o+2],a=o/3;n[a]=K.fromRadians(r,i,s,e,n[a])}return n},K.ZERO=Object.freeze(new K(0,0,0)),K.ONE=Object.freeze(new K(1,1,1)),K.UNIT_X=Object.freeze(new K(1,0,0)),K.UNIT_Y=Object.freeze(new K(0,1,0)),K.UNIT_Z=Object.freeze(new K(0,0,1)),K.prototype.clone=function(t){return K.clone(this,t)},K.prototype.equals=function(t){return K.equals(this,t)},K.prototype.equalsEpsilon=function(t,e,n){return K.equalsEpsilon(this,t,e,n)},K.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`},ot.packedLength=9,ot.pack=function(t,e,n){return M.typeOf.object("value",t),M.defined("array",e),n=n??0,e[n++]=t[0],e[n++]=t[1],e[n++]=t[2],e[n++]=t[3],e[n++]=t[4],e[n++]=t[5],e[n++]=t[6],e[n++]=t[7],e[n++]=t[8],e},ot.unpack=function(t,e,n){return M.defined("array",t),e=e??0,d(n)||(n=new ot),n[0]=t[e++],n[1]=t[e++],n[2]=t[e++],n[3]=t[e++],n[4]=t[e++],n[5]=t[e++],n[6]=t[e++],n[7]=t[e++],n[8]=t[e++],n},ot.packArray=function(t,e){M.defined("array",t);const n=t.length,r=9*n;if(d(e)){if(!Array.isArray(e)&&e.length!==r)throw new E("If result is a typed array, it must have exactly array.length * 9 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(let r=0;r<n;++r)ot.pack(t[r],e,9*r);return e},ot.unpackArray=function(t,e){if(M.defined("array",t),M.typeOf.number.greaterThanOrEquals("array.length",t.length,9),t.length%9!=0)throw new E("array length must be a multiple of 9.");const n=t.length;d(e)?e.length=n/9:e=new Array(n/9);for(let r=0;r<n;r+=9){const n=r/9;e[n]=ot.unpack(t,r,e[n])}return e},ot.clone=function(t,e){if(d(t))return d(e)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e):new ot(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])},ot.fromArray=ot.unpack,ot.fromColumnMajorArray=function(t,e){return M.defined("values",t),ot.clone(t,e)},ot.fromRowMajorArray=function(t,e){return M.defined("values",t),d(e)?(e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e):new ot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ot.fromQuaternion=function(t,e){M.typeOf.object("quaternion",t);const n=t.x*t.x,r=t.x*t.y,o=t.x*t.z,i=t.x*t.w,s=t.y*t.y,a=t.y*t.z,c=t.y*t.w,u=t.z*t.z,l=t.z*t.w,f=t.w*t.w,p=n-s-u+f,h=2*(r-l),_=2*(o+c),y=2*(r+l),E=-n+s-u+f,m=2*(a-i),g=2*(o-c),T=2*(a+i),O=-n-s+u+f;return d(e)?(e[0]=p,e[1]=y,e[2]=g,e[3]=h,e[4]=E,e[5]=T,e[6]=_,e[7]=m,e[8]=O,e):new ot(p,h,_,y,E,m,g,T,O)},ot.fromHeadingPitchRoll=function(t,e){M.typeOf.object("headingPitchRoll",t);const n=Math.cos(-t.pitch),r=Math.cos(-t.heading),o=Math.cos(t.roll),i=Math.sin(-t.pitch),s=Math.sin(-t.heading),a=Math.sin(t.roll),c=n*r,u=-o*s+a*i*r,l=a*s+o*i*r,f=n*s,p=o*r+a*i*s,h=-a*r+o*i*s,_=-i,y=a*n,E=o*n;return d(e)?(e[0]=c,e[1]=f,e[2]=_,e[3]=u,e[4]=p,e[5]=y,e[6]=l,e[7]=h,e[8]=E,e):new ot(c,u,l,f,p,h,_,y,E)},ot.fromScale=function(t,e){return M.typeOf.object("scale",t),d(e)?(e[0]=t.x,e[1]=0,e[2]=0,e[3]=0,e[4]=t.y,e[5]=0,e[6]=0,e[7]=0,e[8]=t.z,e):new ot(t.x,0,0,0,t.y,0,0,0,t.z)},ot.fromUniformScale=function(t,e){return M.typeOf.number("scale",t),d(e)?(e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=t,e[5]=0,e[6]=0,e[7]=0,e[8]=t,e):new ot(t,0,0,0,t,0,0,0,t)},ot.fromCrossProduct=function(t,e){return M.typeOf.object("vector",t),d(e)?(e[0]=0,e[1]=t.z,e[2]=-t.y,e[3]=-t.z,e[4]=0,e[5]=t.x,e[6]=t.y,e[7]=-t.x,e[8]=0,e):new ot(0,-t.z,t.y,t.z,0,-t.x,-t.y,t.x,0)},ot.fromRotationX=function(t,e){M.typeOf.number("angle",t);const n=Math.cos(t),r=Math.sin(t);return d(e)?(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=n,e[5]=r,e[6]=0,e[7]=-r,e[8]=n,e):new ot(1,0,0,0,n,-r,0,r,n)},ot.fromRotationY=function(t,e){M.typeOf.number("angle",t);const n=Math.cos(t),r=Math.sin(t);return d(e)?(e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=1,e[5]=0,e[6]=r,e[7]=0,e[8]=n,e):new ot(n,0,r,0,1,0,-r,0,n)},ot.fromRotationZ=function(t,e){M.typeOf.number("angle",t);const n=Math.cos(t),r=Math.sin(t);return d(e)?(e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e):new ot(n,-r,0,r,n,0,0,0,1)},ot.toArray=function(t,e){return M.typeOf.object("matrix",t),d(e)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e):[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},ot.getElementIndex=function(t,e){return M.typeOf.number.greaterThanOrEquals("row",e,0),M.typeOf.number.lessThanOrEquals("row",e,2),M.typeOf.number.greaterThanOrEquals("column",t,0),M.typeOf.number.lessThanOrEquals("column",t,2),3*t+e},ot.getColumn=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,2),M.typeOf.object("result",n);const r=3*e,o=t[r],i=t[r+1],s=t[r+2];return n.x=o,n.y=i,n.z=s,n},ot.setColumn=function(t,e,n,r){M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,2),M.typeOf.object("cartesian",n),M.typeOf.object("result",r);const o=3*e;return(r=ot.clone(t,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r},ot.getRow=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,2),M.typeOf.object("result",n);const r=t[e],o=t[e+3],i=t[e+6];return n.x=r,n.y=o,n.z=i,n},ot.setRow=function(t,e,n,r){return M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,2),M.typeOf.object("cartesian",n),M.typeOf.object("result",r),(r=ot.clone(t,r))[e]=n.x,r[e+3]=n.y,r[e+6]=n.z,r};const it=new K;ot.setScale=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("scale",e),M.typeOf.object("result",n);const r=ot.getScale(t,it),o=e.x/r.x,i=e.y/r.y,s=e.z/r.z;return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*s,n[7]=t[7]*s,n[8]=t[8]*s,n};const st=new K;ot.setUniformScale=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.number("scale",e),M.typeOf.object("result",n);const r=ot.getScale(t,st),o=e/r.x,i=e/r.y,s=e/r.z;return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*s,n[7]=t[7]*s,n[8]=t[8]*s,n};const at=new K;ot.getScale=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e.x=K.magnitude(K.fromElements(t[0],t[1],t[2],at)),e.y=K.magnitude(K.fromElements(t[3],t[4],t[5],at)),e.z=K.magnitude(K.fromElements(t[6],t[7],t[8],at)),e};const ct=new K;ot.getMaximumScale=function(t){return ot.getScale(t,ct),K.maximumComponent(ct)};const ut=new K;ot.setRotation=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("result",n);const r=ot.getScale(t,ut);return n[0]=e[0]*r.x,n[1]=e[1]*r.x,n[2]=e[2]*r.x,n[3]=e[3]*r.y,n[4]=e[4]*r.y,n[5]=e[5]*r.y,n[6]=e[6]*r.z,n[7]=e[7]*r.z,n[8]=e[8]*r.z,n};const lt=new K;ot.getRotation=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=ot.getScale(t,lt);return e[0]=t[0]/n.x,e[1]=t[1]/n.x,e[2]=t[2]/n.x,e[3]=t[3]/n.y,e[4]=t[4]/n.y,e[5]=t[5]/n.y,e[6]=t[6]/n.z,e[7]=t[7]/n.z,e[8]=t[8]/n.z,e},ot.multiply=function(t,e,n){M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n);const r=t[0]*e[0]+t[3]*e[1]+t[6]*e[2],o=t[1]*e[0]+t[4]*e[1]+t[7]*e[2],i=t[2]*e[0]+t[5]*e[1]+t[8]*e[2],s=t[0]*e[3]+t[3]*e[4]+t[6]*e[5],a=t[1]*e[3]+t[4]*e[4]+t[7]*e[5],c=t[2]*e[3]+t[5]*e[4]+t[8]*e[5],u=t[0]*e[6]+t[3]*e[7]+t[6]*e[8],l=t[1]*e[6]+t[4]*e[7]+t[7]*e[8],f=t[2]*e[6]+t[5]*e[7]+t[8]*e[8];return n[0]=r,n[1]=o,n[2]=i,n[3]=s,n[4]=a,n[5]=c,n[6]=u,n[7]=l,n[8]=f,n},ot.add=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n},ot.subtract=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n},ot.multiplyByVector=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("cartesian",e),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=t[0]*r+t[3]*o+t[6]*i,a=t[1]*r+t[4]*o+t[7]*i,c=t[2]*r+t[5]*o+t[8]*i;return n.x=s,n.y=a,n.z=c,n},ot.multiplyByScalar=function(t,e,n){return M.typeOf.object("matrix",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n},ot.multiplyByScale=function(t,e,n){return M.typeOf.object("matrix",t),M.typeOf.object("scale",e),M.typeOf.object("result",n),n[0]=t[0]*e.x,n[1]=t[1]*e.x,n[2]=t[2]*e.x,n[3]=t[3]*e.y,n[4]=t[4]*e.y,n[5]=t[5]*e.y,n[6]=t[6]*e.z,n[7]=t[7]*e.z,n[8]=t[8]*e.z,n},ot.multiplyByUniformScale=function(t,e,n){return M.typeOf.object("matrix",t),M.typeOf.number("scale",e),M.typeOf.object("result",n),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n},ot.negate=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e},ot.transpose=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=t[0],r=t[3],o=t[6],i=t[1],s=t[4],a=t[7],c=t[2],u=t[5],l=t[8];return e[0]=n,e[1]=r,e[2]=o,e[3]=i,e[4]=s,e[5]=a,e[6]=c,e[7]=u,e[8]=l,e};const ft=[1,0,0],pt=[2,2,1];function ht(t){let e=0;for(let n=0;n<3;++n){const r=t[ot.getElementIndex(pt[n],ft[n])];e+=2*r*r}return Math.sqrt(e)}function _t(t,e){const n=U.EPSILON15;let r=0,o=1;for(let e=0;e<3;++e){const n=Math.abs(t[ot.getElementIndex(pt[e],ft[e])]);n>r&&(o=e,r=n)}let i=1,s=0;const a=ft[o],c=pt[o];if(Math.abs(t[ot.getElementIndex(c,a)])>n){const e=(t[ot.getElementIndex(c,c)]-t[ot.getElementIndex(a,a)])/2/t[ot.getElementIndex(c,a)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),i=1/Math.sqrt(1+n*n),s=n*i}return(e=ot.clone(ot.IDENTITY,e))[ot.getElementIndex(a,a)]=e[ot.getElementIndex(c,c)]=i,e[ot.getElementIndex(c,a)]=s,e[ot.getElementIndex(a,c)]=-s,e}const yt=new ot,dt=new ot;ot.computeEigenDecomposition=function(t,e){M.typeOf.object("matrix",t);const n=U.EPSILON20;let r=0,o=0;d(e)||(e={});const i=e.unitary=ot.clone(ot.IDENTITY,e.unitary),s=e.diagonal=ot.clone(t,e.diagonal),a=n*function(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}(s);for(;o<10&&ht(s)>a;)_t(s,yt),ot.transpose(yt,dt),ot.multiply(s,yt,s),ot.multiply(dt,s,s),ot.multiply(i,yt,i),++r>2&&(++o,r=0);return e},ot.abs=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e[3]=Math.abs(t[3]),e[4]=Math.abs(t[4]),e[5]=Math.abs(t[5]),e[6]=Math.abs(t[6]),e[7]=Math.abs(t[7]),e[8]=Math.abs(t[8]),e},ot.determinant=function(t){M.typeOf.object("matrix",t);const e=t[0],n=t[3],r=t[6],o=t[1],i=t[4],s=t[7],a=t[2],c=t[5],u=t[8];return e*(i*u-c*s)+o*(c*r-n*u)+a*(n*s-i*r)},ot.inverse=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=t[0],r=t[1],o=t[2],i=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=t[8],f=ot.determinant(t);if(Math.abs(f)<=U.EPSILON15)throw new E("matrix is not invertible");e[0]=s*l-u*a,e[1]=u*o-r*l,e[2]=r*a-s*o,e[3]=c*a-i*l,e[4]=n*l-c*o,e[5]=i*o-n*a,e[6]=i*u-c*s,e[7]=c*r-n*u,e[8]=n*s-i*r;const p=1/f;return ot.multiplyByScalar(e,p,e)};const Et=new ot;function mt(t,e,n,r){this.x=t??0,this.y=e??0,this.z=n??0,this.w=r??0}ot.inverseTranspose=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),ot.inverse(ot.transpose(t,Et),e)},ot.equals=function(t,e){return t===e||d(t)&&d(e)&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},ot.equalsEpsilon=function(t,e,n){return n=n??0,t===e||d(t)&&d(e)&&Math.abs(t[0]-e[0])<=n&&Math.abs(t[1]-e[1])<=n&&Math.abs(t[2]-e[2])<=n&&Math.abs(t[3]-e[3])<=n&&Math.abs(t[4]-e[4])<=n&&Math.abs(t[5]-e[5])<=n&&Math.abs(t[6]-e[6])<=n&&Math.abs(t[7]-e[7])<=n&&Math.abs(t[8]-e[8])<=n},ot.IDENTITY=Object.freeze(new ot(1,0,0,0,1,0,0,0,1)),ot.ZERO=Object.freeze(new ot(0,0,0,0,0,0,0,0,0)),ot.COLUMN0ROW0=0,ot.COLUMN0ROW1=1,ot.COLUMN0ROW2=2,ot.COLUMN1ROW0=3,ot.COLUMN1ROW1=4,ot.COLUMN1ROW2=5,ot.COLUMN2ROW0=6,ot.COLUMN2ROW1=7,ot.COLUMN2ROW2=8,Object.defineProperties(ot.prototype,{length:{get:function(){return ot.packedLength}}}),ot.prototype.clone=function(t){return ot.clone(this,t)},ot.prototype.equals=function(t){return ot.equals(this,t)},ot.equalsArray=function(t,e,n){return t[0]===e[n]&&t[1]===e[n+1]&&t[2]===e[n+2]&&t[3]===e[n+3]&&t[4]===e[n+4]&&t[5]===e[n+5]&&t[6]===e[n+6]&&t[7]===e[n+7]&&t[8]===e[n+8]},ot.prototype.equalsEpsilon=function(t,e){return ot.equalsEpsilon(this,t,e)},ot.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})\n(${this[1]}, ${this[4]}, ${this[7]})\n(${this[2]}, ${this[5]}, ${this[8]})`},mt.fromElements=function(t,e,n,r,o){return d(o)?(o.x=t,o.y=e,o.z=n,o.w=r,o):new mt(t,e,n,r)},mt.fromColor=function(t,e){return M.typeOf.object("color",t),d(e)?(e.x=t.red,e.y=t.green,e.z=t.blue,e.w=t.alpha,e):new mt(t.red,t.green,t.blue,t.alpha)},mt.clone=function(t,e){if(d(t))return d(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e):new mt(t.x,t.y,t.z,t.w)},mt.packedLength=4,mt.pack=function(t,e,n){return M.typeOf.object("value",t),M.defined("array",e),n=n??0,e[n++]=t.x,e[n++]=t.y,e[n++]=t.z,e[n]=t.w,e},mt.unpack=function(t,e,n){return M.defined("array",t),e=e??0,d(n)||(n=new mt),n.x=t[e++],n.y=t[e++],n.z=t[e++],n.w=t[e],n},mt.packArray=function(t,e){M.defined("array",t);const n=t.length,r=4*n;if(d(e)){if(!Array.isArray(e)&&e.length!==r)throw new E("If result is a typed array, it must have exactly array.length * 4 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(let r=0;r<n;++r)mt.pack(t[r],e,4*r);return e},mt.unpackArray=function(t,e){if(M.defined("array",t),M.typeOf.number.greaterThanOrEquals("array.length",t.length,4),t.length%4!=0)throw new E("array length must be a multiple of 4.");const n=t.length;d(e)?e.length=n/4:e=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;e[n]=mt.unpack(t,r,e[n])}return e},mt.fromArray=mt.unpack,mt.maximumComponent=function(t){return M.typeOf.object("cartesian",t),Math.max(t.x,t.y,t.z,t.w)},mt.minimumComponent=function(t){return M.typeOf.object("cartesian",t),Math.min(t.x,t.y,t.z,t.w)},mt.minimumByComponent=function(t,e,n){return M.typeOf.object("first",t),M.typeOf.object("second",e),M.typeOf.object("result",n),n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.z=Math.min(t.z,e.z),n.w=Math.min(t.w,e.w),n},mt.maximumByComponent=function(t,e,n){return M.typeOf.object("first",t),M.typeOf.object("second",e),M.typeOf.object("result",n),n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.z=Math.max(t.z,e.z),n.w=Math.max(t.w,e.w),n},mt.clamp=function(t,e,n,r){M.typeOf.object("value",t),M.typeOf.object("min",e),M.typeOf.object("max",n),M.typeOf.object("result",r);const o=U.clamp(t.x,e.x,n.x),i=U.clamp(t.y,e.y,n.y),s=U.clamp(t.z,e.z,n.z),a=U.clamp(t.w,e.w,n.w);return r.x=o,r.y=i,r.z=s,r.w=a,r},mt.magnitudeSquared=function(t){return M.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w},mt.magnitude=function(t){return Math.sqrt(mt.magnitudeSquared(t))};const gt=new mt;mt.distance=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),mt.subtract(t,e,gt),mt.magnitude(gt)},mt.distanceSquared=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),mt.subtract(t,e,gt),mt.magnitudeSquared(gt)},mt.normalize=function(t,e){M.typeOf.object("cartesian",t),M.typeOf.object("result",e);const n=mt.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,e.w=t.w/n,isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||isNaN(e.w))throw new E("normalized result is not a number");return e},mt.dot=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w},mt.multiplyComponents=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n.w=t.w*e.w,n},mt.divideComponents=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n.w=t.w/e.w,n},mt.add=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n.w=t.w+e.w,n},mt.subtract=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n.w=t.w-e.w,n},mt.multiplyByScalar=function(t,e,n){return M.typeOf.object("cartesian",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n.w=t.w*e,n},mt.divideByScalar=function(t,e,n){return M.typeOf.object("cartesian",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n.w=t.w/e,n},mt.negate=function(t,e){return M.typeOf.object("cartesian",t),M.typeOf.object("result",e),e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=-t.w,e},mt.abs=function(t,e){return M.typeOf.object("cartesian",t),M.typeOf.object("result",e),e.x=Math.abs(t.x),e.y=Math.abs(t.y),e.z=Math.abs(t.z),e.w=Math.abs(t.w),e};const Tt=new mt;mt.lerp=function(t,e,n,r){return M.typeOf.object("start",t),M.typeOf.object("end",e),M.typeOf.number("t",n),M.typeOf.object("result",r),mt.multiplyByScalar(e,n,Tt),r=mt.multiplyByScalar(t,1-n,r),mt.add(Tt,r,r)};const Ot=new mt;mt.mostOrthogonalAxis=function(t,e){M.typeOf.object("cartesian",t),M.typeOf.object("result",e);const n=mt.normalize(t,Ot);return mt.abs(n,n),e=n.x<=n.y?n.x<=n.z?n.x<=n.w?mt.clone(mt.UNIT_X,e):mt.clone(mt.UNIT_W,e):n.z<=n.w?mt.clone(mt.UNIT_Z,e):mt.clone(mt.UNIT_W,e):n.y<=n.z?n.y<=n.w?mt.clone(mt.UNIT_Y,e):mt.clone(mt.UNIT_W,e):n.z<=n.w?mt.clone(mt.UNIT_Z,e):mt.clone(mt.UNIT_W,e)},mt.equals=function(t,e){return t===e||d(t)&&d(e)&&t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},mt.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]&&t.z===e[n+2]&&t.w===e[n+3]},mt.equalsEpsilon=function(t,e,n,r){return t===e||d(t)&&d(e)&&U.equalsEpsilon(t.x,e.x,n,r)&&U.equalsEpsilon(t.y,e.y,n,r)&&U.equalsEpsilon(t.z,e.z,n,r)&&U.equalsEpsilon(t.w,e.w,n,r)},mt.ZERO=Object.freeze(new mt(0,0,0,0)),mt.ONE=Object.freeze(new mt(1,1,1,1)),mt.UNIT_X=Object.freeze(new mt(1,0,0,0)),mt.UNIT_Y=Object.freeze(new mt(0,1,0,0)),mt.UNIT_Z=Object.freeze(new mt(0,0,1,0)),mt.UNIT_W=Object.freeze(new mt(0,0,0,1)),mt.prototype.clone=function(t){return mt.clone(this,t)},mt.prototype.equals=function(t){return mt.equals(this,t)},mt.prototype.equalsEpsilon=function(t,e,n){return mt.equalsEpsilon(this,t,e,n)},mt.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const bt=new Float32Array(1),vt=new Uint8Array(bt.buffer),Rt=new Uint32Array([287454020]),At=68===new Uint8Array(Rt.buffer)[0];mt.packFloat=function(t,e){return M.typeOf.number("value",t),d(e)||(e=new mt),bt[0]=t,At?(e.x=vt[0],e.y=vt[1],e.z=vt[2],e.w=vt[3]):(e.x=vt[3],e.y=vt[2],e.z=vt[1],e.w=vt[0]),e},mt.unpackFloat=function(t){return M.typeOf.object("packedFloat",t),At?(vt[0]=t.x,vt[1]=t.y,vt[2]=t.z,vt[3]=t.w):(vt[0]=t.w,vt[1]=t.z,vt[2]=t.y,vt[3]=t.x),bt[0]};const xt={};function wt(t){let e;this.name="RuntimeError",this.message=t;try{throw new Error}catch(t){e=t.stack}this.stack=e}function St(t,e,n,r,o,i,s,a,c,u,l,f,p,h,_,y){this[0]=t??0,this[1]=o??0,this[2]=c??0,this[3]=p??0,this[4]=e??0,this[5]=i??0,this[6]=u??0,this[7]=h??0,this[8]=n??0,this[9]=s??0,this[10]=l??0,this[11]=_??0,this[12]=r??0,this[13]=a??0,this[14]=f??0,this[15]=y??0}xt.EMPTY_OBJECT=Object.freeze({}),xt.EMPTY_ARRAY=Object.freeze([]),d(Object.create)&&(wt.prototype=Object.create(Error.prototype),wt.prototype.constructor=wt),wt.prototype.toString=function(){let t=`${this.name}: ${this.message}`;return d(this.stack)&&(t+=`\n${this.stack.toString()}`),t},St.packedLength=16,St.pack=function(t,e,n){return M.typeOf.object("value",t),M.defined("array",e),n=n??0,e[n++]=t[0],e[n++]=t[1],e[n++]=t[2],e[n++]=t[3],e[n++]=t[4],e[n++]=t[5],e[n++]=t[6],e[n++]=t[7],e[n++]=t[8],e[n++]=t[9],e[n++]=t[10],e[n++]=t[11],e[n++]=t[12],e[n++]=t[13],e[n++]=t[14],e[n]=t[15],e},St.unpack=function(t,e,n){return M.defined("array",t),e=e??0,d(n)||(n=new St),n[0]=t[e++],n[1]=t[e++],n[2]=t[e++],n[3]=t[e++],n[4]=t[e++],n[5]=t[e++],n[6]=t[e++],n[7]=t[e++],n[8]=t[e++],n[9]=t[e++],n[10]=t[e++],n[11]=t[e++],n[12]=t[e++],n[13]=t[e++],n[14]=t[e++],n[15]=t[e],n},St.packArray=function(t,e){M.defined("array",t);const n=t.length,r=16*n;if(d(e)){if(!Array.isArray(e)&&e.length!==r)throw new E("If result is a typed array, it must have exactly array.length * 16 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(let r=0;r<n;++r)St.pack(t[r],e,16*r);return e},St.unpackArray=function(t,e){if(M.defined("array",t),M.typeOf.number.greaterThanOrEquals("array.length",t.length,16),t.length%16!=0)throw new E("array length must be a multiple of 16.");const n=t.length;d(e)?e.length=n/16:e=new Array(n/16);for(let r=0;r<n;r+=16){const n=r/16;e[n]=St.unpack(t,r,e[n])}return e},St.clone=function(t,e){if(d(t))return d(e)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e):new St(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])},St.fromArray=St.unpack,St.fromColumnMajorArray=function(t,e){return M.defined("values",t),St.clone(t,e)},St.fromRowMajorArray=function(t,e){return M.defined("values",t),d(e)?(e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e):new St(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},St.fromRotationTranslation=function(t,e,n){return M.typeOf.object("rotation",t),e=e??K.ZERO,d(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=0,n[4]=t[3],n[5]=t[4],n[6]=t[5],n[7]=0,n[8]=t[6],n[9]=t[7],n[10]=t[8],n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,n):new St(t[0],t[3],t[6],e.x,t[1],t[4],t[7],e.y,t[2],t[5],t[8],e.z,0,0,0,1)},St.fromTranslationQuaternionRotationScale=function(t,e,n,r){M.typeOf.object("translation",t),M.typeOf.object("rotation",e),M.typeOf.object("scale",n),d(r)||(r=new St);const o=n.x,i=n.y,s=n.z,a=e.x*e.x,c=e.x*e.y,u=e.x*e.z,l=e.x*e.w,f=e.y*e.y,p=e.y*e.z,h=e.y*e.w,_=e.z*e.z,y=e.z*e.w,E=e.w*e.w,m=a-f-_+E,g=2*(c-y),T=2*(u+h),O=2*(c+y),b=-a+f-_+E,v=2*(p-l),R=2*(u-h),A=2*(p+l),x=-a-f+_+E;return r[0]=m*o,r[1]=O*o,r[2]=R*o,r[3]=0,r[4]=g*i,r[5]=b*i,r[6]=A*i,r[7]=0,r[8]=T*s,r[9]=v*s,r[10]=x*s,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,r},St.fromTranslationRotationScale=function(t,e){return M.typeOf.object("translationRotationScale",t),St.fromTranslationQuaternionRotationScale(t.translation,t.rotation,t.scale,e)},St.fromTranslation=function(t,e){return M.typeOf.object("translation",t),St.fromRotationTranslation(ot.IDENTITY,t,e)},St.fromScale=function(t,e){return M.typeOf.object("scale",t),d(e)?(e[0]=t.x,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t.y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t.z,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e):new St(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1)},St.fromUniformScale=function(t,e){return M.typeOf.number("scale",t),d(e)?(e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e):new St(t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1)},St.fromRotation=function(t,e){return M.typeOf.object("rotation",t),d(e)||(e=new St),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[3],e[5]=t[4],e[6]=t[5],e[7]=0,e[8]=t[6],e[9]=t[7],e[10]=t[8],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};const Nt=new K,Ct=new K,It=new K;St.fromCamera=function(t,e){M.typeOf.object("camera",t);const n=t.position,r=t.direction,o=t.up;M.typeOf.object("camera.position",n),M.typeOf.object("camera.direction",r),M.typeOf.object("camera.up",o),K.normalize(r,Nt),K.normalize(K.cross(Nt,o,Ct),Ct),K.normalize(K.cross(Ct,Nt,It),It);const i=Ct.x,s=Ct.y,a=Ct.z,c=Nt.x,u=Nt.y,l=Nt.z,f=It.x,p=It.y,h=It.z,_=n.x,y=n.y,E=n.z,m=i*-_+s*-y+a*-E,g=f*-_+p*-y+h*-E,T=c*_+u*y+l*E;return d(e)?(e[0]=i,e[1]=f,e[2]=-c,e[3]=0,e[4]=s,e[5]=p,e[6]=-u,e[7]=0,e[8]=a,e[9]=h,e[10]=-l,e[11]=0,e[12]=m,e[13]=g,e[14]=T,e[15]=1,e):new St(i,s,a,m,f,p,h,g,-c,-u,-l,T,0,0,0,1)},St.computePerspectiveFieldOfView=function(t,e,n,r,o){M.typeOf.number.greaterThan("fovY",t,0),M.typeOf.number.lessThan("fovY",t,Math.PI),M.typeOf.number.greaterThan("near",n,0),M.typeOf.number.greaterThan("far",r,0),M.typeOf.object("result",o);const i=1/Math.tan(.5*t),s=i/e,a=(r+n)/(n-r),c=2*r*n/(n-r);return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=a,o[11]=-1,o[12]=0,o[13]=0,o[14]=c,o[15]=0,o},St.computeOrthographicOffCenter=function(t,e,n,r,o,i,s){M.typeOf.number("left",t),M.typeOf.number("right",e),M.typeOf.number("bottom",n),M.typeOf.number("top",r),M.typeOf.number("near",o),M.typeOf.number("far",i),M.typeOf.object("result",s);let a=1/(e-t),c=1/(r-n),u=1/(i-o);const l=-(e+t)*a,f=-(r+n)*c,p=-(i+o)*u;return a*=2,c*=2,u*=-2,s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=u,s[11]=0,s[12]=l,s[13]=f,s[14]=p,s[15]=1,s},St.computePerspectiveOffCenter=function(t,e,n,r,o,i,s){M.typeOf.number("left",t),M.typeOf.number("right",e),M.typeOf.number("bottom",n),M.typeOf.number("top",r),M.typeOf.number("near",o),M.typeOf.number("far",i),M.typeOf.object("result",s);const a=2*o/(e-t),c=2*o/(r-n),u=(e+t)/(e-t),l=(r+n)/(r-n),f=-(i+o)/(i-o),p=-2*i*o/(i-o);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=u,s[9]=l,s[10]=f,s[11]=-1,s[12]=0,s[13]=0,s[14]=p,s[15]=0,s},St.computeInfinitePerspectiveOffCenter=function(t,e,n,r,o,i){M.typeOf.number("left",t),M.typeOf.number("right",e),M.typeOf.number("bottom",n),M.typeOf.number("top",r),M.typeOf.number("near",o),M.typeOf.object("result",i);const s=2*o/(e-t),a=2*o/(r-n),c=(e+t)/(e-t),u=(r+n)/(r-n),l=-2*o;return i[0]=s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=c,i[9]=u,i[10]=-1,i[11]=-1,i[12]=0,i[13]=0,i[14]=l,i[15]=0,i},St.computeViewportTransformation=function(t,e,n,r){d(r)||(r=new St);const o=(t=t??xt.EMPTY_OBJECT).x??0,i=t.y??0;e=e??0;const s=.5*(t.width??0),a=.5*(t.height??0),c=.5*((n=n??1)-e),u=s,l=a,f=c,p=o+s,h=i+a,_=e+c;return r[0]=u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=f,r[11]=0,r[12]=p,r[13]=h,r[14]=_,r[15]=1,r},St.computeView=function(t,e,n,r,o){return M.typeOf.object("position",t),M.typeOf.object("direction",e),M.typeOf.object("up",n),M.typeOf.object("right",r),M.typeOf.object("result",o),o[0]=r.x,o[1]=n.x,o[2]=-e.x,o[3]=0,o[4]=r.y,o[5]=n.y,o[6]=-e.y,o[7]=0,o[8]=r.z,o[9]=n.z,o[10]=-e.z,o[11]=0,o[12]=-K.dot(r,t),o[13]=-K.dot(n,t),o[14]=K.dot(e,t),o[15]=1,o},St.toArray=function(t,e){return M.typeOf.object("matrix",t),d(e)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e):[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},St.getElementIndex=function(t,e){return M.typeOf.number.greaterThanOrEquals("row",e,0),M.typeOf.number.lessThanOrEquals("row",e,3),M.typeOf.number.greaterThanOrEquals("column",t,0),M.typeOf.number.lessThanOrEquals("column",t,3),4*t+e},St.getColumn=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,3),M.typeOf.object("result",n);const r=4*e,o=t[r],i=t[r+1],s=t[r+2],a=t[r+3];return n.x=o,n.y=i,n.z=s,n.w=a,n},St.setColumn=function(t,e,n,r){M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,3),M.typeOf.object("cartesian",n),M.typeOf.object("result",r);const o=4*e;return(r=St.clone(t,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r[o+3]=n.w,r},St.getRow=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,3),M.typeOf.object("result",n);const r=t[e],o=t[e+4],i=t[e+8],s=t[e+12];return n.x=r,n.y=o,n.z=i,n.w=s,n},St.setRow=function(t,e,n,r){return M.typeOf.object("matrix",t),M.typeOf.number.greaterThanOrEquals("index",e,0),M.typeOf.number.lessThanOrEquals("index",e,3),M.typeOf.object("cartesian",n),M.typeOf.object("result",r),(r=St.clone(t,r))[e]=n.x,r[e+4]=n.y,r[e+8]=n.z,r[e+12]=n.w,r},St.setTranslation=function(t,e,n){return M.typeOf.object("matrix",t),M.typeOf.object("translation",e),M.typeOf.object("result",n),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=t[15],n};const jt=new K;St.setScale=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("scale",e),M.typeOf.object("result",n);const r=St.getScale(t,jt),o=e.x/r.x,i=e.y/r.y,s=e.z/r.z;return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3],n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7],n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};const Mt=new K;St.setUniformScale=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.number("scale",e),M.typeOf.object("result",n);const r=St.getScale(t,Mt),o=e/r.x,i=e/r.y,s=e/r.z;return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3],n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7],n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};const Ft=new K;St.getScale=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e.x=K.magnitude(K.fromElements(t[0],t[1],t[2],Ft)),e.y=K.magnitude(K.fromElements(t[4],t[5],t[6],Ft)),e.z=K.magnitude(K.fromElements(t[8],t[9],t[10],Ft)),e};const Ut=new K;St.getMaximumScale=function(t){return St.getScale(t,Ut),K.maximumComponent(Ut)};const Pt=new K;St.setRotation=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("result",n);const r=St.getScale(t,Pt);return n[0]=e[0]*r.x,n[1]=e[1]*r.x,n[2]=e[2]*r.x,n[3]=t[3],n[4]=e[3]*r.y,n[5]=e[4]*r.y,n[6]=e[5]*r.y,n[7]=t[7],n[8]=e[6]*r.z,n[9]=e[7]*r.z,n[10]=e[8]*r.z,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};const Lt=new K;St.getRotation=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=St.getScale(t,Lt);return e[0]=t[0]/n.x,e[1]=t[1]/n.x,e[2]=t[2]/n.x,e[3]=t[4]/n.y,e[4]=t[5]/n.y,e[5]=t[6]/n.y,e[6]=t[8]/n.z,e[7]=t[9]/n.z,e[8]=t[10]/n.z,e},St.multiply=function(t,e,n){M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n);const r=t[0],o=t[1],i=t[2],s=t[3],a=t[4],c=t[5],u=t[6],l=t[7],f=t[8],p=t[9],h=t[10],_=t[11],y=t[12],d=t[13],E=t[14],m=t[15],g=e[0],T=e[1],O=e[2],b=e[3],v=e[4],R=e[5],A=e[6],x=e[7],w=e[8],S=e[9],N=e[10],C=e[11],I=e[12],j=e[13],F=e[14],U=e[15],P=r*g+a*T+f*O+y*b,L=o*g+c*T+p*O+d*b,B=i*g+u*T+h*O+E*b,D=s*g+l*T+_*O+m*b,k=r*v+a*R+f*A+y*x,z=o*v+c*R+p*A+d*x,G=i*v+u*R+h*A+E*x,H=s*v+l*R+_*A+m*x,V=r*w+a*S+f*N+y*C,X=o*w+c*S+p*N+d*C,q=i*w+u*S+h*N+E*C,Y=s*w+l*S+_*N+m*C,W=r*I+a*j+f*F+y*U,$=o*I+c*j+p*F+d*U,K=i*I+u*j+h*F+E*U,Z=s*I+l*j+_*F+m*U;return n[0]=P,n[1]=L,n[2]=B,n[3]=D,n[4]=k,n[5]=z,n[6]=G,n[7]=H,n[8]=V,n[9]=X,n[10]=q,n[11]=Y,n[12]=W,n[13]=$,n[14]=K,n[15]=Z,n},St.add=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n},St.subtract=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n},St.multiplyTransformation=function(t,e,n){M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n);const r=t[0],o=t[1],i=t[2],s=t[4],a=t[5],c=t[6],u=t[8],l=t[9],f=t[10],p=t[12],h=t[13],_=t[14],y=e[0],d=e[1],E=e[2],m=e[4],g=e[5],T=e[6],O=e[8],b=e[9],v=e[10],R=e[12],A=e[13],x=e[14],w=r*y+s*d+u*E,S=o*y+a*d+l*E,N=i*y+c*d+f*E,C=r*m+s*g+u*T,I=o*m+a*g+l*T,j=i*m+c*g+f*T,F=r*O+s*b+u*v,U=o*O+a*b+l*v,P=i*O+c*b+f*v,L=r*R+s*A+u*x+p,B=o*R+a*A+l*x+h,D=i*R+c*A+f*x+_;return n[0]=w,n[1]=S,n[2]=N,n[3]=0,n[4]=C,n[5]=I,n[6]=j,n[7]=0,n[8]=F,n[9]=U,n[10]=P,n[11]=0,n[12]=L,n[13]=B,n[14]=D,n[15]=1,n},St.multiplyByMatrix3=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("rotation",e),M.typeOf.object("result",n);const r=t[0],o=t[1],i=t[2],s=t[4],a=t[5],c=t[6],u=t[8],l=t[9],f=t[10],p=e[0],h=e[1],_=e[2],y=e[3],d=e[4],E=e[5],m=e[6],g=e[7],T=e[8],O=r*p+s*h+u*_,b=o*p+a*h+l*_,v=i*p+c*h+f*_,R=r*y+s*d+u*E,A=o*y+a*d+l*E,x=i*y+c*d+f*E,w=r*m+s*g+u*T,S=o*m+a*g+l*T,N=i*m+c*g+f*T;return n[0]=O,n[1]=b,n[2]=v,n[3]=0,n[4]=R,n[5]=A,n[6]=x,n[7]=0,n[8]=w,n[9]=S,n[10]=N,n[11]=0,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},St.multiplyByTranslation=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("translation",e),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=r*t[0]+o*t[4]+i*t[8]+t[12],a=r*t[1]+o*t[5]+i*t[9]+t[13],c=r*t[2]+o*t[6]+i*t[10]+t[14];return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=s,n[13]=a,n[14]=c,n[15]=t[15],n},St.multiplyByScale=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("scale",e),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z;return 1===r&&1===o&&1===i?St.clone(t,n):(n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=t[3],n[4]=o*t[4],n[5]=o*t[5],n[6]=o*t[6],n[7]=t[7],n[8]=i*t[8],n[9]=i*t[9],n[10]=i*t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n)},St.multiplyByUniformScale=function(t,e,n){return M.typeOf.object("matrix",t),M.typeOf.number("scale",e),M.typeOf.object("result",n),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3],n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7],n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},St.multiplyByVector=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("cartesian",e),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=e.w,a=t[0]*r+t[4]*o+t[8]*i+t[12]*s,c=t[1]*r+t[5]*o+t[9]*i+t[13]*s,u=t[2]*r+t[6]*o+t[10]*i+t[14]*s,l=t[3]*r+t[7]*o+t[11]*i+t[15]*s;return n.x=a,n.y=c,n.z=u,n.w=l,n},St.multiplyByPointAsVector=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("cartesian",e),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=t[0]*r+t[4]*o+t[8]*i,a=t[1]*r+t[5]*o+t[9]*i,c=t[2]*r+t[6]*o+t[10]*i;return n.x=s,n.y=a,n.z=c,n},St.multiplyByPoint=function(t,e,n){M.typeOf.object("matrix",t),M.typeOf.object("cartesian",e),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=t[0]*r+t[4]*o+t[8]*i+t[12],a=t[1]*r+t[5]*o+t[9]*i+t[13],c=t[2]*r+t[6]*o+t[10]*i+t[14];return n.x=s,n.y=a,n.z=c,n},St.multiplyByScalar=function(t,e,n){return M.typeOf.object("matrix",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n},St.negate=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e},St.transpose=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=t[1],r=t[2],o=t[3],i=t[6],s=t[7],a=t[11];return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[10]=t[10],e[11]=t[14],e[12]=o,e[13]=s,e[14]=a,e[15]=t[15],e},St.abs=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e[3]=Math.abs(t[3]),e[4]=Math.abs(t[4]),e[5]=Math.abs(t[5]),e[6]=Math.abs(t[6]),e[7]=Math.abs(t[7]),e[8]=Math.abs(t[8]),e[9]=Math.abs(t[9]),e[10]=Math.abs(t[10]),e[11]=Math.abs(t[11]),e[12]=Math.abs(t[12]),e[13]=Math.abs(t[13]),e[14]=Math.abs(t[14]),e[15]=Math.abs(t[15]),e},St.equals=function(t,e){return t===e||d(t)&&d(e)&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[3]===e[3]&&t[7]===e[7]&&t[11]===e[11]&&t[15]===e[15]},St.equalsEpsilon=function(t,e,n){return n=n??0,t===e||d(t)&&d(e)&&Math.abs(t[0]-e[0])<=n&&Math.abs(t[1]-e[1])<=n&&Math.abs(t[2]-e[2])<=n&&Math.abs(t[3]-e[3])<=n&&Math.abs(t[4]-e[4])<=n&&Math.abs(t[5]-e[5])<=n&&Math.abs(t[6]-e[6])<=n&&Math.abs(t[7]-e[7])<=n&&Math.abs(t[8]-e[8])<=n&&Math.abs(t[9]-e[9])<=n&&Math.abs(t[10]-e[10])<=n&&Math.abs(t[11]-e[11])<=n&&Math.abs(t[12]-e[12])<=n&&Math.abs(t[13]-e[13])<=n&&Math.abs(t[14]-e[14])<=n&&Math.abs(t[15]-e[15])<=n},St.getTranslation=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e.x=t[12],e.y=t[13],e.z=t[14],e},St.getMatrix3=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e};const Bt=new ot,Dt=new ot,kt=new mt,zt=new mt(0,0,0,1);St.inverse=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=t[0],r=t[4],o=t[8],i=t[12],s=t[1],a=t[5],c=t[9],u=t[13],l=t[2],f=t[6],p=t[10],h=t[14],_=t[3],y=t[7],d=t[11],E=t[15];let m=p*E,g=h*d,T=f*E,O=h*y,b=f*d,v=p*y,R=l*E,A=h*_,x=l*d,w=p*_,S=l*y,N=f*_;const C=m*a+O*c+b*u-(g*a+T*c+v*u),I=g*s+R*c+w*u-(m*s+A*c+x*u),j=T*s+A*a+S*u-(O*s+R*a+N*u),F=v*s+x*a+N*c-(b*s+w*a+S*c),P=g*r+T*o+v*i-(m*r+O*o+b*i),L=m*n+A*o+x*i-(g*n+R*o+w*i),B=O*n+R*r+N*i-(T*n+A*r+S*i),D=b*n+w*r+S*o-(v*n+x*r+N*o);m=o*u,g=i*c,T=r*u,O=i*a,b=r*c,v=o*a,R=n*u,A=i*s,x=n*c,w=o*s,S=n*a,N=r*s;const k=m*y+O*d+b*E-(g*y+T*d+v*E),z=g*_+R*d+w*E-(m*_+A*d+x*E),G=T*_+A*y+S*E-(O*_+R*y+N*E),H=v*_+x*y+N*d-(b*_+w*y+S*d),V=T*p+v*h+g*f-(b*h+m*f+O*p),X=x*h+m*l+A*p-(R*p+w*h+g*l),q=R*f+N*h+O*l-(S*h+T*l+A*f),Y=S*p+b*l+w*f-(x*f+N*p+v*l);let W=n*C+r*I+o*j+i*F;if(Math.abs(W)<U.EPSILON21){if(ot.equalsEpsilon(St.getMatrix3(t,Bt),Dt,U.EPSILON7)&&mt.equals(St.getRow(t,3,kt),zt))return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=0,e[11]=0,e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=1,e;throw new wt("matrix is not invertible because its determinate is zero.")}return W=1/W,e[0]=C*W,e[1]=I*W,e[2]=j*W,e[3]=F*W,e[4]=P*W,e[5]=L*W,e[6]=B*W,e[7]=D*W,e[8]=k*W,e[9]=z*W,e[10]=G*W,e[11]=H*W,e[12]=V*W,e[13]=X*W,e[14]=q*W,e[15]=Y*W,e},St.inverseTransformation=function(t,e){M.typeOf.object("matrix",t),M.typeOf.object("result",e);const n=t[0],r=t[1],o=t[2],i=t[4],s=t[5],a=t[6],c=t[8],u=t[9],l=t[10],f=t[12],p=t[13],h=t[14],_=-n*f-r*p-o*h,y=-i*f-s*p-a*h,d=-c*f-u*p-l*h;return e[0]=n,e[1]=i,e[2]=c,e[3]=0,e[4]=r,e[5]=s,e[6]=u,e[7]=0,e[8]=o,e[9]=a,e[10]=l,e[11]=0,e[12]=_,e[13]=y,e[14]=d,e[15]=1,e};const Gt=new St;St.inverseTranspose=function(t,e){return M.typeOf.object("matrix",t),M.typeOf.object("result",e),St.inverse(St.transpose(t,Gt),e)},St.IDENTITY=Object.freeze(new St(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),St.ZERO=Object.freeze(new St(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),St.COLUMN0ROW0=0,St.COLUMN0ROW1=1,St.COLUMN0ROW2=2,St.COLUMN0ROW3=3,St.COLUMN1ROW0=4,St.COLUMN1ROW1=5,St.COLUMN1ROW2=6,St.COLUMN1ROW3=7,St.COLUMN2ROW0=8,St.COLUMN2ROW1=9,St.COLUMN2ROW2=10,St.COLUMN2ROW3=11,St.COLUMN3ROW0=12,St.COLUMN3ROW1=13,St.COLUMN3ROW2=14,St.COLUMN3ROW3=15,Object.defineProperties(St.prototype,{length:{get:function(){return St.packedLength}}}),St.prototype.clone=function(t){return St.clone(this,t)},St.prototype.equals=function(t){return St.equals(this,t)},St.equalsArray=function(t,e,n){return t[0]===e[n]&&t[1]===e[n+1]&&t[2]===e[n+2]&&t[3]===e[n+3]&&t[4]===e[n+4]&&t[5]===e[n+5]&&t[6]===e[n+6]&&t[7]===e[n+7]&&t[8]===e[n+8]&&t[9]===e[n+9]&&t[10]===e[n+10]&&t[11]===e[n+11]&&t[12]===e[n+12]&&t[13]===e[n+13]&&t[14]===e[n+14]&&t[15]===e[n+15]},St.prototype.equalsEpsilon=function(t,e){return St.equalsEpsilon(this,t,e)},St.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})\n(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})\n(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})\n(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};const Ht={X:0,Y:1,Z:2};Ht.Y_UP_TO_Z_UP=St.fromRotationTranslation(ot.fromArray([1,0,0,0,0,1,0,-1,0])),Ht.Z_UP_TO_Y_UP=St.fromRotationTranslation(ot.fromArray([1,0,0,0,0,-1,0,1,0])),Ht.X_UP_TO_Z_UP=St.fromRotationTranslation(ot.fromArray([0,0,1,0,1,0,-1,0,0])),Ht.Z_UP_TO_X_UP=St.fromRotationTranslation(ot.fromArray([0,0,-1,0,1,0,1,0,0])),Ht.X_UP_TO_Y_UP=St.fromRotationTranslation(ot.fromArray([0,1,0,-1,0,0,0,0,1])),Ht.Y_UP_TO_X_UP=St.fromRotationTranslation(ot.fromArray([0,-1,0,1,0,0,0,0,1])),Ht.fromName=function(t){return M.typeOf.string("name",t),Ht[t]};var Vt=Object.freeze(Ht);function Xt(t,e){this.x=t??0,this.y=e??0}Xt.fromElements=function(t,e,n){return d(n)?(n.x=t,n.y=e,n):new Xt(t,e)},Xt.clone=function(t,e){if(d(t))return d(e)?(e.x=t.x,e.y=t.y,e):new Xt(t.x,t.y)},Xt.fromCartesian3=Xt.clone,Xt.fromCartesian4=Xt.clone,Xt.packedLength=2,Xt.pack=function(t,e,n){return M.typeOf.object("value",t),M.defined("array",e),n=n??0,e[n++]=t.x,e[n]=t.y,e},Xt.unpack=function(t,e,n){return M.defined("array",t),e=e??0,d(n)||(n=new Xt),n.x=t[e++],n.y=t[e],n},Xt.packArray=function(t,e){M.defined("array",t);const n=t.length,r=2*n;if(d(e)){if(!Array.isArray(e)&&e.length!==r)throw new E("If result is a typed array, it must have exactly array.length * 2 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(let r=0;r<n;++r)Xt.pack(t[r],e,2*r);return e},Xt.unpackArray=function(t,e){if(M.defined("array",t),M.typeOf.number.greaterThanOrEquals("array.length",t.length,2),t.length%2!=0)throw new E("array length must be a multiple of 2.");const n=t.length;d(e)?e.length=n/2:e=new Array(n/2);for(let r=0;r<n;r+=2){const n=r/2;e[n]=Xt.unpack(t,r,e[n])}return e},Xt.fromArray=Xt.unpack,Xt.maximumComponent=function(t){return M.typeOf.object("cartesian",t),Math.max(t.x,t.y)},Xt.minimumComponent=function(t){return M.typeOf.object("cartesian",t),Math.min(t.x,t.y)},Xt.minimumByComponent=function(t,e,n){return M.typeOf.object("first",t),M.typeOf.object("second",e),M.typeOf.object("result",n),n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n},Xt.maximumByComponent=function(t,e,n){return M.typeOf.object("first",t),M.typeOf.object("second",e),M.typeOf.object("result",n),n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n},Xt.clamp=function(t,e,n,r){M.typeOf.object("value",t),M.typeOf.object("min",e),M.typeOf.object("max",n),M.typeOf.object("result",r);const o=U.clamp(t.x,e.x,n.x),i=U.clamp(t.y,e.y,n.y);return r.x=o,r.y=i,r},Xt.magnitudeSquared=function(t){return M.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y},Xt.magnitude=function(t){return Math.sqrt(Xt.magnitudeSquared(t))};const qt=new Xt;Xt.distance=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),Xt.subtract(t,e,qt),Xt.magnitude(qt)},Xt.distanceSquared=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),Xt.subtract(t,e,qt),Xt.magnitudeSquared(qt)},Xt.normalize=function(t,e){M.typeOf.object("cartesian",t),M.typeOf.object("result",e);const n=Xt.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,isNaN(e.x)||isNaN(e.y))throw new E("normalized result is not a number");return e},Xt.dot=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),t.x*e.x+t.y*e.y},Xt.cross=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),t.x*e.y-t.y*e.x},Xt.multiplyComponents=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x*e.x,n.y=t.y*e.y,n},Xt.divideComponents=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x/e.x,n.y=t.y/e.y,n},Xt.add=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x+e.x,n.y=t.y+e.y,n},Xt.subtract=function(t,e,n){return M.typeOf.object("left",t),M.typeOf.object("right",e),M.typeOf.object("result",n),n.x=t.x-e.x,n.y=t.y-e.y,n},Xt.multiplyByScalar=function(t,e,n){return M.typeOf.object("cartesian",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n.x=t.x*e,n.y=t.y*e,n},Xt.divideByScalar=function(t,e,n){return M.typeOf.object("cartesian",t),M.typeOf.number("scalar",e),M.typeOf.object("result",n),n.x=t.x/e,n.y=t.y/e,n},Xt.negate=function(t,e){return M.typeOf.object("cartesian",t),M.typeOf.object("result",e),e.x=-t.x,e.y=-t.y,e},Xt.abs=function(t,e){return M.typeOf.object("cartesian",t),M.typeOf.object("result",e),e.x=Math.abs(t.x),e.y=Math.abs(t.y),e};const Yt=new Xt;Xt.lerp=function(t,e,n,r){return M.typeOf.object("start",t),M.typeOf.object("end",e),M.typeOf.number("t",n),M.typeOf.object("result",r),Xt.multiplyByScalar(e,n,Yt),r=Xt.multiplyByScalar(t,1-n,r),Xt.add(Yt,r,r)};const Wt=new Xt,$t=new Xt;Xt.angleBetween=function(t,e){return M.typeOf.object("left",t),M.typeOf.object("right",e),Xt.normalize(t,Wt),Xt.normalize(e,$t),U.acosClamped(Xt.dot(Wt,$t))};const Kt=new Xt;function Zt(t,e){this.center=K.clone(t??K.ZERO),this.halfAxes=ot.clone(e??ot.ZERO)}Xt.mostOrthogonalAxis=function(t,e){M.typeOf.object("cartesian",t),M.typeOf.object("result",e);const n=Xt.normalize(t,Kt);return Xt.abs(n,n),e=n.x<=n.y?Xt.clone(Xt.UNIT_X,e):Xt.clone(Xt.UNIT_Y,e)},Xt.equals=function(t,e){return t===e||d(t)&&d(e)&&t.x===e.x&&t.y===e.y},Xt.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]},Xt.equalsEpsilon=function(t,e,n,r){return t===e||d(t)&&d(e)&&U.equalsEpsilon(t.x,e.x,n,r)&&U.equalsEpsilon(t.y,e.y,n,r)},Xt.ZERO=Object.freeze(new Xt(0,0)),Xt.ONE=Object.freeze(new Xt(1,1)),Xt.UNIT_X=Object.freeze(new Xt(1,0)),Xt.UNIT_Y=Object.freeze(new Xt(0,1)),Xt.prototype.clone=function(t){return Xt.clone(this,t)},Xt.prototype.equals=function(t){return Xt.equals(this,t)},Xt.prototype.equalsEpsilon=function(t,e,n){return Xt.equalsEpsilon(this,t,e,n)},Xt.prototype.toString=function(){return`(${this.x}, ${this.y})`},Zt.packedLength=K.packedLength+ot.packedLength,Zt.pack=function(t,e,n){return M.typeOf.object("value",t),M.defined("array",e),n=n??0,K.pack(t.center,e,n),ot.pack(t.halfAxes,e,n+K.packedLength),e},Zt.unpack=function(t,e,n){return M.defined("array",t),e=e??0,d(n)||(n=new Zt),K.unpack(t,e,n.center),ot.unpack(t,e+K.packedLength,n.halfAxes),n};const Qt=new K,Jt=new K,te=new K,ee=new K,ne=new K,re=new K,oe=new ot,ie={unitary:new ot,diagonal:new ot};Zt.fromPoints=function(t,e){if(d(e)||(e=new Zt),!d(t)||0===t.length)return e.halfAxes=ot.ZERO,e.center=K.ZERO,e;let n;const r=t.length,o=K.clone(t[0],Qt);for(n=1;n<r;n++)K.add(o,t[n],o);const i=1/r;K.multiplyByScalar(o,i,o);let s,a=0,c=0,u=0,l=0,f=0,p=0;for(n=0;n<r;n++)s=K.subtract(t[n],o,Jt),a+=s.x*s.x,c+=s.x*s.y,u+=s.x*s.z,l+=s.y*s.y,f+=s.y*s.z,p+=s.z*s.z;a*=i,c*=i,u*=i,l*=i,f*=i,p*=i;const h=oe;h[0]=a,h[1]=c,h[2]=u,h[3]=c,h[4]=l,h[5]=f,h[6]=u,h[7]=f,h[8]=p;const _=ot.computeEigenDecomposition(h,ie),y=ot.clone(_.unitary,e.halfAxes);let E=ot.getColumn(y,0,ee),m=ot.getColumn(y,1,ne),g=ot.getColumn(y,2,re),T=-Number.MAX_VALUE,O=-Number.MAX_VALUE,b=-Number.MAX_VALUE,v=Number.MAX_VALUE,R=Number.MAX_VALUE,A=Number.MAX_VALUE;for(n=0;n<r;n++)s=t[n],T=Math.max(K.dot(E,s),T),O=Math.max(K.dot(m,s),O),b=Math.max(K.dot(g,s),b),v=Math.min(K.dot(E,s),v),R=Math.min(K.dot(m,s),R),A=Math.min(K.dot(g,s),A);E=K.multiplyByScalar(E,.5*(v+T),E),m=K.multiplyByScalar(m,.5*(R+O),m),g=K.multiplyByScalar(g,.5*(A+b),g);const x=K.add(E,m,e.center);K.add(x,g,x);const w=te;return w.x=T-v,w.y=O-R,w.z=b-A,K.multiplyByScalar(w,.5,w),ot.multiplyByScale(e.halfAxes,w,e.halfAxes),e},Zt.clone=function(t,e){if(d(t))return d(e)?(K.clone(t.center,e.center),ot.clone(t.halfAxes,e.halfAxes),e):new Zt(t.center,t.halfAxes)},Zt.equals=function(t,e){return t===e||d(t)&&d(e)&&K.equals(t.center,e.center)&&ot.equals(t.halfAxes,e.halfAxes)},Zt.prototype.clone=function(t){return Zt.clone(this,t)},Zt.prototype.equals=function(t){return Zt.equals(this,t)};const se={};function ae(t,e,n,r,o){const i=K.subtract(t,e,scratchIntersectionPoint),s=K.dot(n,i),a=K.dot(r,i);return Xt.fromElements(s,a,o)}function ce(t,e,n=2){const r=e&&e.length,o=r?e[0]*n:t.length;let i=ue(t,0,o,n,!0);const s=[];if(!i||i.next===i.prev)return s;let a,c,u;if(r&&(i=function(t,e,n,r){const o=[];for(let n=0,i=e.length;n<i;n++){const s=ue(t,e[n]*r,n<i-1?e[n+1]*r:t.length,r,!1);s===s.next&&(s.steiner=!0),o.push(Te(s))}o.sort(de);for(let t=0;t<o.length;t++)n=Ee(o[t],n);return n}(t,e,i,n)),t.length>80*n){a=1/0,c=1/0;let e=-1/0,r=-1/0;for(let i=n;i<o;i+=n){const n=t[i],o=t[i+1];n<a&&(a=n),o<c&&(c=o),n>e&&(e=n),o>r&&(r=o)}u=Math.max(e-a,r-c),u=0!==u?32767/u:0}return fe(i,s,n,a,c,u,0),s}function ue(t,e,n,r,o){let i;if(o===function(t,e,n,r){let o=0;for(let i=e,s=n-r;i<n;i+=r)o+=(t[s]-t[i])*(t[i+1]+t[s+1]),s=i;return o}(t,e,n,r)>0)for(let o=e;o<n;o+=r)i=Ce(o/r|0,t[o],t[o+1],i);else for(let o=n-r;o>=e;o-=r)i=Ce(o/r|0,t[o],t[o+1],i);return i&&Re(i,i.next)&&(Ie(i),i=i.next),i}function le(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Re(r,r.next)&&0!==ve(r.prev,r,r.next))r=r.next;else{if(Ie(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function fe(t,e,n,r,o,i,s){if(!t)return;!s&&i&&function(t,e,n,r){let o=t;do{0===o.z&&(o.z=ge(o.x,o.y,e,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){let e,n=1;do{let r,o=t;t=null;let i=null;for(e=0;o;){e++;let s=o,a=0;for(let t=0;t<n&&(a++,s=s.nextZ,s);t++);let c=n;for(;a>0||c>0&&s;)0!==a&&(0===c||!s||o.z<=s.z)?(r=o,o=o.nextZ,a--):(r=s,s=s.nextZ,c--),i?i.nextZ=r:t=r,r.prevZ=i,i=r;o=s}i.nextZ=null,n*=2}while(e>1)}(o)}(t,r,o,i);let a=t;for(;t.prev!==t.next;){const c=t.prev,u=t.next;if(i?he(t,r,o,i):pe(t))e.push(c.i,t.i,u.i),Ie(t),t=u.next,a=u.next;else if((t=u)===a){s?1===s?fe(t=_e(le(t),e),e,n,r,o,i,2):2===s&&ye(t,e,n,r,o,i):fe(le(t),e,n,r,o,i,1);break}}}function pe(t){const e=t.prev,n=t,r=t.next;if(ve(e,n,r)>=0)return!1;const o=e.x,i=n.x,s=r.x,a=e.y,c=n.y,u=r.y,l=o<i?o<s?o:s:i<s?i:s,f=a<c?a<u?a:u:c<u?c:u,p=o>i?o>s?o:s:i>s?i:s,h=a>c?a>u?a:u:c>u?c:u;let _=r.next;for(;_!==e;){if(_.x>=l&&_.x<=p&&_.y>=f&&_.y<=h&&Oe(o,a,i,c,s,u,_.x,_.y)&&ve(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function he(t,e,n,r){const o=t.prev,i=t,s=t.next;if(ve(o,i,s)>=0)return!1;const a=o.x,c=i.x,u=s.x,l=o.y,f=i.y,p=s.y,h=a<c?a<u?a:u:c<u?c:u,_=l<f?l<p?l:p:f<p?f:p,y=a>c?a>u?a:u:c>u?c:u,d=l>f?l>p?l:p:f>p?f:p,E=ge(h,_,e,n,r),m=ge(y,d,e,n,r);let g=t.prevZ,T=t.nextZ;for(;g&&g.z>=E&&T&&T.z<=m;){if(g.x>=h&&g.x<=y&&g.y>=_&&g.y<=d&&g!==o&&g!==s&&Oe(a,l,c,f,u,p,g.x,g.y)&&ve(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,T.x>=h&&T.x<=y&&T.y>=_&&T.y<=d&&T!==o&&T!==s&&Oe(a,l,c,f,u,p,T.x,T.y)&&ve(T.prev,T,T.next)>=0)return!1;T=T.nextZ}for(;g&&g.z>=E;){if(g.x>=h&&g.x<=y&&g.y>=_&&g.y<=d&&g!==o&&g!==s&&Oe(a,l,c,f,u,p,g.x,g.y)&&ve(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;T&&T.z<=m;){if(T.x>=h&&T.x<=y&&T.y>=_&&T.y<=d&&T!==o&&T!==s&&Oe(a,l,c,f,u,p,T.x,T.y)&&ve(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function _e(t,e){let n=t;do{const r=n.prev,o=n.next.next;!Re(r,o)&&Ae(r,n,n.next,o)&&Se(r,o)&&Se(o,r)&&(e.push(r.i,n.i,o.i),Ie(n),Ie(n.next),n=t=o),n=n.next}while(n!==t);return le(n)}function ye(t,e,n,r,o,i){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&be(s,t)){let a=Ne(s,t);return s=le(s,s.next),a=le(a,a.next),fe(s,e,n,r,o,i,0),void fe(a,e,n,r,o,i,0)}t=t.next}s=s.next}while(s!==t)}function de(t,e){return t.x-e.x}function Ee(t,e){const n=function(t,e){let n=e;const r=t.x,o=t.y;let i,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const t=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s&&(s=t,i=n.x<n.next.x?n:n.next,t===r))return i}n=n.next}while(n!==e);if(!i)return null;const a=i,c=i.x,u=i.y;let l=1/0;n=i;do{if(r>=n.x&&n.x>=c&&r!==n.x&&Oe(o<u?r:s,o,c,u,o<u?s:r,o,n.x,n.y)){const e=Math.abs(o-n.y)/(r-n.x);Se(n,t)&&(e<l||e===l&&(n.x>i.x||n.x===i.x&&me(i,n)))&&(i=n,l=e)}n=n.next}while(n!==a);return i}(t,e);if(!n)return e;const r=Ne(n,t);return le(r,r.next),le(n,n.next)}function me(t,e){return ve(t.prev,t,e.prev)<0&&ve(e.next,t,t.next)<0}function ge(t,e,n,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Te(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Oe(t,e,n,r,o,i,s,a){return(o-s)*(e-a)>=(t-s)*(i-a)&&(t-s)*(r-a)>=(n-s)*(e-a)&&(n-s)*(i-a)>=(o-s)*(r-a)}function be(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ae(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Se(t,e)&&Se(e,t)&&function(t,e){let n=t,r=!1;const o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(ve(t.prev,t,e.prev)||ve(t,e.prev,e))||Re(t,e)&&ve(t.prev,t,t.next)>0&&ve(e.prev,e,e.next)>0)}function ve(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Re(t,e){return t.x===e.x&&t.y===e.y}function Ae(t,e,n,r){const o=we(ve(t,e,n)),i=we(ve(t,e,r)),s=we(ve(n,r,t)),a=we(ve(n,r,e));return o!==i&&s!==a||(!(0!==o||!xe(t,n,e))||(!(0!==i||!xe(t,r,e))||(!(0!==s||!xe(n,t,r))||!(0!==a||!xe(n,e,r)))))}function xe(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function we(t){return t>0?1:t<0?-1:0}function Se(t,e){return ve(t.prev,t,t.next)<0?ve(t,e,t.next)>=0&&ve(t,t.prev,e)>=0:ve(t,e,t.prev)<0||ve(t,t.next,e)<0}function Ne(t,e){const n=je(t.i,t.x,t.y),r=je(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Ce(t,e,n,r){const o=je(t,e,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Ie(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function je(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}se.computeProjectTo2DArguments=function(t,e,n,r){M.defined("positions",t),M.defined("centerResult",e),M.defined("planeAxis1Result",n),M.defined("planeAxis2Result",r);const o=Zt.fromPoints(t,obbScratch),i=o.halfAxes,s=ot.getColumn(i,0,scratchXAxis),a=ot.getColumn(i,1,scratchYAxis),c=ot.getColumn(i,2,scratchZAxis),u=K.magnitude(s),l=K.magnitude(a),f=K.magnitude(c),p=Math.min(u,l,f);if(0===u&&(0===l||0===f)||0===l&&0===f)return!1;let h,_;return p!==l&&p!==f||(h=s),p===u?h=a:p===f&&(_=a),p!==u&&p!==l||(_=c),K.normalize(h,n),K.normalize(_,r),K.clone(o.center,e),!0},se.createProjectPointsTo2DFunction=function(t,e,n){return function(r){const o=new Array(r.length);for(let i=0;i<r.length;i++)o[i]=ae(r[i],t,e,n);return o}};const Me={CLOCKWISE:m.CW,COUNTER_CLOCKWISE:m.CCW,validate:function(t){return t===Me.CLOCKWISE||t===Me.COUNTER_CLOCKWISE}};var Fe=Object.freeze(Me);const Ue={};function Pe(){this.name=void 0,this.meshes=[]}function Le(){this.name=void 0,this.primitives=[]}function Be(){this.material=void 0,this.indices=new O(T.UNSIGNED_INT),this.positions=new O(T.FLOAT),this.normals=new O(T.FLOAT),this.uvs=new O(T.FLOAT)}Ue.computeArea2D=function(t){M.defined("positions",t),M.typeOf.number.greaterThanOrEquals("positions.length",t.length,3);const e=t.length;let n=0;for(let r=e-1,o=0;o<e;r=o++){const e=t[r],i=t[o];n+=e.x*i.y-i.x*e.y}return.5*n},Ue.computeWindingOrder2D=function(t){return Ue.computeArea2D(t)>0?Fe.COUNTER_CLOCKWISE:Fe.CLOCKWISE},Ue.triangulate=function(t,e){M.defined("positions",t);return ce(Xt.packArray(t),e,2)};const De=/v(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,ke=/vn(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,ze=/vt(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Ge=/(-?\d+)\/?(-?\d*)\/?(-?\d*)/g,He=new K;function Ve(t,e){const n=function(t,e){if("X"===t&&"Y"===e)return Vt.X_UP_TO_Y_UP;if("X"===t&&"Z"===e)return Vt.X_UP_TO_Z_UP;if("Y"===t&&"X"===e)return Vt.Y_UP_TO_X_UP;if("Y"===t&&"Z"===e)return Vt.Y_UP_TO_Z_UP;if("Z"===t&&"X"===e)return Vt.Z_UP_TO_X_UP;if("Z"===t&&"Y"===e)return Vt.Z_UP_TO_Y_UP}(e.inputUpAxis,e.outputUpAxis);let r,o,i,s,a=new O(T.FLOAT),c=new O(T.FLOAT),u=new O(T.FLOAT);const l=[];let f={};let p=0,_=0,E=[],m="";const g=[],b=[],v=[],A=[];function x(){f={},p=0}function w(t){return""===t?void 0:t}function N(t){r=new Pe,r.name=w(t),l.push(r),C()}function C(t){o=new Le,o.name=w(t),r.meshes.push(o),I()}function I(){i=new Be,i.material=s,o.primitives.push(i),x(),_=0}function j(t){const e=o.primitives,n=e.length;for(let r=0;r<n;++r)if(e[r].material===s&&(!d(t)||t(e[r])))return i=e[r],x(),void(_=i.positions.length/3);I()}function M(t,e,n){const r=d(t[0]),o=d(e[0]),i=n.uvs.length>0,s=n.normals.length>0;return i===r&&s===o}function F(t,e,n){const r=parseInt(t);return r<0?e.length/n+r:r-1}function U(t,e,n){const r=t.length;for(let o=0;o<r;++o)0===t[o].length?t[o]=void 0:t[o]=F(t[o],e,n)}function P(t,e,n,r){let o=f[t];return d(o)||(o=_++,f[t]=o,function(t,e,n){if(d(t)&&a.length>0){if(3*t>=a.length)throw new wt(`Position index ${t} is out of bounds`);const e=a.get(3*t),n=a.get(3*t+1),r=a.get(3*t+2);i.positions.push(e),i.positions.push(n),i.positions.push(r)}if(d(n)&&c.length>0){if(3*n>=c.length)throw new wt(`Normal index ${n} is out of bounds`);const t=c.get(3*n),e=c.get(3*n+1),r=c.get(3*n+2);i.normals.push(t),i.normals.push(e),i.normals.push(r)}if(d(e)&&u.length>0){if(2*e>=u.length)throw new wt(`UV index ${e} is out of bounds`);const t=u.get(2*e),n=u.get(2*e+1);i.uvs.push(t),i.uvs.push(n)}}(e,n,r),p++,p>1e6&&x()),o}function L(t,e){const n=a.get(3*t),r=a.get(3*t+1),o=a.get(3*t+2);return K.fromElements(n,r,o,e)}const B=new K,D=new K,k=new K,G=new K,H=new K,V=new K,X=new K,q=new K,Y=new K,W=[new K,new K,new K,new K],$=[],Z=[];function Q(t,e,n,r){if(!d(r))return!0;const o=function(t,e){const n=c.get(3*t),r=c.get(3*t+1),o=c.get(3*t+2);return K.fromElements(n,r,o,e)}(r,Y),i=L(t,B),s=L(e,D),a=L(n,k),u=K.subtract(s,i,G),l=K.subtract(a,i,H),f=K.cross(u,l,k);return K.dot(o,f)>=0}function J(t,e,n,r){r?(i.indices.push(t),i.indices.push(e),i.indices.push(n)):(i.indices.push(t),i.indices.push(n),i.indices.push(e))}function tt(t,e,n,r,o){if(U(e,a,3),U(r,c,3),U(n,u,2),function(t,e,n,r){const o=t.length;for(let i=0;i<o;++i)t[i]=`${R(e[i],"")}/${R(n[i],"")}/${R(r[i],"")}`}(t,e,n,r),function(t,e){0===i.indices.length||M(t,e,i)||j((function(n){return M(t,e,n)}))}(n,A),3===t.length){const i=!o||Q(e[0],e[1],e[2],r[0]);J(P(t[0],e[0],n[0],r[0]),P(t[1],e[1],n[1],r[1]),P(t[2],e[2],n[2],r[2]),i)}else{const o=Z,i=$;o.length=0,i.length=0;for(let s=0;s<t.length;++s){const a=P(t[s],e[s],n[s],r[s]);i.push(a),s===W.length&&W.push(new K),o.push(L(e[s],W[s]))}if(!se.computeProjectTo2DArguments(o,V,X,q))return;const s=se.createProjectPointsTo2DFunction(V,X,q)(o),a=Ue.triangulate(s),c=Ue.computeWindingOrder2D(s)!==Fe.CLOCKWISE;for(let t=0;t<a.length-2;t+=3)J(i[a[t]],i[a[t+1]],i[a[t+2]],c)}}return N(),S(t,(function(t){let r;if(0===(t=t.trim()).length||"#"===t.charAt(0));else if(/^o\s/i.test(t)){N(t.substring(2).trim())}else if(/^g\s/i.test(t)){C(t.substring(2).trim())}else if(/^usemtl/i.test(t)){const e=t.substring(7).trim();s=w(e),j()}else if(/^mtllib/i.test(t)){const e=t.substring(7).trim();E=E.concat(function(t){const e=[];t=t.replace(/^"(.+)"$/,"$1");const n=t.split(" "),r=n.length;let o=0;for(let t=0;t<r;++t){if(".mtl"!==h.extname(n[t]))continue;const r=n.slice(o,t+1).join(" ");e.push(r),o=t+1}return e}(e))}else if(null!==(r=De.exec(t))){const t=He;t.x=parseFloat(r[1]),t.y=parseFloat(r[2]),t.z=parseFloat(r[3]),d(n)&&St.multiplyByPoint(n,t,t),a.push(t.x),a.push(t.y),a.push(t.z)}else if(null!==(r=ke.exec(t))){const t=K.fromElements(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]),Y);K.equals(t,K.ZERO)?K.clone(K.UNIT_Z,t):K.normalize(t,t),d(n)&&St.multiplyByPointAsVector(n,t,t),c.push(t.x),c.push(t.y),c.push(t.z)}else if(null!==(r=ze.exec(t)))u.push(parseFloat(r[1])),u.push(1-parseFloat(r[2]));else{if("\\"===t.slice(-1))return void(m+=t.substring(0,t.length-1));if(m+=t,"f "===m.substring(0,2)){for(;null!==(r=Ge.exec(m));)g.push(r[0]),b.push(r[1]),v.push(r[2]),A.push(r[3]);g.length>2&&tt(g,b,v,A,e.triangleWindingOrderSanitization),g.length=0,b.length=0,A.length=0,v.length=0}m=""}})).then((function(){return a=void 0,c=void 0,u=void 0,function(t,e,n,r,o){if(t=function(t){return t=function(t){const e=[],n=t.length;for(let r=0;r<n;++r){const n=t[r],o=Xe(n.meshes);if(0!==o.length)if(n.meshes=o,!d(n.name)&&qe(o)){const t=o.length;for(let n=0;n<t;++n){const t=o[n],r=new Pe;r.name=t.name,r.meshes=[t],e.push(r)}}else e.push(n)}return e}(t),function(t){const e={};Ye(t,"Node",e);const n=t.length;for(let r=0;r<n;++r){const n=t[r];Ye(n.meshes,`${n.name}-Mesh`,e)}}(t),t}(t),0===t.length)throw new wt(`${n} does not have any geometry data`);const i=h.basename(n,h.extname(n));return function(t,e,n){const r=h.dirname(e);let o=[];return t=t.filter((function(t,e,n){return n.indexOf(t)===e})),y.Promise.map(t,(function(t){const e=h.join(r,h.basename(t));return z(e,n).then((function(t){o=o.concat(t)})).catch((function(t){n.logger(t.message),n.logger(`Could not read material file at ${e}. Using default material instead.`)}))}),{concurrency:10}).then((function(){return o}))}(e,n,o).then((function(e){return e.length>0&&!r&&function(t,e){const n=e[0].name,r=t.length;for(let e=0;e<r;++e){const r=t[e].meshes,o=r.length;for(let t=0;t<o;++t){const e=r[t].primitives,o=e.length;for(let t=0;t<o;++t){const r=e[t];r.material=R(r.material,n)}}}}(t,e),function(t,e){const n=e.find((function(t){return 0===t.name.length}));if(!d(n))return;const r=t.length;for(let e=0;e<r;++e){const r=t[e].meshes,o=r.length;for(let t=0;t<o;++t){const e=r[t].primitives,o=e.length;for(let t=0;t<o;++t){const r=e[t];d(r.material)||(r.material=n.name)}}}}(t,e),{nodes:t,materials:e,name:i}}))}(l,E,t,d(s),e)}))}function Xe(t){return t.filter((function(t){return t.primitives=t.primitives.filter((function(t){return t.indices.length>0&&t.positions.length>0})),t.primitives.length>0}))}function qe(t){const e=t.length;for(let n=0;n<e;++n)if(d(t[n].name))return!0;return!1}function Ye(t,e,n){const r=t.length;for(let o=0;o<r;++o){const r=t[o];let i=R(r.name,e);const s=n[i];d(s)?(n[i]++,i=`${i}_${s}`):n[i]=1,r.name=i}}const We=z.getDefaultMaterial;function $e(t,e){const n=t.nodes;let r=t.materials;const o=t.name;r=function(t,e,n){const r=[],o={},i=t.length;for(let s=0;s<i;++s){const i=t[s].meshes,a=i.length;for(let t=0;t<a;++t){const s=i[t].primitives,a=s.length;for(let t=0;t<a;++t){const i=s[t],a=i.uvs.length>0,c={hasUvs:a,hasNormals:i.normals.length>0},u=R(i.material,"default"),l=on(u,c,o);i.material=l,o[l]=c;let f=rn(r,l);if(d(f))continue;const p=rn(e,u);f=d(p)?tn(p,!a):We(n),f.name=l,r.push(f)}}}return r}(n,r,e);const i={accessors:[],asset:{},buffers:[],bufferViews:[],extensionsUsed:[],extensionsRequired:[],images:[],materials:[],meshes:[],nodes:[],samplers:[],scene:0,scenes:[],textures:[]};i.asset={generator:"obj2gltf",version:"2.0"},i.scenes.push({nodes:[]});const s={positionBuffers:[],normalBuffers:[],uvBuffers:[],indexBuffers:[],positionAccessors:[],normalAccessors:[],uvAccessors:[],indexAccessors:[]},a=function(t){const e=t.length;for(let n=0;n<e;++n){const e=t[n].meshes,r=e.length;for(let t=0;t<r;++t){const n=e[t].primitives,r=n.length;for(let t=0;t<r;++t){if(n[t].positions.length/3>65534)return!0}}}return!1}(n),c=n.length;for(let t=0;t<c;++t){const o=n[t],c=o.meshes,u=c.length;if(1===u){const t=cn(i,r,s,a,c[0],e);un(i,o.name,t,void 0)}else{const t=un(i,o.name);for(let n=0;n<u;++n){const o=c[n],u=cn(i,r,s,a,o,e);un(i,o.name,u,t)}}}return i.images.length>0&&i.samplers.push({wrapS:m.REPEAT,wrapT:m.REPEAT}),function(t,e,n,r){const o=e.positionBuffers.concat(e.normalBuffers,e.uvBuffers,e.indexBuffers),i=o.length;let s=0;for(let t=0;t<i;++t)s+=o[t].length;r?function(t,e,n){Qe(t,e.positionBuffers,e.positionAccessors,12,m.ARRAY_BUFFER,n),Qe(t,e.normalBuffers,e.normalAccessors,12,m.ARRAY_BUFFER,n),Qe(t,e.uvBuffers,e.uvAccessors,8,m.ARRAY_BUFFER,n),Qe(t,e.indexBuffers,e.indexAccessors,void 0,m.ELEMENT_ARRAY_BUFFER,n)}(t,e,n):function(t,e,n){Ke(t,e.positionBuffers,e.positionAccessors,12,m.ARRAY_BUFFER),Ke(t,e.normalBuffers,e.normalAccessors,12,m.ARRAY_BUFFER),Ke(t,e.uvBuffers,e.uvAccessors,8,m.ARRAY_BUFFER),Ke(t,e.indexBuffers,e.indexAccessors,void 0,m.ELEMENT_ARRAY_BUFFER);let r=[];r=r.concat(e.positionBuffers,e.normalBuffers,e.uvBuffers,e.indexBuffers);const o=function(t){const e=t.length%4;if(0===e)return t;const n=0===e?0:4-e,r=Buffer.alloc(n);return Buffer.concat([t,r])}(Buffer.concat(r));t.buffers.push({name:n,byteLength:o.length,extras:{_obj2gltf:{source:o}}})}(t,e,n)}(i,s,o,e.separate),e.specularGlossiness&&(i.extensionsUsed.push("KHR_materials_pbrSpecularGlossiness"),i.extensionsRequired.push("KHR_materials_pbrSpecularGlossiness")),e.unlit&&(i.extensionsUsed.push("KHR_materials_unlit"),i.extensionsRequired.push("KHR_materials_unlit")),i}function Ke(t,e,n,r,o){const i=e.length;if(0===i)return;const s=t.bufferViews.length,a=t.bufferViews[s-1],c=d(a)?a.byteOffset+a.byteLength:0;let u=0;for(let r=0;r<i;++r){const o=t.accessors[n[r]];o.bufferView=s,o.byteOffset=u,u+=e[r].length}t.bufferViews.push({name:`bufferView_${s}`,buffer:0,byteLength:u,byteOffset:c,byteStride:r,target:o})}function Ze(t,e,n,r,o,i){const s=t.buffers.length,a=t.bufferViews.length;t.buffers.push({name:`${i}_${s}`,byteLength:e.length,extras:{_obj2gltf:{source:e}}}),t.bufferViews.push({buffer:s,byteLength:e.length,byteOffset:0,byteStride:r,target:o}),t.accessors[n].bufferView=a,t.accessors[n].byteOffset=0}function Qe(t,e,n,r,o,i){const s=e.length;for(let a=0;a<s;++a)Ze(t,e[a],n[a],r,o,i)}function Je(t,e){let n;const r=t.images,o=r.length;for(let t=0;t<o;++t)if(r[t].extras._obj2gltf===e){n=t;break}return d(n)||(n=function(t,e){const n=e.name,r=e.name,o=t.images.length,i=t.textures.length;return t.images.push({name:n,extras:{_obj2gltf:e}}),t.textures.push({name:r,sampler:0,source:o}),i}(t,e)),{index:n}}function tn(t,e){if("object"!=typeof t)return t;if(t instanceof v){if(e)return;return t}if(Array.isArray(t)){const n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=tn(t[o],e);return r}const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=tn(t[r],e));return n}function en(t,e){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];r instanceof v?e[n]=Je(t,r):Array.isArray(r)||"object"!=typeof r||en(t,r)}}function nn(t,e,n){en(t,e);const r=t.materials.length;return n.unlit&&(d(e.extensions)||(e.extensions={}),e.extensions.KHR_materials_unlit={}),t.materials.push(e),r}function rn(t,e){const n=t.length;for(let r=0;r<n;++r)if(t[r].name===e)return t[r]}function on(t,e,n){let r=t,o=2;for(;d(n[r])&&(i=e,s=n[r],i.hasUvs!==s.hasUvs||i.hasNormals!==s.hasNormals);)r=`${t}-${o++}`;var i,s;return r}function sn(t,e,n,r){const o=e.length/n,i=e.getMinMax(n),s=3===n?"VEC3":"VEC2",a={name:r,componentType:m.FLOAT,count:o,min:i.min,max:i.max,type:s},c=t.accessors.length;return t.accessors.push(a),c}function an(t,e,n,r,o,i,s,a){const c=i.positions.length>0,u=i.normals.length>0,l=i.uvs.length>0,f={};if(c){const e=sn(t,i.positions,3,`${o.name}_${s}_positions`);f.POSITION=e,n.positionBuffers.push(i.positions.toFloatBuffer()),n.positionAccessors.push(e)}if(u){const e=sn(t,i.normals,3,`${o.name}_${s}_normals`);f.NORMAL=e,n.normalBuffers.push(i.normals.toFloatBuffer()),n.normalAccessors.push(e)}if(l){const e=sn(t,i.uvs,2,`${o.name}_${s}_texcoords`);f.TEXCOORD_0=e,n.uvBuffers.push(i.uvs.toFloatBuffer()),n.uvAccessors.push(e)}const p=function(t,e,n,r){const o=n?m.UNSIGNED_INT:m.UNSIGNED_SHORT,i=e.length,s=e.getMinMax(1),a={name:r,componentType:o,count:i,min:s.min,max:s.max,type:"SCALAR"},c=t.accessors.length;return t.accessors.push(a),c}(t,i.indices,r,`${o.name}_${s}_indices`),h=r?i.indices.toUint32Buffer():i.indices.toUint16Buffer();n.indexBuffers.push(h),n.indexAccessors.push(p),i.positions=void 0,i.normals=void 0,i.uvs=void 0,i.indices=void 0;const _=function(t,e,n,r){const o=rn(e,n);let i=function(t,e){const n=t.length;for(let r=0;r<n;++r)if(t[r].name===e)return r}(t.materials,n);return d(i)||(i=nn(t,o,r)),i}(t,e,i.material,a);return{attributes:f,indices:p,material:_,mode:m.TRIANGLES}}function cn(t,e,n,r,o,i){const s=[],a=o.primitives,c=a.length;for(let u=0;u<c;++u)s.push(an(t,e,n,r,o,a[u],u,i));const u={name:o.name,primitives:s},l=t.meshes.length;return t.meshes.push(u),l}function un(t,e,n,r){const o={name:e,mesh:n},i=t.nodes.length;if(t.nodes.push(o),d(r)){const e=t.nodes[r];d(e.children)||(e.children=[]),e.children.push(i)}else t.scenes[t.scene].nodes.push(i);return i}function ln(t,e){return function(t){const e=[],n=t.images,r=n.length;for(let t=0;t<r;++t)e.push(fn(n[t].extras._obj2gltf));return y.Promise.all(e)}(t).then((function(){const e=[];return e.push(function(t){const e=t.images;return y.Promise.map(e,(function(t){const e=t.extras._obj2gltf,n=t.name+e.extension;return t.uri=n,t}),{concurrency:10})}(t)),function(t){const e=t.buffers[0],n=e.extras._obj2gltf.source;if(n.length>201326580)throw new wt("Buffer is too large to embed in the glTF. Use the --separate flag instead.");e.uri=`data:application/octet-stream;base64,${n.toString("base64")}`}(t),y.Promise.all(e).then((function(){return function(t){const e=t.buffers,n=e.length;for(let t=0;t<n;++t)delete e[t].extras;const r=t.images,o=r.length;for(let t=0;t<o;++t)delete r[t].extras}(t),pn(t),t}))}))}function fn(t){if(!d(t.source)&&d(t.pixels)&&".png"===t.extension)return function(t){const e=new PNG({width:t.width,height:t.height,colorType:t.transparent?6:2,inputColorType:6,inputHasAlpha:!0});return e.data=t.pixels,new y.Promise((function(t,n){const r=[],o=e.pack();o.on("data",(function(t){r.push(t)})),o.on("end",(function(){t(Buffer.concat(r))})),o.on("error",n)}))}(t).then((function(e){t.source=e}))}function pn(t){Object.keys(t).forEach((function(e){!d(t[e])||Array.isArray(t[e])&&0===t[e].length?delete t[e]:"object"==typeof t[e]&&pn(t[e])}))}function hn(t,e){const n=hn.defaults;if((e=R(e,{})).binary=R(e.binary,n.binary),e.separate=R(e.separate,n.separate),e.separateTextures=R(e.separateTextures,n.separateTextures)||e.separate,e.checkTransparency=R(e.checkTransparency,n.checkTransparency),e.doubleSidedMaterial=R(e.doubleSidedMaterial,n.doubleSidedMaterial),e.secure=R(e.secure,n.secure),e.packOcclusion=R(e.packOcclusion,n.packOcclusion),e.metallicRoughness=R(e.metallicRoughness,n.metallicRoughness),e.specularGlossiness=R(e.specularGlossiness,n.specularGlossiness),e.unlit=R(e.unlit,n.unlit),e.overridingTextures=R(e.overridingTextures,R.EMPTY_OBJECT),e.logger=R(e.logger,(function(t){console.log(t)})),e.inputUpAxis=R(e.inputUpAxis,n.inputUpAxis),e.outputUpAxis=R(e.outputUpAxis,n.outputUpAxis),e.triangleWindingOrderSanitization=R(e.triangleWindingOrderSanitization,n.triangleWindingOrderSanitization),!d(t))throw new E("objPath is required");if(e.metallicRoughness+e.specularGlossiness+e.unlit>1)throw new E("Only one material type may be set from [metallicRoughness, specularGlossiness, unlit].");if(d(e.overridingTextures.metallicRoughnessOcclusionTexture)&&d(e.overridingTextures.specularGlossinessTexture))throw new E("metallicRoughnessOcclusionTexture and specularGlossinessTexture cannot both be defined.");return d(e.overridingTextures.metallicRoughnessOcclusionTexture)&&(e.metallicRoughness=!0,e.specularGlossiness=!1,e.packOcclusion=!0),d(e.overridingTextures.specularGlossinessTexture)&&(e.metallicRoughness=!1,e.specularGlossiness=!0),Ve(t,e).then((function(t){return $e(t,e)})).then((function(t){return ln(t)}))}hn.defaults={binary:!1,separate:!1,separateTextures:!1,checkTransparency:!1,doubleSidedMaterial:!1,secure:!1,packOcclusion:!1,metallicRoughness:!1,specularGlossiness:!1,unlit:!1,inputUpAxis:"Y",outputUpAxis:"Y",windingOrderSanitization:!1};export{hn as default};
