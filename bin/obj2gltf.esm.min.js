var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n,r,o={exports:{}},i={};var s,a,u,c={exports:{}};function l(){return a||(a=1,function(t){var o=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),a=r[n];n<i;a=r[++n])_(a)||!w(a)?s+=" "+a:s+=" "+u(a);return s},t.deprecate=function(n,r){if(E(e.process))return function(){return t.deprecate(n,r).apply(this,arguments)};if(!0===process.noDeprecation)return n;var o=!1;return function(){if(!o){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,a={};function u(e,n){var r={seen:[],stylize:f};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&t._extend(r,n),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),p(r,e,r.depth)}function l(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function f(e,t){return e}function p(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return b(o)||(o=p(e,o,r)),o}var i=function(e,t){if(E(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(g(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(_(t))return e.stylize("null","null")}(e,n);if(i)return i;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),T(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(x(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(O(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(v(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return h(n)}var c,l="",f=!1,w=["{","}"];(m(n)&&(f=!0,w=["[","]"]),x(n))&&(l=" [Function"+(n.name?": "+n.name:"")+"]");return O(n)&&(l=" "+RegExp.prototype.toString.call(n)),v(n)&&(l=" "+Date.prototype.toUTCString.call(n)),T(n)&&(l=" "+h(n)),0!==s.length||f&&0!=n.length?r<0?O(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=f?function(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)I(t,String(s))?i.push(d(e,t,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(e,n,r,a,s):s.map((function(t){return d(e,n,r,a,t,f)})),e.seen.pop(),function(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,w)):w[0]+l+w[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),I(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(u.value)<0?(a=_(n)?p(e,u.value,null):p(e,u.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),E(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function m(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function _(e){return null===e}function g(e){return"number"==typeof e}function b(e){return"string"==typeof e}function E(e){return void 0===e}function O(e){return w(e)&&"[object RegExp]"===R(e)}function w(e){return"object"==typeof e&&null!==e}function v(e){return w(e)&&"[object Date]"===R(e)}function T(e){return w(e)&&("[object Error]"===R(e)||e instanceof Error)}function x(e){return"function"==typeof e}function R(e){return Object.prototype.toString.call(e)}function A(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(E(i)&&(i=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=process.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=y,t.isNull=_,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=b,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=E,t.isRegExp=O,t.isObject=w,t.isDate=v,t.isError=T,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r?n:(r=1,n=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8});var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(e=new Date,n=[A(e.getHours()),A(e.getMinutes()),A(e.getSeconds())].join(":"),[e.getDate(),S[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=(s||(s=1,"function"==typeof Object.create?c.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:c.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}),c.exports),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}(i)),i}var f,p=function(){if(u)return o.exports;u=1;var e="win32"===process.platform,t=l();function n(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(o))}return n}function r(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var i=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,s=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,a={};function c(e){var t=i.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",o=s.exec(r);return[n,o[1],o[2],o[3]]}function f(e){var t=i.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function p(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}a.resolve=function(){for(var e="",r="",o=!1,i=arguments.length-1;i>=-1;i--){var s;if(i>=0?s=arguments[i]:e?(s=process.env["="+e])&&s.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(s=e+"\\"):s=process.cwd(),!t.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var a=f(s),u=a.device,c=a.isUnc,l=a.isAbsolute,h=a.tail;if((!u||!e||u.toLowerCase()===e.toLowerCase())&&(e||(e=u),o||(r=h+"\\"+r,o=l),e&&o))break}}return c&&(e=p(e)),e+(o?"\\":"")+(r=n(r.split(/[\\\/]+/),!o).join("\\"))||"."},a.normalize=function(e){var t=f(e),r=t.device,o=t.isUnc,i=t.isAbsolute,s=t.tail,a=/[\\\/]$/.test(s);return(s=n(s.split(/[\\\/]+/),!i).join("\\"))||i||(s="."),s&&a&&(s+="\\"),o&&(r=p(r)),r+(i?"\\":"")+s},a.isAbsolute=function(e){return f(e).isAbsolute},a.join=function(){for(var e=[],n=0;n<arguments.length;n++){var r=arguments[n];if(!t.isString(r))throw new TypeError("Arguments to path.join must be strings");r&&e.push(r)}var o=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(o=o.replace(/^[\\\/]{2,}/,"\\")),a.normalize(o)},a.relative=function(e,t){e=a.resolve(e),t=a.resolve(t);for(var n=e.toLowerCase(),o=t.toLowerCase(),i=r(t.split("\\")),s=r(n.split("\\")),u=r(o.split("\\")),c=Math.min(s.length,u.length),l=c,f=0;f<c;f++)if(s[f]!==u[f]){l=f;break}if(0==l)return t;var p=[];for(f=l;f<s.length;f++)p.push("..");return(p=p.concat(i.slice(l))).join("\\")},a._makeLong=function(e){if(!t.isString(e))return e;if(!e)return"";var n=a.resolve(e);return/^[a-zA-Z]\:\\/.test(n)?"\\\\?\\"+n:/^\\\\[^?.]/.test(n)?"\\\\?\\UNC\\"+n.substring(2):e},a.dirname=function(e){var t=c(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},a.basename=function(e,t){var n=c(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},a.extname=function(e){return c(e)[3]},a.format=function(e){if(!t.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var n=e.root||"";if(!t.isString(n))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var r=e.dir,o=e.base||"";return r?r[r.length-1]===a.sep?r+o:r+a.sep+o:o},a.parse=function(e){if(!t.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var n=c(e);if(!n||4!==n.length)throw new TypeError("Invalid path '"+e+"'");return{root:n[0],dir:n[0]+n[1].slice(0,-1),base:n[2],ext:n[3],name:n[2].slice(0,n[2].length-n[3].length)}},a.sep="\\",a.delimiter=";";var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,d={};function m(e){return h.exec(e).slice(1)}return d.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var i=o>=0?arguments[o]:process.cwd();if(!t.isString(i))throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i[0])}return(r?"/":"")+(e=n(e.split("/"),!r).join("/"))||"."},d.normalize=function(e){var t=d.isAbsolute(e),r=e&&"/"===e[e.length-1];return(e=n(e.split("/"),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},d.isAbsolute=function(e){return"/"===e.charAt(0)},d.join=function(){for(var e="",n=0;n<arguments.length;n++){var r=arguments[n];if(!t.isString(r))throw new TypeError("Arguments to path.join must be strings");r&&(e+=e?"/"+r:r)}return d.normalize(e)},d.relative=function(e,t){e=d.resolve(e).substr(1),t=d.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),s=i,a=0;a<i;a++)if(n[a]!==o[a]){s=a;break}var u=[];for(a=s;a<n.length;a++)u.push("..");return(u=u.concat(o.slice(s))).join("/")},d._makeLong=function(e){return e},d.dirname=function(e){var t=m(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},d.basename=function(e,t){var n=m(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},d.extname=function(e){return m(e)[3]},d.format=function(e){if(!t.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var n=e.root||"";if(!t.isString(n))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+d.sep:"")+(e.base||"")},d.parse=function(e){if(!t.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var n=m(e);if(!n||4!==n.length)throw new TypeError("Invalid path '"+e+"'");return n[1]=n[1]||"",n[2]=n[2]||"",n[3]=n[3]||"",{root:n[0],dir:n[0]+n[1].slice(0,-1),base:n[2],ext:n[3],name:n[2].slice(0,n[2].length-n[3].length)}},d.sep="/",d.delimiter=":",o.exports=e?a:d,o.exports.posix=d,o.exports.win32=a,o.exports}(),h=t(p),d={exports:{}};var m=(f||(f=1,d.exports=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof _dereq_&&_dereq_;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,(function(e){var n=t[s][1][e];return o(n||e)}),l,l.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){t.exports=function(e){var t=e._SomePromiseArray;function n(e){var n=new t(e),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}},{}],2:[function(e,t,n){var r;try{throw new Error}catch(e){r=e}var o=e("./schedule"),i=e("./queue");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=o}function a(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function u(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function c(e){this._normalQueue._pushOne(e),this._queueTick()}function l(e){for(;e.length()>0;)f(e)}function f(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var n=e.shift(),r=e.shift();t.call(n,r)}}s.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},s.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.prototype.invokeLater=a,s.prototype.invoke=u,s.prototype.settlePromises=c,s.prototype._drainQueues=function(){l(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,l(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},t.exports=s,t.exports.firstLineError=r},{"./queue":26,"./schedule":29}],3:[function(e,t,n){t.exports=function(e,t,n,r){var o=!1,i=function(e,t){this._reject(t)},s=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},a=function(e,t){50397184&this._bitField||this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var c=n(i),l=new e(t);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(c),c instanceof e){var p={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:c};f._then(t,s,void 0,l,p),c._then(a,u,void 0,l,p),l._setOnCancel(c)}else l._resolveCallback(f);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return!(2097152&~this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},{}],4:[function(e,t,n){var r;function o(){try{Promise===i&&(Promise=r)}catch(e){}return i}"undefined"!=typeof Promise&&(r=Promise);var i=e("./promise")();i.noConflict=o,t.exports=i},{"./promise":22}],5:[function(e,t,n){var r=Object.create;if(r){var o=r(null),i=r(null);o[" size"]=i[" size"]=0}t.exports=function(t){var n,r=e("./util"),o=r.canEvaluate;function i(e,n){var o;if(null!=e&&(o=e[n]),"function"!=typeof o){var i="Object "+r.classString(e)+" has no method '"+r.toString(n)+"'";throw new t.TypeError(i)}return o}function s(e){return i(e,this.pop()).apply(e,this)}function a(e){return e[this]}function u(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}r.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(s,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=u;else if(o){var r=n(e);t=null!==r?r:a}else t=a;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,n){t.exports=function(t,n,r,o){var i=e("./util"),s=i.tryCatch,a=i.errorObj,u=t._async;t.prototype.break=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=s(e).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),u.throwLater(r.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,n){t.exports=function(t){var n=e("./util"),r=e("./es5").keys,o=n.tryCatch,i=n.errorObj;function s(e,s,a){return function(u){var c=a._boundValue();e:for(var l=0;l<e.length;++l){var f=e[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(u instanceof f)return o(s).call(c,u)}else if("function"==typeof f){var p=o(f).call(c,u);if(p===i)return p;if(p)return o(s).call(c,u)}else if(n.isObject(u)){for(var h=r(f),d=0;d<h.length;++d){var m=h[d];if(f[m]!=u[m])continue e}return o(s).call(c,u)}}return t}}return s}},{"./es5":13,"./util":36}],8:[function(e,t,n){t.exports=function(e){var t=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function o(){if(t)return new r}function i(){var e=n.length-1;if(e>=0)return n[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var e=n.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},r.CapturedTrace=null,r.create=o,r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=e.prototype._pushContext,o=e.prototype._popContext,s=e._peekContext,a=e.prototype._peekContext,u=e.prototype._promiseCreated;r.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=o,e._peekContext=s,e.prototype._peekContext=a,e.prototype._promiseCreated=u,t=!1},t=!0,e.prototype._pushContext=r.prototype._pushContext,e.prototype._popContext=r.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},r}},{}],9:[function(e,t,n){t.exports=function(t,n,r,o){var i,s,a,u,c=t._async,l=e("./errors").Warning,f=e("./util"),p=e("./es5"),h=f.canAttachTrace,d=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,m=/\((?:timers\.js):\d+:\d+\)/,y=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,_=null,g=null,b=!1,E=!(0==f.env("BLUEBIRD_DEBUG")),O=!(0==f.env("BLUEBIRD_WARNINGS")||!E&&!f.env("BLUEBIRD_WARNINGS")),w=!(0==f.env("BLUEBIRD_LONG_STACK_TRACES")||!E&&!f.env("BLUEBIRD_LONG_STACK_TRACES")),v=0!=f.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(O||!!f.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var e=[];function n(){for(var t=0;t<e.length;++t)e[t]._notifyUnhandledRejection();r()}function r(){e.length=0}u=function(t){e.push(t),setTimeout(n,1)},p.defineProperty(t,"_unhandledRejectionCheck",{value:n}),p.defineProperty(t,"_unhandledRejectionClear",{value:r})}(),t.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},t.prototype._ensurePossibleRejectionHandled=function(){524288&this._bitField||(this._setRejectionIsUnhandled(),u(this))},t.prototype._notifyUnhandledRejectionIsHandled=function(){ee("rejectionHandled",i,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return!!(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),ee("unhandledRejection",s,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(e,t,n){return W(e,t,n||this)},t.onPossiblyUnhandledRejection=function(e){var n=t._getContext();s=f.contextBind(n,e)},t.onUnhandledRejectionHandled=function(e){var n=t._getContext();i=f.contextBind(n,e)};var T=function(){};t.longStackTraces=function(){if(c.haveItemsQueued()&&!le.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!le.longStackTraces&&re()){var e=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace,o=t.prototype._dereferenceTrace;le.longStackTraces=!0,T=function(){if(c.haveItemsQueued()&&!le.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=r,t.prototype._dereferenceTrace=o,n.deactivateLongStackTraces(),le.longStackTraces=!1},t.prototype._captureStackTrace=z,t.prototype._attachExtraTrace=k,t.prototype._dereferenceTrace=G,n.activateLongStackTraces()}},t.hasLongStackTraces=function(){return le.longStackTraces&&re()};var x={unhandledrejection:{before:function(){var e=f.global.onunhandledrejection;return f.global.onunhandledrejection=null,e},after:function(e){f.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=f.global.onrejectionhandled;return f.global.onrejectionhandled=null,e},after:function(e){f.global.onrejectionhandled=e}}},R=function(){var e=function(e,t){if(!e)return!f.global.dispatchEvent(t);var n;try{return n=e.before(),!f.global.dispatchEvent(t)}finally{e.after(n)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return f.global.dispatchEvent(t),function(t,n){t=t.toLowerCase();var r=new CustomEvent(t,{detail:n,cancelable:!0});return p.defineProperty(r,"promise",{value:n.promise}),p.defineProperty(r,"reason",{value:n.reason}),e(x[t],r)}}return"function"==typeof Event?(t=new Event("CustomEvent"),f.global.dispatchEvent(t),function(t,n){t=t.toLowerCase();var r=new Event(t,{cancelable:!0});return r.detail=n,p.defineProperty(r,"promise",{value:n.promise}),p.defineProperty(r,"reason",{value:n.reason}),e(x[t],r)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),f.global.dispatchEvent(t),function(t,n){t=t.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,!1,!0,n),e(x[t],r)})}catch(e){}return function(){return!1}}(),A=f.isNode?function(){return process.emit.apply(process,arguments)}:f.global?function(e){var t="on"+e.toLowerCase(),n=f.global[t];return!!n&&(n.apply(f.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function S(e,t){return{promise:t}}var I={promiseCreated:S,promiseFulfilled:S,promiseRejected:S,promiseResolved:S,promiseCancelled:S,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:S},N=function(e){var t=!1;try{t=A.apply(null,arguments)}catch(e){c.throwLater(e),t=!0}var n=!1;try{n=R(e,I[e].apply(null,arguments))}catch(e){c.throwLater(e),n=!0}return n||t};function C(){return!1}function P(e,t,n){var r=this;try{e(t,n,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+f.toString(e));r._attachCancellationCallback(e)}))}catch(e){return e}}function M(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?f.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function j(){return this._onCancelField}function U(e){this._onCancelField=e}function F(){this._cancellationParent=void 0,this._onCancelField=void 0}function q(e,t){if(1&t){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}2&t&&e._isBound()&&this._setBoundTo(e._boundTo)}function L(e,t){2&t&&e._isBound()&&this._setBoundTo(e._boundTo)}t.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&T()),"warnings"in e){var n=e.warnings;le.warnings=!!n,v=le.warnings,f.isObject(n)&&"wForgottenReturn"in n&&(v=!!n.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!le.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=F,t.prototype._propagateFrom=q,t.prototype._onCancel=j,t.prototype._setOnCancel=U,t.prototype._attachCancellationCallback=M,t.prototype._execute=P,D=q,le.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!le.monitoring?(le.monitoring=!0,t.prototype._fireEvent=N):!e.monitoring&&le.monitoring&&(le.monitoring=!1,t.prototype._fireEvent=C)),"asyncHooks"in e&&f.nodeSupportsAsyncResource){var i=le.asyncHooks,s=!!e.asyncHooks;i!==s&&(le.asyncHooks=s,s?r():o())}return t},t.prototype._fireEvent=C,t.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(e){},t.prototype._attachCancellationCallback=function(e){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._dereferenceTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(e,t){};var D=L;function B(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function z(){this._trace=new ue(this._peekContext())}function k(e,t){if(h(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=K(e);f.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),f.notEnumerableProp(e,"__stackCleaned__",!0)}}}function G(){this._trace=void 0}function V(e,t,n,r,o){if(void 0===e&&null!==t&&v){if(void 0!==o&&o._returnedNonUndefined())return;if(!(65535&r._bitField))return;n&&(n+=" ");var i="",s="";if(t._trace){for(var a=t._trace.stack.split("\n"),u=Z(a),c=u.length-1;c>=0;--c){var l=u[c];if(!m.test(l)){var f=l.match(y);f&&(i="at "+f[1]+":"+f[2]+":"+f[3]+" ");break}}if(u.length>0){var p=u[0];for(c=0;c<a.length;++c)if(a[c]===p){c>0&&(s="\n"+a[c-1]);break}}}var h="a promise was created in a "+n+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(h,!0,t)}}function H(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),W(n)}function W(e,n,r){if(le.warnings){var o,i=new l(e);if(n)r._attachExtraTrace(i);else if(le.longStackTraces&&(o=t._peekContext()))o.attachExtraTrace(i);else{var s=K(i);i.stack=s.message+"\n"+s.stack.join("\n")}N("warning",i)||J(i,"",!0)}}function X(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function $(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function Y(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],o=t.length-1,i=t[o],s=-1,a=r.length-1;a>=0;--a)if(r[a]===i){s=a;break}for(a=s;a>=0;--a){var u=r[a];if(t[o]!==u)break;t.pop(),o--}t=r}}function Z(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],o="    (No stack trace)"===r||_.test(r),i=o&&oe(r);o&&!i&&(b&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function Q(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||_.test(r))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}function K(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?Q(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:Z(t)}}function J(e,t,n){if("undefined"!=typeof console){var r;if(f.isObject(e)){var o=e.stack;r=t+g(o,e)}else r=t+String(e);"function"==typeof a?a(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function ee(e,t,n,r){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(e){c.throwLater(e)}"unhandledRejection"===e?N(e,n,r)||o||J(n,"Unhandled rejection "):N(e,r)}function te(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():f.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+ne(t)+">, no stack trace)"}function ne(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function re(){return"function"==typeof ce}var oe=function(){return!1},ie=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function se(e){var t=e.match(ie);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function ae(e,t){if(re()){for(var n,r,o=(e.stack||"").split("\n"),i=(t.stack||"").split("\n"),s=-1,a=-1,u=0;u<o.length;++u)if(c=se(o[u])){n=c.fileName,s=c.line;break}for(u=0;u<i.length;++u){var c;if(c=se(i[u])){r=c.fileName,a=c.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||(oe=function(e){if(d.test(e))return!0;var t=se(e);return!!(t&&t.fileName===n&&s<=t.line&&t.line<=a)})}}function ue(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ce(this,ue),t>32&&this.uncycle()}f.inherits(ue,Error),n.CapturedTrace=ue,ue.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},r=0,o=this;void 0!==o;++r)t.push(o),o=o._parent;for(r=(e=this._length=r)-1;r>=0;--r){var i=t[r].stack;void 0===n[i]&&(n[i]=r)}for(r=0;r<e;++r){var s=n[t[r].stack];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var a=r>0?t[r-1]:this;s<e-1?(a._parent=t[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,c=r-2;c>=0;--c)t[c]._length=u,u++;return}}}},ue.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=K(e),n=t.message,r=[t.stack],o=this;void 0!==o;)r.push(Z(o.stack.split("\n"))),o=o._parent;Y(r),$(r),f.notEnumerableProp(e,"stack",X(n,r)),f.notEnumerableProp(e,"__stackCleaned__",!0)}};var ce=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():te(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,_=e,g=t;var n=Error.captureStackTrace;return oe=function(e){return d.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return _=/@/,g=t,b=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){r="stack"in e}return!("stack"in o)&&r&&"number"==typeof Error.stackTraceLimit?(_=e,g=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6}):(g=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?te(t):t.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(a=function(e){console.warn(e)},f.isNode&&process.stderr.isTTY?a=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:f.isNode||"string"!=typeof(new Error).stack||(a=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var le={warnings:O,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return w&&t.longStackTraces(),{asyncHooks:function(){return le.asyncHooks},longStackTraces:function(){return le.longStackTraces},warnings:function(){return le.warnings},cancellation:function(){return le.cancellation},monitoring:function(){return le.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return B},checkForgottenReturns:V,setBounds:ae,warn:W,deprecated:H,CapturedTrace:ue,fireDomEvent:R,fireGlobalEvent:A}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,t,n){t.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1],r=function(){throw t};return this.caught(e,r)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();var o=function(){return r};return this.caught(n,o)}}},{}],11:[function(e,t,n){t.exports=function(e,t){var n=e.reduce,r=e.all;function o(){return r(this)}function i(e,r){return n(e,r,t,t)}e.prototype.each=function(e){return n(this,e,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return n(this,e,t,t)},e.each=function(e,r){return n(e,r,t,0)._then(o,void 0,void 0,e,void 0)},e.mapSeries=i}},{}],12:[function(e,t,n){var r,o,i=e("./es5"),s=i.freeze,a=e("./util"),u=a.inherits,c=a.notEnumerableProp;function l(e,t){function n(r){if(!(this instanceof n))return new n(r);c(this,"message","string"==typeof r?r:t),c(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(n,Error),n}var f=l("Warning","warning"),p=l("CancellationError","cancellation error"),h=l("TimeoutError","timeout error"),d=l("AggregateError","aggregate error");try{r=TypeError,o=RangeError}catch(e){r=l("TypeError","type error"),o=l("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<m.length;++y)"function"==typeof Array.prototype[m[y]]&&(d.prototype[m[y]]=Array.prototype[m[y]]);i.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var _=0;function g(e){if(!(this instanceof g))return new g(e);c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}d.prototype.toString=function(){var e=Array(4*_+1).join(" "),t="\n"+e+"AggregateError of:\n";_++,e=Array(4*_+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",o=r.split("\n"),i=0;i<o.length;++i)o[i]=e+o[i];t+=(r=o.join("\n"))+"\n"}return _--,t},u(g,Error);var b=Error.__BluebirdErrorTypes__;b||(b=s({CancellationError:p,TimeoutError:h,OperationalError:g,RejectionError:g,AggregateError:d}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:r,RangeError:o,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(e,t,n){var r=function(){return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,i={}.toString,s={}.constructor.prototype,a=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t},u=function(e,t){return{value:e[t]}},c=function(e,t,n){return e[t]=n.value,e},l=function(e){return e},f=function(e){try{return Object(e).constructor.prototype}catch(e){return s}},p=function(e){try{return"[object Array]"===i.call(e)}catch(e){return!1}};t.exports={isArray:p,keys:a,names:a,defineProperty:c,getDescriptor:u,freeze:l,getPrototypeOf:f,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,n){t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,o){return n(e,r,o,t)}}},{}],15:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=t.CancellationError,s=o.errorObj,a=e("./catch_filter")(r);function u(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function c(e){this.finallyHandler=e}function l(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function f(){return h.call(this,this.promise._target()._settledValue())}function p(e){if(!l(this,e))return s.e=e,s}function h(e){var o=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(o._boundValue()):a.call(o._boundValue(),e);if(u===r)return u;if(void 0!==u){o._setReturnedNonUndefined();var h=n(u,o);if(h instanceof t){if(null!=this.cancelPromise){if(h._isCancelled()){var d=new i("late cancellation observer");return o._attachExtraTrace(d),s.e=d,s}h.isPending()&&h._attachCancellationCallback(new c(this))}return h._then(f,p,void 0,this,void 0)}}}return o.isRejected()?(l(this),s.e=e,s):(l(this),e)}return u.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){l(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,r){return"function"!=typeof e?this.then():this._then(n,r,void 0,new u(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,h,h)},t.prototype.tap=function(e){return this._passThrough(e,1,h)},t.prototype.tapCatch=function(e){var n=arguments.length;if(1===n)return this._passThrough(e,1,void 0,h);var r,i=new Array(n-1),s=0;for(r=0;r<n-1;++r){var u=arguments[r];if(!o.isObject(u))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(u)));i[s++]=u}i.length=s;var c=arguments[r];return this._passThrough(a(i,c,this),1,void 0,h)},u}},{"./catch_filter":7,"./util":36}],16:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./errors").TypeError,u=e("./util"),c=u.errorObj,l=u.tryCatch,f=[];function p(e,n,r){for(var i=0;i<n.length;++i){r._pushContext();var s=l(n[i])(e);if(r._popContext(),s===c){r._pushContext();var a=t.reject(c.e);return r._popContext(),a}var u=o(s,r);if(u instanceof t)return u}return null}function h(e,n,o,i){if(s.cancellation()){var a=new t(r),u=this._finallyPromise=new t(r);this._promise=a.lastly((function(){return u})),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new t(r))._captureStackTrace();this._stack=i,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(h,i),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),e=l(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},h.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(e){var n=this._promise;if(e===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var r=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var i=o(r,this._promise);if(i instanceof t||null!==(i=p(i,this._yieldHandlers,this._promise))){var s=(i=i._target())._bitField;50397184&s?33554432&s?t._async.invoke(this._promiseFulfilled,this,i._value()):16777216&s?t._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled():(this._yieldedPromise=i,i._proxy(this,null))}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,r=h,o=(new Error).stack;return function(){var t=e.apply(this,arguments),i=new r(void 0,void 0,n,o),s=i.promise();return i._generator=t,i._promiseFulfilled(void 0),s}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new a("expecting a function but got "+u.classString(e));f.push(e)},t.spawn=function(e){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new h(e,this),o=r.promise();return r._run(t.spawn),o}}},{"./errors":12,"./util":36}],17:[function(e,t,n){t.exports=function(t,n,r,o,i){var s=e("./util");s.canEvaluate,s.tryCatch,s.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var r=[].slice.call(arguments);e&&r.pop();var o=new n(r).promise();return void 0!==e?o.spread(e):o}}},{"./util":36}],18:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./util"),u=a.tryCatch,c=a.errorObj,l=t._async;function f(e,n,r,o){this.constructor$(e),this._promise._captureStackTrace();var s=t._getContext();if(this._callback=a.contextBind(s,n),this._preservedValues=o===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0),a.isArray(e))for(var u=0;u<e.length;++u){var c=e[u];c instanceof t&&c.suppressUnhandledRejections()}}function p(e,n,o,i){if("function"!=typeof n)return r("expecting a function but got "+a.classString(n));var s=0;if(void 0!==o){if("object"!=typeof o||null===o)return t.reject(new TypeError("options argument must be an object but it is "+a.classString(o)));if("number"!=typeof o.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(o.concurrency)));s=o.concurrency}return new f(e,n,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,i).promise()}a.inherits(f,n),f.prototype._asyncInit=function(){this._init$(void 0,-2)},f.prototype._init=function(){},f.prototype._promiseFulfilled=function(e,n){var r=this._values,i=this.length(),a=this._preservedValues,l=this._limit;if(n<0){if(r[n=-1*n-1]=e,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=e,this._queue.push(n),!1;null!==a&&(a[n]=e);var f=this._promise,p=this._callback,h=f._boundValue();f._pushContext();var d=u(p).call(h,e,n,i),m=f._popContext();if(s.checkForgottenReturns(d,m,null!==a?"Promise.filter":"Promise.map",f),d===c)return this._reject(d.e),!0;var y=o(d,this._promise);if(y instanceof t){var _=(y=y._target())._bitField;if(!(50397184&_))return l>=1&&this._inFlight++,r[n]=y,y._proxy(this,-1*(n+1)),!1;if(!(33554432&_))return 16777216&_?(this._reject(y._reason()),!0):(this._cancel(),!0);d=y._value()}r[n]=d}return++this._totalResolved>=i&&(null!==a?this._filter(r,a):this._resolve(r),!0)},f.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},f.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),o=0,i=0;i<n;++i)e[i]&&(r[o++]=t[i]);r.length=o,this._resolve(r)},f.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return p(this,e,t,null)},t.map=function(e,t,n,r){return p(e,t,n,r)}}},{"./util":36}],19:[function(e,t,n){t.exports=function(t,n,r,o,i){var s=e("./util"),a=s.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+s.classString(e));return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var o=a(e).apply(this,arguments),s=r._popContext();return i.checkForgottenReturns(o,s,"Promise.method",r),r._resolveFromSyncValue(o),r}},t.attempt=t.try=function(e){if("function"!=typeof e)return o("expecting a function but got "+s.classString(e));var r,u=new t(n);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];r=s.isArray(c)?a(e).apply(l,c):a(e).call(l,c)}else r=a(e)();var f=u._popContext();return i.checkForgottenReturns(r,f,"Promise.try",u),u._resolveFromSyncValue(r),u},t.prototype._resolveFromSyncValue=function(e){e===s.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,n){var r=e("./util"),o=r.maybeWrapAsError,i=e("./errors").OperationalError,s=e("./es5");function a(e){return e instanceof Error&&s.getPrototypeOf(e)===Error.prototype}var u=/^(?:name|message|stack|cause)$/;function c(e){var t;if(a(e)){(t=new i(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var n=s.keys(e),o=0;o<n.length;++o){var c=n[o];u.test(c)||(t[c]=e[c])}return t}return r.markAsOriginatingFromRejection(e),e}function l(e,t){return function(n,r){if(null!==e){if(n){var i=c(o(n));e._attachExtraTrace(i),e._reject(i)}else if(t){var s=[].slice.call(arguments,1);e._fulfill(s)}else e._fulfill(r);e=null}}}t.exports=l},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,n){t.exports=function(t){var n=e("./util"),r=t._async,o=n.tryCatch,i=n.errorObj;function s(e,t){var s=this;if(!n.isArray(e))return a.call(s,e,t);var u=o(t).apply(s._boundValue(),[null].concat(e));u===i&&r.throwLater(u.e)}function a(e,t){var n=this._boundValue(),s=void 0===e?o(t).call(n,null):o(t).call(n,null,e);s===i&&r.throwLater(s.e)}function u(e,t){var n=this;if(!e){var s=new Error(e+"");s.cause=e,e=s}var a=o(t).call(n._boundValue(),e);a===i&&r.throwLater(a.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var n=a;void 0!==t&&Object(t).spread&&(n=s),this._then(n,u,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,t,n){t.exports=function(){var n=function(){return new E("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},r=function(){return new F.PromiseInspection(this._target())},o=function(e){return F.reject(new E(e))};function i(){}var s={},a=e("./util");a.setReflectHandler(r);var u=function(){var e=process.domain;return void 0===e?null:e},c=function(){return null},l=function(){return{domain:u(),async:null}},f=a.isNode&&a.nodeSupportsAsyncResource?e("async_hooks").AsyncResource:null,p=function(){return{domain:u(),async:new f("Bluebird::Promise")}},h=a.isNode?l:c;a.notEnumerableProp(F,"_getContext",h);var d=function(){h=p,a.notEnumerableProp(F,"_getContext",p)},m=function(){h=l,a.notEnumerableProp(F,"_getContext",l)},y=e("./es5"),_=e("./async"),g=new _;y.defineProperty(F,"_async",{value:g});var b=e("./errors"),E=F.TypeError=b.TypeError;F.RangeError=b.RangeError;var O=F.CancellationError=b.CancellationError;F.TimeoutError=b.TimeoutError,F.OperationalError=b.OperationalError,F.RejectionError=b.OperationalError,F.AggregateError=b.AggregateError;var w=function(){},v={},T={},x=e("./thenables")(F,w),R=e("./promise_array")(F,w,x,o,i),A=e("./context")(F),S=A.create,I=e("./debuggability")(F,A,d,m);I.CapturedTrace;var N=e("./finally")(F,x,T),C=e("./catch_filter")(T),P=e("./nodeback"),M=a.errorObj,j=a.tryCatch;function U(e,t){if(null==e||e.constructor!==F)throw new E("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new E("expecting a function but got "+a.classString(t))}function F(e){e!==w&&U(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function q(e){this.promise._resolveCallback(e)}function L(e){this.promise._rejectCallback(e,!1)}function D(e){var t=new F(w);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return F.prototype.toString=function(){return"[object Promise]"},F.prototype.caught=F.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),i=0;for(n=0;n<t-1;++n){var s=arguments[n];if(!a.isObject(s))return o("Catch statement predicate: expecting an object but got "+a.classString(s));r[i++]=s}if(r.length=i,"function"!=typeof(e=arguments[n]))throw new E("The last argument to .catch() must be a function, got "+a.toString(e));return this.then(void 0,C(r,e,this))}return this.then(void 0,e)},F.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},F.prototype.then=function(e,t){if(I.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+a.classString(e);arguments.length>1&&(n+=", "+a.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},F.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},F.prototype.spread=function(e){return"function"!=typeof e?o("expecting a function but got "+a.classString(e)):this.all()._then(e,void 0,void 0,v,void 0)},F.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},F.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new R(this).promise()},F.prototype.error=function(e){return this.caught(a.originatesFromRejection,e)},F.getNewLibraryCopy=t.exports,F.is=function(e){return e instanceof F},F.fromNode=F.fromCallback=function(e){var t=new F(w);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=j(e)(P(t,n));return r===M&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},F.all=function(e){return new R(e).promise()},F.cast=function(e){var t=x(e);return t instanceof F||((t=new F(w))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},F.resolve=F.fulfilled=F.cast,F.reject=F.rejected=function(e){var t=new F(w);return t._captureStackTrace(),t._rejectCallback(e,!0),t},F.setScheduler=function(e){if("function"!=typeof e)throw new E("expecting a function but got "+a.classString(e));return g.setScheduler(e)},F.prototype._then=function(e,t,n,r,o){var i=void 0!==o,s=i?o:new F(w),u=this._target(),c=u._bitField;i||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&2097152&this._bitField&&(r=50397184&c?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=h();if(50397184&c){var f,p,d=u._settlePromiseCtx;33554432&c?(p=u._rejectionHandler0,f=e):16777216&c?(p=u._fulfillmentHandler0,f=t,u._unsetRejectionIsUnhandled()):(d=u._settlePromiseLateCancellationObserver,p=new O("late cancellation observer"),u._attachExtraTrace(p),f=t),g.invoke(d,u,{handler:a.contextBind(l,f),promise:s,receiver:r,value:p})}else u._addCallbacks(e,t,s,r,l);return s},F.prototype._length=function(){return 65535&this._bitField},F.prototype._isFateSealed=function(){return!!(117506048&this._bitField)},F.prototype._isFollowing=function(){return!(67108864&~this._bitField)},F.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},F.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},F.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},F.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},F.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},F.prototype._isFinal=function(){return(4194304&this._bitField)>0},F.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},F.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},F.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},F.prototype._setAsyncGuaranteed=function(){if(!g.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},F.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&this._bitField|536870912},F.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==s)return void 0===t&&this._isBound()?this._boundValue():t},F.prototype._promiseAt=function(e){return this[4*e-4+2]},F.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},F.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},F.prototype._boundValue=function(){},F.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,r=e._promise0,o=e._receiverAt(0);void 0===o&&(o=s),this._addCallbacks(t,n,r,o,null)},F.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=s),this._addCallbacks(n,r,o,i,null)},F.prototype._addCallbacks=function(e,t,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=a.contextBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=a.contextBind(o,t));else{var s=4*i-4;this[s+2]=n,this[s+3]=r,"function"==typeof e&&(this[s+0]=a.contextBind(o,e)),"function"==typeof t&&(this[s+1]=a.contextBind(o,t))}return this._setLength(i+1),i},F.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},F.prototype._resolveCallback=function(e,t){if(!(117506048&this._bitField)){if(e===this)return this._rejectCallback(n(),!1);var r=x(e,this);if(!(r instanceof F))return this._fulfill(e);t&&this._propagateFrom(r,2);var o=r._target();if(o!==this){var i=o._bitField;if(50397184&i)if(33554432&i)this._fulfill(o._value());else if(16777216&i)this._reject(o._reason());else{var s=new O("late cancellation observer");o._attachExtraTrace(s),this._reject(s)}else{var a=this._length();a>0&&o._migrateCallback0(this);for(var u=1;u<a;++u)o._migrateCallbackAt(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(r)}}else this._reject(n())}},F.prototype._rejectCallback=function(e,t,n){var r=a.ensureErrorObject(e),o=r===e;if(!o&&!n&&I.warnings()){var i="a promise was rejected with a non-error: "+a.classString(e);this._warn(i,!0)}this._attachExtraTrace(r,!!t&&o),this._reject(e)},F.prototype._resolveFromExecutor=function(e){if(e!==w){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,n)}));n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)}},F.prototype._settlePromiseFromHandler=function(e,t,n,r){var o=r._bitField;if(!(65536&o)){var i;r._pushContext(),t===v?n&&"number"==typeof n.length?i=j(e).apply(this._boundValue(),n):(i=M).e=new E("cannot .spread() a non-array: "+a.classString(n)):i=j(e).call(t,n);var s=r._popContext();65536&(o=r._bitField)||(i===T?r._reject(n):i===M?r._rejectCallback(i.e,!1):(I.checkForgottenReturns(i,s,"",r,this),r._resolveCallback(i)))}},F.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},F.prototype._followee=function(){return this._rejectionHandler0},F.prototype._setFollowee=function(e){this._rejectionHandler0=e},F.prototype._settlePromise=function(e,t,n,o){var s=e instanceof F,a=this._bitField,u=!!(134217728&a);65536&a?(s&&e._invokeInternalOnCancel(),n instanceof N&&n.isFinallyHandler()?(n.cancelPromise=e,j(t).call(n,o)===M&&e._reject(M.e)):t===r?e._fulfill(r.call(n)):n instanceof i?n._promiseCancelled(e):s||e instanceof R?e._cancel():n.cancel()):"function"==typeof t?s?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,o,e)):t.call(n,o,e):n instanceof i?n._isResolved()||(33554432&a?n._promiseFulfilled(o,e):n._promiseRejected(o,e)):s&&(u&&e._setAsyncGuaranteed(),33554432&a?e._fulfill(o):e._reject(o))},F.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,o=e.value;"function"==typeof t?n instanceof F?this._settlePromiseFromHandler(t,r,o,n):t.call(r,o,n):n instanceof F&&n._reject(o)},F.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},F.prototype._settlePromise0=function(e,t,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,o,t)},F.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},F.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(134217728&t?this._settlePromises():g.settlePromises(this),this._dereferenceTrace())}},F.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return g.fatalError(e,a.isNode);(65535&t)>0?g.settlePromises(this):this._ensurePossibleRejectionHandled()}},F.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},F.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},F.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(16842752&e){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},F.prototype._settledValue=function(){var e=this._bitField;return 33554432&e?this._rejectionHandler0:16777216&e?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&y.defineProperty(F.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),F.defer=F.pending=function(){return I.deprecated("Promise.defer","new Promise"),{promise:new F(w),resolve:q,reject:L}},a.notEnumerableProp(F,"_makeSelfResolutionError",n),e("./method")(F,w,x,o,I),e("./bind")(F,w,x,I),e("./cancel")(F,R,o,I),e("./direct_resolve")(F),e("./synchronous_inspection")(F),e("./join")(F,R,x,w,g),F.Promise=F,F.version="3.7.2",e("./call_get.js")(F),e("./generators.js")(F,o,w,x,i,I),e("./map.js")(F,R,o,x,w,I),e("./nodeify.js")(F),e("./promisify.js")(F,w),e("./props.js")(F,R,x,o),e("./race.js")(F,w,x,o),e("./reduce.js")(F,R,o,x,w,I),e("./settle.js")(F,R,I),e("./some.js")(F,R,o),e("./timers.js")(F,w,I),e("./using.js")(F,o,x,S,w,I),e("./any.js")(F),e("./each.js")(F,w),e("./filter.js")(F,w),a.toFastProperties(F),a.toFastProperties(F.prototype),D({a:1}),D({b:2}),D({c:3}),D(1),D((function(){})),D(void 0),D(!1),D(new F(w)),I.setBounds(_.firstLineError,a.lastLineError),F}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,t,n){t.exports=function(t,n,r,o,i){var s=e("./util");function a(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}function u(e){var r=this._promise=new t(n);e instanceof t&&(r._propagateFrom(e,3),e.suppressUnhandledRejections()),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.isArray,s.inherits(u,i),u.prototype.length=function(){return this._length},u.prototype.promise=function(){return this._promise},u.prototype._init=function e(n,i){var u=r(this._values,this._promise);if(u instanceof t){var c=(u=u._target())._bitField;if(this._values=u,!(50397184&c))return this._promise._setAsyncGuaranteed(),u._then(e,this._reject,void 0,this,i);if(!(33554432&c))return 16777216&c?this._reject(u._reason()):this._cancel();u=u._value()}if(null!==(u=s.asArray(u)))0!==u.length?this._iterate(u):-5===i?this._resolveEmptyArray():this._resolve(a(i));else{var l=o("expecting an array or an iterable object but got "+s.classString(u)).reason();this._promise._rejectCallback(l,!1)}},u.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,s=null,a=0;a<n;++a){var u=r(e[a],o);s=u instanceof t?(u=u._target())._bitField:null,i?null!==s&&u.suppressUnhandledRejections():null!==s?50397184&s?i=33554432&s?this._promiseFulfilled(u._value(),a):16777216&s?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):(u._proxy(this,a),this._values[a]=u):i=this._promiseFulfilled(u,a)}i||o._setAsyncGuaranteed()},u.prototype._isResolved=function(){return null===this._values},u.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},u.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},u.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},u.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},u.prototype._promiseCancelled=function(){return this._cancel(),!0},u.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},u.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},u.prototype.shouldCopyValues=function(){return!0},u.prototype.getActualLength=function(e){return e},u}},{"./util":36}],24:[function(e,t,n){t.exports=function(t,n){var r={},o=e("./util"),i=e("./nodeback"),s=o.withAppended,a=o.maybeWrapAsError,u=o.canEvaluate,c=e("./errors").TypeError,l="Async",f={__isPromisified__:!0},p=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(e){return o.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function d(e){return!p.test(e)}function m(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function y(e,t,n){var r=o.getDataPropertyOrDefault(e,t+n,f);return!!r&&m(r)}function _(e,t,n){for(var r=0;r<e.length;r+=2){var o=e[r];if(n.test(o))for(var i=o.replace(n,""),s=0;s<e.length;s+=2)if(e[s]===i)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function g(e,t,n,r){for(var i=o.inheritedDataKeys(e),s=[],a=0;a<i.length;++a){var u=i[a],c=e[u],l=r===h||h(u);"function"!=typeof c||m(c)||y(e,u,t)||!r(u,c,e,l)||s.push(u,c)}return _(s,t,n),s}var b,E=function(e){return e.replace(/([$])/,"\\$")};function O(e,u,c,l,f,p){var h=function(){return this}(),d=e;function m(){var o=u;u===r&&(o=this);var c=new t(n);c._captureStackTrace();var l="string"==typeof d&&this!==h?this[d]:e,f=i(c,p);try{l.apply(o,s(arguments,f))}catch(e){c._rejectCallback(a(e),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof d&&(e=l),o.notEnumerableProp(m,"__isPromisified__",!0),m}var w=u?b:O;function v(e,t,n,i,s){for(var a=new RegExp(E(t)+"$"),u=g(e,t,a,n),c=0,l=u.length;c<l;c+=2){var f=u[c],p=u[c+1],h=f+t;if(i===w)e[h]=w(f,r,f,p,t,s);else{var d=i(p,(function(){return w(f,r,f,p,t,s)}));o.notEnumerableProp(d,"__isPromisified__",!0),e[h]=d}}return o.toFastProperties(e),e}function T(e,t,n){return w(e,t,void 0,e,null,n)}t.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+o.classString(e));if(m(e))return e;var n=T(e,void 0===(t=Object(t)).context?r:t.context,!!t.multiArgs);return o.copyDescriptors(e,n,d),n},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(t=Object(t)).multiArgs,r=t.suffix;"string"!=typeof r&&(r=l);var i=t.filter;"function"!=typeof i&&(i=h);var s=t.promisifier;if("function"!=typeof s&&(s=w),!o.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=o.inheritedDataKeys(e),u=0;u<a.length;++u){var f=e[a[u]];"constructor"!==a[u]&&o.isClass(f)&&(v(f.prototype,r,i,s,n),v(f,r,i,s,n))}return v(e,r,i,s,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,n){t.exports=function(t,n,r,o){var i,s=e("./util"),a=s.isObject,u=e("./es5");"function"==typeof Map&&(i=Map);var c=function(){var e=0,t=0;function n(n,r){this[e]=n,this[e+t]=r,e++}return function(r){t=r.size,e=0;var o=new Array(2*r.size);return r.forEach(n,o),o}}(),l=function(e){for(var t=new i,n=e.length/2|0,r=0;r<n;++r){var o=e[n+r],s=e[r];t.set(o,s)}return t};function f(e){var t,n=!1;if(void 0!==i&&e instanceof i)t=c(e),n=!0;else{var r=u.keys(e),o=r.length;t=new Array(2*o);for(var s=0;s<o;++s){var a=r[s];t[s]=e[a],t[s+o]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,n?-6:-3)}function p(e){var n,i=r(e);return a(i)?(n=i instanceof t?i._then(t.props,void 0,void 0,void 0,void 0):new f(i).promise(),i instanceof t&&n._propagateFrom(i,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(f,n),f.prototype._init=function(){},f.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var n;if(this._isMap)n=l(this._values);else{n={};for(var r=this.length(),o=0,i=this.length();o<i;++o)n[this._values[o+r]]=this._values[o]}return this._resolve(n),!0}return!1},f.prototype.shouldCopyValues=function(){return!1},f.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return p(this)},t.props=function(e){return p(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,n){function r(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t],e[i+t]=void 0}function o(e){this._capacity=e,this._length=0,this._front=0}o.prototype._willBeOverCapacity=function(e){return this._capacity<e},o.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},o.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=n,this._length=r},o.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},o.prototype.length=function(){return this._length},o.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},o.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,r(this,0,this,t,this._front+this._length&t-1)},t.exports=o},{}],27:[function(e,t,n){t.exports=function(t,n,r,o){var i=e("./util"),s=function(e){return e.then((function(t){return a(t,e)}))};function a(e,a){var u=r(e);if(u instanceof t)return s(u);if(null===(e=i.asArray(e)))return o("expecting an array or an iterable object but got "+i.classString(e));var c=new t(n);void 0!==a&&c._propagateFrom(a,3);for(var l=c._fulfill,f=c._reject,p=0,h=e.length;p<h;++p){var d=e[p];(void 0!==d||p in e)&&t.cast(d)._then(l,f,void 0,c,null)}return c}t.race=function(e){return a(e,void 0)},t.prototype.race=function(){return a(this,void 0)}}},{"./util":36}],28:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./util"),u=a.tryCatch;function c(e,n,r,o){this.constructor$(e);var s=t._getContext();this._fn=a.contextBind(s,n),void 0!==r&&(r=t.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function f(e,t,n,o){return"function"!=typeof t?r("expecting a function but got "+a.classString(t)):new c(e,t,n,o).promise()}function p(e){this.accum=e,this.array._gotAccum(e);var n=o(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(h,void 0,void 0,this,void 0)):h.call(this,n)}function h(e){var n,r=this.array,o=r._promise,i=u(r._fn);o._pushContext(),(n=void 0!==r._eachValues?i.call(o._boundValue(),e,this.index,this.length):i.call(o._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(r._currentCancellable=n);var a=o._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",o),n}a.inherits(c,n),c.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},c.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},c.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},c.prototype._iterate=function(e){var n,r;this._values=e;var o=e.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=t.resolve(e[0]),r=1),this._currentCancellable=n;for(var i=r;i<o;++i){var s=e[i];s instanceof t&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;r<o;++r){var a={accum:null,value:e[r],index:r,length:o,array:this};n=n._then(p,void 0,void 0,a,void 0),127&r||n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},t.prototype.reduce=function(e,t){return f(this,e,t,null)},t.reduce=function(e,t,n,r){return f(e,t,n,r)}}},{"./util":36}],29:[function(t,n,r){var o,i=t("./util"),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},a=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var u=e.setImmediate,c=process.nextTick;o=i.isRecentNode?function(t){u.call(e,t)}:function(e){c.call(process,e)}}else if("function"==typeof a&&"function"==typeof a.resolve){var l=a.resolve();o=function(e){l.then(e)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:s:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver((function(){e.classList.toggle("foo"),n=!1})).observe(r,t);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver((function(){r.disconnect(),n()}));r.observe(e,t),o()}}();n.exports=o},{"./util":36}],30:[function(e,t,n){t.exports=function(t,n,r){var o=t.PromiseInspection;function i(e){this.constructor$(e)}e("./util").inherits(i,n),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var n=new o;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},i.prototype._promiseRejected=function(e,t){var n=new o;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},t.settle=function(e){return r.deprecated(".settle()",".reflect()"),new i(e).promise()},t.allSettled=function(e){return new i(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=e("./errors").RangeError,s=e("./errors").AggregateError,a=o.isArray,u={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,t){if((0|t)!==t||t<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(e),o=n.promise();return n.setHowMany(t),n.init(),o}o.inherits(c,n),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=a(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new s,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new i(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return l(e,t)},t.prototype.some=function(e){return l(this,e)},t._SomePromiseArray=c}},{"./errors":12,"./util":36}],32:[function(e,t,n){t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return!!(33554432&this._bitField)},i=t.prototype.isRejected=function(){return!!(16777216&this._bitField)},s=t.prototype.isPending=function(){return!(50397184&this._bitField)},a=t.prototype.isResolved=function(){return!!(50331648&this._bitField)};t.prototype.isCancelled=function(){return!!(8454144&this._bitField)},e.prototype.__isCancelled=function(){return!(65536&~this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return!!(8454144&this._target()._bitField)},e.prototype.isPending=function(){return s.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,n){t.exports=function(t,n){var r=e("./util"),o=r.errorObj,i=r.isObject;function s(e,r){if(i(e)){if(e instanceof t)return e;var s=u(e);if(s===o){r&&r._pushContext();var a=t.reject(s.e);return r&&r._popContext(),a}if("function"==typeof s)return l(e)?(a=new t(n),e._then(a._fulfill,a._reject,void 0,a,null),a):f(e,s,r)}return e}function a(e){return e.then}function u(e){try{return a(e)}catch(e){return o.e=e,o}}var c={}.hasOwnProperty;function l(e){try{return c.call(e,"_promise0")}catch(e){return!1}}function f(e,i,s){var a=new t(n),u=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var c=!0,l=r.tryCatch(i).call(e,f,p);function f(e){a&&(a._resolveCallback(e),a=null)}function p(e){a&&(a._rejectCallback(e,c,!0),a=null)}return c=!1,a&&l===o&&(a._rejectCallback(l.e,!0,!0),a=null),u}return s}},{"./util":36}],34:[function(e,t,n){t.exports=function(t,n,r){var o=e("./util"),i=t.TimeoutError;function s(e){this.handle=e}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(e){return u(+this).thenReturn(e)},u=t.delay=function(e,o){var i,u;return void 0!==o?(i=t.resolve(o)._then(a,null,null,e,void 0),r.cancellation()&&o instanceof t&&i._setOnCancel(o)):(i=new t(n),u=setTimeout((function(){i._fulfill()}),+e),r.cancellation()&&i._setOnCancel(new s(u)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};t.prototype.delay=function(e){return u(e,this)};var c=function(e,t,n){var r;r="string"!=typeof t?t instanceof Error?t:new i("operation timed out"):new i(t),o.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=n&&n.cancel()};function l(e){return clearTimeout(this.handle),e}function f(e){throw clearTimeout(this.handle),e}t.prototype.timeout=function(e,t){var n,o;e=+e;var i=new s(setTimeout((function(){n.isPending()&&c(n,t,o)}),e));return r.cancellation()?(o=this.then(),(n=o._then(l,f,void 0,i,void 0))._setOnCancel(i)):n=this._then(l,f,void 0,i,void 0),n}}},{"./util":36}],35:[function(e,t,n){t.exports=function(t,n,r,o,i,s){var a=e("./util"),u=e("./errors").TypeError,c=e("./util").inherits,l=a.errorObj,f=a.tryCatch,p={};function h(e){setTimeout((function(){throw e}),0)}function d(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function m(e,n){var o=0,s=e.length,a=new t(i);function u(){if(o>=s)return a._fulfill();var i=d(e[o++]);if(i instanceof t&&i._isDisposable()){try{i=r(i._getDisposer().tryDispose(n),e.promise)}catch(e){return h(e)}if(i instanceof t)return i._then(u,h,null,null,null)}u()}return u(),a}function y(e,t,n){this._data=e,this._promise=t,this._context=n}function _(e,t,n){this.constructor$(e,t,n)}function g(e){return y.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function b(e){this.length=e,this.promise=null,this[e-1]=null}y.prototype.data=function(){return this._data},y.prototype.promise=function(){return this._promise},y.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():p},y.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=t!==p?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},y.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},c(_,y),_.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},b.prototype._resultCancelled=function(){for(var e=this.length,n=0;n<e;++n){var r=this[n];r instanceof t&&r.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var o,i=arguments[e-1];if("function"!=typeof i)return n("expecting a function but got "+a.classString(i));var u=!0;2===e&&Array.isArray(arguments[0])?(e=(o=arguments[0]).length,u=!1):(o=arguments,e--);for(var c=new b(e),p=0;p<e;++p){var h=o[p];if(y.isDisposer(h)){var d=h;(h=h.promise())._setDisposable(d)}else{var _=r(h);_ instanceof t&&(h=_._then(g,null,null,{resources:c,index:p},void 0))}c[p]=h}var E=new Array(c.length);for(p=0;p<E.length;++p)E[p]=t.resolve(c[p]).reflect();var O=t.all(E).then((function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return l.e=n.error(),l;if(!n.isFulfilled())return void O.cancel();e[t]=n.value()}w._pushContext(),i=f(i);var r=u?i.apply(void 0,e):i(e),o=w._popContext();return s.checkForgottenReturns(r,o,"Promise.using",w),r})),w=O.lastly((function(){var e=new t.PromiseInspection(O);return m(c,e)}));return c.promise=w,w._setOnCancel(c),w},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new _(e,this,o());throw new u}}},{"./errors":12,"./util":36}],36:[function(t,n,r){var o,i=t("./es5"),s="undefined"==typeof navigator,a={e:{}},u="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0!==this?this:null;function c(){try{var e=o;return o=null,e.apply(this,arguments)}catch(e){return a.e=e,a}}function l(e){return o=e,c}var f=function(e,t){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=t.prototype[r])}return r.prototype=t.prototype,e.prototype=new r,e.prototype};function p(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function h(e){return"function"==typeof e||"object"==typeof e&&null!==e}function d(e){return p(e)?new Error(R(e)):e}function m(e,t){var n,r=e.length,o=new Array(r+1);for(n=0;n<r;++n)o[n]=e[n];return o[n]=t,o}function y(e,t,n){if(!i.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function _(e,t,n){if(p(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return i.defineProperty(e,t,r),e}function g(e){throw e}var b=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(i.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],o=Object.create(null);null!=e&&!t(e);){var s;try{s=n(e)}catch(e){return r}for(var a=0;a<s.length;++a){var u=s[a];if(!o[u]){o[u]=!0;var c=Object.getOwnPropertyDescriptor(e,u);null!=c&&null==c.get&&null==c.set&&r.push(u)}}e=i.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var i in n)if(r.call(n,i))o.push(i);else{for(var s=0;s<e.length;++s)if(r.call(e[s],i))continue e;o.push(i)}return o}}(),E=/this\s*\.\s*\S+\s*=/;function O(e){try{if("function"==typeof e){var t=i.names(e.prototype),n=i.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=E.test(e+"")&&i.names(e).length>0;if(n||r||o)return!0}return!1}catch(e){return!1}}function w(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.foo}return r(),r(),e}var v=/^[a-z$_][a-z$_0-9]*$/i;function T(e){return v.test(e)}function x(e,t,n){for(var r=new Array(e),o=0;o<e;++o)r[o]=t+o+n;return r}function R(e){try{return e+""}catch(e){return"[no string representation]"}}function A(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function S(e){try{_(e,"isOperational",!0)}catch(e){}}function I(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function N(e){return A(e)&&i.propertyIsWritable(e,"stack")}var C="stack"in new Error?function(e){return N(e)?e:new Error(R(e))}:function(e){if(N(e))return e;try{throw new Error(R(e))}catch(e){return e}};function P(e){return{}.toString.call(e)}function M(e,t,n){for(var r=i.names(e),o=0;o<r.length;++o){var s=r[o];if(n(s))try{i.defineProperty(t,s,i.getDescriptor(e,s))}catch(e){}}}var j=function(e){return i.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var U="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};j=function(e){return i.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?U(e):null}}var F,q="undefined"!=typeof process&&"[object process]"===P(process).toLowerCase(),L="undefined"!=typeof process&&void 0!==process.env;function D(e){return L?process.env[e]:void 0}function B(){if("function"==typeof Promise)try{if("[object Promise]"===P(new Promise((function(){}))))return Promise}catch(e){}}function z(e,t){if(null===e||"function"!=typeof t||t===F)return t;null!==e.domain&&(t=e.domain.bind(t));var n=e.async;if(null!==n){var r=t;t=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=r,e[1]=this,n.runInAsyncScope.apply(n,e)}}return t}var k,G={setReflectHandler:function(e){F=e},isClass:O,isIdentifier:T,inheritedDataKeys:b,getDataPropertyOrDefault:y,thrower:g,isArray:i.isArray,asArray:j,notEnumerableProp:_,isPrimitive:p,isObject:h,isError:A,canEvaluate:s,errorObj:a,tryCatch:l,inherits:f,withAppended:m,maybeWrapAsError:d,toFastProperties:w,filledRange:x,toString:R,canAttachTrace:N,ensureErrorObject:C,originatesFromRejection:I,markAsOriginatingFromRejection:S,classString:P,copyDescriptors:M,isNode:q,hasEnvVariables:L,env:D,global:u,getNativePromise:B,contextBind:z};G.isRecentNode=G.isNode&&(process.versions&&process.versions.node?k=process.versions.node.split(".").map(Number):process.version&&(k=process.version.split(".").map(Number)),0===k[0]&&k[1]>10||k[0]>0),G.nodeSupportsAsyncResource=G.isNode&&function(){var e=!1;try{e="function"==typeof t("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(t){e=!1}return e}(),G.isNode&&G.toFastProperties(process);try{throw new Error}catch(e){G.lastLineError=e}n.exports=G},{"./es5":13,async_hooks:void 0}]},{},[4])(4),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)),d.exports);function y(e,t){return null!=e?e:t}function _(e){return null!=e}function g(e){let t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}y.EMPTY_OBJECT=Object.freeze({}),_(Object.create)&&(g.prototype=Object.create(Error.prototype),g.prototype.constructor=g),g.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return _(this.stack)&&(e+=`\n${this.stack.toString()}`),e},g.throwInstantiationError=function(){throw new g("This function defines an interface and should not be called directly.")};var b=Object.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047});const E={BYTE:b.BYTE,UNSIGNED_BYTE:b.UNSIGNED_BYTE,SHORT:b.SHORT,UNSIGNED_SHORT:b.UNSIGNED_SHORT,INT:b.INT,UNSIGNED_INT:b.UNSIGNED_INT,FLOAT:b.FLOAT,DOUBLE:b.DOUBLE,getSizeInBytes:function(e){if(!_(e))throw new g("value is required.");switch(e){case E.BYTE:return Int8Array.BYTES_PER_ELEMENT;case E.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case E.SHORT:return Int16Array.BYTES_PER_ELEMENT;case E.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case E.INT:return Int32Array.BYTES_PER_ELEMENT;case E.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case E.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case E.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new g("componentDatatype is not a valid value.")}},fromTypedArray:function(e){if(e instanceof Int8Array)return E.BYTE;if(e instanceof Uint8Array)return E.UNSIGNED_BYTE;if(e instanceof Int16Array)return E.SHORT;if(e instanceof Uint16Array)return E.UNSIGNED_SHORT;if(e instanceof Int32Array)return E.INT;if(e instanceof Uint32Array)return E.UNSIGNED_INT;if(e instanceof Float32Array)return E.FLOAT;if(e instanceof Float64Array)return E.DOUBLE;throw new g("array must be an Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, Uint32Array, Float32Array, or Float64Array.")},validate:function(e){return _(e)&&(e===E.BYTE||e===E.UNSIGNED_BYTE||e===E.SHORT||e===E.UNSIGNED_SHORT||e===E.INT||e===E.UNSIGNED_INT||e===E.FLOAT||e===E.DOUBLE)},createTypedArray:function(e,t){if(!_(e))throw new g("componentDatatype is required.");if(!_(t))throw new g("valuesOrLength is required.");switch(e){case E.BYTE:return new Int8Array(t);case E.UNSIGNED_BYTE:return new Uint8Array(t);case E.SHORT:return new Int16Array(t);case E.UNSIGNED_SHORT:return new Uint16Array(t);case E.INT:return new Int32Array(t);case E.UNSIGNED_INT:return new Uint32Array(t);case E.FLOAT:return new Float32Array(t);case E.DOUBLE:return new Float64Array(t);default:throw new g("componentDatatype is not a valid value.")}},createArrayBufferView:function(e,t,n,r){if(!_(e))throw new g("componentDatatype is required.");if(!_(t))throw new g("buffer is required.");switch(n=y(n,0),r=y(r,(t.byteLength-n)/E.getSizeInBytes(e)),e){case E.BYTE:return new Int8Array(t,n,r);case E.UNSIGNED_BYTE:return new Uint8Array(t,n,r);case E.SHORT:return new Int16Array(t,n,r);case E.UNSIGNED_SHORT:return new Uint16Array(t,n,r);case E.INT:return new Int32Array(t,n,r);case E.UNSIGNED_INT:return new Uint32Array(t,n,r);case E.FLOAT:return new Float32Array(t,n,r);case E.DOUBLE:return new Float64Array(t,n,r);default:throw new g("componentDatatype is not a valid value.")}},fromName:function(e){switch(e){case"BYTE":return E.BYTE;case"UNSIGNED_BYTE":return E.UNSIGNED_BYTE;case"SHORT":return E.SHORT;case"UNSIGNED_SHORT":return E.UNSIGNED_SHORT;case"INT":return E.INT;case"UNSIGNED_INT":return E.UNSIGNED_INT;case"FLOAT":return E.FLOAT;case"DOUBLE":return E.DOUBLE;default:throw new g("name is not a valid value.")}}};var O=Object.freeze(E);function w(e){this.componentDatatype=e,this.typedArray=O.createTypedArray(e,0),this.length=0}function v(e,t){const n=O.createTypedArray(e.componentDatatype,t);n.set(e.typedArray),e.typedArray=n}w.prototype.push=function(e){const t=this.length,n=this.typedArray.length;0===t?v(this,1024):t===n&&v(this,t<33554432?2*n:n+33554432),this.typedArray[this.length++]=e},w.prototype.get=function(e){return this.typedArray[e]};function T(){this.transparent=!1,this.source=void 0,this.name=void 0,this.extension=void 0,this.path=void 0,this.pixels=void 0,this.width=void 0,this.height=void 0}function x(e,t){return(t=y(t,{})).checkTransparency=y(t.checkTransparency,!1),t.decode=y(t.decode,!1),t.keepSource=y(t.keepSource,!1),new m.Promise((function(t,n){const r=h.basename(e,h.extname(e)),o=h.extname(e).toLowerCase(),i=new T;i.name=r,i.extension=o,i.path=e,".png"===o?i.transparent=!0:".jpg"!==o&&".jpeg"!==o||(i.transparent=!1),t(i)}))}async function R(e,t){try{const n=await async function(e,t){if("string"!=typeof e)throw new Error("fetch url "+e+" is illegal. ");try{const n=await fetch(e,t);if(n.ok)return n;throw new Error("fetch url "+e+" failed, status="+n.status+" ;statusText="+n.statusText)}catch(e){throw e}}(e,t),r=await n.text();if(r)return r;throw new Error("fetchText result is null. ")}catch(e){throw e}}function A(e,t,n){return new Promise(((r,o)=>{function i(e){const n=e.split(/\r\n|\r|\n/g);let i=0;const s=n.length;n.forEach((e=>{if(t)try{t(e,i,s)}catch(e){o(e)}i++})),r()}if(e instanceof Blob)!function(e,t,n,r){new Promise(((o,i)=>{const s=new FileReader;s.onload=function(){t&&t(s.result),o(s.result)},s.onerror=function(e){console.error("readAsText failed.",e),n&&n(e),i(e)},s.readAsText(e,r)}))}(e,(e=>{i(e)}),(e=>{o(e)}),n);else if(e instanceof ArrayBuffer){i(new TextDecode(n).decode(e))}else if("string"==typeof e){i(e)}else o(new Error("unsupported data."+e))}))}function S(e,t){return new Promise((function(n,r){R(e).then((e=>{A(e,t).then((()=>{n()})).catch((e=>{r(e)}))})).catch((e=>{r(e)}))}))}var I,N;w.prototype.toUint16Buffer=function(){const e=this.length,t=this.typedArray,n=e+(e%2==0?0:1),r=Buffer.alloc(2*n);for(let n=0;n<e;++n)r.writeUInt16LE(t[n],2*n);return r},w.prototype.toUint32Buffer=function(){const e=this.length,t=this.typedArray,n=Buffer.alloc(4*e);for(let r=0;r<e;++r)n.writeUInt32LE(t[r],4*r);return n},w.prototype.toFloatBuffer=function(){const e=this.length,t=this.typedArray,n=Buffer.alloc(4*e);for(let r=0;r<e;++r)n.writeFloatLE(t[r],4*r);return n},w.prototype.getMinMax=function(e){const t=this.length,n=this.typedArray,r=t/e,o=new Array(e).fill(Number.POSITIVE_INFINITY),i=new Array(e).fill(Number.NEGATIVE_INFINITY);for(let t=0;t<r;++t)for(let r=0;r<e;++r){const s=n[t*e+r];o[r]=Math.min(o[r],s),i[r]=Math.max(i[r],s)}return{min:o,max:i}};var C=function(){if(N)return I;N=1;var e=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};return e.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.init_by_array=function(e,t){var n,r,o;for(this.init_seed(19650218),n=1,r=0,o=this.N>t?this.N:t;o;o--){var i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&i)>>>16)<<16)+1664525*(65535&i))+e[r]+r,this.mt[n]>>>=0,r++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=t&&(r=0)}for(o=this.N-1;o;o--){i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1566083941*((4294901760&i)>>>16)<<16)+1566083941*(65535&i))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648},e.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random_int31=function(){return this.random_int()>>>1},e.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},e.prototype.random=function(){return this.random_int()*(1/4294967296)},e.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},e.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},I=e}(),P=t(C);const M={};function j(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}M.typeOf={},M.defined=function(e,t){if(!_(t))throw new g(function(e){return`${e} is required, actual value was undefined`}(e))},M.typeOf.func=function(e,t){if("function"!=typeof t)throw new g(j(typeof t,"function",e))},M.typeOf.string=function(e,t){if("string"!=typeof t)throw new g(j(typeof t,"string",e))},M.typeOf.number=function(e,t){if("number"!=typeof t)throw new g(j(typeof t,"number",e))},M.typeOf.number.lessThan=function(e,t,n){if(M.typeOf.number(e,t),t>=n)throw new g(`Expected ${e} to be less than ${n}, actual value was ${t}`)},M.typeOf.number.lessThanOrEquals=function(e,t,n){if(M.typeOf.number(e,t),t>n)throw new g(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)},M.typeOf.number.greaterThan=function(e,t,n){if(M.typeOf.number(e,t),t<=n)throw new g(`Expected ${e} to be greater than ${n}, actual value was ${t}`)},M.typeOf.number.greaterThanOrEquals=function(e,t,n){if(M.typeOf.number(e,t),t<n)throw new g(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)},M.typeOf.object=function(e,t){if("object"!=typeof t)throw new g(j(typeof t,"object",e))},M.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new g(j(typeof t,"boolean",e))},M.typeOf.bigint=function(e,t){if("bigint"!=typeof t)throw new g(j(typeof t,"bigint",e))},M.typeOf.number.equals=function(e,t,n,r){if(M.typeOf.number(e,n),M.typeOf.number(t,r),n!==r)throw new g(`${e} must be equal to ${t}, the actual values are ${n} and ${r}`)};const U={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};U.sign=y(Math.sign,(function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1})),U.signNotZero=function(e){return e<0?-1:1},U.toSNorm=function(e,t){return t=y(t,255),Math.round((.5*U.clamp(e,-1,1)+.5)*t)},U.fromSNorm=function(e,t){return t=y(t,255),U.clamp(e,0,t)/t*2-1},U.normalize=function(e,t,n){return 0===(n=Math.max(n-t,0))?0:U.clamp((e-t)/n,0,1)},U.sinh=y(Math.sinh,(function(e){return(Math.exp(e)-Math.exp(-e))/2})),U.cosh=y(Math.cosh,(function(e){return(Math.exp(e)+Math.exp(-e))/2})),U.lerp=function(e,t,n){return(1-n)*e+n*t},U.PI=Math.PI,U.ONE_OVER_PI=1/Math.PI,U.PI_OVER_TWO=Math.PI/2,U.PI_OVER_THREE=Math.PI/3,U.PI_OVER_FOUR=Math.PI/4,U.PI_OVER_SIX=Math.PI/6,U.THREE_PI_OVER_TWO=3*Math.PI/2,U.TWO_PI=2*Math.PI,U.ONE_OVER_TWO_PI=1/(2*Math.PI),U.RADIANS_PER_DEGREE=Math.PI/180,U.DEGREES_PER_RADIAN=180/Math.PI,U.RADIANS_PER_ARCSECOND=U.RADIANS_PER_DEGREE/3600,U.toRadians=function(e){if(!_(e))throw new g("degrees is required.");return e*U.RADIANS_PER_DEGREE},U.toDegrees=function(e){if(!_(e))throw new g("radians is required.");return e*U.DEGREES_PER_RADIAN},U.convertLongitudeRange=function(e){if(!_(e))throw new g("angle is required.");const t=U.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n},U.clampToLatitudeRange=function(e){if(!_(e))throw new g("angle is required.");return U.clamp(e,-1*U.PI_OVER_TWO,U.PI_OVER_TWO)},U.negativePiToPi=function(e){if(!_(e))throw new g("angle is required.");return e>=-U.PI&&e<=U.PI?e:U.zeroToTwoPi(e+U.PI)-U.PI},U.zeroToTwoPi=function(e){if(!_(e))throw new g("angle is required.");if(e>=0&&e<=U.TWO_PI)return e;const t=U.mod(e,U.TWO_PI);return Math.abs(t)<U.EPSILON14&&Math.abs(e)>U.EPSILON14?U.TWO_PI:t},U.mod=function(e,t){if(!_(e))throw new g("m is required.");if(!_(t))throw new g("n is required.");if(0===t)throw new g("divisor cannot be 0.");return U.sign(e)===U.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t},U.equalsEpsilon=function(e,t,n,r){if(!_(e))throw new g("left is required.");if(!_(t))throw new g("right is required.");n=y(n,0),r=y(r,n);const o=Math.abs(e-t);return o<=r||o<=n*Math.max(Math.abs(e),Math.abs(t))},U.lessThan=function(e,t,n){if(!_(e))throw new g("first is required.");if(!_(t))throw new g("second is required.");if(!_(n))throw new g("absoluteEpsilon is required.");return e-t<-n},U.lessThanOrEquals=function(e,t,n){if(!_(e))throw new g("first is required.");if(!_(t))throw new g("second is required.");if(!_(n))throw new g("absoluteEpsilon is required.");return e-t<n},U.greaterThan=function(e,t,n){if(!_(e))throw new g("first is required.");if(!_(t))throw new g("second is required.");if(!_(n))throw new g("absoluteEpsilon is required.");return e-t>n},U.greaterThanOrEquals=function(e,t,n){if(!_(e))throw new g("first is required.");if(!_(t))throw new g("second is required.");if(!_(n))throw new g("absoluteEpsilon is required.");return e-t>-n};const F=[1];U.factorial=function(e){if("number"!=typeof e||e<0)throw new g("A number greater than or equal to 0 is required.");const t=F.length;if(e>=t){let n=F[t-1];for(let r=t;r<=e;r++){const e=n*r;F.push(e),n=e}}return F[e]},U.incrementWrap=function(e,t,n){if(n=y(n,0),!_(e))throw new g("n is required.");if(t<=n)throw new g("maximumValue must be greater than minimumValue.");return++e>t&&(e=n),e},U.isPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new g("A number between 0 and (2^32)-1 is required.");return 0!==e&&!(e&e-1)},U.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>2147483648)throw new g("A number between 0 and 2^31 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},U.previousPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new g("A number between 0 and (2^32)-1 is required.");return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e=((e|=e>>32)>>>0)-(e>>>1)},U.clamp=function(e,t,n){return M.typeOf.number("value",e),M.typeOf.number("min",t),M.typeOf.number("max",n),e<t?t:e>n?n:e};let q,L=new P;function D(e,t){if(null===e||"object"!=typeof e)return e;t=y(t,!1);const n=new e.constructor;for(const r in e)if(e.hasOwnProperty(r)){let o=e[r];t&&(o=D(o,t)),n[r]=o}return n}function B(e,t,n){n=y(n,!1);const r={},o=_(e),i=_(t);let s,a,u;if(o)for(s in e)e.hasOwnProperty(s)&&(a=e[s],i&&n&&"object"==typeof a&&t.hasOwnProperty(s)?(u=t[s],r[s]="object"==typeof u?B(a,u,n):a):r[s]=a);if(i)for(s in t)t.hasOwnProperty(s)&&!r.hasOwnProperty(s)&&(u=t[s],r[s]=u);return r}function z(e,t){let n,r,o;const i=h.dirname(e),s=[],a={},u=[],c=t.overridingTextures,l=y(c.metallicRoughnessOcclusionTexture,c.specularGlossinessTexture),f=y(c.metallicRoughnessOcclusionTexture,c.specularGlossinessTexture),p=y(c.metallicRoughnessOcclusionTexture,c.occlusionTexture),d=c.normalTexture,g=c.baseColorTexture,b=c.emissiveTexture,E=c.alphaTexture,O={decode:!0},w={checkTransparency:t.checkTransparency},v=_(p)?void 0:t.packOcclusion?O:void 0,T=_(l)?void 0:O,R=_(f)?void 0:O,A={decode:!0};function I(e,t){e=e.replace(/^"(.+)"$/,"$1");return/-(bm|t|s|o|blendu|blendv|boost|mm|texres|clamp|imfchan|type)/.test(e)&&(e=e.split(/\s+/).pop()),e=e.replace(/\\/g,"/"),h.normalize(h.resolve(t,e))}function N(e){const n=_(e.alphaTexture)?A:w;e.diffuseTexture===e.ambientTexture&&(e.ambientTexture=void 0);const r=["diffuseTexture","ambientTexture","emissiveTexture","specularTexture","specularShininessTexture","normalTexture","alphaTexture"],o=[n,v,undefined,T,R,undefined,A],s={};r.forEach((function(t,n){const r=e[t],i=o[n];if(_(r)&&_(i)){_(s[r])||(s[r]=D(i));const e=s[r];e.checkTransparency=e.checkTransparency||i.checkTransparency,e.decode=e.decode||i.decode,e.keepSource=e.keepSource||!i.decode||!i.checkTransparency}})),r.forEach((function(n){const r=e[n];_(r)&&function(e,t,n,r,o,i,s){const a=e[t];if(!_(a))return;let u=o[a];if(!_(u)){const e=h.join(r,h.basename(a));u=x(a,n).catch((function(t){return s.logger(t.message),s.logger(`Could not read texture file at ${a}. Attempting to read the texture file from within the obj directory instead.`),x(e,n)})).catch((function(t){s.logger(t.message),s.logger(`Could not read texture file at ${e}. This texture will be ignored.`)})),o[a]=u}i.push(u.then((function(n){e[t]=n})))}(e,n,s[r],i,a,u,t)}))}return S(e,(function(e){if(e=e.trim(),/^newmtl/i.test(e)){!function(e){n=new G,n.name=e,n.specularShininess=t.metallicRoughness?1:0,n.specularTexture=l,n.specularShininessTexture=f,n.diffuseTexture=g,n.ambientTexture=p,n.normalTexture=d,n.emissiveTexture=b,n.alphaTexture=E,s.push(n)}(e.substring(7).trim())}else/^Ka /i.test(e)?(r=e.substring(3).trim().split(" "),n.ambientColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ke /i.test(e)?(r=e.substring(3).trim().split(" "),n.emissiveColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Kd /i.test(e)?(r=e.substring(3).trim().split(" "),n.diffuseColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ks /i.test(e)?(r=e.substring(3).trim().split(" "),n.specularColor=[parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1]):/^Ns /i.test(e)?(o=e.substring(3).trim(),n.specularShininess=parseFloat(o)):/^d /i.test(e)?(o=e.substring(2).trim(),n.alpha=k(parseFloat(o))):/^Tr /i.test(e)?(o=e.substring(3).trim(),n.alpha=k(1-parseFloat(o))):/^map_Ka /i.test(e)?_(p)||(n.ambientTexture=I(e.substring(7).trim(),i)):/^map_Ke /i.test(e)?_(b)||(n.emissiveTexture=I(e.substring(7).trim(),i)):/^map_Kd /i.test(e)?_(g)||(n.diffuseTexture=I(e.substring(7).trim(),i)):/^map_Ks /i.test(e)?_(l)||(n.specularTexture=I(e.substring(7).trim(),i)):/^map_Ns /i.test(e)?_(f)||(n.specularShininessTexture=I(e.substring(7).trim(),i)):/^map_Bump /i.test(e)?_(d)||(n.normalTexture=I(e.substring(9).trim(),i)):/^map_d /i.test(e)&&(_(E)||(n.alphaTexture=I(e.substring(6).trim(),i)))})).then((function(){const e=s.length;for(let t=0;t<e;++t)N(s[t]);return m.Promise.all(u)})).then((function(){return function(e,t){return e.map((function(e){return V(e,t)}))}(s,t)}))}function k(e){return 0===e?1:e}function G(){this.name=void 0,this.ambientColor=[0,0,0,1],this.emissiveColor=[0,0,0,1],this.diffuseColor=[.5,.5,.5,1],this.specularColor=[0,0,0,1],this.specularShininess=0,this.alpha=1,this.ambientTexture=void 0,this.emissiveTexture=void 0,this.diffuseTexture=void 0,this.specularTexture=void 0,this.specularShininessTexture=void 0,this.normalTexture=void 0,this.alphaTexture=void 0}function V(e,t){return t.specularGlossiness?function(e,t){const n=e.emissiveTexture,r=e.normalTexture,o=e.ambientTexture,i=e.diffuseTexture,s=e.alphaTexture,a=e.specularTexture,u=e.specularShininessTexture,c=function(e,t,n){if(_(n.overridingTextures.specularGlossinessTexture))return e;const r=_(e),o=_(t);if(!r&&!o)return;if(r&&!_(e.pixels))return void n.logger(`Could not get decoded texture data for ${e.path}. The material will be created without a specularGlossiness texture.`);if(o&&!_(t.pixels))return void n.logger(`Could not get decoded texture data for ${t.path}. The material will be created without a specularGlossiness texture.`);const i=[e,t].filter((function(e){return _(e)&&_(e.pixels)})),s=X(i,n),a=s[0],u=s[1],c=a*u,l=Buffer.alloc(4*c,255),f=Buffer.alloc(c);if(r){W(l,H(e,0,a,u,f),0);W(l,H(e,1,a,u,f),1);W(l,H(e,2,a,u,f),2)}if(o){W(l,H(t,0,a,u,f),3)}const p=i.length,h=new Array(p);for(let e=0;e<p;++e)h[e]=i[e].name;const d=h.join("_"),m=new T;return m.name=d,m.extension=".png",m.pixels=l,m.width=a,m.height=u,m}(a,u,t),l=$(i,s,t);let f=e.emissiveColor.slice(0,3),p=e.diffuseColor,h=e.specularColor.slice(0,3),d=e.specularShininess;_(n)&&(f=[1,1,1]);_(i)&&(p=[1,1,1,1]);_(a)&&(h=[1,1,1]);_(u)&&(d=1);let m=!1;if(_(s))m=!0;else{const t=e.alpha;p[3]=t,m=t<1}_(i)&&(m=m||i.transparent);const y=m||t.doubleSidedMaterial,g=m?"BLEND":"OPAQUE";return{name:e.name,extensions:{KHR_materials_pbrSpecularGlossiness:{diffuseTexture:l,specularGlossinessTexture:c,diffuseFactor:p,specularFactor:h,glossinessFactor:d}},emissiveTexture:n,normalTexture:r,occlusionTexture:o,emissiveFactor:f,alphaMode:g,doubleSided:y}}(e,t):(t.metallicRoughness||function(e){const t=(n=e.specularColor,.2125*n[0]+.7154*n[1]+.0721*n[2]);var n;let r=e.specularShininess;r/=1e3,r=1-r,r=U.clamp(r,0,1),t<.1&&(r*=1-t);const o=0;e.specularColor=[o,o,o,1],e.specularShininess=r}(e),Y(e,t))}function H(e,t,n,r,o){const i=e.pixels,s=e.width,a=e.height,u=s*a,c=n*r;let l=o;u>c&&((!_(q)||u>q.length)&&(q=Buffer.alloc(u)),l=q);for(let e=0;e<u;++e){const n=i.readUInt8(4*e+t);l.writeUInt8(n,e)}return u>c&&function(e,t,n,r,o,i){const s=t/o,a=n/i;for(let n=0;n<i;++n)for(let i=0;i<o;++i){const u=n*o+i,c=Math.round(n*a)*t+Math.round(i*s),l=e.readUInt8(c);r.writeUInt8(l,u)}}(l,s,a,o,n,r),o}function W(e,t,n){const r=e.length/4;for(let o=0;o<r;++o){const r=t.readUInt8(o);e.writeUInt8(r,4*o+n)}}function X(e,t){let n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;const o=e.length;for(let t=0;t<o;++t){const o=e[t];n=Math.min(o.width,n),r=Math.min(o.height,r)}for(let i=0;i<o;++i){const o=e[i];o.width===n&&o.height===r||t.logger(`Texture ${o.path} will be scaled from ${o.width}x${o.height} to ${n}x${r}.`)}return[n,r]}function $(e,t,n){const r=_(e),o=_(t);if(!r)return;if(!o)return e;if(e===t)return e;if(!_(e.pixels)||!_(t.pixels))return n.logger(`Could not get decoded texture data for ${e.path} or ${t.path}. The material will be created without an alpha texture.`),e;const i=X([e,t],n),s=i[0],a=i[1],u=s*a,c=Buffer.alloc(4*u,255),l=Buffer.alloc(u);W(c,H(e,0,s,a,l),0);W(c,H(e,1,s,a,l),1);W(c,H(e,2,s,a,l),2);let f=H(t,3,s,a,l);(function(e){const t=e.readUInt8(0),n=e.length;for(let r=1;r<n;++r)if(e[r]!==t)return!1;return!0})(f)&&(f=H(t,0,s,a,l)),W(c,f,3);const p=new T;return p.name=e.name,p.extension=".png",p.pixels=c,p.width=s,p.height=a,p.transparent=!0,p}function Y(e,t){const n=e.emissiveTexture,r=e.normalTexture;let o=e.ambientTexture;const i=e.diffuseTexture,s=e.alphaTexture,a=e.specularTexture,u=e.specularShininessTexture,c=function(e,t,n,r){if(_(r.overridingTextures.metallicRoughnessOcclusionTexture))return e;const o=_(e),i=_(t),s=_(n)&&r.packOcclusion;if(!o&&!i)return;if(o&&!_(e.pixels))return void r.logger(`Could not get decoded texture data for ${e.path}. The material will be created without a metallicRoughness texture.`);if(i&&!_(t.pixels))return void r.logger(`Could not get decoded texture data for ${t.path}. The material will be created without a metallicRoughness texture.`);if(s&&!_(n.pixels))return void r.logger(`Could not get decoded texture data for ${n.path}. The occlusion texture will not be packed in the metallicRoughness texture.`);const a=[e,t,n].filter((function(e){return _(e)&&_(e.pixels)})),u=X(a,r),c=u[0],l=u[1],f=c*l,p=Buffer.alloc(4*f,255),h=Buffer.alloc(f);o&&W(p,H(e,0,c,l,h),2);i&&W(p,H(t,0,c,l,h),1);s&&W(p,H(n,0,c,l,h),0);const d=a.length,m=new Array(d);for(let e=0;e<d;++e)m[e]=a[e].name;const y=m.join("_"),g=new T;return g.name=y,g.extension=".png",g.pixels=p,g.width=c,g.height=l,g}(a,u,o,t),l=$(i,s,t);t.packOcclusion&&(o=c);let f=e.emissiveColor.slice(0,3),p=e.diffuseColor,h=e.specularColor[0],d=e.specularShininess;_(n)&&(f=[1,1,1]),_(i)&&(p=[1,1,1,1]),_(a)&&(h=1),_(u)&&(d=1);let m=!1;if(_(s))m=!0;else{const t=e.alpha;p[3]=t,m=t<1}_(i)&&(m=m||i.transparent);const y=m||t.doubleSidedMaterial,g=m?"BLEND":"OPAQUE";return{name:e.name,pbrMetallicRoughness:{baseColorTexture:l,metallicRoughnessTexture:c,baseColorFactor:p,metallicFactor:h,roughnessFactor:d},emissiveTexture:n,normalTexture:r,occlusionTexture:o,emissiveFactor:f,alphaMode:g,doubleSided:y}}function Z(e,t,n){this.x=y(e,0),this.y=y(t,0),this.z=y(n,0)}U.setRandomNumberSeed=function(e){if(!_(e))throw new g("seed is required.");L=new P(e)},U.nextRandomNumber=function(){return L.random()},U.randomBetween=function(e,t){return U.nextRandomNumber()*(t-e)+e},U.acosClamped=function(e){if(!_(e))throw new g("value is required.");return Math.acos(U.clamp(e,-1,1))},U.asinClamped=function(e){if(!_(e))throw new g("value is required.");return Math.asin(U.clamp(e,-1,1))},U.chordLength=function(e,t){if(!_(e))throw new g("angle is required.");if(!_(t))throw new g("radius is required.");return 2*t*Math.sin(.5*e)},U.logBase=function(e,t){if(!_(e))throw new g("number is required.");if(!_(t))throw new g("base is required.");return Math.log(e)/Math.log(t)},U.cbrt=y(Math.cbrt,(function(e){const t=Math.pow(Math.abs(e),1/3);return e<0?-t:t})),U.log2=y(Math.log2,(function(e){return Math.log(e)*Math.LOG2E})),U.fog=function(e,t){const n=e*t;return 1-Math.exp(-n*n)},U.fastApproximateAtan=function(e){return M.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},U.fastApproximateAtan2=function(e,t){let n;M.typeOf.number("x",e),M.typeOf.number("y",t);let r=Math.abs(e);n=Math.abs(t);const o=Math.max(r,n);n=Math.min(r,n);const i=n/o;if(isNaN(i))throw new g("either x or y must be nonzero");return r=U.fastApproximateAtan(i),r=Math.abs(t)>Math.abs(e)?U.PI_OVER_TWO-r:r,r=e<0?U.PI-r:r,r=t<0?-r:r,r},z.getDefaultMaterial=function(e){return V(new G,e)},z._createMaterial=function(e,t){return V(B(e,new G),t)},Z.fromSpherical=function(e,t){M.typeOf.object("spherical",e),_(t)||(t=new Z);const n=e.clock,r=e.cone,o=y(e.magnitude,1),i=o*Math.sin(r);return t.x=i*Math.cos(n),t.y=i*Math.sin(n),t.z=o*Math.cos(r),t},Z.fromElements=function(e,t,n,r){return _(r)?(r.x=e,r.y=t,r.z=n,r):new Z(e,t,n)},Z.clone=function(e,t){if(_(e))return _(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new Z(e.x,e.y,e.z)},Z.fromCartesian4=Z.clone,Z.packedLength=3,Z.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t},Z.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new Z),n.x=e[t++],n.y=e[t++],n.z=e[t],n},Z.packArray=function(e,t){M.defined("array",e);const n=e.length,r=3*n;if(_(t)){if(!Array.isArray(t)&&t.length!==r)throw new g("If result is a typed array, it must have exactly array.length * 3 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)Z.pack(e[r],t,3*r);return t},Z.unpackArray=function(e,t){if(M.defined("array",e),M.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new g("array length must be a multiple of 3.");const n=e.length;_(t)?t.length=n/3:t=new Array(n/3);for(let r=0;r<n;r+=3){const n=r/3;t[n]=Z.unpack(e,r,t[n])}return t},Z.fromArray=Z.unpack,Z.maximumComponent=function(e){return M.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},Z.minimumComponent=function(e){return M.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},Z.minimumByComponent=function(e,t,n){return M.typeOf.object("first",e),M.typeOf.object("second",t),M.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n},Z.maximumByComponent=function(e,t,n){return M.typeOf.object("first",e),M.typeOf.object("second",t),M.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n},Z.clamp=function(e,t,n,r){M.typeOf.object("value",e),M.typeOf.object("min",t),M.typeOf.object("max",n),M.typeOf.object("result",r);const o=U.clamp(e.x,t.x,n.x),i=U.clamp(e.y,t.y,n.y),s=U.clamp(e.z,t.z,n.z);return r.x=o,r.y=i,r.z=s,r},Z.magnitudeSquared=function(e){return M.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},Z.magnitude=function(e){return Math.sqrt(Z.magnitudeSquared(e))};const Q=new Z;Z.distance=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),Z.subtract(e,t,Q),Z.magnitude(Q)},Z.distanceSquared=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),Z.subtract(e,t,Q),Z.magnitudeSquared(Q)},Z.normalize=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=Z.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new g("normalized result is not a number");return t},Z.dot=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},Z.multiplyComponents=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n},Z.divideComponents=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n},Z.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n},Z.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n},Z.multiplyByScalar=function(e,t,n){return M.typeOf.object("cartesian",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n},Z.divideByScalar=function(e,t,n){return M.typeOf.object("cartesian",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n},Z.negate=function(e,t){return M.typeOf.object("cartesian",e),M.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},Z.abs=function(e,t){return M.typeOf.object("cartesian",e),M.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};const K=new Z;Z.lerp=function(e,t,n,r){return M.typeOf.object("start",e),M.typeOf.object("end",t),M.typeOf.number("t",n),M.typeOf.object("result",r),Z.multiplyByScalar(t,n,K),r=Z.multiplyByScalar(e,1-n,r),Z.add(K,r,r)};const J=new Z,ee=new Z;Z.angleBetween=function(e,t){M.typeOf.object("left",e),M.typeOf.object("right",t),Z.normalize(e,J),Z.normalize(t,ee);const n=Z.dot(J,ee),r=Z.magnitude(Z.cross(J,ee,J));return Math.atan2(r,n)};const te=new Z;Z.mostOrthogonalAxis=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=Z.normalize(e,te);return Z.abs(n,n),t=n.x<=n.y?n.x<=n.z?Z.clone(Z.UNIT_X,t):Z.clone(Z.UNIT_Z,t):n.y<=n.z?Z.clone(Z.UNIT_Y,t):Z.clone(Z.UNIT_Z,t)},Z.projectVector=function(e,t,n){M.defined("a",e),M.defined("b",t),M.defined("result",n);const r=Z.dot(e,t)/Z.dot(t,t);return Z.multiplyByScalar(t,r,n)},Z.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},Z.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]},Z.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&U.equalsEpsilon(e.x,t.x,n,r)&&U.equalsEpsilon(e.y,t.y,n,r)&&U.equalsEpsilon(e.z,t.z,n,r)},Z.cross=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=t.x,a=t.y,u=t.z,c=o*u-i*a,l=i*s-r*u,f=r*a-o*s;return n.x=c,n.y=l,n.z=f,n},Z.midpoint=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y),n.z=.5*(e.z+t.z),n},Z.fromDegrees=function(e,t,n,r,o){return M.typeOf.number("longitude",e),M.typeOf.number("latitude",t),e=U.toRadians(e),t=U.toRadians(t),Z.fromRadians(e,t,n,r,o)};let ne=new Z,re=new Z;function oe(e,t,n,r,o,i,s,a,u){this[0]=y(e,0),this[1]=y(r,0),this[2]=y(s,0),this[3]=y(t,0),this[4]=y(o,0),this[5]=y(a,0),this[6]=y(n,0),this[7]=y(i,0),this[8]=y(u,0)}Z._ellipsoidRadiiSquared=new Z(40680631590769,40680631590769,40408299984661.445),Z.fromRadians=function(e,t,n,r,o){M.typeOf.number("longitude",e),M.typeOf.number("latitude",t),n=y(n,0);const i=_(r)?r.radiiSquared:Z._ellipsoidRadiiSquared,s=Math.cos(t);ne.x=s*Math.cos(e),ne.y=s*Math.sin(e),ne.z=Math.sin(t),ne=Z.normalize(ne,ne),Z.multiplyComponents(i,ne,re);const a=Math.sqrt(Z.dot(ne,re));return re=Z.divideByScalar(re,a,re),ne=Z.multiplyByScalar(ne,n,ne),_(o)||(o=new Z),Z.add(re,ne,o)},Z.fromDegreesArray=function(e,t,n){if(M.defined("coordinates",e),e.length<2||e.length%2!=0)throw new g("the number of coordinates must be a multiple of 2 and at least 2");const r=e.length;_(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=e[o],i=e[o+1],s=o/2;n[s]=Z.fromDegrees(r,i,0,t,n[s])}return n},Z.fromRadiansArray=function(e,t,n){if(M.defined("coordinates",e),e.length<2||e.length%2!=0)throw new g("the number of coordinates must be a multiple of 2 and at least 2");const r=e.length;_(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=e[o],i=e[o+1],s=o/2;n[s]=Z.fromRadians(r,i,0,t,n[s])}return n},Z.fromDegreesArrayHeights=function(e,t,n){if(M.defined("coordinates",e),e.length<3||e.length%3!=0)throw new g("the number of coordinates must be a multiple of 3 and at least 3");const r=e.length;_(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=e[o],i=e[o+1],s=e[o+2],a=o/3;n[a]=Z.fromDegrees(r,i,s,t,n[a])}return n},Z.fromRadiansArrayHeights=function(e,t,n){if(M.defined("coordinates",e),e.length<3||e.length%3!=0)throw new g("the number of coordinates must be a multiple of 3 and at least 3");const r=e.length;_(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=e[o],i=e[o+1],s=e[o+2],a=o/3;n[a]=Z.fromRadians(r,i,s,t,n[a])}return n},Z.ZERO=Object.freeze(new Z(0,0,0)),Z.ONE=Object.freeze(new Z(1,1,1)),Z.UNIT_X=Object.freeze(new Z(1,0,0)),Z.UNIT_Y=Object.freeze(new Z(0,1,0)),Z.UNIT_Z=Object.freeze(new Z(0,0,1)),Z.prototype.clone=function(e){return Z.clone(this,e)},Z.prototype.equals=function(e){return Z.equals(this,e)},Z.prototype.equalsEpsilon=function(e,t,n){return Z.equalsEpsilon(this,e,t,n)},Z.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`},oe.packedLength=9,oe.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t},oe.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new oe),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n},oe.packArray=function(e,t){M.defined("array",e);const n=e.length,r=9*n;if(_(t)){if(!Array.isArray(t)&&t.length!==r)throw new g("If result is a typed array, it must have exactly array.length * 9 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)oe.pack(e[r],t,9*r);return t},oe.unpackArray=function(e,t){if(M.defined("array",e),M.typeOf.number.greaterThanOrEquals("array.length",e.length,9),e.length%9!=0)throw new g("array length must be a multiple of 9.");const n=e.length;_(t)?t.length=n/9:t=new Array(n/9);for(let r=0;r<n;r+=9){const n=r/9;t[n]=oe.unpack(e,r,t[n])}return t},oe.clone=function(e,t){if(_(e))return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new oe(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},oe.fromArray=oe.unpack,oe.fromColumnMajorArray=function(e,t){return M.defined("values",e),oe.clone(e,t)},oe.fromRowMajorArray=function(e,t){return M.defined("values",e),_(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new oe(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},oe.fromQuaternion=function(e,t){M.typeOf.object("quaternion",e);const n=e.x*e.x,r=e.x*e.y,o=e.x*e.z,i=e.x*e.w,s=e.y*e.y,a=e.y*e.z,u=e.y*e.w,c=e.z*e.z,l=e.z*e.w,f=e.w*e.w,p=n-s-c+f,h=2*(r-l),d=2*(o+u),m=2*(r+l),y=-n+s-c+f,g=2*(a-i),b=2*(o-u),E=2*(a+i),O=-n-s+c+f;return _(t)?(t[0]=p,t[1]=m,t[2]=b,t[3]=h,t[4]=y,t[5]=E,t[6]=d,t[7]=g,t[8]=O,t):new oe(p,h,d,m,y,g,b,E,O)},oe.fromHeadingPitchRoll=function(e,t){M.typeOf.object("headingPitchRoll",e);const n=Math.cos(-e.pitch),r=Math.cos(-e.heading),o=Math.cos(e.roll),i=Math.sin(-e.pitch),s=Math.sin(-e.heading),a=Math.sin(e.roll),u=n*r,c=-o*s+a*i*r,l=a*s+o*i*r,f=n*s,p=o*r+a*i*s,h=-a*r+o*i*s,d=-i,m=a*n,y=o*n;return _(t)?(t[0]=u,t[1]=f,t[2]=d,t[3]=c,t[4]=p,t[5]=m,t[6]=l,t[7]=h,t[8]=y,t):new oe(u,c,l,f,p,h,d,m,y)},oe.fromScale=function(e,t){return M.typeOf.object("scale",e),_(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new oe(e.x,0,0,0,e.y,0,0,0,e.z)},oe.fromUniformScale=function(e,t){return M.typeOf.number("scale",e),_(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new oe(e,0,0,0,e,0,0,0,e)},oe.fromCrossProduct=function(e,t){return M.typeOf.object("vector",e),_(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new oe(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},oe.fromRotationX=function(e,t){M.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=r,t[6]=0,t[7]=-r,t[8]=n,t):new oe(1,0,0,0,n,-r,0,r,n)},oe.fromRotationY=function(e,t){M.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=1,t[5]=0,t[6]=r,t[7]=0,t[8]=n,t):new oe(n,0,r,0,1,0,-r,0,n)},oe.fromRotationZ=function(e,t){M.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new oe(n,-r,0,r,n,0,0,0,1)},oe.toArray=function(e,t){return M.typeOf.object("matrix",e),_(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},oe.getElementIndex=function(e,t){return M.typeOf.number.greaterThanOrEquals("row",t,0),M.typeOf.number.lessThanOrEquals("row",t,2),M.typeOf.number.greaterThanOrEquals("column",e,0),M.typeOf.number.lessThanOrEquals("column",e,2),3*e+t},oe.getColumn=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,2),M.typeOf.object("result",n);const r=3*t,o=e[r],i=e[r+1],s=e[r+2];return n.x=o,n.y=i,n.z=s,n},oe.setColumn=function(e,t,n,r){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,2),M.typeOf.object("cartesian",n),M.typeOf.object("result",r);const o=3*t;return(r=oe.clone(e,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r},oe.getRow=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,2),M.typeOf.object("result",n);const r=e[t],o=e[t+3],i=e[t+6];return n.x=r,n.y=o,n.z=i,n},oe.setRow=function(e,t,n,r){return M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,2),M.typeOf.object("cartesian",n),M.typeOf.object("result",r),(r=oe.clone(e,r))[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};const ie=new Z;oe.setScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("scale",t),M.typeOf.object("result",n);const r=oe.getScale(e,ie),o=t.x/r.x,i=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*i,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};const se=new Z;oe.setUniformScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number("scale",t),M.typeOf.object("result",n);const r=oe.getScale(e,se),o=t/r.x,i=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*i,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*s,n};const ae=new Z;oe.getScale=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t.x=Z.magnitude(Z.fromElements(e[0],e[1],e[2],ae)),t.y=Z.magnitude(Z.fromElements(e[3],e[4],e[5],ae)),t.z=Z.magnitude(Z.fromElements(e[6],e[7],e[8],ae)),t};const ue=new Z;oe.getMaximumScale=function(e){return oe.getScale(e,ue),Z.maximumComponent(ue)};const ce=new Z;oe.setRotation=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("result",n);const r=oe.getScale(e,ce);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=t[3]*r.y,n[4]=t[4]*r.y,n[5]=t[5]*r.y,n[6]=t[6]*r.z,n[7]=t[7]*r.z,n[8]=t[8]*r.z,n};const le=new Z;oe.getRotation=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=oe.getScale(e,le);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t},oe.multiply=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n);const r=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],o=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],i=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],s=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],a=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],u=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],l=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],f=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=r,n[1]=o,n[2]=i,n[3]=s,n[4]=a,n[5]=u,n[6]=c,n[7]=l,n[8]=f,n},oe.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n},oe.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n},oe.multiplyByVector=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("cartesian",t),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e[0]*r+e[3]*o+e[6]*i,a=e[1]*r+e[4]*o+e[7]*i,u=e[2]*r+e[5]*o+e[8]*i;return n.x=s,n.y=a,n.z=u,n},oe.multiplyByScalar=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},oe.multiplyByScale=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.object("scale",t),M.typeOf.object("result",n),n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n},oe.multiplyByUniformScale=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.number("scale",t),M.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},oe.negate=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},oe.transpose=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=e[0],r=e[3],o=e[6],i=e[1],s=e[4],a=e[7],u=e[2],c=e[5],l=e[8];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=s,t[5]=a,t[6]=u,t[7]=c,t[8]=l,t};const fe=[1,0,0],pe=[2,2,1];function he(e){let t=0;for(let n=0;n<3;++n){const r=e[oe.getElementIndex(pe[n],fe[n])];t+=2*r*r}return Math.sqrt(t)}function de(e,t){const n=U.EPSILON15;let r=0,o=1;for(let t=0;t<3;++t){const n=Math.abs(e[oe.getElementIndex(pe[t],fe[t])]);n>r&&(o=t,r=n)}let i=1,s=0;const a=fe[o],u=pe[o];if(Math.abs(e[oe.getElementIndex(u,a)])>n){const t=(e[oe.getElementIndex(u,u)]-e[oe.getElementIndex(a,a)])/2/e[oe.getElementIndex(u,a)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),i=1/Math.sqrt(1+n*n),s=n*i}return(t=oe.clone(oe.IDENTITY,t))[oe.getElementIndex(a,a)]=t[oe.getElementIndex(u,u)]=i,t[oe.getElementIndex(u,a)]=s,t[oe.getElementIndex(a,u)]=-s,t}const me=new oe,ye=new oe;oe.computeEigenDecomposition=function(e,t){M.typeOf.object("matrix",e);const n=U.EPSILON20;let r=0,o=0;_(t)||(t={});const i=t.unitary=oe.clone(oe.IDENTITY,t.unitary),s=t.diagonal=oe.clone(e,t.diagonal),a=n*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(s);for(;o<10&&he(s)>a;)de(s,me),oe.transpose(me,ye),oe.multiply(s,me,s),oe.multiply(ye,s,s),oe.multiply(i,me,i),++r>2&&(++o,r=0);return t},oe.abs=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},oe.determinant=function(e){M.typeOf.object("matrix",e);const t=e[0],n=e[3],r=e[6],o=e[1],i=e[4],s=e[7],a=e[2],u=e[5],c=e[8];return t*(i*c-u*s)+o*(u*r-n*c)+a*(n*s-i*r)},oe.inverse=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],f=oe.determinant(e);if(Math.abs(f)<=U.EPSILON15)throw new g("matrix is not invertible");t[0]=s*l-c*a,t[1]=c*o-r*l,t[2]=r*a-s*o,t[3]=u*a-i*l,t[4]=n*l-u*o,t[5]=i*o-n*a,t[6]=i*c-u*s,t[7]=u*r-n*c,t[8]=n*s-i*r;const p=1/f;return oe.multiplyByScalar(t,p,t)};const _e=new oe;function ge(e,t,n,r){this.x=y(e,0),this.y=y(t,0),this.z=y(n,0),this.w=y(r,0)}oe.inverseTranspose=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),oe.inverse(oe.transpose(e,_e),t)},oe.equals=function(e,t){return e===t||_(e)&&_(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},oe.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n},oe.IDENTITY=Object.freeze(new oe(1,0,0,0,1,0,0,0,1)),oe.ZERO=Object.freeze(new oe(0,0,0,0,0,0,0,0,0)),oe.COLUMN0ROW0=0,oe.COLUMN0ROW1=1,oe.COLUMN0ROW2=2,oe.COLUMN1ROW0=3,oe.COLUMN1ROW1=4,oe.COLUMN1ROW2=5,oe.COLUMN2ROW0=6,oe.COLUMN2ROW1=7,oe.COLUMN2ROW2=8,Object.defineProperties(oe.prototype,{length:{get:function(){return oe.packedLength}}}),oe.prototype.clone=function(e){return oe.clone(this,e)},oe.prototype.equals=function(e){return oe.equals(this,e)},oe.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]},oe.prototype.equalsEpsilon=function(e,t){return oe.equalsEpsilon(this,e,t)},oe.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})\n(${this[1]}, ${this[4]}, ${this[7]})\n(${this[2]}, ${this[5]}, ${this[8]})`},ge.fromElements=function(e,t,n,r,o){return _(o)?(o.x=e,o.y=t,o.z=n,o.w=r,o):new ge(e,t,n,r)},ge.fromColor=function(e,t){return M.typeOf.object("color",e),_(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new ge(e.red,e.green,e.blue,e.alpha)},ge.clone=function(e,t){if(_(e))return _(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new ge(e.x,e.y,e.z,e.w)},ge.packedLength=4,ge.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},ge.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new ge),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n},ge.packArray=function(e,t){M.defined("array",e);const n=e.length,r=4*n;if(_(t)){if(!Array.isArray(t)&&t.length!==r)throw new g("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)ge.pack(e[r],t,4*r);return t},ge.unpackArray=function(e,t){if(M.defined("array",e),M.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new g("array length must be a multiple of 4.");const n=e.length;_(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;t[n]=ge.unpack(e,r,t[n])}return t},ge.fromArray=ge.unpack,ge.maximumComponent=function(e){return M.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z,e.w)},ge.minimumComponent=function(e){return M.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z,e.w)},ge.minimumByComponent=function(e,t,n){return M.typeOf.object("first",e),M.typeOf.object("second",t),M.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n},ge.maximumByComponent=function(e,t,n){return M.typeOf.object("first",e),M.typeOf.object("second",t),M.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n},ge.clamp=function(e,t,n,r){M.typeOf.object("value",e),M.typeOf.object("min",t),M.typeOf.object("max",n),M.typeOf.object("result",r);const o=U.clamp(e.x,t.x,n.x),i=U.clamp(e.y,t.y,n.y),s=U.clamp(e.z,t.z,n.z),a=U.clamp(e.w,t.w,n.w);return r.x=o,r.y=i,r.z=s,r.w=a,r},ge.magnitudeSquared=function(e){return M.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},ge.magnitude=function(e){return Math.sqrt(ge.magnitudeSquared(e))};const be=new ge;ge.distance=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),ge.subtract(e,t,be),ge.magnitude(be)},ge.distanceSquared=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),ge.subtract(e,t,be),ge.magnitudeSquared(be)},ge.normalize=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=ge.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))throw new g("normalized result is not a number");return t},ge.dot=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},ge.multiplyComponents=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n},ge.divideComponents=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n},ge.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},ge.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},ge.multiplyByScalar=function(e,t,n){return M.typeOf.object("cartesian",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},ge.divideByScalar=function(e,t,n){return M.typeOf.object("cartesian",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},ge.negate=function(e,t){return M.typeOf.object("cartesian",e),M.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},ge.abs=function(e,t){return M.typeOf.object("cartesian",e),M.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};const Ee=new ge;ge.lerp=function(e,t,n,r){return M.typeOf.object("start",e),M.typeOf.object("end",t),M.typeOf.number("t",n),M.typeOf.object("result",r),ge.multiplyByScalar(t,n,Ee),r=ge.multiplyByScalar(e,1-n,r),ge.add(Ee,r,r)};const Oe=new ge;ge.mostOrthogonalAxis=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=ge.normalize(e,Oe);return ge.abs(n,n),t=n.x<=n.y?n.x<=n.z?n.x<=n.w?ge.clone(ge.UNIT_X,t):ge.clone(ge.UNIT_W,t):n.z<=n.w?ge.clone(ge.UNIT_Z,t):ge.clone(ge.UNIT_W,t):n.y<=n.z?n.y<=n.w?ge.clone(ge.UNIT_Y,t):ge.clone(ge.UNIT_W,t):n.z<=n.w?ge.clone(ge.UNIT_Z,t):ge.clone(ge.UNIT_W,t)},ge.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},ge.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]},ge.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&U.equalsEpsilon(e.x,t.x,n,r)&&U.equalsEpsilon(e.y,t.y,n,r)&&U.equalsEpsilon(e.z,t.z,n,r)&&U.equalsEpsilon(e.w,t.w,n,r)},ge.ZERO=Object.freeze(new ge(0,0,0,0)),ge.ONE=Object.freeze(new ge(1,1,1,1)),ge.UNIT_X=Object.freeze(new ge(1,0,0,0)),ge.UNIT_Y=Object.freeze(new ge(0,1,0,0)),ge.UNIT_Z=Object.freeze(new ge(0,0,1,0)),ge.UNIT_W=Object.freeze(new ge(0,0,0,1)),ge.prototype.clone=function(e){return ge.clone(this,e)},ge.prototype.equals=function(e){return ge.equals(this,e)},ge.prototype.equalsEpsilon=function(e,t,n){return ge.equalsEpsilon(this,e,t,n)},ge.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const we=new Float32Array(1),ve=new Uint8Array(we.buffer),Te=new Uint32Array([287454020]),xe=68===new Uint8Array(Te.buffer)[0];function Re(e){let t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}function Ae(e,t,n,r,o,i,s,a,u,c,l,f,p,h,d,m){this[0]=y(e,0),this[1]=y(o,0),this[2]=y(u,0),this[3]=y(p,0),this[4]=y(t,0),this[5]=y(i,0),this[6]=y(c,0),this[7]=y(h,0),this[8]=y(n,0),this[9]=y(s,0),this[10]=y(l,0),this[11]=y(d,0),this[12]=y(r,0),this[13]=y(a,0),this[14]=y(f,0),this[15]=y(m,0)}ge.packFloat=function(e,t){return M.typeOf.number("value",e),_(t)||(t=new ge),we[0]=e,xe?(t.x=ve[0],t.y=ve[1],t.z=ve[2],t.w=ve[3]):(t.x=ve[3],t.y=ve[2],t.z=ve[1],t.w=ve[0]),t},ge.unpackFloat=function(e){return M.typeOf.object("packedFloat",e),xe?(ve[0]=e.x,ve[1]=e.y,ve[2]=e.z,ve[3]=e.w):(ve[0]=e.w,ve[1]=e.z,ve[2]=e.y,ve[3]=e.x),we[0]},_(Object.create)&&(Re.prototype=Object.create(Error.prototype),Re.prototype.constructor=Re),Re.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return _(this.stack)&&(e+=`\n${this.stack.toString()}`),e},Ae.packedLength=16,Ae.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t},Ae.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new Ae),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n},Ae.packArray=function(e,t){M.defined("array",e);const n=e.length,r=16*n;if(_(t)){if(!Array.isArray(t)&&t.length!==r)throw new g("If result is a typed array, it must have exactly array.length * 16 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)Ae.pack(e[r],t,16*r);return t},Ae.unpackArray=function(e,t){if(M.defined("array",e),M.typeOf.number.greaterThanOrEquals("array.length",e.length,16),e.length%16!=0)throw new g("array length must be a multiple of 16.");const n=e.length;_(t)?t.length=n/16:t=new Array(n/16);for(let r=0;r<n;r+=16){const n=r/16;t[n]=Ae.unpack(e,r,t[n])}return t},Ae.clone=function(e,t){if(_(e))return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new Ae(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},Ae.fromArray=Ae.unpack,Ae.fromColumnMajorArray=function(e,t){return M.defined("values",e),Ae.clone(e,t)},Ae.fromRowMajorArray=function(e,t){return M.defined("values",e),_(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new Ae(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Ae.fromRotationTranslation=function(e,t,n){return M.typeOf.object("rotation",e),t=y(t,Z.ZERO),_(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new Ae(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},Ae.fromTranslationQuaternionRotationScale=function(e,t,n,r){M.typeOf.object("translation",e),M.typeOf.object("rotation",t),M.typeOf.object("scale",n),_(r)||(r=new Ae);const o=n.x,i=n.y,s=n.z,a=t.x*t.x,u=t.x*t.y,c=t.x*t.z,l=t.x*t.w,f=t.y*t.y,p=t.y*t.z,h=t.y*t.w,d=t.z*t.z,m=t.z*t.w,y=t.w*t.w,g=a-f-d+y,b=2*(u-m),E=2*(c+h),O=2*(u+m),w=-a+f-d+y,v=2*(p-l),T=2*(c-h),x=2*(p+l),R=-a-f+d+y;return r[0]=g*o,r[1]=O*o,r[2]=T*o,r[3]=0,r[4]=b*i,r[5]=w*i,r[6]=x*i,r[7]=0,r[8]=E*s,r[9]=v*s,r[10]=R*s,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r},Ae.fromTranslationRotationScale=function(e,t){return M.typeOf.object("translationRotationScale",e),Ae.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},Ae.fromTranslation=function(e,t){return M.typeOf.object("translation",e),Ae.fromRotationTranslation(oe.IDENTITY,e,t)},Ae.fromScale=function(e,t){return M.typeOf.object("scale",e),_(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Ae(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},Ae.fromUniformScale=function(e,t){return M.typeOf.number("scale",e),_(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Ae(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)},Ae.fromRotation=function(e,t){return M.typeOf.object("rotation",e),_(t)||(t=new Ae),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};const Se=new Z,Ie=new Z,Ne=new Z;Ae.fromCamera=function(e,t){M.typeOf.object("camera",e);const n=e.position,r=e.direction,o=e.up;M.typeOf.object("camera.position",n),M.typeOf.object("camera.direction",r),M.typeOf.object("camera.up",o),Z.normalize(r,Se),Z.normalize(Z.cross(Se,o,Ie),Ie),Z.normalize(Z.cross(Ie,Se,Ne),Ne);const i=Ie.x,s=Ie.y,a=Ie.z,u=Se.x,c=Se.y,l=Se.z,f=Ne.x,p=Ne.y,h=Ne.z,d=n.x,m=n.y,y=n.z,g=i*-d+s*-m+a*-y,b=f*-d+p*-m+h*-y,E=u*d+c*m+l*y;return _(t)?(t[0]=i,t[1]=f,t[2]=-u,t[3]=0,t[4]=s,t[5]=p,t[6]=-c,t[7]=0,t[8]=a,t[9]=h,t[10]=-l,t[11]=0,t[12]=g,t[13]=b,t[14]=E,t[15]=1,t):new Ae(i,s,a,g,f,p,h,b,-u,-c,-l,E,0,0,0,1)},Ae.computePerspectiveFieldOfView=function(e,t,n,r,o){M.typeOf.number.greaterThan("fovY",e,0),M.typeOf.number.lessThan("fovY",e,Math.PI),M.typeOf.number.greaterThan("near",n,0),M.typeOf.number.greaterThan("far",r,0),M.typeOf.object("result",o);const i=1/Math.tan(.5*e),s=i/t,a=(r+n)/(n-r),u=2*r*n/(n-r);return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=a,o[11]=-1,o[12]=0,o[13]=0,o[14]=u,o[15]=0,o},Ae.computeOrthographicOffCenter=function(e,t,n,r,o,i,s){M.typeOf.number("left",e),M.typeOf.number("right",t),M.typeOf.number("bottom",n),M.typeOf.number("top",r),M.typeOf.number("near",o),M.typeOf.number("far",i),M.typeOf.object("result",s);let a=1/(t-e),u=1/(r-n),c=1/(i-o);const l=-(t+e)*a,f=-(r+n)*u,p=-(i+o)*c;return a*=2,u*=2,c*=-2,s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=c,s[11]=0,s[12]=l,s[13]=f,s[14]=p,s[15]=1,s},Ae.computePerspectiveOffCenter=function(e,t,n,r,o,i,s){M.typeOf.number("left",e),M.typeOf.number("right",t),M.typeOf.number("bottom",n),M.typeOf.number("top",r),M.typeOf.number("near",o),M.typeOf.number("far",i),M.typeOf.object("result",s);const a=2*o/(t-e),u=2*o/(r-n),c=(t+e)/(t-e),l=(r+n)/(r-n),f=-(i+o)/(i-o),p=-2*i*o/(i-o);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=c,s[9]=l,s[10]=f,s[11]=-1,s[12]=0,s[13]=0,s[14]=p,s[15]=0,s},Ae.computeInfinitePerspectiveOffCenter=function(e,t,n,r,o,i){M.typeOf.number("left",e),M.typeOf.number("right",t),M.typeOf.number("bottom",n),M.typeOf.number("top",r),M.typeOf.number("near",o),M.typeOf.object("result",i);const s=2*o/(t-e),a=2*o/(r-n),u=(t+e)/(t-e),c=(r+n)/(r-n),l=-2*o;return i[0]=s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=u,i[9]=c,i[10]=-1,i[11]=-1,i[12]=0,i[13]=0,i[14]=l,i[15]=0,i},Ae.computeViewportTransformation=function(e,t,n,r){_(r)||(r=new Ae),e=y(e,y.EMPTY_OBJECT);const o=y(e.x,0),i=y(e.y,0),s=y(e.width,0),a=y(e.height,0);t=y(t,0);const u=.5*s,c=.5*a,l=.5*((n=y(n,1))-t),f=u,p=c,h=l,d=o+u,m=i+c,g=t+l;return r[0]=f,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=p,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=h,r[11]=0,r[12]=d,r[13]=m,r[14]=g,r[15]=1,r},Ae.computeView=function(e,t,n,r,o){return M.typeOf.object("position",e),M.typeOf.object("direction",t),M.typeOf.object("up",n),M.typeOf.object("right",r),M.typeOf.object("result",o),o[0]=r.x,o[1]=n.x,o[2]=-t.x,o[3]=0,o[4]=r.y,o[5]=n.y,o[6]=-t.y,o[7]=0,o[8]=r.z,o[9]=n.z,o[10]=-t.z,o[11]=0,o[12]=-Z.dot(r,e),o[13]=-Z.dot(n,e),o[14]=Z.dot(t,e),o[15]=1,o},Ae.toArray=function(e,t){return M.typeOf.object("matrix",e),_(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},Ae.getElementIndex=function(e,t){return M.typeOf.number.greaterThanOrEquals("row",t,0),M.typeOf.number.lessThanOrEquals("row",t,3),M.typeOf.number.greaterThanOrEquals("column",e,0),M.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},Ae.getColumn=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,3),M.typeOf.object("result",n);const r=4*t,o=e[r],i=e[r+1],s=e[r+2],a=e[r+3];return n.x=o,n.y=i,n.z=s,n.w=a,n},Ae.setColumn=function(e,t,n,r){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,3),M.typeOf.object("cartesian",n),M.typeOf.object("result",r);const o=4*t;return(r=Ae.clone(e,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r[o+3]=n.w,r},Ae.getRow=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,3),M.typeOf.object("result",n);const r=e[t],o=e[t+4],i=e[t+8],s=e[t+12];return n.x=r,n.y=o,n.z=i,n.w=s,n},Ae.setRow=function(e,t,n,r){return M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,3),M.typeOf.object("cartesian",n),M.typeOf.object("result",r),(r=Ae.clone(e,r))[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r},Ae.setTranslation=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.object("translation",t),M.typeOf.object("result",n),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};const Ce=new Z;Ae.setScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("scale",t),M.typeOf.object("result",n);const r=Ae.getScale(e,Ce),o=t.x/r.x,i=t.y/r.y,s=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const Pe=new Z;Ae.setUniformScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number("scale",t),M.typeOf.object("result",n);const r=Ae.getScale(e,Pe),o=t/r.x,i=t/r.y,s=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7],n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const Me=new Z;Ae.getScale=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t.x=Z.magnitude(Z.fromElements(e[0],e[1],e[2],Me)),t.y=Z.magnitude(Z.fromElements(e[4],e[5],e[6],Me)),t.z=Z.magnitude(Z.fromElements(e[8],e[9],e[10],Me)),t};const je=new Z;Ae.getMaximumScale=function(e){return Ae.getScale(e,je),Z.maximumComponent(je)};const Ue=new Z;Ae.setRotation=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("result",n);const r=Ae.getScale(e,Ue);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=e[3],n[4]=t[3]*r.y,n[5]=t[4]*r.y,n[6]=t[5]*r.y,n[7]=e[7],n[8]=t[6]*r.z,n[9]=t[7]*r.z,n[10]=t[8]*r.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const Fe=new Z;Ae.getRotation=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=Ae.getScale(e,Fe);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t},Ae.multiply=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],p=e[9],h=e[10],d=e[11],m=e[12],y=e[13],_=e[14],g=e[15],b=t[0],E=t[1],O=t[2],w=t[3],v=t[4],T=t[5],x=t[6],R=t[7],A=t[8],S=t[9],I=t[10],N=t[11],C=t[12],P=t[13],j=t[14],U=t[15],F=r*b+a*E+f*O+m*w,q=o*b+u*E+p*O+y*w,L=i*b+c*E+h*O+_*w,D=s*b+l*E+d*O+g*w,B=r*v+a*T+f*x+m*R,z=o*v+u*T+p*x+y*R,k=i*v+c*T+h*x+_*R,G=s*v+l*T+d*x+g*R,V=r*A+a*S+f*I+m*N,H=o*A+u*S+p*I+y*N,W=i*A+c*S+h*I+_*N,X=s*A+l*S+d*I+g*N,$=r*C+a*P+f*j+m*U,Y=o*C+u*P+p*j+y*U,Z=i*C+c*P+h*j+_*U,Q=s*C+l*P+d*j+g*U;return n[0]=F,n[1]=q,n[2]=L,n[3]=D,n[4]=B,n[5]=z,n[6]=k,n[7]=G,n[8]=V,n[9]=H,n[10]=W,n[11]=X,n[12]=$,n[13]=Y,n[14]=Z,n[15]=Q,n},Ae.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n},Ae.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n},Ae.multiplyTransformation=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],s=e[4],a=e[5],u=e[6],c=e[8],l=e[9],f=e[10],p=e[12],h=e[13],d=e[14],m=t[0],y=t[1],_=t[2],g=t[4],b=t[5],E=t[6],O=t[8],w=t[9],v=t[10],T=t[12],x=t[13],R=t[14],A=r*m+s*y+c*_,S=o*m+a*y+l*_,I=i*m+u*y+f*_,N=r*g+s*b+c*E,C=o*g+a*b+l*E,P=i*g+u*b+f*E,j=r*O+s*w+c*v,U=o*O+a*w+l*v,F=i*O+u*w+f*v,q=r*T+s*x+c*R+p,L=o*T+a*x+l*R+h,D=i*T+u*x+f*R+d;return n[0]=A,n[1]=S,n[2]=I,n[3]=0,n[4]=N,n[5]=C,n[6]=P,n[7]=0,n[8]=j,n[9]=U,n[10]=F,n[11]=0,n[12]=q,n[13]=L,n[14]=D,n[15]=1,n},Ae.multiplyByMatrix3=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("rotation",t),M.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],s=e[4],a=e[5],u=e[6],c=e[8],l=e[9],f=e[10],p=t[0],h=t[1],d=t[2],m=t[3],y=t[4],_=t[5],g=t[6],b=t[7],E=t[8],O=r*p+s*h+c*d,w=o*p+a*h+l*d,v=i*p+u*h+f*d,T=r*m+s*y+c*_,x=o*m+a*y+l*_,R=i*m+u*y+f*_,A=r*g+s*b+c*E,S=o*g+a*b+l*E,I=i*g+u*b+f*E;return n[0]=O,n[1]=w,n[2]=v,n[3]=0,n[4]=T,n[5]=x,n[6]=R,n[7]=0,n[8]=A,n[9]=S,n[10]=I,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},Ae.multiplyByTranslation=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("translation",t),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=r*e[0]+o*e[4]+i*e[8]+e[12],a=r*e[1]+o*e[5]+i*e[9]+e[13],u=r*e[2]+o*e[6]+i*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=s,n[13]=a,n[14]=u,n[15]=e[15],n},Ae.multiplyByScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("scale",t),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z;return 1===r&&1===o&&1===i?Ae.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=o*e[6],n[7]=e[7],n[8]=i*e[8],n[9]=i*e[9],n[10]=i*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},Ae.multiplyByUniformScale=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.number("scale",t),M.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},Ae.multiplyByVector=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("cartesian",t),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=t.w,a=e[0]*r+e[4]*o+e[8]*i+e[12]*s,u=e[1]*r+e[5]*o+e[9]*i+e[13]*s,c=e[2]*r+e[6]*o+e[10]*i+e[14]*s,l=e[3]*r+e[7]*o+e[11]*i+e[15]*s;return n.x=a,n.y=u,n.z=c,n.w=l,n},Ae.multiplyByPointAsVector=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("cartesian",t),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e[0]*r+e[4]*o+e[8]*i,a=e[1]*r+e[5]*o+e[9]*i,u=e[2]*r+e[6]*o+e[10]*i;return n.x=s,n.y=a,n.z=u,n},Ae.multiplyByPoint=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("cartesian",t),M.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,s=e[0]*r+e[4]*o+e[8]*i+e[12],a=e[1]*r+e[5]*o+e[9]*i+e[13],u=e[2]*r+e[6]*o+e[10]*i+e[14];return n.x=s,n.y=a,n.z=u,n},Ae.multiplyByScalar=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n},Ae.negate=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},Ae.transpose=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=e[1],r=e[2],o=e[3],i=e[6],s=e[7],a=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[10]=e[10],t[11]=e[14],t[12]=o,t[13]=s,t[14]=a,t[15]=e[15],t},Ae.abs=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},Ae.equals=function(e,t){return e===t||_(e)&&_(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},Ae.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n},Ae.getTranslation=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},Ae.getMatrix3=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};const qe=new oe,Le=new oe,De=new ge,Be=new ge(0,0,0,1);Ae.inverse=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=e[0],r=e[4],o=e[8],i=e[12],s=e[1],a=e[5],u=e[9],c=e[13],l=e[2],f=e[6],p=e[10],h=e[14],d=e[3],m=e[7],y=e[11],_=e[15];let g=p*_,b=h*y,E=f*_,O=h*m,w=f*y,v=p*m,T=l*_,x=h*d,R=l*y,A=p*d,S=l*m,I=f*d;const N=g*a+O*u+w*c-(b*a+E*u+v*c),C=b*s+T*u+A*c-(g*s+x*u+R*c),P=E*s+x*a+S*c-(O*s+T*a+I*c),j=v*s+R*a+I*u-(w*s+A*a+S*u),F=b*r+E*o+v*i-(g*r+O*o+w*i),q=g*n+x*o+R*i-(b*n+T*o+A*i),L=O*n+T*r+I*i-(E*n+x*r+S*i),D=w*n+A*r+S*o-(v*n+R*r+I*o);g=o*c,b=i*u,E=r*c,O=i*a,w=r*u,v=o*a,T=n*c,x=i*s,R=n*u,A=o*s,S=n*a,I=r*s;const B=g*m+O*y+w*_-(b*m+E*y+v*_),z=b*d+T*y+A*_-(g*d+x*y+R*_),k=E*d+x*m+S*_-(O*d+T*m+I*_),G=v*d+R*m+I*y-(w*d+A*m+S*y),V=E*p+v*h+b*f-(w*h+g*f+O*p),H=R*h+g*l+x*p-(T*p+A*h+b*l),W=T*f+I*h+O*l-(S*h+E*l+x*f),X=S*p+w*l+A*f-(R*f+I*p+v*l);let $=n*N+r*C+o*P+i*j;if(Math.abs($)<U.EPSILON21){if(oe.equalsEpsilon(Ae.getMatrix3(e,qe),Le,U.EPSILON7)&&ge.equals(Ae.getRow(e,3,De),Be))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new Re("matrix is not invertible because its determinate is zero.")}return $=1/$,t[0]=N*$,t[1]=C*$,t[2]=P*$,t[3]=j*$,t[4]=F*$,t[5]=q*$,t[6]=L*$,t[7]=D*$,t[8]=B*$,t[9]=z*$,t[10]=k*$,t[11]=G*$,t[12]=V*$,t[13]=H*$,t[14]=W*$,t[15]=X*$,t},Ae.inverseTransformation=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=e[0],r=e[1],o=e[2],i=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10],f=e[12],p=e[13],h=e[14],d=-n*f-r*p-o*h,m=-i*f-s*p-a*h,y=-u*f-c*p-l*h;return t[0]=n,t[1]=i,t[2]=u,t[3]=0,t[4]=r,t[5]=s,t[6]=c,t[7]=0,t[8]=o,t[9]=a,t[10]=l,t[11]=0,t[12]=d,t[13]=m,t[14]=y,t[15]=1,t};const ze=new Ae;Ae.inverseTranspose=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),Ae.inverse(Ae.transpose(e,ze),t)},Ae.IDENTITY=Object.freeze(new Ae(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Ae.ZERO=Object.freeze(new Ae(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),Ae.COLUMN0ROW0=0,Ae.COLUMN0ROW1=1,Ae.COLUMN0ROW2=2,Ae.COLUMN0ROW3=3,Ae.COLUMN1ROW0=4,Ae.COLUMN1ROW1=5,Ae.COLUMN1ROW2=6,Ae.COLUMN1ROW3=7,Ae.COLUMN2ROW0=8,Ae.COLUMN2ROW1=9,Ae.COLUMN2ROW2=10,Ae.COLUMN2ROW3=11,Ae.COLUMN3ROW0=12,Ae.COLUMN3ROW1=13,Ae.COLUMN3ROW2=14,Ae.COLUMN3ROW3=15,Object.defineProperties(Ae.prototype,{length:{get:function(){return Ae.packedLength}}}),Ae.prototype.clone=function(e){return Ae.clone(this,e)},Ae.prototype.equals=function(e){return Ae.equals(this,e)},Ae.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]},Ae.prototype.equalsEpsilon=function(e,t){return Ae.equalsEpsilon(this,e,t)},Ae.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})\n(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})\n(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})\n(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};const ke={X:0,Y:1,Z:2};ke.Y_UP_TO_Z_UP=Ae.fromRotationTranslation(oe.fromArray([1,0,0,0,0,1,0,-1,0])),ke.Z_UP_TO_Y_UP=Ae.fromRotationTranslation(oe.fromArray([1,0,0,0,0,-1,0,1,0])),ke.X_UP_TO_Z_UP=Ae.fromRotationTranslation(oe.fromArray([0,0,1,0,1,0,-1,0,0])),ke.Z_UP_TO_X_UP=Ae.fromRotationTranslation(oe.fromArray([0,0,-1,0,1,0,1,0,0])),ke.X_UP_TO_Y_UP=Ae.fromRotationTranslation(oe.fromArray([0,1,0,-1,0,0,0,0,1])),ke.Y_UP_TO_X_UP=Ae.fromRotationTranslation(oe.fromArray([0,-1,0,1,0,0,0,0,1])),ke.fromName=function(e){return M.typeOf.string("name",e),ke[e]};var Ge=Object.freeze(ke);function Ve(e,t){this.x=y(e,0),this.y=y(t,0)}Ve.fromElements=function(e,t,n){return _(n)?(n.x=e,n.y=t,n):new Ve(e,t)},Ve.clone=function(e,t){if(_(e))return _(t)?(t.x=e.x,t.y=e.y,t):new Ve(e.x,e.y)},Ve.fromCartesian3=Ve.clone,Ve.fromCartesian4=Ve.clone,Ve.packedLength=2,Ve.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e.x,t[n]=e.y,t},Ve.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new Ve),n.x=e[t++],n.y=e[t],n},Ve.packArray=function(e,t){M.defined("array",e);const n=e.length,r=2*n;if(_(t)){if(!Array.isArray(t)&&t.length!==r)throw new g("If result is a typed array, it must have exactly array.length * 2 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)Ve.pack(e[r],t,2*r);return t},Ve.unpackArray=function(e,t){if(M.defined("array",e),M.typeOf.number.greaterThanOrEquals("array.length",e.length,2),e.length%2!=0)throw new g("array length must be a multiple of 2.");const n=e.length;_(t)?t.length=n/2:t=new Array(n/2);for(let r=0;r<n;r+=2){const n=r/2;t[n]=Ve.unpack(e,r,t[n])}return t},Ve.fromArray=Ve.unpack,Ve.maximumComponent=function(e){return M.typeOf.object("cartesian",e),Math.max(e.x,e.y)},Ve.minimumComponent=function(e){return M.typeOf.object("cartesian",e),Math.min(e.x,e.y)},Ve.minimumByComponent=function(e,t,n){return M.typeOf.object("first",e),M.typeOf.object("second",t),M.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n},Ve.maximumByComponent=function(e,t,n){return M.typeOf.object("first",e),M.typeOf.object("second",t),M.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n},Ve.clamp=function(e,t,n,r){M.typeOf.object("value",e),M.typeOf.object("min",t),M.typeOf.object("max",n),M.typeOf.object("result",r);const o=U.clamp(e.x,t.x,n.x),i=U.clamp(e.y,t.y,n.y);return r.x=o,r.y=i,r},Ve.magnitudeSquared=function(e){return M.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},Ve.magnitude=function(e){return Math.sqrt(Ve.magnitudeSquared(e))};const He=new Ve;Ve.distance=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),Ve.subtract(e,t,He),Ve.magnitude(He)},Ve.distanceSquared=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),Ve.subtract(e,t,He),Ve.magnitudeSquared(He)},Ve.normalize=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=Ve.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,isNaN(t.x)||isNaN(t.y))throw new g("normalized result is not a number");return t},Ve.dot=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),e.x*t.x+e.y*t.y},Ve.cross=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),e.x*t.y-e.y*t.x},Ve.multiplyComponents=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n},Ve.divideComponents=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n},Ve.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n},Ve.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n},Ve.multiplyByScalar=function(e,t,n){return M.typeOf.object("cartesian",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n},Ve.divideByScalar=function(e,t,n){return M.typeOf.object("cartesian",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n},Ve.negate=function(e,t){return M.typeOf.object("cartesian",e),M.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},Ve.abs=function(e,t){return M.typeOf.object("cartesian",e),M.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};const We=new Ve;Ve.lerp=function(e,t,n,r){return M.typeOf.object("start",e),M.typeOf.object("end",t),M.typeOf.number("t",n),M.typeOf.object("result",r),Ve.multiplyByScalar(t,n,We),r=Ve.multiplyByScalar(e,1-n,r),Ve.add(We,r,r)};const Xe=new Ve,$e=new Ve;Ve.angleBetween=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),Ve.normalize(e,Xe),Ve.normalize(t,$e),U.acosClamped(Ve.dot(Xe,$e))};const Ye=new Ve;Ve.mostOrthogonalAxis=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=Ve.normalize(e,Ye);return Ve.abs(n,n),t=n.x<=n.y?Ve.clone(Ve.UNIT_X,t):Ve.clone(Ve.UNIT_Y,t)},Ve.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y},Ve.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]},Ve.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&U.equalsEpsilon(e.x,t.x,n,r)&&U.equalsEpsilon(e.y,t.y,n,r)},Ve.ZERO=Object.freeze(new Ve(0,0)),Ve.ONE=Object.freeze(new Ve(1,1)),Ve.UNIT_X=Object.freeze(new Ve(1,0)),Ve.UNIT_Y=Object.freeze(new Ve(0,1)),Ve.prototype.clone=function(e){return Ve.clone(this,e)},Ve.prototype.equals=function(e){return Ve.equals(this,e)},Ve.prototype.equalsEpsilon=function(e,t,n){return Ve.equalsEpsilon(this,e,t,n)},Ve.prototype.toString=function(){return`(${this.x}, ${this.y})`};const Ze=new Z,Qe=new Z;function Ke(e,t,n,r,o){if(!_(e))throw new g("cartesian is required.");if(!_(t))throw new g("oneOverRadii is required.");if(!_(n))throw new g("oneOverRadiiSquared is required.");if(!_(r))throw new g("centerToleranceSquared is required.");const i=e.x,s=e.y,a=e.z,u=t.x,c=t.y,l=t.z,f=i*i*u*u,p=s*s*c*c,h=a*a*l*l,d=f+p+h,m=Math.sqrt(1/d),y=Z.multiplyByScalar(e,m,Ze);if(d<r)return isFinite(m)?Z.clone(y,o):void 0;const b=n.x,E=n.y,O=n.z,w=Qe;w.x=y.x*b*2,w.y=y.y*E*2,w.z=y.z*O*2;let v,T,x,R,A,S,I,N,C,P,M,j=(1-m)*Z.magnitude(e)/(.5*Z.magnitude(w)),F=0;do{j-=F,x=1/(1+j*b),R=1/(1+j*E),A=1/(1+j*O),S=x*x,I=R*R,N=A*A,C=S*x,P=I*R,M=N*A,v=f*S+p*I+h*N-1,T=f*C*b+p*P*E+h*M*O;F=v/(-2*T)}while(Math.abs(v)>U.EPSILON12);return _(o)?(o.x=i*x,o.y=s*R,o.z=a*A,o):new Z(i*x,s*R,a*A)}function Je(e,t,n){this.longitude=y(e,0),this.latitude=y(t,0),this.height=y(n,0)}Je.fromRadians=function(e,t,n,r){return M.typeOf.number("longitude",e),M.typeOf.number("latitude",t),n=y(n,0),_(r)?(r.longitude=e,r.latitude=t,r.height=n,r):new Je(e,t,n)},Je.fromDegrees=function(e,t,n,r){return M.typeOf.number("longitude",e),M.typeOf.number("latitude",t),e=U.toRadians(e),t=U.toRadians(t),Je.fromRadians(e,t,n,r)};const et=new Z,tt=new Z,nt=new Z;function rt(e,t,n,r){t=y(t,0),n=y(n,0),r=y(r,0),M.typeOf.number.greaterThanOrEquals("x",t,0),M.typeOf.number.greaterThanOrEquals("y",n,0),M.typeOf.number.greaterThanOrEquals("z",r,0),e._radii=new Z(t,n,r),e._radiiSquared=new Z(t*t,n*n,r*r),e._radiiToTheFourth=new Z(t*t*t*t,n*n*n*n,r*r*r*r),e._oneOverRadii=new Z(0===t?0:1/t,0===n?0:1/n,0===r?0:1/r),e._oneOverRadiiSquared=new Z(0===t?0:1/(t*t),0===n?0:1/(n*n),0===r?0:1/(r*r)),e._minimumRadius=Math.min(t,n,r),e._maximumRadius=Math.max(t,n,r),e._centerToleranceSquared=U.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function ot(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,rt(this,e,t,n)}Je._ellipsoidOneOverRadii=new Z(1/6378137,1/6378137,1/6356752.314245179),Je._ellipsoidOneOverRadiiSquared=new Z(1/40680631590769,1/40680631590769,1/40408299984661.445),Je._ellipsoidCenterToleranceSquared=U.EPSILON1,Je.fromCartesian=function(e,t,n){const r=_(t)?t.oneOverRadii:Je._ellipsoidOneOverRadii,o=_(t)?t.oneOverRadiiSquared:Je._ellipsoidOneOverRadiiSquared,i=Ke(e,r,o,_(t)?t._centerToleranceSquared:Je._ellipsoidCenterToleranceSquared,tt);if(!_(i))return;let s=Z.multiplyComponents(i,o,et);s=Z.normalize(s,s);const a=Z.subtract(e,i,nt),u=Math.atan2(s.y,s.x),c=Math.asin(s.z),l=U.sign(Z.dot(a,e))*Z.magnitude(a);return _(n)?(n.longitude=u,n.latitude=c,n.height=l,n):new Je(u,c,l)},Je.toCartesian=function(e,t,n){return M.defined("cartographic",e),Z.fromRadians(e.longitude,e.latitude,e.height,t,n)},Je.clone=function(e,t){if(_(e))return _(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new Je(e.longitude,e.latitude,e.height)},Je.equals=function(e,t){return e===t||_(e)&&_(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},Je.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n},Je.ZERO=Object.freeze(new Je(0,0,0)),Je.prototype.clone=function(e){return Je.clone(this,e)},Je.prototype.equals=function(e){return Je.equals(this,e)},Je.prototype.equalsEpsilon=function(e,t){return Je.equalsEpsilon(this,e,t)},Je.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`},Object.defineProperties(ot.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),ot.clone=function(e,t){if(!_(e))return;const n=e._radii;return _(t)?(Z.clone(n,t._radii),Z.clone(e._radiiSquared,t._radiiSquared),Z.clone(e._radiiToTheFourth,t._radiiToTheFourth),Z.clone(e._oneOverRadii,t._oneOverRadii),Z.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new ot(n.x,n.y,n.z)},ot.fromCartesian3=function(e,t){return _(t)||(t=new ot),_(e)?(rt(t,e.x,e.y,e.z),t):t},ot.WGS84=Object.freeze(new ot(6378137,6378137,6356752.314245179)),ot.UNIT_SPHERE=Object.freeze(new ot(1,1,1)),ot.MOON=Object.freeze(new ot(U.LUNAR_RADIUS,U.LUNAR_RADIUS,U.LUNAR_RADIUS)),ot._default=ot.WGS84,Object.defineProperties(ot,{default:{get:function(){return ot._default},set:function(e){M.typeOf.object("value",e),ot._default=e,Z._ellipsoidRadiiSquared=e.radiiSquared,Je._ellipsoidOneOverRadii=e.oneOverRadii,Je._ellipsoidOneOverRadiiSquared=e.oneOverRadiiSquared,Je._ellipsoidCenterToleranceSquared=e._centerToleranceSquared}}}),ot.prototype.clone=function(e){return ot.clone(this,e)},ot.packedLength=Z.packedLength,ot.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),Z.pack(e._radii,t,n),t},ot.unpack=function(e,t,n){M.defined("array",e),t=y(t,0);const r=Z.unpack(e,t);return ot.fromCartesian3(r,n)},ot.prototype.geocentricSurfaceNormal=Z.normalize,ot.prototype.geodeticSurfaceNormalCartographic=function(e,t){M.typeOf.object("cartographic",e);const n=e.longitude,r=e.latitude,o=Math.cos(r),i=o*Math.cos(n),s=o*Math.sin(n),a=Math.sin(r);return _(t)||(t=new Z),t.x=i,t.y=s,t.z=a,Z.normalize(t,t)},ot.prototype.geodeticSurfaceNormal=function(e,t){if(M.typeOf.object("cartesian",e),isNaN(e.x)||isNaN(e.y)||isNaN(e.z))throw new g("cartesian has a NaN component");if(!Z.equalsEpsilon(e,Z.ZERO,U.EPSILON14))return _(t)||(t=new Z),t=Z.multiplyComponents(e,this._oneOverRadiiSquared,t),Z.normalize(t,t)};const it=new Z,st=new Z;ot.prototype.cartographicToCartesian=function(e,t){const n=it,r=st;this.geodeticSurfaceNormalCartographic(e,n),Z.multiplyComponents(this._radiiSquared,n,r);const o=Math.sqrt(Z.dot(n,r));return Z.divideByScalar(r,o,r),Z.multiplyByScalar(n,e.height,n),_(t)||(t=new Z),Z.add(r,n,t)},ot.prototype.cartographicArrayToCartesianArray=function(e,t){M.defined("cartographics",e);const n=e.length;_(t)?t.length=n:t=new Array(n);for(let r=0;r<n;r++)t[r]=this.cartographicToCartesian(e[r],t[r]);return t};const at=new Z,ut=new Z,ct=new Z;ot.prototype.cartesianToCartographic=function(e,t){const n=this.scaleToGeodeticSurface(e,ut);if(!_(n))return;const r=this.geodeticSurfaceNormal(n,at),o=Z.subtract(e,n,ct),i=Math.atan2(r.y,r.x),s=Math.asin(r.z),a=U.sign(Z.dot(o,e))*Z.magnitude(o);return _(t)?(t.longitude=i,t.latitude=s,t.height=a,t):new Je(i,s,a)},ot.prototype.cartesianArrayToCartographicArray=function(e,t){M.defined("cartesians",e);const n=e.length;_(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.cartesianToCartographic(e[r],t[r]);return t},ot.prototype.scaleToGeodeticSurface=function(e,t){return Ke(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},ot.prototype.scaleToGeocentricSurface=function(e,t){M.typeOf.object("cartesian",e),_(t)||(t=new Z);const n=e.x,r=e.y,o=e.z,i=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*i.x+r*r*i.y+o*o*i.z);return Z.multiplyByScalar(e,s,t)},ot.prototype.transformPositionToScaledSpace=function(e,t){return _(t)||(t=new Z),Z.multiplyComponents(e,this._oneOverRadii,t)},ot.prototype.transformPositionFromScaledSpace=function(e,t){return _(t)||(t=new Z),Z.multiplyComponents(e,this._radii,t)},ot.prototype.equals=function(e){return this===e||_(e)&&Z.equals(this._radii,e._radii)},ot.prototype.toString=function(){return this._radii.toString()},ot.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){if(M.typeOf.object("position",e),!U.equalsEpsilon(this._radii.x,this._radii.y,U.EPSILON15))throw new g("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");M.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),t=y(t,0);const r=this._squaredXOverSquaredZ;if(_(n)||(n=new Z),n.x=0,n.y=0,n.z=e.z*(1-r),!(Math.abs(n.z)>=this._radii.z-t))return n};const lt=new Z;ot.prototype.getLocalCurvature=function(e,t){M.typeOf.object("surfacePosition",e),_(t)||(t=new Ve);const n=this.getSurfaceNormalIntersectionWithZAxis(e,0,lt),r=Z.distance(e,n),o=r*(this.minimumRadius*r/this.maximumRadius**2)**2;return Ve.fromElements(1/r,1/o,t)};const ft=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],pt=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function ht(e,t,n){M.typeOf.number("a",e),M.typeOf.number("b",t),M.typeOf.func("func",n);const r=.5*(t+e),o=.5*(t-e);let i=0;for(let e=0;e<5;e++){const t=o*ft[e];i+=pt[e]*(n(r+t)+n(r-t))}return i*=o,i}function dt(e){this._ellipsoid=y(e,ot.default),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}ot.prototype.surfaceArea=function(e){M.typeOf.object("rectangle",e);const t=e.west;let n=e.east;const r=e.south,o=e.north;for(;n<t;)n+=U.TWO_PI;const i=this._radiiSquared,s=i.x,a=i.y,u=i.z,c=s*a;return ht(r,o,(function(e){const r=Math.cos(e),o=Math.sin(e);return Math.cos(e)*ht(t,n,(function(e){const t=Math.cos(e),n=Math.sin(e);return Math.sqrt(c*o*o+u*(a*t*t+s*n*n)*r*r)}))}))},Object.defineProperties(dt.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),dt.prototype.project=function(e,t){const n=this._semimajorAxis,r=e.longitude*n,o=e.latitude*n,i=e.height;return _(t)?(t.x=r,t.y=o,t.z=i,t):new Z(r,o,i)},dt.prototype.unproject=function(e,t){if(!_(e))throw new g("cartesian is required");const n=this._oneOverSemimajorAxis,r=e.x*n,o=e.y*n,i=e.z;return _(t)?(t.longitude=r,t.latitude=o,t.height=i,t):new Je(r,o,i)};var mt=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function yt(e,t){this.start=y(e,0),this.stop=y(t,0)}function _t(e,t,n){M.defined("array",e),M.defined("itemToFind",t),M.defined("comparator",n);let r,o,i=0,s=e.length-1;for(;i<=s;)if(r=~~((i+s)/2),o=n(e[r],t),o<0)i=r+1;else{if(!(o>0))return r;s=r-1}return~(s+1)}function gt(e,t,n,r,o){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=o}function bt(e){if(null===e||isNaN(e))throw new g("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}const Et=[31,28,31,30,31,30,31,31,30,31,30,31];function Ot(e,t,n,r,o,i,s,a){e=y(e,1),t=y(t,1),n=y(n,1),r=y(r,0),o=y(o,0),i=y(i,0),s=y(s,0),a=y(a,!1),M.typeOf.number.greaterThanOrEquals("Year",e,1),M.typeOf.number.lessThanOrEquals("Year",e,9999),M.typeOf.number.greaterThanOrEquals("Month",t,1),M.typeOf.number.lessThanOrEquals("Month",t,12),M.typeOf.number.greaterThanOrEquals("Day",n,1),M.typeOf.number.lessThanOrEquals("Day",n,31),M.typeOf.number.greaterThanOrEquals("Hour",r,0),M.typeOf.number.lessThanOrEquals("Hour",r,23),M.typeOf.number.greaterThanOrEquals("Minute",o,0),M.typeOf.number.lessThanOrEquals("Minute",o,59),M.typeOf.bool("IsLeapSecond",a),M.typeOf.number.greaterThanOrEquals("Second",i,0),M.typeOf.number.lessThanOrEquals("Second",i,a?60:59),M.typeOf.number.greaterThanOrEquals("Millisecond",s,0),M.typeOf.number.lessThan("Millisecond",s,1e3),function(){const r=2===t&&bt(e)?Et[t-1]+1:Et[t-1];if(n>r)throw new g("Month and Day represents invalid date")}(),this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=o,this.second=i,this.millisecond=s,this.isLeapSecond=a}function wt(e,t){this.julianDate=e,this.offset=t}var vt=Object.freeze({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5});var Tt=Object.freeze({UTC:0,TAI:1});const xt=new Ot,Rt=[31,28,31,30,31,30,31,31,30,31,30,31];function At(e,t){return Gt.compare(e.julianDate,t.julianDate)}const St=new wt;function It(e){St.julianDate=e;const t=Gt.leapSeconds;let n=_t(t,St,At);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let r=t[n].offset;if(n>0){Gt.secondsDifference(t[n].julianDate,e)>r&&(n--,r=t[n].offset)}Gt.addSeconds(e,r,e)}function Nt(e,t){St.julianDate=e;const n=Gt.leapSeconds;let r=_t(n,St,At);if(r<0&&(r=~r),0===r)return Gt.addSeconds(e,-n[0].offset,t);if(r>=n.length)return Gt.addSeconds(e,-n[r-1].offset,t);const o=Gt.secondsDifference(n[r].julianDate,e);return 0===o?Gt.addSeconds(e,-n[r].offset,t):o<=1?void 0:Gt.addSeconds(e,-n[--r].offset,t)}function Ct(e,t,n){const r=t/vt.SECONDS_PER_DAY|0;return e+=r,(t-=vt.SECONDS_PER_DAY*r)<0&&(e--,t+=vt.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function Pt(e,t,n,r,o,i,s){const a=(t-14)/12|0,u=e+4800+a;let c=(1461*u/4|0)+(367*(t-2-12*a)/12|0)-(3*((u+100)/100|0)/4|0)+n-32075;(r-=12)<0&&(r+=24);const l=i+(r*vt.SECONDS_PER_HOUR+o*vt.SECONDS_PER_MINUTE+s*vt.SECONDS_PER_MILLISECOND);return l>=43200&&(c-=1),[c,l]}const Mt=/^(\d{4})$/,jt=/^(\d{4})-(\d{2})$/,Ut=/^(\d{4})-?(\d{3})$/,Ft=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,qt=/^(\d{4})-?(\d{2})-?(\d{2})$/,Lt=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Dt=/^(\d{2})(\.\d+)?/.source+Lt.source,Bt=/^(\d{2}):?(\d{2})(\.\d+)?/.source+Lt.source,zt=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+Lt.source,kt="Invalid ISO 8601 date.";function Gt(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=y(e,0),t=y(t,0),n=y(n,Tt.UTC);const r=0|e;Ct(r,t+=(e-r)*vt.SECONDS_PER_DAY,this),n===Tt.UTC&&It(this)}Gt.fromGregorianDate=function(e,t){if(!(e instanceof Ot))throw new g("date must be a valid GregorianDate.");const n=Pt(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return _(t)?(Ct(n[0],n[1],t),It(t),t):new Gt(n[0],n[1],Tt.UTC)},Gt.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new g("date must be a valid JavaScript Date.");const n=Pt(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return _(t)?(Ct(n[0],n[1],t),It(t),t):new Gt(n[0],n[1],Tt.UTC)},Gt.fromIso8601=function(e,t){if("string"!=typeof e)throw new g(kt);let n,r=(e=e.replace(",",".")).split("T"),o=1,i=1,s=0,a=0,u=0,c=0;const l=r[0],f=r[1];let p,h,d,m;if(!_(l))throw new g(kt);if(r=l.match(qt),null!==r){if(d=l.split("-").length-1,d>0&&2!==d)throw new g(kt);n=+r[1],o=+r[2],i=+r[3]}else if(r=l.match(jt),null!==r)n=+r[1],o=+r[2];else if(r=l.match(Mt),null!==r)n=+r[1];else{let e;if(r=l.match(Ut),null!==r){if(n=+r[1],e=+r[2],h=bt(n),e<1||h&&e>366||!h&&e>365)throw new g(kt)}else{if(r=l.match(Ft),null===r)throw new g(kt);{n=+r[1];const t=+r[2],o=+r[3]||0;if(d=l.split("-").length-1,d>0&&(!_(r[3])&&1!==d||_(r[3])&&2!==d))throw new g(kt);e=7*t+o-new Date(Date.UTC(n,0,4)).getUTCDay()-3}}p=new Date(Date.UTC(n,0,1)),p.setUTCDate(e),o=p.getUTCMonth()+1,i=p.getUTCDate()}if(h=bt(n),o<1||o>12||i<1||(2!==o||!h)&&i>Rt[o-1]||h&&2===o&&i>29)throw new g(kt);if(_(f)){if(r=f.match(zt),null!==r){if(d=f.split(":").length-1,d>0&&2!==d&&3!==d)throw new g(kt);s=+r[1],a=+r[2],u=+r[3],c=1e3*+(r[4]||0),m=5}else if(r=f.match(Bt),null!==r){if(d=f.split(":").length-1,d>2)throw new g(kt);s=+r[1],a=+r[2],u=60*+(r[3]||0),m=4}else{if(r=f.match(Dt),null===r)throw new g(kt);s=+r[1],a=60*+(r[2]||0),m=3}if(a>=60||u>=61||s>24||24===s&&(a>0||u>0||c>0))throw new g(kt);const e=r[m],t=+r[m+1],l=+(r[m+2]||0);switch(e){case"+":s-=t,a-=l;break;case"-":s+=t,a+=l;break;case"Z":break;default:a+=new Date(Date.UTC(n,o-1,i,s,a)).getTimezoneOffset()}}const y=60===u;for(y&&u--;a>=60;)a-=60,s++;for(;s>=24;)s-=24,i++;for(p=h&&2===o?29:Rt[o-1];i>p;)i-=p,o++,o>12&&(o-=12,n++),p=h&&2===o?29:Rt[o-1];for(;a<0;)a+=60,s--;for(;s<0;)s+=24,i--;for(;i<1;)o--,o<1&&(o+=12,n--),p=h&&2===o?29:Rt[o-1],i+=p;const b=Pt(n,o,i,s,a,u,c);return _(t)?(Ct(b[0],b[1],t),It(t)):t=new Gt(b[0],b[1],Tt.UTC),y&&Gt.addSeconds(t,1,t),t},Gt.now=function(e){return Gt.fromDate(new Date,e)};const Vt=new Gt(0,0,Tt.TAI);Gt.toGregorianDate=function(e,t){if(!_(e))throw new g("julianDate is required.");let n=!1,r=Nt(e,Vt);_(r)||(Gt.addSeconds(e,-1,Vt),r=Nt(Vt,Vt),n=!0);let o=r.dayNumber;const i=r.secondsOfDay;i>=43200&&(o+=1);let s=o+68569|0;const a=4*s/146097|0;s=s-((146097*a+3)/4|0)|0;const u=4e3*(s+1)/1461001|0;s=s-(1461*u/4|0)+31|0;const c=80*s/2447|0,l=s-(2447*c/80|0)|0;s=c/11|0;const f=c+2-12*s|0,p=100*(a-49)+u+s|0;let h=i/vt.SECONDS_PER_HOUR|0,d=i-h*vt.SECONDS_PER_HOUR;const m=d/vt.SECONDS_PER_MINUTE|0;d-=m*vt.SECONDS_PER_MINUTE;let y=0|d;const b=(d-y)/vt.SECONDS_PER_MILLISECOND;return h+=12,h>23&&(h-=24),n&&(y+=1),_(t)?(t.year=p,t.month=f,t.day=l,t.hour=h,t.minute=m,t.second=y,t.millisecond=b,t.isLeapSecond=n,t):new Ot(p,f,l,h,m,y,b,n)},Gt.toDate=function(e){if(!_(e))throw new g("julianDate is required.");const t=Gt.toGregorianDate(e,xt);let n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))},Gt.toIso8601=function(e,t){if(!_(e))throw new g("julianDate is required.");const n=Gt.toGregorianDate(e,xt);let r=n.year,o=n.month,i=n.day,s=n.hour;const a=n.minute,u=n.second,c=n.millisecond;let l;return 1e4===r&&1===o&&1===i&&0===s&&0===a&&0===u&&0===c&&(r=9999,o=12,i=31,s=24),_(t)||0===c?_(t)&&0!==t?(l=(.01*c).toFixed(t).replace(".","").slice(0,t),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}.${l}Z`):`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}Z`:(l=(.01*c).toString().replace(".",""),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}.${l}Z`)},Gt.clone=function(e,t){if(_(e))return _(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new Gt(e.dayNumber,e.secondsOfDay,Tt.TAI)},Gt.compare=function(e,t){if(!_(e))throw new g("left is required.");if(!_(t))throw new g("right is required.");const n=e.dayNumber-t.dayNumber;return 0!==n?n:e.secondsOfDay-t.secondsOfDay},Gt.equals=function(e,t){return e===t||_(e)&&_(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},Gt.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(Gt.secondsDifference(e,t))<=n},Gt.totalDays=function(e){if(!_(e))throw new g("julianDate is required.");return e.dayNumber+e.secondsOfDay/vt.SECONDS_PER_DAY},Gt.secondsDifference=function(e,t){if(!_(e))throw new g("left is required.");if(!_(t))throw new g("right is required.");return(e.dayNumber-t.dayNumber)*vt.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},Gt.daysDifference=function(e,t){if(!_(e))throw new g("left is required.");if(!_(t))throw new g("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/vt.SECONDS_PER_DAY},Gt.computeTaiMinusUtc=function(e){St.julianDate=e;const t=Gt.leapSeconds;let n=_t(t,St,At);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset},Gt.addSeconds=function(e,t,n){if(!_(e))throw new g("julianDate is required.");if(!_(t))throw new g("seconds is required.");if(!_(n))throw new g("result is required.");return Ct(e.dayNumber,e.secondsOfDay+t,n)},Gt.addMinutes=function(e,t,n){if(!_(e))throw new g("julianDate is required.");if(!_(t))throw new g("minutes is required.");if(!_(n))throw new g("result is required.");const r=e.secondsOfDay+t*vt.SECONDS_PER_MINUTE;return Ct(e.dayNumber,r,n)},Gt.addHours=function(e,t,n){if(!_(e))throw new g("julianDate is required.");if(!_(t))throw new g("hours is required.");if(!_(n))throw new g("result is required.");const r=e.secondsOfDay+t*vt.SECONDS_PER_HOUR;return Ct(e.dayNumber,r,n)},Gt.addDays=function(e,t,n){if(!_(e))throw new g("julianDate is required.");if(!_(t))throw new g("days is required.");if(!_(n))throw new g("result is required.");return Ct(e.dayNumber+t,e.secondsOfDay,n)},Gt.lessThan=function(e,t){return Gt.compare(e,t)<0},Gt.lessThanOrEquals=function(e,t){return Gt.compare(e,t)<=0},Gt.greaterThan=function(e,t){return Gt.compare(e,t)>0},Gt.greaterThanOrEquals=function(e,t){return Gt.compare(e,t)>=0},Gt.prototype.clone=function(e){return Gt.clone(this,e)},Gt.prototype.equals=function(e){return Gt.equals(this,e)},Gt.prototype.equalsEpsilon=function(e,t){return Gt.equalsEpsilon(this,e,t)},Gt.prototype.toString=function(){return Gt.toIso8601(this)},Gt.leapSeconds=[new wt(new Gt(2441317,43210,Tt.TAI),10),new wt(new Gt(2441499,43211,Tt.TAI),11),new wt(new Gt(2441683,43212,Tt.TAI),12),new wt(new Gt(2442048,43213,Tt.TAI),13),new wt(new Gt(2442413,43214,Tt.TAI),14),new wt(new Gt(2442778,43215,Tt.TAI),15),new wt(new Gt(2443144,43216,Tt.TAI),16),new wt(new Gt(2443509,43217,Tt.TAI),17),new wt(new Gt(2443874,43218,Tt.TAI),18),new wt(new Gt(2444239,43219,Tt.TAI),19),new wt(new Gt(2444786,43220,Tt.TAI),20),new wt(new Gt(2445151,43221,Tt.TAI),21),new wt(new Gt(2445516,43222,Tt.TAI),22),new wt(new Gt(2446247,43223,Tt.TAI),23),new wt(new Gt(2447161,43224,Tt.TAI),24),new wt(new Gt(2447892,43225,Tt.TAI),25),new wt(new Gt(2448257,43226,Tt.TAI),26),new wt(new Gt(2448804,43227,Tt.TAI),27),new wt(new Gt(2449169,43228,Tt.TAI),28),new wt(new Gt(2449534,43229,Tt.TAI),29),new wt(new Gt(2450083,43230,Tt.TAI),30),new wt(new Gt(2450630,43231,Tt.TAI),31),new wt(new Gt(2451179,43232,Tt.TAI),32),new wt(new Gt(2453736,43233,Tt.TAI),33),new wt(new Gt(2454832,43234,Tt.TAI),34),new wt(new Gt(2456109,43235,Tt.TAI),35),new wt(new Gt(2457204,43236,Tt.TAI),36),new wt(new Gt(2457754,43237,Tt.TAI),37)];var Ht,Wt={exports:{}},Xt={exports:{}},$t=Xt.exports;var Yt,Zt={exports:{}},Qt=Zt.exports;
/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */var Kt,Jt,en={exports:{}},tn=en.exports;
/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */var nn,rn,on,sn=(Jt||(Jt=1,rn=Wt.exports,on=function(e,t,n,r){var o=r&&r.URI;function i(e,t){var n=arguments.length>=1;if(!(this instanceof i))return n?arguments.length>=2?new i(e,t):new i(e):new i;if(void 0===e){if(n)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&n)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}i.version="1.19.11";var s=i.prototype,a=Object.prototype.hasOwnProperty;function u(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function l(e){return"Array"===c(e)}function f(e,t){var n,r,o={};if("RegExp"===c(t))o=null;else if(l(t))for(n=0,r=t.length;n<r;n++)o[t[n]]=!0;else o[t]=!0;for(n=0,r=e.length;n<r;n++)(o&&void 0!==o[e[n]]||!o&&t.test(e[n]))&&(e.splice(n,1),r--,n--);return e}function p(e,t){var n,r;if(l(t)){for(n=0,r=t.length;n<r;n++)if(!p(e,t[n]))return!1;return!0}var o=c(t);for(n=0,r=e.length;n<r;n++)if("RegExp"===o){if("string"==typeof e[n]&&e[n].match(t))return!0}else if(e[n]===t)return!0;return!1}function h(e,t){if(!l(e)||!l(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function d(e){return e.replace(/^\/+|\/+$/g,"")}function m(e){return escape(e)}function y(e){return encodeURIComponent(e).replace(/[!'()*]/g,m).replace(/\*/g,"%2A")}i._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:i.preventInvalidHostname,duplicateQueryParameters:i.duplicateQueryParameters,escapeQuerySpace:i.escapeQuerySpace}},i.preventInvalidHostname=!1,i.duplicateQueryParameters=!1,i.escapeQuerySpace=!0,i.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,i.idn_expression=/[^a-z0-9\._-]/i,i.punycode_expression=/(xn--)/i,i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,i.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},i.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,i.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},i.hostProtocols=["http","https"],i.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,i.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},i.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return i.domAttributes[t]}},i.encode=y,i.decode=decodeURIComponent,i.iso8859=function(){i.encode=escape,i.decode=unescape},i.unicode=function(){i.encode=y,i.decode=decodeURIComponent},i.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},i.encodeQuery=function(e,t){var n=i.encode(e+"");return void 0===t&&(t=i.escapeQuerySpace),t?n.replace(/%20/g,"+"):n},i.decodeQuery=function(e,t){e+="",void 0===t&&(t=i.escapeQuerySpace);try{return i.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var _,g={encode:"encode",decode:"decode"},b=function(e,t){return function(n){try{return i[t](n+"").replace(i.characters[e][t].expression,(function(n){return i.characters[e][t].map[n]}))}catch(e){return n}}};for(_ in g)i[_+"PathSegment"]=b("pathname",g[_]),i[_+"UrnPathSegment"]=b("urnpath",g[_]);var E=function(e,t,n){return function(r){var o;o=n?function(e){return i[t](i[n](e))}:i[t];for(var s=(r+"").split(e),a=0,u=s.length;a<u;a++)s[a]=o(s[a]);return s.join(e)}};function O(e){return function(t,n){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!n),this)}}function w(e,t){return function(n,r){return void 0===n?this._parts[e]||"":(null!==n&&(n+="").charAt(0)===t&&(n=n.substring(1)),this._parts[e]=n,this.build(!r),this)}}i.decodePath=E("/","decodePathSegment"),i.decodeUrnPath=E(":","decodeUrnPathSegment"),i.recodePath=E("/","encodePathSegment","decode"),i.recodeUrnPath=E(":","encodeUrnPathSegment","decode"),i.encodeReserved=b("reserved","encode"),i.parse=function(e,t){var n;return t||(t={preventInvalidHostname:i.preventInvalidHostname}),(n=(e=(e=e.replace(i.leading_whitespace_expression,"")).replace(i.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(n+1)||null,e=e.substring(0,n)),(n=e.indexOf("?"))>-1&&(t.query=e.substring(n+1)||null,e=e.substring(0,n)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=i.parseAuthority(e,t)):(n=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,n)||null,t.protocol&&!t.protocol.match(i.protocol_expression)?t.protocol=void 0:"//"===e.substring(n+1,n+3).replace(/\\/g,"/")?(e=e.substring(n+3),e=i.parseAuthority(e,t)):(e=e.substring(n+1),t.urn=!0)),t.path=e,t},i.parseHost=function(e,t){e||(e="");var n,r,o=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===o&&(o=e.length),"["===e.charAt(0))n=e.indexOf("]"),t.hostname=e.substring(1,n)||null,t.port=e.substring(n+2,o)||null,"/"===t.port&&(t.port=null);else{var s=e.indexOf(":"),a=e.indexOf("/"),u=e.indexOf(":",s+1);-1!==u&&(-1===a||u<a)?(t.hostname=e.substring(0,o)||null,t.port=null):(r=e.substring(0,o).split(":"),t.hostname=r[0]||null,t.port=r[1]||null)}return t.hostname&&"/"!==e.substring(o).charAt(0)&&(o++,e="/"+e),t.preventInvalidHostname&&i.ensureValidHostname(t.hostname,t.protocol),t.port&&i.ensureValidPort(t.port),e.substring(o)||"/"},i.parseAuthority=function(e,t){return e=i.parseUserinfo(e,t),i.parseHost(e,t)},i.parseUserinfo=function(e,t){var n=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var r,o=e.indexOf("/"),s=e.lastIndexOf("@",o>-1?o:e.length-1);return s>-1&&(-1===o||s<o)?(r=e.substring(0,s).split(":"),t.username=r[0]?i.decode(r[0]):null,r.shift(),t.password=r[0]?i.decode(r.join(":")):null,e=n.substring(s+1)):(t.username=null,t.password=null),e},i.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,o,s={},u=e.split("&"),c=u.length,l=0;l<c;l++)n=u[l].split("="),r=i.decodeQuery(n.shift(),t),o=n.length?i.decodeQuery(n.join("="),t):null,"__proto__"!==r&&(a.call(s,r)?("string"!=typeof s[r]&&null!==s[r]||(s[r]=[s[r]]),s[r].push(o)):s[r]=o);return s},i.build=function(e){var t="",n=!1;return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//",n=!0),t+=i.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&n&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},i.buildHost=function(e){var t="";return e.hostname?(i.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},i.buildAuthority=function(e){return i.buildUserinfo(e)+i.buildHost(e)},i.buildUserinfo=function(e){var t="";return e.username&&(t+=i.encode(e.username)),e.password&&(t+=":"+i.encode(e.password)),t&&(t+="@"),t},i.buildQuery=function(e,t,n){var r,o,s,u,c="";for(o in e)if("__proto__"!==o&&a.call(e,o))if(l(e[o]))for(r={},s=0,u=e[o].length;s<u;s++)void 0!==e[o][s]&&void 0===r[e[o][s]+""]&&(c+="&"+i.buildQueryParameter(o,e[o][s],n),!0!==t&&(r[e[o][s]+""]=!0));else void 0!==e[o]&&(c+="&"+i.buildQueryParameter(o,e[o],n));return c.substring(1)},i.buildQueryParameter=function(e,t,n){return i.encodeQuery(e,n)+(null!==t?"="+i.encodeQuery(t,n):"")},i.addQuery=function(e,t,n){if("object"==typeof t)for(var r in t)a.call(t,r)&&i.addQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=n);"string"==typeof e[t]&&(e[t]=[e[t]]),l(n)||(n=[n]),e[t]=(e[t]||[]).concat(n)}},i.setQuery=function(e,t,n){if("object"==typeof t)for(var r in t)a.call(t,r)&&i.setQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===n?null:n}},i.removeQuery=function(e,t,n){var r,o,s;if(l(t))for(r=0,o=t.length;r<o;r++)e[t[r]]=void 0;else if("RegExp"===c(t))for(s in e)t.test(s)&&(e[s]=void 0);else if("object"==typeof t)for(s in t)a.call(t,s)&&i.removeQuery(e,s,t[s]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===c(n)?!l(e[t])&&n.test(e[t])?e[t]=void 0:e[t]=f(e[t],n):e[t]!==String(n)||l(n)&&1!==n.length?l(e[t])&&(e[t]=f(e[t],n)):e[t]=void 0:e[t]=void 0}},i.hasQuery=function(e,t,n,r){switch(c(t)){case"String":break;case"RegExp":for(var o in e)if(a.call(e,o)&&t.test(o)&&(void 0===n||i.hasQuery(e,o,n)))return!0;return!1;case"Object":for(var s in t)if(a.call(t,s)&&!i.hasQuery(e,s,t[s]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(c(n)){case"Undefined":return t in e;case"Boolean":return n===Boolean(l(e[t])?e[t].length:e[t]);case"Function":return!!n(e[t],t,e);case"Array":return!!l(e[t])&&(r?p:h)(e[t],n);case"RegExp":return l(e[t])?!!r&&p(e[t],n):Boolean(e[t]&&e[t].match(n));case"Number":n=String(n);case"String":return l(e[t])?!!r&&p(e[t],n):e[t]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},i.joinPaths=function(){for(var e=[],t=[],n=0,r=0;r<arguments.length;r++){var o=new i(arguments[r]);e.push(o);for(var s=o.segment(),a=0;a<s.length;a++)"string"==typeof s[a]&&t.push(s[a]),s[a]&&n++}if(!t.length||!n)return new i("");var u=new i("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||u.path("/"+u.path()),u.normalize()},i.commonPath=function(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n++)if(e.charAt(n)!==t.charAt(n)){n--;break}return n<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(n)&&"/"===t.charAt(n)||(n=e.substring(0,n).lastIndexOf("/")),e.substring(0,n+1))},i.withinString=function(e,t,n){n||(n={});var r=n.start||i.findUri.start,o=n.end||i.findUri.end,s=n.trim||i.findUri.trim,a=n.parens||i.findUri.parens,u=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var c=r.exec(e);if(!c)break;var l=c.index;if(n.ignoreHtml){var f=e.slice(Math.max(l-3,0),l);if(f&&u.test(f))continue}for(var p=l+e.slice(l).search(o),h=e.slice(l,p),d=-1;;){var m=a.exec(h);if(!m)break;var y=m.index+m[0].length;d=Math.max(d,y)}if(!((h=d>-1?h.slice(0,d)+h.slice(d).replace(s,""):h.replace(s,"")).length<=c[0].length||n.ignore&&n.ignore.test(h))){var _=t(h,l,p=l+h.length,e);void 0!==_?(_=String(_),e=e.slice(0,l)+_+e.slice(p),r.lastIndex=l+_.length):r.lastIndex=p}}return r.lastIndex=0,e},i.ensureValidHostname=function(t,n){var r=!!t,o=!1;if(!!n&&(o=p(i.hostProtocols,n)),o&&!r)throw new TypeError("Hostname cannot be empty, if protocol is "+n);if(t&&t.match(i.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(i.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},i.ensureValidPort=function(e){if(e){var t=Number(e);if(!(/^[0-9]+$/.test(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},i.noConflict=function(e){if(e){var t={URI:this.noConflict()};return r.URITemplate&&"function"==typeof r.URITemplate.noConflict&&(t.URITemplate=r.URITemplate.noConflict()),r.IPv6&&"function"==typeof r.IPv6.noConflict&&(t.IPv6=r.IPv6.noConflict()),r.SecondLevelDomains&&"function"==typeof r.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=r.SecondLevelDomains.noConflict()),t}return r.URI===this&&(r.URI=o),this},s.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=i.build(this._parts),this._deferred_build=!1),this},s.clone=function(){return new i(this)},s.valueOf=s.toString=function(){return this.build(!1)._string},s.protocol=O("protocol"),s.username=O("username"),s.password=O("password"),s.hostname=O("hostname"),s.port=O("port"),s.query=w("query","?"),s.fragment=w("fragment","#"),s.search=function(e,t){var n=this.query(e,t);return"string"==typeof n&&n.length?"?"+n:n},s.hash=function(e,t){var n=this.fragment(e,t);return"string"==typeof n&&n.length?"#"+n:n},s.pathname=function(e,t){if(void 0===e||!0===e){var n=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?i.decodeUrnPath:i.decodePath)(n):n}return this._parts.urn?this._parts.path=e?i.recodeUrnPath(e):"":this._parts.path=e?i.recodePath(e):"/",this.build(!t),this},s.path=s.pathname,s.href=function(e,t){var n;if(void 0===e)return this.toString();this._string="",this._parts=i._parts();var r=e instanceof i,o="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName&&(e=e[i.getDomAttribute(e)]||"",o=!1),!r&&o&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=i.parse(String(e),this._parts);else{if(!r&&!o)throw new TypeError("invalid input");var s=r?e._parts:e;for(n in s)"query"!==n&&a.call(this._parts,n)&&(this._parts[n]=s[n]);s.query&&this.query(s.query,!1)}return this.build(!t),this},s.is=function(e){var t=!1,r=!1,o=!1,s=!1,a=!1,u=!1,c=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,r=i.ip4_expression.test(this._parts.hostname),o=i.ip6_expression.test(this._parts.hostname),a=(s=!(t=r||o))&&n&&n.has(this._parts.hostname),u=s&&i.idn_expression.test(this._parts.hostname),c=s&&i.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return s;case"sld":return a;case"ip":return t;case"ip4":case"ipv4":case"inet4":return r;case"ip6":case"ipv6":case"inet6":return o;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var v=s.protocol,T=s.port,x=s.hostname;s.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(i.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return v.call(this,e,t)},s.scheme=s.protocol,s.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),i.ensureValidPort(e))),T.call(this,e,t))},s.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var n={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==i.parseHost(e,n))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=n.hostname,this._parts.preventInvalidHostname&&i.ensureValidHostname(e,this._parts.protocol)}return x.call(this,e,t)},s.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=this.protocol();return this.authority()?(n?n+"://":"")+this.authority():""}var r=i(e);return this.protocol(r.protocol()).authority(r.authority()).build(!t),this},s.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildHost(this._parts):"";if("/"!==i.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},s.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildAuthority(this._parts):"";if("/"!==i.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},s.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=i.buildUserinfo(this._parts);return n?n.substring(0,n.length-1):n}return"@"!==e[e.length-1]&&(e+="@"),i.parseUserinfo(e,this._parts),this.build(!t),this},s.resource=function(e,t){var n;return void 0===e?this.path()+this.search()+this.hash():(n=i.parse(e),this._parts.path=n.path,this._parts.query=n.query,this._parts.fragment=n.fragment,this.build(!t),this)},s.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,n)||""}var r=this._parts.hostname.length-this.domain().length,o=this._parts.hostname.substring(0,r),s=new RegExp("^"+u(o));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&i.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(s,e),this.build(!t),this},s.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.match(/\./g);if(n&&n.length<2)return this._parts.hostname;var r=this._parts.hostname.length-this.tld(t).length-1;return r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(i.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var o=new RegExp(u(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},s.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.lastIndexOf("."),o=this._parts.hostname.substring(r+1);return!0!==t&&n&&n.list[o.toLowerCase()]&&n.get(this._parts.hostname)||o}var i;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!n||!n.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');i=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");i=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}return this.build(!t),this},s.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,n)||(this._parts.hostname?"/":"");return e?i.decodePath(r):r}var o=this._parts.path.length-this.filename().length,s=this._parts.path.substring(0,o),a=new RegExp("^"+u(s));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=i.recodePath(e),this._parts.path=this._parts.path.replace(a,e),this.build(!t),this},s.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(n+1);return e?i.decodePathSegment(r):r}var o=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(o=!0);var s=new RegExp(u(this.filename())+"$");return e=i.recodePath(e),this._parts.path=this._parts.path.replace(s,e),o?this.normalizePath(t):this.build(!t),this},s.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var n,r,o=this.filename(),s=o.lastIndexOf(".");return-1===s?"":(n=o.substring(s+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",e?i.decodePathSegment(r):r)}"."===e.charAt(0)&&(e=e.substring(1));var a,c=this.suffix();if(c)a=e?new RegExp(u(c)+"$"):new RegExp(u("."+c)+"$");else{if(!e)return this;this._parts.path+="."+i.recodePath(e)}return a&&(e=i.recodePath(e),this._parts.path=this._parts.path.replace(a,e)),this.build(!t),this},s.segment=function(e,t,n){var r=this._parts.urn?":":"/",o=this.path(),i="/"===o.substring(0,1),s=o.split(r);if(void 0!==e&&"number"!=typeof e&&(n=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(i&&s.shift(),e<0&&(e=Math.max(s.length+e,0)),void 0===t)return void 0===e?s:s[e];if(null===e||void 0===s[e])if(l(t)){s=[];for(var a=0,u=t.length;a<u;a++)(t[a].length||s.length&&s[s.length-1].length)&&(s.length&&!s[s.length-1].length&&s.pop(),s.push(d(t[a])))}else(t||"string"==typeof t)&&(t=d(t),""===s[s.length-1]?s[s.length-1]=t:s.push(t));else t?s[e]=d(t):s.splice(e,1);return i&&s.unshift(""),this.path(s.join(r),n)},s.segmentCoded=function(e,t,n){var r,o,s;if("number"!=typeof e&&(n=t,t=e,e=void 0),void 0===t){if(l(r=this.segment(e,t,n)))for(o=0,s=r.length;o<s;o++)r[o]=i.decode(r[o]);else r=void 0!==r?i.decode(r):void 0;return r}if(l(t))for(o=0,s=t.length;o<s;o++)t[o]=i.encode(t[o]);else t="string"==typeof t||t instanceof String?i.encode(t):t;return this.segment(e,t,n)};var R=s.query;return s.query=function(e,t){if(!0===e)return i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace),r=e.call(this,n);return this._parts.query=i.buildQuery(r||n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=i.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):R.call(this,e,t)},s.setQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)r[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var o in e)a.call(e,o)&&(r[o]=e[o])}return this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},s.addQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.addQuery(r,e,void 0===t?null:t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},s.removeQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.removeQuery(r,e,t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},s.hasQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.hasQuery(r,e,t,n)},s.setSearch=s.setQuery,s.addSearch=s.addQuery,s.removeSearch=s.removeQuery,s.hasSearch=s.hasQuery,s.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},s.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},s.normalizeHostname=function(n){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!n)),this},s.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},s.normalizePath=function(e){var t,n=this._parts.path;if(!n)return this;if(this._parts.urn)return this._parts.path=i.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var r,o,s="";for("/"!==(n=i.recodePath(n)).charAt(0)&&(t=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),t&&(s=n.substring(1).match(/^(\.\.\/)+/)||"")&&(s=s[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)0!==r?(-1===(o=n.substring(0,r).lastIndexOf("/"))&&(o=r),n=n.substring(0,o)+n.substring(r+3)):n=n.substring(3);return t&&this.is("relative")&&(n=s+n.substring(1)),this._parts.path=n,this.build(!e),this},s.normalizePathname=s.normalizePath,s.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},s.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},s.normalizeSearch=s.normalizeQuery,s.normalizeHash=s.normalizeFragment,s.iso8859=function(){var e=i.encode,t=i.decode;i.encode=escape,i.decode=decodeURIComponent;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},s.unicode=function(){var e=i.encode,t=i.decode;i.encode=y,i.decode=unescape;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},s.readable=function(){var t=this.clone();t.username("").password("").normalize();var n="";if(t._parts.protocol&&(n+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(n+=e.toUnicode(t._parts.hostname),t._parts.port&&(n+=":"+t._parts.port)):n+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(n+="/"),n+=t.path(!0),t._parts.query){for(var r="",o=0,s=t._parts.query.split("&"),a=s.length;o<a;o++){var u=(s[o]||"").split("=");r+="&"+i.decodeQuery(u[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==u[1]&&(r+="="+i.decodeQuery(u[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}n+="?"+r.substring(1)}return n+=i.decodeQuery(t.hash(),!0)},s.absoluteTo=function(e){var t,n,r,o=this.clone(),s=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof i||(e=new i(e)),o._parts.protocol)return o;if(o._parts.protocol=e._parts.protocol,this._parts.hostname)return o;for(n=0;r=s[n];n++)o._parts[r]=e._parts[r];return o._parts.path?(".."===o._parts.path.substring(-2)&&(o._parts.path+="/"),"/"!==o.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),o._parts.path=(t?t+"/":"")+o._parts.path,o.normalizePath())):(o._parts.path=e._parts.path,o._parts.query||(o._parts.query=e._parts.query)),o.build(),o},s.relativeTo=function(e){var t,n,r,o,s,a=this.clone().normalize();if(a._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new i(e).normalize(),t=a._parts,n=e._parts,o=a.path(),s=e.path(),"/"!==o.charAt(0))throw new Error("URI is already relative");if("/"!==s.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===n.protocol&&(t.protocol=null),t.username!==n.username||t.password!==n.password)return a.build();if(null!==t.protocol||null!==t.username||null!==t.password)return a.build();if(t.hostname!==n.hostname||t.port!==n.port)return a.build();if(t.hostname=null,t.port=null,o===s)return t.path="",a.build();if(!(r=i.commonPath(o,s)))return a.build();var u=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=u+t.path.substring(r.length)||"./",a.build()},s.equals=function(e){var t,n,r,o,s,u=this.clone(),c=new i(e),f={};if(u.normalize(),c.normalize(),u.toString()===c.toString())return!0;if(r=u.query(),o=c.query(),u.query(""),c.query(""),u.toString()!==c.toString())return!1;if(r.length!==o.length)return!1;for(s in t=i.parseQuery(r,this._parts.escapeQuerySpace),n=i.parseQuery(o,this._parts.escapeQuerySpace),t)if(a.call(t,s)){if(l(t[s])){if(!h(t[s],n[s]))return!1}else if(t[s]!==n[s])return!1;f[s]=!0}for(s in n)if(a.call(n,s)&&!f[s])return!1;return!0},s.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},s.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},s.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},i},(nn=Wt).exports?nn.exports=on(function(){return Ht||(Ht=1,t=Xt,n=Xt.exports,function(r){var o=n&&!n.nodeType&&n,i=t&&!t.nodeType&&t,s="object"==typeof e&&e;s.global!==s&&s.window!==s&&s.self!==s||(r=s);var a,u,c=2147483647,l=36,f=/^xn--/,p=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,y=String.fromCharCode;function _(e){throw new RangeError(d[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function b(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(h,".")).split("."),t).join(".")}function E(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function O(e){return g(e,(function(e){var t="";return e>65535&&(t+=y((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+y(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function v(e,t,n){var r=0;for(e=n?m(e/700):e>>1,e+=m(e/t);e>455;r+=l)e=m(e/35);return m(r+36*e/(e+38))}function T(e){var t,n,r,o,i,s,a,u,f,p,h,d=[],y=e.length,g=0,b=128,E=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&_("not-basic"),d.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<y;){for(i=g,s=1,a=l;o>=y&&_("invalid-input"),((u=(h=e.charCodeAt(o++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:l)>=l||u>m((c-g)/s))&&_("overflow"),g+=u*s,!(u<(f=a<=E?1:a>=E+26?26:a-E));a+=l)s>m(c/(p=l-f))&&_("overflow"),s*=p;E=v(g-i,t=d.length+1,0==i),m(g/t)>c-b&&_("overflow"),b+=m(g/t),g%=t,d.splice(g++,0,b)}return O(d)}function x(e){var t,n,r,o,i,s,a,u,f,p,h,d,g,b,O,T=[];for(d=(e=E(e)).length,t=128,n=0,i=72,s=0;s<d;++s)(h=e[s])<128&&T.push(y(h));for(r=o=T.length,o&&T.push("-");r<d;){for(a=c,s=0;s<d;++s)(h=e[s])>=t&&h<a&&(a=h);for(a-t>m((c-n)/(g=r+1))&&_("overflow"),n+=(a-t)*g,t=a,s=0;s<d;++s)if((h=e[s])<t&&++n>c&&_("overflow"),h==t){for(u=n,f=l;!(u<(p=f<=i?1:f>=i+26?26:f-i));f+=l)O=u-p,b=l-p,T.push(y(w(p+O%b,0))),u=m(O/b);T.push(y(w(u,0))),i=v(n,g,r==o),n=0,++r}++n,++t}return T.join("")}if(a={version:"1.3.2",ucs2:{decode:E,encode:O},decode:T,encode:x,toASCII:function(e){return b(e,(function(e){return p.test(e)?"xn--"+x(e):e}))},toUnicode:function(e){return b(e,(function(e){return f.test(e)?T(e.slice(4).toLowerCase()):e}))}},o&&i)if(t.exports==o)i.exports=a;else for(u in a)a.hasOwnProperty(u)&&(o[u]=a[u]);else r.punycode=a}($t)),Xt.exports;var t,n}(),function(){return Yt||(Yt=1,t=Qt,n=function(e){var t=e&&e.IPv6;return{best:function(e){var t,n,r=e.toLowerCase().split(":"),o=r.length,i=8;for(""===r[0]&&""===r[1]&&""===r[2]?(r.shift(),r.shift()):""===r[0]&&""===r[1]?r.shift():""===r[o-1]&&""===r[o-2]&&r.pop(),-1!==r[(o=r.length)-1].indexOf(".")&&(i=7),t=0;t<o&&""!==r[t];t++);if(t<i)for(r.splice(t,1,"0000");r.length<i;)r.splice(t,0,"0000");for(var s=0;s<i;s++){n=r[s].split("");for(var a=0;a<3&&"0"===n[0]&&n.length>1;a++)n.splice(0,1);r[s]=n.join("")}var u=-1,c=0,l=0,f=-1,p=!1;for(s=0;s<i;s++)p?"0"===r[s]?l+=1:(p=!1,l>c&&(u=f,c=l)):"0"===r[s]&&(p=!0,f=s,l=1);l>c&&(u=f,c=l),c>1&&r.splice(u,c,""),o=r.length;var h="";for(""===r[0]&&(h=":"),s=0;s<o&&(h+=r[s],s!==o-1);s++)h+=":";return""===r[o-1]&&(h+=":"),h},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}},(e=Zt).exports?e.exports=n():t.IPv6=n(t)),Zt.exports;var e,t,n}(),function(){return Kt||(Kt=1,t=tn,n=function(e){var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var r=e.lastIndexOf(".",t-1);if(r<=0||r>=t-1)return!1;var o=n.list[e.slice(t+1)];return!!o&&o.indexOf(" "+e.slice(r+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var r=n.list[e.slice(t+1)];return!!r&&r.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var r=e.lastIndexOf(".",t-1);if(r<=0||r>=t-1)return null;var o=n.list[e.slice(t+1)];return o?o.indexOf(" "+e.slice(r+1,t)+" ")<0?null:e.slice(r+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n},(e=en).exports?e.exports=n():t.SecondLevelDomains=n(t)),en.exports;var e,t,n}
/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */()):rn.URI=on(rn.punycode,rn.IPv6,rn.SecondLevelDomains,rn)),Wt.exports),an=t(sn);function un(){let e,t;const n=new Promise((function(n,r){e=n,t=r}));return{resolve:e,reject:t,promise:n}}function cn(e,t){let n;return"undefined"!=typeof document&&(n=document),cn._implementation(e,t,n)}cn._implementation=function(e,t,n){if(!_(e))throw new g("relative uri is required.");if(!_(t)){if(void 0===n)return e;t=y(n.baseURI,n.location.href)}const r=new an(e);return""!==r.scheme()?r.toString():r.absoluteTo(t).toString()};const ln={};function fn(e,t,n){_(t)||(t=e.width),_(n)||(n=e.height);let r=ln[t];_(r)||(r={},ln[t]=r);let o=r[n];if(!_(o)){const e=document.createElement("canvas");e.width=t,e.height=n,o=e.getContext("2d",{willReadFrequently:!0}),o.globalCompositeOperation="copy",r[n]=o}return o.drawImage(e,0,0,t,n),o.getImageData(0,0,t,n).data}const pn=/^blob:/i;function hn(e){return M.typeOf.string("uri",e),pn.test(e)}let dn;const mn=/^data:/i;function yn(e){return M.typeOf.string("uri",e),mn.test(e)}var _n=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5});var gn=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3});function bn(e){e=y(e,y.EMPTY_OBJECT);const t=y(e.throttleByServer,!1),n=y(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=y(e.priority,0),this.throttle=n,this.throttleByServer=t,this.type=y(e.type,gn.OTHER),this.serverKey=e.serverKey,this.state=_n.UNISSUED,this.deferred=void 0,this.cancelled=!1}function En(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){const t={};if(!e)return t;const n=e.split("\r\n");for(let e=0;e<n.length;++e){const r=n[e],o=r.indexOf(": ");if(o>0){const e=r.substring(0,o),n=r.substring(o+2);t[e]=n}}return t}(this.responseHeaders))}function On(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function wn(e,t){return t-e}function vn(e){M.typeOf.object("options",e),M.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function Tn(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}bn.prototype.cancel=function(){this.cancelled=!0},bn.prototype.clone=function(e){return _(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=_n.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new bn(this)},En.prototype.toString=function(){let e="Request has failed.";return _(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e},Object.defineProperties(On.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),On.prototype.addEventListener=function(e,t){M.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);const n=this;return function(){n.removeEventListener(e,t)}},On.prototype.removeEventListener=function(e,t){M.typeOf.func("listener",e);const n=this._listeners,r=this._scopes;let o=-1;for(let i=0;i<n.length;i++)if(n[i]===e&&r[i]===t){o=i;break}return-1!==o&&(this._insideRaiseEvent?(this._toRemove.push(o),n[o]=void 0,r[o]=void 0):(n.splice(o,1),r.splice(o,1)),!0)},On.prototype.raiseEvent=function(){let e;this._insideRaiseEvent=!0;const t=this._listeners,n=this._scopes;let r=t.length;for(e=0;e<r;e++){_(t[e])&&t[e].apply(n[e],arguments)}const o=this._toRemove;if(r=o.length,r>0){for(o.sort(wn),e=0;e<r;e++){const r=o[e];t.splice(r,1),n.splice(r,1)}o.length=0}this._insideRaiseEvent=!1},Object.defineProperties(vn.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){M.typeOf.number.greaterThanOrEquals("maximumLength",e,0);const t=this._length;if(e<t){const n=this._array;for(let r=e;r<t;++r)n[r]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}}),vn.prototype.reserve=function(e){e=y(e,this._length),this._array.length=e},vn.prototype.heapify=function(e){e=y(e,0);const t=this._length,n=this._comparator,r=this._array;let o=-1,i=!0;for(;i;){const s=2*(e+1),a=s-1;o=a<t&&n(r[a],r[e])<0?a:e,s<t&&n(r[s],r[o])<0&&(o=s),o!==e?(Tn(r,o,e),e=o):i=!1}},vn.prototype.resort=function(){const e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},vn.prototype.insert=function(e){M.defined("element",e);const t=this._array,n=this._comparator,r=this._maximumLength;let o,i=this._length++;for(i<t.length?t[i]=e:t.push(e);0!==i;){const e=Math.floor((i-1)/2);if(!(n(t[i],t[e])<0))break;Tn(t,i,e),i=e}return _(r)&&this._length>r&&(o=t[r],this._length=r),o},vn.prototype.pop=function(e){if(e=y(e,0),0===this._length)return;M.typeOf.number.lessThan("index",e,this._length);const t=this._array,n=t[e];return Tn(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};const xn={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0};let Rn=20;const An=new vn({comparator:function(e,t){return e.priority-t.priority}});An.maximumLength=Rn,An.reserve(Rn);const Sn=[];let In={};const Nn="undefined"!=typeof document?new an(document.location.href):new an,Cn=new On;function Pn(){}function Mn(e){_(e.priorityFunction)&&(e.priority=e.priorityFunction())}function jn(e){return e.state===_n.UNISSUED&&(e.state=_n.ISSUED,e.deferred=un()),e.deferred.promise}function Un(e){const t=jn(e);return e.state=_n.ACTIVE,Sn.push(e),++xn.numberOfActiveRequests,++xn.numberOfActiveRequestsEver,++In[e.serverKey],e.requestFunction().then(function(e){return function(t){if(e.state===_n.CANCELLED)return;const n=e.deferred;--xn.numberOfActiveRequests,--In[e.serverKey],Cn.raiseEvent(),e.state=_n.RECEIVED,e.deferred=void 0,n.resolve(t)}}(e)).catch(function(e){return function(t){e.state!==_n.CANCELLED&&(++xn.numberOfFailedRequests,--xn.numberOfActiveRequests,--In[e.serverKey],Cn.raiseEvent(t),e.state=_n.FAILED,e.deferred.reject(t))}}(e)),t}function Fn(e){const t=e.state===_n.ACTIVE;if(e.state=_n.CANCELLED,++xn.numberOfCancelledRequests,_(e.deferred)){const t=e.deferred;e.deferred=void 0,t.reject()}t&&(--xn.numberOfActiveRequests,--In[e.serverKey],++xn.numberOfCancelledActiveRequests),_(e.cancelFunction)&&e.cancelFunction()}Pn.maximumRequests=50,Pn.maximumRequestsPerServer=18,Pn.requestsByServer={},Pn.throttleRequests=!0,Pn.debugShowStatistics=!1,Pn.requestCompletedEvent=Cn,Object.defineProperties(Pn,{statistics:{get:function(){return xn}},priorityHeapLength:{get:function(){return Rn},set:function(e){if(e<Rn)for(;An.length>e;){Fn(An.pop())}Rn=e,An.maximumLength=e,An.reserve(e)}}}),Pn.serverHasOpenSlots=function(e,t){t=y(t,1);const n=y(Pn.requestsByServer[e],Pn.maximumRequestsPerServer);return In[e]+t<=n},Pn.heapHasOpenSlots=function(e){return An.length+e<=Rn},Pn.update=function(){let e,t,n=0;const r=Sn.length;for(e=0;e<r;++e)t=Sn[e],t.cancelled&&Fn(t),t.state===_n.ACTIVE?n>0&&(Sn[e-n]=t):++n;Sn.length-=n;const o=An.internalArray,i=An.length;for(e=0;e<i;++e)Mn(o[e]);An.resort();const s=Math.max(Pn.maximumRequests-Sn.length,0);let a=0;for(;a<s&&An.length>0;)t=An.pop(),t.cancelled?Fn(t):!t.throttleByServer||Pn.serverHasOpenSlots(t.serverKey)?(Un(t),++a):Fn(t);!function(){if(!Pn.debugShowStatistics)return;0===xn.numberOfActiveRequests&&xn.lastNumberOfActiveRequests>0&&(xn.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${xn.numberOfAttemptedRequests}`),xn.numberOfAttemptedRequests=0),xn.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${xn.numberOfCancelledRequests}`),xn.numberOfCancelledRequests=0),xn.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${xn.numberOfCancelledActiveRequests}`),xn.numberOfCancelledActiveRequests=0),xn.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${xn.numberOfFailedRequests}`),xn.numberOfFailedRequests=0));xn.lastNumberOfActiveRequests=xn.numberOfActiveRequests}()},Pn.getServerKey=function(e){M.typeOf.string("url",e);let t=new an(e);""===t.scheme()&&(t=t.absoluteTo(Nn),t.normalize());let n=t.authority();/:/.test(n)||(n=`${n}:${"https"===t.scheme()?"443":"80"}`);return _(In[n])||(In[n]=0),n},Pn.request=function(e){if(M.typeOf.object("request",e),M.typeOf.string("request.url",e.url),M.typeOf.func("request.requestFunction",e.requestFunction),yn(e.url)||hn(e.url))return Cn.raiseEvent(),e.state=_n.RECEIVED,e.requestFunction();if(++xn.numberOfAttemptedRequests,_(e.serverKey)||(e.serverKey=Pn.getServerKey(e.url)),Pn.throttleRequests&&e.throttleByServer&&!Pn.serverHasOpenSlots(e.serverKey))return;if(!Pn.throttleRequests||!e.throttle)return Un(e);if(Sn.length>=Pn.maximumRequests)return;Mn(e);const t=An.insert(e);if(_(t)){if(t===e)return;Fn(t)}return jn(e)},Pn.clearForSpecs=function(){for(;An.length>0;){Fn(An.pop())}const e=Sn.length;for(let t=0;t<e;++t)Fn(Sn[t]);Sn.length=0,In={},xn.numberOfAttemptedRequests=0,xn.numberOfActiveRequests=0,xn.numberOfCancelledRequests=0,xn.numberOfCancelledActiveRequests=0,xn.numberOfFailedRequests=0,xn.numberOfActiveRequestsEver=0,xn.lastNumberOfActiveRequests=0},Pn.numberOfActiveRequestsByServer=function(e){return In[e]},Pn.requestHeap=An;const qn={};let Ln={};qn.add=function(e,t){if(!_(e))throw new g("host is required.");if(!_(t)||t<=0)throw new g("port is required to be greater than 0.");const n=`${e.toLowerCase()}:${t}`;_(Ln[n])||(Ln[n]=!0)},qn.remove=function(e,t){if(!_(e))throw new g("host is required.");if(!_(t)||t<=0)throw new g("port is required to be greater than 0.");const n=`${e.toLowerCase()}:${t}`;_(Ln[n])&&delete Ln[n]},qn.contains=function(e){if(!_(e))throw new g("url is required.");const t=function(e){const t=new an(e);t.normalize();let n=t.authority();if(0!==n.length){if(t.authority(n),-1!==n.indexOf("@")){const e=n.split("@");n=e[1]}if(-1===n.indexOf(":")){let e=t.scheme();if(0===e.length&&(e=window.location.protocol,e=e.substring(0,e.length-1)),"http"===e)n+=":80";else{if("https"!==e)return;n+=":443"}}return n}}(e);return!(!_(t)||!_(Ln[t]))},qn.clear=function(){Ln={}};const Dn=function(){try{const e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function Bn(e){"string"==typeof(e=y(e,y.EMPTY_OBJECT))&&(e={url:e}),M.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=zn(e.templateValues,{}),this._queryParameters=zn(e.queryParameters,{}),this.headers=zn(e.headers,{}),this.request=y(e.request,new bn),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=y(e.retryAttempts,0),this._retryCount=0;y(e.parseUrl,!0)?this.parseUrl(e.url,!0,!0):this._url=e.url,this._credits=e.credits}function zn(e,t){return _(e)?D(e):t}let kn;function Gn(e,t,n){if(!n)return B(e,t);const r=D(e,!0);for(const e in t)if(t.hasOwnProperty(e)){let n=r[e];const o=t[e];_(n)?(Array.isArray(n)||(n=r[e]=[n]),r[e]=n.concat(o)):r[e]=Array.isArray(o)?o.slice():o}return r}function Vn(e){const t=e.resource,n=e.flipY,r=e.skipColorSpaceConversion,o=e.preferImageBitmap,i=t.request;i.url=t.url,i.requestFunction=function(){let e=!1;t.isDataUri||t.isBlobUri||(e=t.isCrossOriginUrl);const s=un();return Bn._Implementations.createImage(i,e,s,n,r,o),s.promise};const s=Pn.request(i);if(_(s))return s.catch((function(e){return i.state!==_n.FAILED?Promise.reject(e):t.retryOnError(e).then((function(s){return s?(i.state=_n.UNISSUED,i.deferred=void 0,Vn({resource:t,flipY:n,skipColorSpaceConversion:r,preferImageBitmap:o})):Promise.reject(e)}))}))}function Hn(e,t,n){const r={};r[t]=n,e.setQueryParameters(r);const o=e.request,i=e.url;o.url=i,o.requestFunction=function(){const e=un();return window[n]=function(t){e.resolve(t);try{delete window[n]}catch(e){window[n]=void 0}},Bn._Implementations.loadAndExecuteScript(i,n,e),e.promise};const s=Pn.request(o);if(_(s))return s.catch((function(r){return o.state!==_n.FAILED?Promise.reject(r):e.retryOnError(r).then((function(i){return i?(o.state=_n.UNISSUED,o.deferred=void 0,Hn(e,t,n)):Promise.reject(r)}))}))}function Wn(e){if(e.state===_n.ISSUED||e.state===_n.ACTIVE)throw new Re("The Resource is already being fetched.");e.state=_n.UNISSUED,e.deferred=void 0}Bn.createIfNeeded=function(e){return e instanceof Bn?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new Bn({url:e})},Bn.supportsImageBitmapOptions=function(){if(_(kn))return kn;if("function"!=typeof createImageBitmap)return kn=Promise.resolve(!1),kn;return kn=Bn.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC"}).then((function(e){return Promise.all([createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"}),createImageBitmap(e)])})).then((function(e){const t=fn(e[0]),n=fn(e[1]);return t[1]!==n[1]})).catch((function(){return!1})),kn},Object.defineProperties(Bn,{isBlobSupported:{get:function(){return Dn}}}),Object.defineProperties(Bn.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){this.parseUrl(e,!1,!1)}},extension:{get:function(){return function(e){if(!_(e))throw new g("uri is required.");const t=new an(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return-1!==r&&(n=n.substr(r+1)),r=n.lastIndexOf("."),n=-1===r?"":n.substr(r+1),n}(this._url)}},isDataUri:{get:function(){return yn(this._url)}},isBlobUri:{get:function(){return hn(this._url)}},isCrossOriginUrl:{get:function(){return function(e){_(dn)||(dn=document.createElement("a")),dn.href=window.location.href;const t=dn.host,n=dn.protocol;return dn.href=e,dn.href=dn.href,n!==dn.protocol||t!==dn.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}},credits:{get:function(){return this._credits}}}),Bn.prototype.toString=function(){return this.getUrlComponent(!0,!0)},Bn.prototype.parseUrl=function(e,t,n,r){let o=new an(e);const i=function(e){if(0===e.length)return{};if(-1===e.indexOf("="))return{[e]:void 0};return function(e){if(!_(e))throw new g("queryString is required.");const t={};if(""===e)return t;const n=e.replace(/\+/g,"%20").split(/[&;]/);for(let e=0,r=n.length;e<r;++e){const r=n[e].split("="),o=decodeURIComponent(r[0]);let i=r[1];i=_(i)?decodeURIComponent(i):"";const s=t[o];"string"==typeof s?t[o]=[s,i]:Array.isArray(s)?s.push(i):t[o]=i}return t}(e)}(o.query());this._queryParameters=t?Gn(i,this.queryParameters,n):i,o.search(""),o.fragment(""),_(r)&&""===o.scheme()&&(o=o.absoluteTo(cn(r))),this._url=o.toString()},Bn.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=this._url;e&&(n=`${n}${function(e){const t=Object.keys(e);if(0===t.length)return"";if(1===t.length&&!_(e[t[0]]))return`?${t[0]}`;return`?${function(e){if(!_(e))throw new g("obj is required.");let t="";for(const n in e)if(e.hasOwnProperty(n)){const r=e[n],o=`${encodeURIComponent(n)}=`;if(Array.isArray(r))for(let e=0,n=r.length;e<n;++e)t+=`${o+encodeURIComponent(r[e])}&`;else t+=`${o+encodeURIComponent(r)}&`}return t=t.slice(0,-1),t}(e)}`}(this.queryParameters)}`),n=n.replace(/%7B/g,"{").replace(/%7D/g,"}");const r=this._templateValues;return Object.keys(r).length>0&&(n=n.replace(/{(.*?)}/g,(function(e,t){const n=r[t];return _(n)?encodeURIComponent(n):e}))),t&&_(this.proxy)&&(n=this.proxy.getURL(n)),n},Bn.prototype.setQueryParameters=function(e,t){this._queryParameters=t?Gn(this._queryParameters,e,!1):Gn(e,this._queryParameters,!1)},Bn.prototype.appendQueryParameters=function(e){this._queryParameters=Gn(e,this._queryParameters,!0)},Bn.prototype.setTemplateValues=function(e,t){this._templateValues=t?B(this._templateValues,e):B(e,this._templateValues)},Bn.prototype.getDerivedResource=function(e){const t=this.clone();if(t._retryCount=0,_(e.url)){const n=y(e.preserveQueryParameters,!1);t.parseUrl(e.url,!0,n,this._url)}return _(e.queryParameters)&&(t._queryParameters=B(e.queryParameters,t.queryParameters)),_(e.templateValues)&&(t._templateValues=B(e.templateValues,t.templateValues)),_(e.headers)&&(t.headers=B(e.headers,t.headers)),_(e.proxy)&&(t.proxy=e.proxy),_(e.request)&&(t.request=e.request),_(e.retryCallback)&&(t.retryCallback=e.retryCallback),_(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},Bn.prototype.retryOnError=function(e){const t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);const n=this;return Promise.resolve(t(this,e)).then((function(e){return++n._retryCount,e}))},Bn.prototype.clone=function(e){return _(e)?(e._url=this._url,e._queryParameters=D(this._queryParameters),e._templateValues=D(this._templateValues),e.headers=D(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e):new Bn({url:this._url,queryParameters:this.queryParameters,templateValues:this.templateValues,headers:this.headers,proxy:this.proxy,retryCallback:this.retryCallback,retryAttempts:this.retryAttempts,request:this.request.clone(),parseUrl:!1,credits:_(this.credits)?this.credits.slice():void 0})},Bn.prototype.getBaseUri=function(e){return function(e,t){if(!_(e))throw new g("uri is required.");let n="";const r=e.lastIndexOf("/");return-1!==r&&(n=e.substring(0,r+1)),t?(0!==(e=new an(e)).query().length&&(n+=`?${e.query()}`),0!==e.fragment().length&&(n+=`#${e.fragment()}`),n):n}(this.getUrlComponent(e),e)},Bn.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e=`${e}/`),e)},Bn.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},Bn.fetchArrayBuffer=function(e){return new Bn(e).fetchArrayBuffer()},Bn.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},Bn.fetchBlob=function(e){return new Bn(e).fetchBlob()},Bn.prototype.fetchImage=function(e){e=y(e,y.EMPTY_OBJECT);const t=y(e.preferImageBitmap,!1),n=y(e.preferBlob,!1),r=y(e.flipY,!1),o=y(e.skipColorSpaceConversion,!1);if(Wn(this.request),!Dn||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return Vn({resource:this,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:t});const i=this.fetchBlob();if(!_(i))return;let s,a,u,c;return Bn.supportsImageBitmapOptions().then((function(e){return s=e,a=s&&t,i})).then((function(e){if(!_(e))return;if(c=e,a)return Bn.createImageBitmapFromBlob(e,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});const t=window.URL.createObjectURL(e);return u=new Bn({url:t}),Vn({resource:u,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:!1})})).then((function(e){if(_(e))return e.blob=c,a||window.URL.revokeObjectURL(u.url),e})).catch((function(e){return _(u)&&window.URL.revokeObjectURL(u.url),e.blob=c,Promise.reject(e)}))},Bn.fetchImage=function(e){return new Bn(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},Bn.prototype.fetchText=function(){return this.fetch({responseType:"text"})},Bn.fetchText=function(e){return new Bn(e).fetchText()},Bn.prototype.fetchJson=function(){const e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(_(e))return e.then((function(e){if(_(e))return JSON.parse(e)}))},Bn.fetchJson=function(e){return new Bn(e).fetchJson()},Bn.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},Bn.fetchXML=function(e){return new Bn(e).fetchXML()},Bn.prototype.fetchJsonp=function(e){let t;e=y(e,"callback"),Wn(this.request);do{t=`loadJsonp${U.nextRandomNumber().toString().substring(2,8)}`}while(_(window[t]));return Hn(this,e,t)},Bn.fetchJsonp=function(e){return new Bn(e).fetchJsonp(e.callbackParameterName)},Bn.prototype._makeRequest=function(e){const t=this;Wn(t.request);const n=t.request,r=t.url;n.url=r,n.requestFunction=function(){const o=e.responseType,i=B(e.headers,t.headers),s=e.overrideMimeType,a=e.method,u=e.data,c=un(),l=Bn._Implementations.loadWithXhr(r,o,a,u,i,c,s);return _(l)&&_(l.abort)&&(n.cancelFunction=function(){l.abort()}),c.promise};const o=Pn.request(n);if(_(o))return o.then((function(e){return n.cancelFunction=void 0,e})).catch((function(r){return n.cancelFunction=void 0,n.state!==_n.FAILED?Promise.reject(r):t.retryOnError(r).then((function(o){return o?(n.state=_n.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(r)}))}))};const Xn=/^data:(.*?)(;base64)?,(.*)$/;function $n(e,t){const n=decodeURIComponent(t);return e?atob(n):n}function Yn(e,t){const n=$n(e,t),r=new ArrayBuffer(n.length),o=new Uint8Array(r);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);return r}Bn.prototype.fetch=function(e){return(e=zn(e,{})).method="GET",this._makeRequest(e)},Bn.fetch=function(e){return new Bn(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Bn.prototype.delete=function(e){return(e=zn(e,{})).method="DELETE",this._makeRequest(e)},Bn.delete=function(e){return new Bn(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},Bn.prototype.head=function(e){return(e=zn(e,{})).method="HEAD",this._makeRequest(e)},Bn.head=function(e){return new Bn(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Bn.prototype.options=function(e){return(e=zn(e,{})).method="OPTIONS",this._makeRequest(e)},Bn.options=function(e){return new Bn(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Bn.prototype.post=function(e,t){return M.defined("data",e),(t=zn(t,{})).method="POST",t.data=e,this._makeRequest(t)},Bn.post=function(e){return new Bn(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Bn.prototype.put=function(e,t){return M.defined("data",e),(t=zn(t,{})).method="PUT",t.data=e,this._makeRequest(t)},Bn.put=function(e){return new Bn(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Bn.prototype.patch=function(e,t){return M.defined("data",e),(t=zn(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},Bn.patch=function(e){return new Bn(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Bn._Implementations={},Bn._Implementations.loadImageElement=function(e,t,n){const r=new Image;r.onload=function(){0===r.naturalWidth&&0===r.naturalHeight&&0===r.width&&0===r.height&&(r.width=300,r.height=150),n.resolve(r)},r.onerror=function(e){n.reject(e)},t&&(qn.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e},Bn._Implementations.createImage=function(e,t,n,r,o,i){const s=e.url;Bn.supportsImageBitmapOptions().then((function(a){if(!a||!i)return void Bn._Implementations.loadImageElement(s,t,n);const u=un(),c=Bn._Implementations.loadWithXhr(s,"blob","GET",void 0,void 0,u,void 0,void 0,void 0);return _(c)&&_(c.abort)&&(e.cancelFunction=function(){c.abort()}),u.promise.then((function(e){if(_(e))return Bn.createImageBitmapFromBlob(e,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});n.reject(new Re(`Successfully retrieved ${s} but it contained no content.`))})).then((function(e){n.resolve(e)}))})).catch((function(e){n.reject(e)}))},Bn.createImageBitmapFromBlob=function(e,t){return M.defined("options",t),M.typeOf.bool("options.flipY",t.flipY),M.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),M.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};const Zn="undefined"==typeof XMLHttpRequest;function Qn(e){e=y(e,y.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._addNewLeapSeconds=y(e.addNewLeapSeconds,!0),_(e.data)?Jn(this,e.data):Jn(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function Kn(e,t){return Gt.compare(e.julianDate,t)}function Jn(e,t){if(!_(t.columnNames))throw new Re("Error in loaded EOP data: The columnNames property is required.");if(!_(t.samples))throw new Re("Error in loaded EOP data: The samples property is required.");const n=t.columnNames.indexOf("modifiedJulianDateUtc"),r=t.columnNames.indexOf("xPoleWanderRadians"),o=t.columnNames.indexOf("yPoleWanderRadians"),i=t.columnNames.indexOf("ut1MinusUtcSeconds"),s=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),a=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||r<0||o<0||i<0||s<0||a<0||u<0)throw new Re("Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");const c=e._samples=t.samples,l=e._dates=[];let f;e._dateColumn=n,e._xPoleWanderRadiansColumn=r,e._yPoleWanderRadiansColumn=o,e._ut1MinusUtcSecondsColumn=i,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=a,e._taiMinusUtcSecondsColumn=u,e._columnCount=t.columnNames.length,e._lastIndex=void 0;const p=e._addNewLeapSeconds;for(let t=0,r=c.length;t<r;t+=e._columnCount){const e=c[t+n],r=c[t+u],o=new Gt(e+vt.MODIFIED_JULIAN_DATE_DIFFERENCE,r,Tt.TAI);if(l.push(o),p){if(r!==f&&_(f)){const e=Gt.leapSeconds,t=_t(e,o,Kn);if(t<0){const n=new wt(o,r);e.splice(~t,0,n)}}f=r}}}function er(e,t,n,r,o){const i=n*r;o.xPoleWander=t[i+e._xPoleWanderRadiansColumn],o.yPoleWander=t[i+e._yPoleWanderRadiansColumn],o.xPoleOffset=t[i+e._xCelestialPoleOffsetRadiansColumn],o.yPoleOffset=t[i+e._yCelestialPoleOffsetRadiansColumn],o.ut1MinusUtc=t[i+e._ut1MinusUtcSecondsColumn]}function tr(e,t,n){return t+e*(n-t)}function nr(e,t,n,r,o,i,s){const a=e._columnCount;if(i>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;const u=t[o],c=t[i];if(u.equals(c)||r.equals(u))return er(e,n,o,a,s),s;if(r.equals(c))return er(e,n,i,a,s),s;const l=Gt.secondsDifference(r,u)/Gt.secondsDifference(c,u),f=o*a,p=i*a;let h=n[f+e._ut1MinusUtcSecondsColumn],d=n[p+e._ut1MinusUtcSecondsColumn];const m=d-h;if(m>.5||m<-.5){const t=n[f+e._taiMinusUtcSecondsColumn],o=n[p+e._taiMinusUtcSecondsColumn];t!==o&&(c.equals(r)?h=d:d-=o-t)}return s.xPoleWander=tr(l,n[f+e._xPoleWanderRadiansColumn],n[p+e._xPoleWanderRadiansColumn]),s.yPoleWander=tr(l,n[f+e._yPoleWanderRadiansColumn],n[p+e._yPoleWanderRadiansColumn]),s.xPoleOffset=tr(l,n[f+e._xCelestialPoleOffsetRadiansColumn],n[p+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=tr(l,n[f+e._yCelestialPoleOffsetRadiansColumn],n[p+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=tr(l,h,d),s}function rr(e,t,n){this.heading=y(e,0),this.pitch=y(t,0),this.roll=y(n,0)}Bn._Implementations.loadWithXhr=function(e,t,n,r,o,i,s){const a=Xn.exec(e);if(null!==a)return void i.resolve(function(e,t){t=y(t,"");const n=e[1],r=!!e[2],o=e[3];let i,s;switch(t){case"":case"text":return $n(r,o);case"arraybuffer":return Yn(r,o);case"blob":return i=Yn(r,o),new Blob([i],{type:n});case"document":return s=new DOMParser,s.parseFromString($n(r,o),n);case"json":return JSON.parse($n(r,o));default:throw new g(`Unhandled responseType: ${t}`)}}(a,t));if(Zn)return void function(e,t,n,r,o,i){fetch(e,{method:n,headers:o}).then((async e=>{if(!e.ok){const t={};return e.headers.forEach(((e,n)=>{t[n]=e})),void i.reject(new En(e.status,e,t))}switch(t){case"text":i.resolve(e.text());break;case"json":i.resolve(e.json());break;default:i.resolve(new Uint8Array(await e.arrayBuffer()).buffer)}})).catch((()=>{i.reject(new En)}))}(e,t,n,0,o,i);const u=new XMLHttpRequest;if(qn.contains(e)&&(u.withCredentials=!0),u.open(n,e,!0),_(s)&&_(u.overrideMimeType)&&u.overrideMimeType(s),_(o))for(const e in o)o.hasOwnProperty(e)&&u.setRequestHeader(e,o[e]);_(t)&&(u.responseType=t);let c=!1;return"string"==typeof e&&(c=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),u.onload=function(){if((u.status<200||u.status>=300)&&(!c||0!==u.status))return void i.reject(new En(u.status,u.response,u.getAllResponseHeaders()));const e=u.response,r=u.responseType;if("HEAD"===n||"OPTIONS"===n){const e=u.getAllResponseHeaders().trim().split(/[\r\n]+/),t={};return e.forEach((function(e){const n=e.split(": "),r=n.shift();t[r]=n.join(": ")})),void i.resolve(t)}if(204===u.status)i.resolve(void 0);else if(!_(e)||_(t)&&r!==t)if("json"===t&&"string"==typeof e)try{i.resolve(JSON.parse(e))}catch(e){i.reject(e)}else(""===r||"document"===r)&&_(u.responseXML)&&u.responseXML.hasChildNodes()?i.resolve(u.responseXML):""!==r&&"text"!==r||!_(u.responseText)?i.reject(new Re("Invalid XMLHttpRequest response type.")):i.resolve(u.responseText);else i.resolve(e)},u.onerror=function(e){i.reject(new En)},u.send(r),u},Bn._Implementations.loadAndExecuteScript=function(e,t,n){return function(e){const t=document.createElement("script");return t.async=!0,t.src=e,new Promise(((e,n)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");const r=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,r.removeChild(t),e()},t.onerror=function(e){n(e)},r.appendChild(t)}))}(e).catch((function(e){n.reject(e)}))},Bn._DefaultImplementations={},Bn._DefaultImplementations.createImage=Bn._Implementations.createImage,Bn._DefaultImplementations.loadWithXhr=Bn._Implementations.loadWithXhr,Bn._DefaultImplementations.loadAndExecuteScript=Bn._Implementations.loadAndExecuteScript,Bn.DEFAULT=Object.freeze(new Bn({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),Qn.fromUrl=async function(e,t){M.defined("url",e),t=y(t,y.EMPTY_OBJECT);const n=Bn.createIfNeeded(e);let r;try{r=await n.fetchJson()}catch(e){throw new Re(`An error occurred while retrieving the EOP data from the URL ${n.url}.`)}return new Qn({addNewLeapSeconds:t.addNewLeapSeconds,data:r})},Qn.NONE=Object.freeze({compute:function(e,t){return _(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new gt(0,0,0,0,0),t}}),Qn.prototype.compute=function(e,t){if(!_(this._samples))return;if(_(t)||(t=new gt(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;const n=this._dates,r=this._lastIndex;let o=0,i=0;if(_(r)){const s=n[r],a=n[r+1],u=Gt.lessThanOrEquals(s,e),c=!_(a),l=c||Gt.greaterThanOrEquals(a,e);if(u&&l)return o=r,!c&&a.equals(e)&&++o,i=o+1,nr(this,n,this._samples,e,o,i,t),t}let s=_t(n,e,Gt.compare,this._dateColumn);return s>=0?(s<n.length-1&&n[s+1].equals(e)&&++s,o=s,i=s):(i=~s,o=i-1,o<0&&(o=0)),this._lastIndex=o,nr(this,n,this._samples,e,o,i,t),t},rr.fromQuaternion=function(e,t){if(!_(e))throw new g("quaternion is required");_(t)||(t=new rr);const n=2*(e.w*e.y-e.z*e.x),r=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),i=1-2*(e.y*e.y+e.z*e.z),s=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(s,i),t.roll=Math.atan2(o,r),t.pitch=-U.asinClamped(n),t},rr.fromDegrees=function(e,t,n,r){if(!_(e))throw new g("heading is required");if(!_(t))throw new g("pitch is required");if(!_(n))throw new g("roll is required");return _(r)||(r=new rr),r.heading=e*U.RADIANS_PER_DEGREE,r.pitch=t*U.RADIANS_PER_DEGREE,r.roll=n*U.RADIANS_PER_DEGREE,r},rr.clone=function(e,t){if(_(e))return _(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new rr(e.heading,e.pitch,e.roll)},rr.equals=function(e,t){return e===t||_(e)&&_(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},rr.equalsEpsilon=function(e,t,n,r){return e===t||_(e)&&_(t)&&U.equalsEpsilon(e.heading,t.heading,n,r)&&U.equalsEpsilon(e.pitch,t.pitch,n,r)&&U.equalsEpsilon(e.roll,t.roll,n,r)},rr.prototype.clone=function(e){return rr.clone(this,e)},rr.prototype.equals=function(e){return rr.equals(this,e)},rr.prototype.equalsEpsilon=function(e,t,n){return rr.equalsEpsilon(this,e,t,n)},rr.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};const or=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;let ir,sr,ar;function ur(e){return"undefined"==typeof document?e:(_(ir)||(ir=document.createElement("a")),ir.href=e,ir.href)}function cr(){if(_(sr))return sr;let e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:_(import.meta?.url)?cn(".",import.meta.url):"object"==typeof define&&_(define.amd)&&!define.amd.toUrlUndefined&&_(require.toUrl)?cn("..",pr("Core/buildModuleUrl.js")):function(){const e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){const n=e[t].getAttribute("src"),r=or.exec(n);if(null!==r)return r[1]}}(),!_(e))throw new g("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return sr=new Bn({url:ur(e)}),sr.appendForwardSlash(),sr}function lr(e){return ur(require.toUrl(`../${e}`))}function fr(e){return cr().getDerivedResource({url:e}).url}function pr(e){_(ar)||(ar="object"==typeof define&&_(define.amd)&&!define.amd.toUrlUndefined&&_(require.toUrl)?lr:fr);return ar(e)}function hr(e,t,n){this.x=e,this.y=t,this.s=n}function dr(e){e=y(e,y.EMPTY_OBJECT),this._xysFileUrlTemplate=Bn.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=y(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=y(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new Gt(this._sampleZeroJulianEphemerisDate,0,Tt.TAI),this._stepSizeDays=y(e.stepSizeDays,1),this._samplesPerXysFile=y(e.samplesPerXysFile,1e3),this._totalSamples=y(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];const t=this._interpolationOrder,n=this._denominators=new Array(t+1),r=this._xTable=new Array(t+1),o=Math.pow(this._stepSizeDays,t);for(let e=0;e<=t;++e){n[e]=o,r[e]=e*this._stepSizeDays;for(let r=0;r<=t;++r)r!==e&&(n[e]*=e-r);n[e]=1/n[e]}this._work=new Array(t+1),this._coef=new Array(t+1)}pr._cesiumScriptRegex=or,pr._buildModuleUrlFromBaseUrl=fr,pr._clearBaseResource=function(){sr=void 0},pr.setBaseUrl=function(e){sr=Bn.DEFAULT.getDerivedResource({url:e})},pr.getCesiumBaseUrl=cr;const mr=new Gt(0,0,Tt.TAI);function yr(e,t,n){const r=mr;return r.dayNumber=t,r.secondsOfDay=n,Gt.daysDifference(r,e._sampleZeroDateTT)}function _r(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n;const r=e._xysFileUrlTemplate;n=_(r)?r.getDerivedResource({templateValues:{0:t}}):new Bn({url:pr(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});const o=n.fetchJson().then((function(n){e._chunkDownloadsInProgress[t]=!1;const r=e._samples,o=n.samples,i=t*e._samplesPerXysFile*3;for(let e=0,t=o.length;e<t;++e)r[i+e]=o[e]}));return e._chunkDownloadsInProgress[t]=o,o}let gr;dr.prototype.preload=function(e,t,n,r){const o=yr(this,e,t),i=yr(this,n,r);let s=o/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);let a=i/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;a>=this._totalSamples&&(a=this._totalSamples-1);const u=s/this._samplesPerXysFile|0,c=a/this._samplesPerXysFile|0,l=[];for(let e=u;e<=c;++e)l.push(_r(this,e));return Promise.all(l)},dr.prototype.computeXysRadians=function(e,t,n){const r=yr(this,e,t);if(r<0)return;const o=r/this._stepSizeDays|0;if(o>=this._totalSamples)return;const i=this._interpolationOrder;let s=o-(i/2|0);s<0&&(s=0);let a=s+i;a>=this._totalSamples&&(a=this._totalSamples-1,s=a-i,s<0&&(s=0));let u=!1;const c=this._samples;if(_(c[3*s])||(_r(this,s/this._samplesPerXysFile|0),u=!0),_(c[3*a])||(_r(this,a/this._samplesPerXysFile|0),u=!0),u)return;_(n)?(n.x=0,n.y=0,n.s=0):n=new hr(0,0,0);const l=r-s*this._stepSizeDays,f=this._work,p=this._denominators,h=this._coef,d=this._xTable;let m,y;for(m=0;m<=i;++m)f[m]=l-d[m];for(m=0;m<=i;++m){for(h[m]=1,y=0;y<=i;++y)y!==m&&(h[m]*=f[y]);h[m]*=p[m];let e=3*(s+m);n.x+=h[m]*c[e++],n.y+=h[m]*c[e++],n.s+=h[m]*c[e]}return n};const br={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},Er={};let Or,wr,vr,Tr,xr,Rr,Ar,Sr,Ir,Nr,Cr,Pr,Mr,jr,Ur,Fr,qr,Lr;function Dr(e){const t=e.split(".");for(let e=0,n=t.length;e<n;++e)t[e]=parseInt(t[e],10);return t}function Br(){if(!_(wr)&&(wr=!1,!Vr())){const e=/ Chrome\/([\.0-9]+)/.exec(Or.userAgent);null!==e&&(wr=!0,vr=Dr(e[1]))}return wr}function zr(){if(!_(Tr)&&(Tr=!1,!Br()&&!Vr()&&/ Safari\/[\.0-9]+/.test(Or.userAgent))){const e=/ Version\/([\.0-9]+)/.exec(Or.userAgent);null!==e&&(Tr=!0,xr=Dr(e[1]))}return Tr}function kr(){if(!_(Rr)){Rr=!1;const e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(Or.userAgent);null!==e&&(Rr=!0,Ar=Dr(e[1]),Ar.isNightly=!!e[2])}return Rr}function Gr(){if(!_(Sr)){let e;Sr=!1,"Microsoft Internet Explorer"===Or.appName?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(Or.userAgent),null!==e&&(Sr=!0,Ir=Dr(e[1]))):"Netscape"===Or.appName&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(Or.userAgent),null!==e&&(Sr=!0,Ir=Dr(e[1])))}return Sr}function Vr(){if(!_(Nr)){Nr=!1;const e=/ Edg\/([\.0-9]+)/.exec(Or.userAgent);null!==e&&(Nr=!0,Cr=Dr(e[1]))}return Nr}function Hr(){if(!_(Pr)){Pr=!1;const e=/Firefox\/([\.0-9]+)/.exec(Or.userAgent);null!==e&&(Pr=!0,Mr=Dr(e[1]))}return Pr}function Wr(){if(!_(Lr)){const e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");const t=e.style.imageRendering;Lr=_(t)&&""!==t,Lr&&(qr=t)}return Lr}function Xr(){if(!Xr.initialized)throw new g("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return Xr._result}Object.defineProperties(Er,{element:{get:function(){if(Er.supportsFullscreen())return document[br.fullscreenElement]}},changeEventName:{get:function(){if(Er.supportsFullscreen())return br.fullscreenchange}},errorEventName:{get:function(){if(Er.supportsFullscreen())return br.fullscreenerror}},enabled:{get:function(){if(Er.supportsFullscreen())return document[br.fullscreenEnabled]}},fullscreen:{get:function(){if(Er.supportsFullscreen())return null!==Er.element}}}),Er.supportsFullscreen=function(){if(_(gr))return gr;gr=!1;const e=document.body;if("function"==typeof e.requestFullscreen)return br.requestFullscreen="requestFullscreen",br.exitFullscreen="exitFullscreen",br.fullscreenEnabled="fullscreenEnabled",br.fullscreenElement="fullscreenElement",br.fullscreenchange="fullscreenchange",br.fullscreenerror="fullscreenerror",gr=!0,gr;const t=["webkit","moz","o","ms","khtml"];let n;for(let r=0,o=t.length;r<o;++r){const o=t[r];n=`${o}RequestFullscreen`,"function"==typeof e[n]?(br.requestFullscreen=n,gr=!0):(n=`${o}RequestFullScreen`,"function"==typeof e[n]&&(br.requestFullscreen=n,gr=!0)),n=`${o}ExitFullscreen`,"function"==typeof document[n]?br.exitFullscreen=n:(n=`${o}CancelFullScreen`,"function"==typeof document[n]&&(br.exitFullscreen=n)),n=`${o}FullscreenEnabled`,void 0!==document[n]?br.fullscreenEnabled=n:(n=`${o}FullScreenEnabled`,void 0!==document[n]&&(br.fullscreenEnabled=n)),n=`${o}FullscreenElement`,void 0!==document[n]?br.fullscreenElement=n:(n=`${o}FullScreenElement`,void 0!==document[n]&&(br.fullscreenElement=n)),n=`${o}fullscreenchange`,void 0!==document[`on${n}`]&&("ms"===o&&(n="MSFullscreenChange"),br.fullscreenchange=n),n=`${o}fullscreenerror`,void 0!==document[`on${n}`]&&("ms"===o&&(n="MSFullscreenError"),br.fullscreenerror=n)}return gr},Er.requestFullscreen=function(e,t){Er.supportsFullscreen()&&e[br.requestFullscreen]({vrDisplay:t})},Er.exitFullscreen=function(){Er.supportsFullscreen()&&document[br.exitFullscreen]()},Er._names=br,Or="undefined"!=typeof navigator?navigator:{},Xr._promise=void 0,Xr._result=void 0,Xr.initialize=function(){return _(Xr._promise)||(Xr._promise=new Promise((e=>{const t=new Image;t.onload=function(){Xr._result=t.width>0&&t.height>0,e(Xr._result)},t.onerror=function(){Xr._result=!1,e(Xr._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"}))),Xr._promise},Object.defineProperties(Xr,{initialized:{get:function(){return _(Xr._result)}}});const $r=[];"undefined"!=typeof ArrayBuffer&&($r.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&$r.push(Uint8ClampedArray),"undefined"!=typeof Uint8ClampedArray&&$r.push(Uint8ClampedArray),"undefined"!=typeof BigInt64Array&&$r.push(BigInt64Array),"undefined"!=typeof BigUint64Array&&$r.push(BigUint64Array));const Yr={isChrome:Br,chromeVersion:function(){return Br()&&vr},isSafari:zr,safariVersion:function(){return zr()&&xr},isWebkit:kr,webkitVersion:function(){return kr()&&Ar},isInternetExplorer:Gr,internetExplorerVersion:function(){return Gr()&&Ir},isEdge:Vr,edgeVersion:function(){return Vr()&&Cr},isFirefox:Hr,firefoxVersion:function(){return Hr()&&Mr},isWindows:function(){return _(jr)||(jr=/Windows/i.test(Or.appVersion)),jr},isIPadOrIOS:function(){return _(Ur)||(Ur="iPhone"===navigator.platform||"iPod"===navigator.platform||"iPad"===navigator.platform),Ur},hardwareConcurrency:y(Or.hardwareConcurrency,3),supportsPointerEvents:function(){return _(Fr)||(Fr=!Hr()&&"undefined"!=typeof PointerEvent&&(!_(Or.pointerEnabled)||Or.pointerEnabled)),Fr},supportsImageRenderingPixelated:Wr,supportsWebP:Xr,imageRenderingValue:function(){return Wr()?qr:void 0},typedArrayTypes:$r};function Zr(e,t,n,r){this.x=y(e,0),this.y=y(t,0),this.z=y(n,0),this.w=y(r,0)}Yr.supportsBasis=function(e){return Yr.supportsWebAssembly()&&e.context.supportsBasis},Yr.supportsFullscreen=function(){return Er.supportsFullscreen()},Yr.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},Yr.supportsBigInt64Array=function(){return"undefined"!=typeof BigInt64Array},Yr.supportsBigUint64Array=function(){return"undefined"!=typeof BigUint64Array},Yr.supportsBigInt=function(){return"undefined"!=typeof BigInt},Yr.supportsWebWorkers=function(){return"undefined"!=typeof Worker},Yr.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly},Yr.supportsWebgl2=function(e){return M.defined("scene",e),e.context.webgl2},Yr.supportsEsmWebWorkers=function(){return!Hr()||parseInt(Mr)>=114};let Qr=new Z;Zr.fromAxisAngle=function(e,t,n){M.typeOf.object("axis",e),M.typeOf.number("angle",t);const r=t/2,o=Math.sin(r);Qr=Z.normalize(e,Qr);const i=Qr.x*o,s=Qr.y*o,a=Qr.z*o,u=Math.cos(r);return _(n)?(n.x=i,n.y=s,n.z=a,n.w=u,n):new Zr(i,s,a,u)};const Kr=[1,2,0],Jr=new Array(3);Zr.fromRotationMatrix=function(e,t){let n,r,o,i,s;M.typeOf.object("matrix",e);const a=e[oe.COLUMN0ROW0],u=e[oe.COLUMN1ROW1],c=e[oe.COLUMN2ROW2],l=a+u+c;if(l>0)n=Math.sqrt(l+1),s=.5*n,n=.5/n,r=(e[oe.COLUMN1ROW2]-e[oe.COLUMN2ROW1])*n,o=(e[oe.COLUMN2ROW0]-e[oe.COLUMN0ROW2])*n,i=(e[oe.COLUMN0ROW1]-e[oe.COLUMN1ROW0])*n;else{const t=Kr;let l=0;u>a&&(l=1),c>a&&c>u&&(l=2);const f=t[l],p=t[f];n=Math.sqrt(e[oe.getElementIndex(l,l)]-e[oe.getElementIndex(f,f)]-e[oe.getElementIndex(p,p)]+1);const h=Jr;h[l]=.5*n,n=.5/n,s=(e[oe.getElementIndex(p,f)]-e[oe.getElementIndex(f,p)])*n,h[f]=(e[oe.getElementIndex(f,l)]+e[oe.getElementIndex(l,f)])*n,h[p]=(e[oe.getElementIndex(p,l)]+e[oe.getElementIndex(l,p)])*n,r=-h[0],o=-h[1],i=-h[2]}return _(t)?(t.x=r,t.y=o,t.z=i,t.w=s,t):new Zr(r,o,i,s)};const eo=new Zr;let to=new Zr,no=new Zr,ro=new Zr;Zr.fromHeadingPitchRoll=function(e,t){return M.typeOf.object("headingPitchRoll",e),ro=Zr.fromAxisAngle(Z.UNIT_X,e.roll,eo),no=Zr.fromAxisAngle(Z.UNIT_Y,-e.pitch,t),t=Zr.multiply(no,ro,no),to=Zr.fromAxisAngle(Z.UNIT_Z,-e.heading,eo),Zr.multiply(to,t,t)};const oo=new Z,io=new Z,so=new Zr,ao=new Zr,uo=new Zr;Zr.packedLength=4,Zr.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},Zr.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new Zr),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n},Zr.packedInterpolationLength=3,Zr.convertPackedArrayForInterpolation=function(e,t,n,r){Zr.unpack(e,4*n,uo),Zr.conjugate(uo,uo);for(let o=0,i=n-t+1;o<i;o++){const n=3*o;Zr.unpack(e,4*(t+o),so),Zr.multiply(so,uo,so),so.w<0&&Zr.negate(so,so),Zr.computeAxis(so,oo);const i=Zr.computeAngle(so);_(r)||(r=[]),r[n]=oo.x*i,r[n+1]=oo.y*i,r[n+2]=oo.z*i}},Zr.unpackInterpolationResult=function(e,t,n,r,o){_(o)||(o=new Zr),Z.fromArray(e,0,io);const i=Z.magnitude(io);return Zr.unpack(t,4*r,ao),0===i?Zr.clone(Zr.IDENTITY,so):Zr.fromAxisAngle(io,i,so),Zr.multiply(so,ao,o)},Zr.clone=function(e,t){if(_(e))return _(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new Zr(e.x,e.y,e.z,e.w)},Zr.conjugate=function(e,t){return M.typeOf.object("quaternion",e),M.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},Zr.magnitudeSquared=function(e){return M.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},Zr.magnitude=function(e){return Math.sqrt(Zr.magnitudeSquared(e))},Zr.normalize=function(e,t){M.typeOf.object("result",t);const n=1/Zr.magnitude(e),r=e.x*n,o=e.y*n,i=e.z*n,s=e.w*n;return t.x=r,t.y=o,t.z=i,t.w=s,t},Zr.inverse=function(e,t){M.typeOf.object("result",t);const n=Zr.magnitudeSquared(e);return t=Zr.conjugate(e,t),Zr.multiplyByScalar(t,1/n,t)},Zr.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},Zr.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},Zr.negate=function(e,t){return M.typeOf.object("quaternion",e),M.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},Zr.dot=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},Zr.multiply=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,s=e.w,a=t.x,u=t.y,c=t.z,l=t.w,f=s*a+r*l+o*c-i*u,p=s*u-r*c+o*l+i*a,h=s*c+r*u-o*a+i*l,d=s*l-r*a-o*u-i*c;return n.x=f,n.y=p,n.z=h,n.w=d,n},Zr.multiplyByScalar=function(e,t,n){return M.typeOf.object("quaternion",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},Zr.divideByScalar=function(e,t,n){return M.typeOf.object("quaternion",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},Zr.computeAxis=function(e,t){M.typeOf.object("quaternion",e),M.typeOf.object("result",t);const n=e.w;if(Math.abs(n-1)<U.EPSILON6||Math.abs(n+1)<U.EPSILON6)return t.x=1,t.y=t.z=0,t;const r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t},Zr.computeAngle=function(e){return M.typeOf.object("quaternion",e),Math.abs(e.w-1)<U.EPSILON6?0:2*Math.acos(e.w)};let co=new Zr;Zr.lerp=function(e,t,n,r){return M.typeOf.object("start",e),M.typeOf.object("end",t),M.typeOf.number("t",n),M.typeOf.object("result",r),co=Zr.multiplyByScalar(t,n,co),r=Zr.multiplyByScalar(e,1-n,r),Zr.add(co,r,r)};let lo=new Zr,fo=new Zr,po=new Zr;Zr.slerp=function(e,t,n,r){M.typeOf.object("start",e),M.typeOf.object("end",t),M.typeOf.number("t",n),M.typeOf.object("result",r);let o=Zr.dot(e,t),i=t;if(o<0&&(o=-o,i=lo=Zr.negate(t,lo)),1-o<U.EPSILON6)return Zr.lerp(e,i,n,r);const s=Math.acos(o);return fo=Zr.multiplyByScalar(e,Math.sin((1-n)*s),fo),po=Zr.multiplyByScalar(i,Math.sin(n*s),po),r=Zr.add(fo,po,r),Zr.multiplyByScalar(r,1/Math.sin(s),r)},Zr.log=function(e,t){M.typeOf.object("quaternion",e),M.typeOf.object("result",t);const n=U.acosClamped(e.w);let r=0;return 0!==n&&(r=n/Math.sin(n)),Z.multiplyByScalar(e,r,t)},Zr.exp=function(e,t){M.typeOf.object("cartesian",e),M.typeOf.object("result",t);const n=Z.magnitude(e);let r=0;return 0!==n&&(r=Math.sin(n)/n),t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t.w=Math.cos(n),t};const ho=new Z,mo=new Z,yo=new Zr,_o=new Zr;Zr.computeInnerQuadrangle=function(e,t,n,r){M.typeOf.object("q0",e),M.typeOf.object("q1",t),M.typeOf.object("q2",n),M.typeOf.object("result",r);const o=Zr.conjugate(t,yo);Zr.multiply(o,n,_o);const i=Zr.log(_o,ho);Zr.multiply(o,e,_o);const s=Zr.log(_o,mo);return Z.add(i,s,i),Z.multiplyByScalar(i,.25,i),Z.negate(i,i),Zr.exp(i,yo),Zr.multiply(t,yo,r)},Zr.squad=function(e,t,n,r,o,i){M.typeOf.object("q0",e),M.typeOf.object("q1",t),M.typeOf.object("s0",n),M.typeOf.object("s1",r),M.typeOf.number("t",o),M.typeOf.object("result",i);const s=Zr.slerp(e,t,o,yo),a=Zr.slerp(n,r,o,_o);return Zr.slerp(s,a,2*o*(1-o),i)};const go=new Zr,bo=1.9011074535173003,Eo=Yr.supportsTypedArrays()?new Float32Array(8):[],Oo=Yr.supportsTypedArrays()?new Float32Array(8):[],wo=Yr.supportsTypedArrays()?new Float32Array(8):[],vo=Yr.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){const t=e+1,n=2*t+1;Eo[e]=1/(t*n),Oo[e]=t/n}Eo[7]=bo/136,Oo[7]=8*bo/17,Zr.fastSlerp=function(e,t,n,r){M.typeOf.object("start",e),M.typeOf.object("end",t),M.typeOf.number("t",n),M.typeOf.object("result",r);let o,i=Zr.dot(e,t);i>=0?o=1:(o=-1,i=-i);const s=i-1,a=1-n,u=n*n,c=a*a;for(let e=7;e>=0;--e)wo[e]=(Eo[e]*u-Oo[e])*s,vo[e]=(Eo[e]*c-Oo[e])*s;const l=o*n*(1+wo[0]*(1+wo[1]*(1+wo[2]*(1+wo[3]*(1+wo[4]*(1+wo[5]*(1+wo[6]*(1+wo[7])))))))),f=a*(1+vo[0]*(1+vo[1]*(1+vo[2]*(1+vo[3]*(1+vo[4]*(1+vo[5]*(1+vo[6]*(1+vo[7])))))))),p=Zr.multiplyByScalar(e,f,go);return Zr.multiplyByScalar(t,l,r),Zr.add(p,r,r)},Zr.fastSquad=function(e,t,n,r,o,i){M.typeOf.object("q0",e),M.typeOf.object("q1",t),M.typeOf.object("s0",n),M.typeOf.object("s1",r),M.typeOf.number("t",o),M.typeOf.object("result",i);const s=Zr.fastSlerp(e,t,o,yo),a=Zr.fastSlerp(n,r,o,_o);return Zr.fastSlerp(s,a,2*o*(1-o),i)},Zr.equals=function(e,t){return e===t||_(e)&&_(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},Zr.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n},Zr.ZERO=Object.freeze(new Zr(0,0,0,0)),Zr.IDENTITY=Object.freeze(new Zr(0,0,0,1)),Zr.prototype.clone=function(e){return Zr.clone(this,e)},Zr.prototype.equals=function(e){return Zr.equals(this,e)},Zr.prototype.equalsEpsilon=function(e,t){return Zr.equalsEpsilon(this,e,t)},Zr.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const To={},xo={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Ro={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Ao={},So={east:new Z,north:new Z,up:new Z,west:new Z,south:new Z,down:new Z};let Io=new Z,No=new Z,Co=new Z;To.localFrameToFixedFrameGenerator=function(e,t){if(!xo.hasOwnProperty(e)||!xo[e].hasOwnProperty(t))throw new g("firstAxis and secondAxis must be east, north, up, west, south or down.");const n=xo[e][t];let r;const o=e+t;return _(Ao[o])?r=Ao[o]:(r=function(r,o,i){if(!_(r))throw new g("origin is required.");if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z))throw new g("origin has a NaN component");if(_(i)||(i=new Ae),Z.equalsEpsilon(r,Z.ZERO,U.EPSILON14))Z.unpack(Ro[e],0,Io),Z.unpack(Ro[t],0,No),Z.unpack(Ro[n],0,Co);else if(U.equalsEpsilon(r.x,0,U.EPSILON14)&&U.equalsEpsilon(r.y,0,U.EPSILON14)){const o=U.sign(r.z);Z.unpack(Ro[e],0,Io),"east"!==e&&"west"!==e&&Z.multiplyByScalar(Io,o,Io),Z.unpack(Ro[t],0,No),"east"!==t&&"west"!==t&&Z.multiplyByScalar(No,o,No),Z.unpack(Ro[n],0,Co),"east"!==n&&"west"!==n&&Z.multiplyByScalar(Co,o,Co)}else{(o=y(o,ot.default)).geodeticSurfaceNormal(r,So.up);const i=So.up,s=So.east;s.x=-r.y,s.y=r.x,s.z=0,Z.normalize(s,So.east),Z.cross(i,s,So.north),Z.multiplyByScalar(So.up,-1,So.down),Z.multiplyByScalar(So.east,-1,So.west),Z.multiplyByScalar(So.north,-1,So.south),Io=So[e],No=So[t],Co=So[n]}return i[0]=Io.x,i[1]=Io.y,i[2]=Io.z,i[3]=0,i[4]=No.x,i[5]=No.y,i[6]=No.z,i[7]=0,i[8]=Co.x,i[9]=Co.y,i[10]=Co.z,i[11]=0,i[12]=r.x,i[13]=r.y,i[14]=r.z,i[15]=1,i},Ao[o]=r),r},To.eastNorthUpToFixedFrame=To.localFrameToFixedFrameGenerator("east","north"),To.northEastDownToFixedFrame=To.localFrameToFixedFrameGenerator("north","east"),To.northUpEastToFixedFrame=To.localFrameToFixedFrameGenerator("north","up"),To.northWestUpToFixedFrame=To.localFrameToFixedFrameGenerator("north","west");const Po=new Zr,Mo=new Z(1,1,1),jo=new Ae;To.headingPitchRollToFixedFrame=function(e,t,n,r,o){M.typeOf.object("HeadingPitchRoll",t),r=y(r,To.eastNorthUpToFixedFrame);const i=Zr.fromHeadingPitchRoll(t,Po),s=Ae.fromTranslationQuaternionRotationScale(Z.ZERO,i,Mo,jo);return o=r(e,n,o),Ae.multiply(o,s,o)};const Uo=new Ae,Fo=new oe;To.headingPitchRollQuaternion=function(e,t,n,r,o){M.typeOf.object("HeadingPitchRoll",t);const i=To.headingPitchRollToFixedFrame(e,t,n,r,Uo),s=Ae.getMatrix3(i,Fo);return Zr.fromRotationMatrix(s,o)};const qo=new Z(1,1,1),Lo=new Z,Do=new Ae,Bo=new Ae,zo=new oe,ko=new Zr;To.fixedFrameToHeadingPitchRoll=function(e,t,n,r){M.defined("transform",e),t=y(t,ot.default),n=y(n,To.eastNorthUpToFixedFrame),_(r)||(r=new rr);const o=Ae.getTranslation(e,Lo);if(Z.equals(o,Z.ZERO))return r.heading=0,r.pitch=0,r.roll=0,r;let i=Ae.inverseTransformation(n(o,t,Do),Do),s=Ae.setScale(e,qo,Bo);s=Ae.setTranslation(s,Z.ZERO,s),i=Ae.multiply(i,s,i);let a=Zr.fromRotationMatrix(Ae.getMatrix3(i,zo),ko);return a=Zr.normalize(a,a),rr.fromQuaternion(a,r)};const Go=U.TWO_PI/86400;let Vo=new Gt;To.computeIcrfToCentralBodyFixedMatrix=function(e,t){let n=To.computeIcrfToFixedMatrix(e,t);return _(n)||(n=To.computeTemeToPseudoFixedMatrix(e,t)),n},To.computeTemeToPseudoFixedMatrix=function(e,t){if(!_(e))throw new g("date is required.");Vo=Gt.addSeconds(e,-Gt.computeTaiMinusUtc(e),Vo);const n=Vo.dayNumber,r=Vo.secondsOfDay;let o;const i=n-2451545;o=r>=43200?(i+.5)/vt.DAYS_PER_JULIAN_CENTURY:(i-.5)/vt.DAYS_PER_JULIAN_CENTURY;const s=(24110.54841+o*(8640184.812866+o*(.093104+-62e-7*o)))*Go%U.TWO_PI+(72921158553e-15+11772758384668e-32*(n-2451545.5))*((r+.5*vt.SECONDS_PER_DAY)%vt.SECONDS_PER_DAY),a=Math.cos(s),u=Math.sin(s);return _(t)?(t[0]=a,t[1]=-u,t[2]=0,t[3]=u,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new oe(a,u,0,-u,a,0,0,0,1)},To.iau2006XysData=new dr,To.earthOrientationParameters=Qn.NONE;const Ho=32.184;To.preloadIcrfFixed=function(e){const t=e.start.dayNumber,n=e.start.secondsOfDay+Ho,r=e.stop.dayNumber,o=e.stop.secondsOfDay+Ho;return To.iau2006XysData.preload(t,n,r,o)},To.computeIcrfToFixedMatrix=function(e,t){if(!_(e))throw new g("date is required.");_(t)||(t=new oe);const n=To.computeFixedToIcrfMatrix(e,t);if(_(n))return oe.transpose(n,t)};const Wo=new rr,Xo=new oe,$o=new Gt;To.computeMoonFixedToIcrfMatrix=function(e,t){if(!_(e))throw new g("date is required.");const n=Gt.addSeconds(e,32.184,$o),r=Gt.totalDays(n)-2451545,o=U.toRadians(12.112)-U.toRadians(.052992)*r,i=U.toRadians(24.224)-U.toRadians(.105984)*r,s=U.toRadians(227.645)+U.toRadians(13.012)*r,a=U.toRadians(261.105)+U.toRadians(13.340716)*r,u=U.toRadians(358)+U.toRadians(.9856)*r;return Wo.pitch=U.toRadians(180)-U.toRadians(3.878)*Math.sin(o)-U.toRadians(.12)*Math.sin(i)+U.toRadians(.07)*Math.sin(s)-U.toRadians(.017)*Math.sin(a),Wo.roll=U.toRadians(-23.47)+U.toRadians(1.543)*Math.cos(o)+U.toRadians(.24)*Math.cos(i)-U.toRadians(.028)*Math.cos(s)+U.toRadians(.007)*Math.cos(a),Wo.heading=U.toRadians(154.375)+U.toRadians(13.17635831)*r+U.toRadians(3.558)*Math.sin(o)+U.toRadians(.121)*Math.sin(i)-U.toRadians(.064)*Math.sin(s)+U.toRadians(.016)*Math.sin(a)+U.toRadians(.025)*Math.sin(u),oe.fromHeadingPitchRoll(Wo,Xo)},To.computeIcrfToMoonFixedMatrix=function(e,t){if(!_(e))throw new g("date is required.");_(t)||(t=new oe);const n=To.computeMoonFixedToIcrfMatrix(e,t);if(_(n))return oe.transpose(n,t)};const Yo=new hr(0,0,0),Zo=new gt(0,0,0,0,0),Qo=new oe,Ko=new oe;To.computeFixedToIcrfMatrix=function(e,t){if(!_(e))throw new g("date is required.");_(t)||(t=new oe);const n=To.earthOrientationParameters.compute(e,Zo);if(!_(n))return;const r=e.dayNumber,o=e.secondsOfDay+Ho,i=To.iau2006XysData.computeXysRadians(r,o,Yo);if(!_(i))return;const s=i.x+n.xPoleOffset,a=i.y+n.yPoleOffset,u=1/(1+Math.sqrt(1-s*s-a*a)),c=Qo;c[0]=1-u*s*s,c[3]=-u*s*a,c[6]=s,c[1]=-u*s*a,c[4]=1-u*a*a,c[7]=a,c[2]=-s,c[5]=-a,c[8]=1-u*(s*s+a*a);const l=oe.fromRotationZ(-i.s,Ko),f=oe.multiply(c,l,Qo),p=e.dayNumber-2451545,h=(e.secondsOfDay-Gt.computeTaiMinusUtc(e)+n.ut1MinusUtc)/vt.SECONDS_PER_DAY;let d=.779057273264+h+.00273781191135448*(p+h);d=d%1*U.TWO_PI;const m=oe.fromRotationZ(d,Ko),y=oe.multiply(f,m,Qo),b=Math.cos(n.xPoleWander),E=Math.cos(n.yPoleWander),O=Math.sin(n.xPoleWander),w=Math.sin(n.yPoleWander);let v=r-2451545+o/vt.SECONDS_PER_DAY;v/=36525;const T=-47e-6*v*U.RADIANS_PER_DEGREE/3600,x=Math.cos(T),R=Math.sin(T),A=Ko;return A[0]=b*x,A[1]=b*R,A[2]=O,A[3]=-E*R+w*O*x,A[4]=E*x+w*O*R,A[5]=-w*b,A[6]=-w*R-E*O*x,A[7]=w*x-E*O*R,A[8]=E*b,oe.multiply(y,A,t)};const Jo=new ge;To.pointToWindowCoordinates=function(e,t,n,r){return(r=To.pointToGLWindowCoordinates(e,t,n,r)).y=2*t[5]-r.y,r},To.pointToGLWindowCoordinates=function(e,t,n,r){if(!_(e))throw new g("modelViewProjectionMatrix is required.");if(!_(t))throw new g("viewportTransformation is required.");if(!_(n))throw new g("point is required.");_(r)||(r=new Ve);const o=Jo;return Ae.multiplyByVector(e,ge.fromElements(n.x,n.y,n.z,1,o),o),ge.multiplyByScalar(o,1/o.w,o),Ae.multiplyByVector(t,o,o),Ve.fromCartesian4(o,r)};const ei=new Z,ti=new Z,ni=new Z;To.rotationMatrixFromPositionVelocity=function(e,t,n,r){if(!_(e))throw new g("position is required.");if(!_(t))throw new g("velocity is required.");const o=y(n,ot.default).geodeticSurfaceNormal(e,ei);let i=Z.cross(t,o,ti);Z.equalsEpsilon(i,Z.ZERO,U.EPSILON6)&&(i=Z.clone(Z.UNIT_X,i));const s=Z.cross(i,t,ni);return Z.normalize(s,s),Z.cross(t,s,i),Z.negate(i,i),Z.normalize(i,i),_(r)||(r=new oe),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=i.x,r[4]=i.y,r[5]=i.z,r[6]=s.x,r[7]=s.y,r[8]=s.z,r};const ri=new Ae(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),oi=new Je,ii=new Z,si=new Z,ai=new oe,ui=new Ae,ci=new Ae;function li(e,t,n,r){this.west=y(e,0),this.south=y(t,0),this.east=y(n,0),this.north=y(r,0)}To.basisTo2D=function(e,t,n){if(!_(e))throw new g("projection is required.");if(!_(t))throw new g("matrix is required.");if(!_(n))throw new g("result is required.");const r=Ae.getTranslation(t,si),o=e.ellipsoid;let i;if(Z.equals(r,Z.ZERO))i=Z.clone(Z.ZERO,ii);else{const t=o.cartesianToCartographic(r,oi);i=e.project(t,ii),Z.fromElements(i.z,i.x,i.y,i)}const s=To.eastNorthUpToFixedFrame(r,o,ui),a=Ae.inverseTransformation(s,ci),u=Ae.getMatrix3(t,ai),c=Ae.multiplyByMatrix3(a,u,n);return Ae.multiply(ri,c,n),Ae.setTranslation(n,i,n),n},To.ellipsoidTo2DModelMatrix=function(e,t,n){if(!_(e))throw new g("projection is required.");if(!_(t))throw new g("center is required.");if(!_(n))throw new g("result is required.");const r=e.ellipsoid,o=To.eastNorthUpToFixedFrame(t,r,ui),i=Ae.inverseTransformation(o,ci),s=r.cartesianToCartographic(t,oi),a=e.project(s,ii);Z.fromElements(a.z,a.x,a.y,a);const u=Ae.fromTranslation(a,ui);return Ae.multiply(ri,i,n),Ae.multiply(u,n,n),n},Object.defineProperties(li.prototype,{width:{get:function(){return li.computeWidth(this)}},height:{get:function(){return li.computeHeight(this)}}}),li.packedLength=4,li.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t},li.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new li),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n},li.computeWidth=function(e){M.typeOf.object("rectangle",e);let t=e.east;const n=e.west;return t<n&&(t+=U.TWO_PI),t-n},li.computeHeight=function(e){return M.typeOf.object("rectangle",e),e.north-e.south},li.fromDegrees=function(e,t,n,r,o){return e=U.toRadians(y(e,0)),t=U.toRadians(y(t,0)),n=U.toRadians(y(n,0)),r=U.toRadians(y(r,0)),_(o)?(o.west=e,o.south=t,o.east=n,o.north=r,o):new li(e,t,n,r)},li.fromRadians=function(e,t,n,r,o){return _(o)?(o.west=y(e,0),o.south=y(t,0),o.east=y(n,0),o.north=y(r,0),o):new li(e,t,n,r)},li.fromCartographicArray=function(e,t){M.defined("cartographics",e);let n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE;for(let t=0,u=e.length;t<u;t++){const u=e[t];n=Math.min(n,u.longitude),r=Math.max(r,u.longitude),s=Math.min(s,u.latitude),a=Math.max(a,u.latitude);const c=u.longitude>=0?u.longitude:u.longitude+U.TWO_PI;o=Math.min(o,c),i=Math.max(i,c)}return r-n>i-o&&(n=o,r=i,r>U.PI&&(r-=U.TWO_PI),n>U.PI&&(n-=U.TWO_PI)),_(t)?(t.west=n,t.south=s,t.east=r,t.north=a,t):new li(n,s,r,a)},li.fromCartesianArray=function(e,t,n){M.defined("cartesians",e),t=y(t,ot.default);let r=Number.MAX_VALUE,o=-Number.MAX_VALUE,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let n=0,c=e.length;n<c;n++){const c=t.cartesianToCartographic(e[n]);r=Math.min(r,c.longitude),o=Math.max(o,c.longitude),a=Math.min(a,c.latitude),u=Math.max(u,c.latitude);const l=c.longitude>=0?c.longitude:c.longitude+U.TWO_PI;i=Math.min(i,l),s=Math.max(s,l)}return o-r>s-i&&(r=i,o=s,o>U.PI&&(o-=U.TWO_PI),r>U.PI&&(r-=U.TWO_PI)),_(n)?(n.west=r,n.south=a,n.east=o,n.north=u,n):new li(r,a,o,u)};const fi=new Z,pi=new Z,hi=new Z,di=new Z,mi=new Z,yi=new Array(5);for(let e=0;e<yi.length;++e)yi[e]=new Z;li.fromBoundingSphere=function(e,t,n){M.typeOf.object("boundingSphere",e);const r=e.center,o=e.radius;if(_(t)||(t=ot.default),_(n)||(n=new li),Z.equals(r,Z.ZERO))return li.clone(li.MAX_VALUE,n),n;const i=To.eastNorthUpToFixedFrame(r,t,fi),s=Ae.multiplyByPointAsVector(i,Z.UNIT_X,pi);Z.normalize(s,s);const a=Ae.multiplyByPointAsVector(i,Z.UNIT_Y,hi);Z.normalize(a,a),Z.multiplyByScalar(a,o,a),Z.multiplyByScalar(s,o,s);const u=Z.negate(a,mi),c=Z.negate(s,di),l=yi;let f=l[0];return Z.add(r,a,f),f=l[1],Z.add(r,c,f),f=l[2],Z.add(r,u,f),f=l[3],Z.add(r,s,f),l[4]=r,li.fromCartesianArray(l,t,n)},li.clone=function(e,t){if(_(e))return _(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new li(e.west,e.south,e.east,e.north)},li.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n},li.prototype.clone=function(e){return li.clone(this,e)},li.prototype.equals=function(e){return li.equals(this,e)},li.equals=function(e,t){return e===t||_(e)&&_(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},li.prototype.equalsEpsilon=function(e,t){return li.equalsEpsilon(this,e,t)},li._validate=function(e){M.typeOf.object("rectangle",e);const t=e.north;M.typeOf.number.greaterThanOrEquals("north",t,-U.PI_OVER_TWO),M.typeOf.number.lessThanOrEquals("north",t,U.PI_OVER_TWO);const n=e.south;M.typeOf.number.greaterThanOrEquals("south",n,-U.PI_OVER_TWO),M.typeOf.number.lessThanOrEquals("south",n,U.PI_OVER_TWO);const r=e.west;M.typeOf.number.greaterThanOrEquals("west",r,-Math.PI),M.typeOf.number.lessThanOrEquals("west",r,Math.PI);const o=e.east;M.typeOf.number.greaterThanOrEquals("east",o,-Math.PI),M.typeOf.number.lessThanOrEquals("east",o,Math.PI)},li.southwest=function(e,t){return M.typeOf.object("rectangle",e),_(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new Je(e.west,e.south)},li.northwest=function(e,t){return M.typeOf.object("rectangle",e),_(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new Je(e.west,e.north)},li.northeast=function(e,t){return M.typeOf.object("rectangle",e),_(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new Je(e.east,e.north)},li.southeast=function(e,t){return M.typeOf.object("rectangle",e),_(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new Je(e.east,e.south)},li.center=function(e,t){M.typeOf.object("rectangle",e);let n=e.east;const r=e.west;n<r&&(n+=U.TWO_PI);const o=U.negativePiToPi(.5*(r+n)),i=.5*(e.south+e.north);return _(t)?(t.longitude=o,t.latitude=i,t.height=0,t):new Je(o,i)},li.intersection=function(e,t,n){M.typeOf.object("rectangle",e),M.typeOf.object("otherRectangle",t);let r=e.east,o=e.west,i=t.east,s=t.west;r<o&&i>0?r+=U.TWO_PI:i<s&&r>0&&(i+=U.TWO_PI),r<o&&s<0?s+=U.TWO_PI:i<s&&o<0&&(o+=U.TWO_PI);const a=U.negativePiToPi(Math.max(o,s)),u=U.negativePiToPi(Math.min(r,i));if((e.west<e.east||t.west<t.east)&&u<=a)return;const c=Math.max(e.south,t.south),l=Math.min(e.north,t.north);return c>=l?void 0:_(n)?(n.west=a,n.south=c,n.east=u,n.north=l,n):new li(a,c,u,l)},li.simpleIntersection=function(e,t,n){M.typeOf.object("rectangle",e),M.typeOf.object("otherRectangle",t);const r=Math.max(e.west,t.west),o=Math.max(e.south,t.south),i=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(o>=s||r>=i))return _(n)?(n.west=r,n.south=o,n.east=i,n.north=s,n):new li(r,o,i,s)},li.union=function(e,t,n){M.typeOf.object("rectangle",e),M.typeOf.object("otherRectangle",t),_(n)||(n=new li);let r=e.east,o=e.west,i=t.east,s=t.west;r<o&&i>0?r+=U.TWO_PI:i<s&&r>0&&(i+=U.TWO_PI),r<o&&s<0?s+=U.TWO_PI:i<s&&o<0&&(o+=U.TWO_PI);const a=U.negativePiToPi(Math.min(o,s)),u=U.negativePiToPi(Math.max(r,i));return n.west=a,n.south=Math.min(e.south,t.south),n.east=u,n.north=Math.max(e.north,t.north),n},li.expand=function(e,t,n){return M.typeOf.object("rectangle",e),M.typeOf.object("cartographic",t),_(n)||(n=new li),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n},li.contains=function(e,t){M.typeOf.object("rectangle",e),M.typeOf.object("cartographic",t);let n=t.longitude;const r=t.latitude,o=e.west;let i=e.east;return i<o&&(i+=U.TWO_PI,n<0&&(n+=U.TWO_PI)),(n>o||U.equalsEpsilon(n,o,U.EPSILON14))&&(n<i||U.equalsEpsilon(n,i,U.EPSILON14))&&r>=e.south&&r<=e.north};const _i=new Je;function gi(e,t){this.center=Z.clone(y(e,Z.ZERO)),this.radius=y(t,0)}li.subsample=function(e,t,n,r){M.typeOf.object("rectangle",e),t=y(t,ot.default),n=y(n,0),_(r)||(r=[]);let o=0;const i=e.north,s=e.south,a=e.east,u=e.west,c=_i;c.height=n,c.longitude=u,c.latitude=i,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=s,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=i<0?i:s>0?s:0;for(let n=1;n<8;++n)c.longitude=-Math.PI+n*U.PI_OVER_TWO,li.contains(e,c)&&(r[o]=t.cartographicToCartesian(c,r[o]),o++);return 0===c.latitude&&(c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++),r.length=o,r},li.subsection=function(e,t,n,r,o,i){if(M.typeOf.object("rectangle",e),M.typeOf.number.greaterThanOrEquals("westLerp",t,0),M.typeOf.number.lessThanOrEquals("westLerp",t,1),M.typeOf.number.greaterThanOrEquals("southLerp",n,0),M.typeOf.number.lessThanOrEquals("southLerp",n,1),M.typeOf.number.greaterThanOrEquals("eastLerp",r,0),M.typeOf.number.lessThanOrEquals("eastLerp",r,1),M.typeOf.number.greaterThanOrEquals("northLerp",o,0),M.typeOf.number.lessThanOrEquals("northLerp",o,1),M.typeOf.number.lessThanOrEquals("westLerp",t,r),M.typeOf.number.lessThanOrEquals("southLerp",n,o),_(i)||(i=new li),e.west<=e.east){const n=e.east-e.west;i.west=e.west+t*n,i.east=e.west+r*n}else{const n=U.TWO_PI+e.east-e.west;i.west=U.negativePiToPi(e.west+t*n),i.east=U.negativePiToPi(e.west+r*n)}const s=e.north-e.south;return i.south=e.south+n*s,i.north=e.south+o*s,1===t&&(i.west=e.east),1===r&&(i.east=e.east),1===n&&(i.south=e.north),1===o&&(i.north=e.north),i},li.MAX_VALUE=Object.freeze(new li(-Math.PI,-U.PI_OVER_TWO,Math.PI,U.PI_OVER_TWO));const bi=new Z,Ei=new Z,Oi=new Z,wi=new Z,vi=new Z,Ti=new Z,xi=new Z,Ri=new Z,Ai=new Z,Si=new Z,Ii=new Z,Ni=new Z,Ci=4/3*U.PI;gi.fromPoints=function(e,t){if(_(t)||(t=new gi),!_(e)||0===e.length)return t.center=Z.clone(Z.ZERO,t.center),t.radius=0,t;const n=Z.clone(e[0],xi),r=Z.clone(n,bi),o=Z.clone(n,Ei),i=Z.clone(n,Oi),s=Z.clone(n,wi),a=Z.clone(n,vi),u=Z.clone(n,Ti),c=e.length;let l;for(l=1;l<c;l++){Z.clone(e[l],n);const t=n.x,c=n.y,f=n.z;t<r.x&&Z.clone(n,r),t>s.x&&Z.clone(n,s),c<o.y&&Z.clone(n,o),c>a.y&&Z.clone(n,a),f<i.z&&Z.clone(n,i),f>u.z&&Z.clone(n,u)}const f=Z.magnitudeSquared(Z.subtract(s,r,Ri)),p=Z.magnitudeSquared(Z.subtract(a,o,Ri)),h=Z.magnitudeSquared(Z.subtract(u,i,Ri));let d=r,m=s,y=f;p>y&&(y=p,d=o,m=a),h>y&&(y=h,d=i,m=u);const g=Ai;g.x=.5*(d.x+m.x),g.y=.5*(d.y+m.y),g.z=.5*(d.z+m.z);let b=Z.magnitudeSquared(Z.subtract(m,g,Ri)),E=Math.sqrt(b);const O=Si;O.x=r.x,O.y=o.y,O.z=i.z;const w=Ii;w.x=s.x,w.y=a.y,w.z=u.z;const v=Z.midpoint(O,w,Ni);let T=0;for(l=0;l<c;l++){Z.clone(e[l],n);const t=Z.magnitude(Z.subtract(n,v,Ri));t>T&&(T=t);const r=Z.magnitudeSquared(Z.subtract(n,g,Ri));if(r>b){const e=Math.sqrt(r);E=.5*(E+e),b=E*E;const t=e-E;g.x=(E*g.x+t*n.x)/e,g.y=(E*g.y+t*n.y)/e,g.z=(E*g.z+t*n.z)/e}}return E<T?(Z.clone(g,t.center),t.radius=E):(Z.clone(v,t.center),t.radius=T),t};const Pi=new dt,Mi=new Z,ji=new Z,Ui=new Je,Fi=new Je;gi.fromRectangle2D=function(e,t,n){return gi.fromRectangleWithHeights2D(e,t,0,0,n)},gi.fromRectangleWithHeights2D=function(e,t,n,r,o){if(_(o)||(o=new gi),!_(e))return o.center=Z.clone(Z.ZERO,o.center),o.radius=0,o;Pi._ellipsoid=ot.default,t=y(t,Pi),li.southwest(e,Ui),Ui.height=n,li.northeast(e,Fi),Fi.height=r;const i=t.project(Ui,Mi),s=t.project(Fi,ji),a=s.x-i.x,u=s.y-i.y,c=s.z-i.z;o.radius=.5*Math.sqrt(a*a+u*u+c*c);const l=o.center;return l.x=i.x+.5*a,l.y=i.y+.5*u,l.z=i.z+.5*c,o};const qi=[];gi.fromRectangle3D=function(e,t,n,r){if(t=y(t,ot.default),n=y(n,0),_(r)||(r=new gi),!_(e))return r.center=Z.clone(Z.ZERO,r.center),r.radius=0,r;const o=li.subsample(e,t,n,qi);return gi.fromPoints(o,r)},gi.fromVertices=function(e,t,n,r){if(_(r)||(r=new gi),!_(e)||0===e.length)return r.center=Z.clone(Z.ZERO,r.center),r.radius=0,r;t=y(t,Z.ZERO),n=y(n,3),M.typeOf.number.greaterThanOrEquals("stride",n,3);const o=xi;o.x=e[0]+t.x,o.y=e[1]+t.y,o.z=e[2]+t.z;const i=Z.clone(o,bi),s=Z.clone(o,Ei),a=Z.clone(o,Oi),u=Z.clone(o,wi),c=Z.clone(o,vi),l=Z.clone(o,Ti),f=e.length;let p;for(p=0;p<f;p+=n){const n=e[p]+t.x,r=e[p+1]+t.y,f=e[p+2]+t.z;o.x=n,o.y=r,o.z=f,n<i.x&&Z.clone(o,i),n>u.x&&Z.clone(o,u),r<s.y&&Z.clone(o,s),r>c.y&&Z.clone(o,c),f<a.z&&Z.clone(o,a),f>l.z&&Z.clone(o,l)}const h=Z.magnitudeSquared(Z.subtract(u,i,Ri)),d=Z.magnitudeSquared(Z.subtract(c,s,Ri)),m=Z.magnitudeSquared(Z.subtract(l,a,Ri));let g=i,b=u,E=h;d>E&&(E=d,g=s,b=c),m>E&&(E=m,g=a,b=l);const O=Ai;O.x=.5*(g.x+b.x),O.y=.5*(g.y+b.y),O.z=.5*(g.z+b.z);let w=Z.magnitudeSquared(Z.subtract(b,O,Ri)),v=Math.sqrt(w);const T=Si;T.x=i.x,T.y=s.y,T.z=a.z;const x=Ii;x.x=u.x,x.y=c.y,x.z=l.z;const R=Z.midpoint(T,x,Ni);let A=0;for(p=0;p<f;p+=n){o.x=e[p]+t.x,o.y=e[p+1]+t.y,o.z=e[p+2]+t.z;const n=Z.magnitude(Z.subtract(o,R,Ri));n>A&&(A=n);const r=Z.magnitudeSquared(Z.subtract(o,O,Ri));if(r>w){const e=Math.sqrt(r);v=.5*(v+e),w=v*v;const t=e-v;O.x=(v*O.x+t*o.x)/e,O.y=(v*O.y+t*o.y)/e,O.z=(v*O.z+t*o.z)/e}}return v<A?(Z.clone(O,r.center),r.radius=v):(Z.clone(R,r.center),r.radius=A),r},gi.fromEncodedCartesianVertices=function(e,t,n){if(_(n)||(n=new gi),!_(e)||!_(t)||e.length!==t.length||0===e.length)return n.center=Z.clone(Z.ZERO,n.center),n.radius=0,n;const r=xi;r.x=e[0]+t[0],r.y=e[1]+t[1],r.z=e[2]+t[2];const o=Z.clone(r,bi),i=Z.clone(r,Ei),s=Z.clone(r,Oi),a=Z.clone(r,wi),u=Z.clone(r,vi),c=Z.clone(r,Ti),l=e.length;let f;for(f=0;f<l;f+=3){const n=e[f]+t[f],l=e[f+1]+t[f+1],p=e[f+2]+t[f+2];r.x=n,r.y=l,r.z=p,n<o.x&&Z.clone(r,o),n>a.x&&Z.clone(r,a),l<i.y&&Z.clone(r,i),l>u.y&&Z.clone(r,u),p<s.z&&Z.clone(r,s),p>c.z&&Z.clone(r,c)}const p=Z.magnitudeSquared(Z.subtract(a,o,Ri)),h=Z.magnitudeSquared(Z.subtract(u,i,Ri)),d=Z.magnitudeSquared(Z.subtract(c,s,Ri));let m=o,y=a,g=p;h>g&&(g=h,m=i,y=u),d>g&&(g=d,m=s,y=c);const b=Ai;b.x=.5*(m.x+y.x),b.y=.5*(m.y+y.y),b.z=.5*(m.z+y.z);let E=Z.magnitudeSquared(Z.subtract(y,b,Ri)),O=Math.sqrt(E);const w=Si;w.x=o.x,w.y=i.y,w.z=s.z;const v=Ii;v.x=a.x,v.y=u.y,v.z=c.z;const T=Z.midpoint(w,v,Ni);let x=0;for(f=0;f<l;f+=3){r.x=e[f]+t[f],r.y=e[f+1]+t[f+1],r.z=e[f+2]+t[f+2];const n=Z.magnitude(Z.subtract(r,T,Ri));n>x&&(x=n);const o=Z.magnitudeSquared(Z.subtract(r,b,Ri));if(o>E){const e=Math.sqrt(o);O=.5*(O+e),E=O*O;const t=e-O;b.x=(O*b.x+t*r.x)/e,b.y=(O*b.y+t*r.y)/e,b.z=(O*b.z+t*r.z)/e}}return O<x?(Z.clone(b,n.center),n.radius=O):(Z.clone(T,n.center),n.radius=x),n},gi.fromCornerPoints=function(e,t,n){M.typeOf.object("corner",e),M.typeOf.object("oppositeCorner",t),_(n)||(n=new gi);const r=Z.midpoint(e,t,n.center);return n.radius=Z.distance(r,t),n},gi.fromEllipsoid=function(e,t){return M.typeOf.object("ellipsoid",e),_(t)||(t=new gi),Z.clone(Z.ZERO,t.center),t.radius=e.maximumRadius,t};const Li=new Z;gi.fromBoundingSpheres=function(e,t){if(_(t)||(t=new gi),!_(e)||0===e.length)return t.center=Z.clone(Z.ZERO,t.center),t.radius=0,t;const n=e.length;if(1===n)return gi.clone(e[0],t);if(2===n)return gi.union(e[0],e[1],t);const r=[];let o;for(o=0;o<n;o++)r.push(e[o].center);const i=(t=gi.fromPoints(r,t)).center;let s=t.radius;for(o=0;o<n;o++){const t=e[o];s=Math.max(s,Z.distance(i,t.center,Li)+t.radius)}return t.radius=s,t};const Di=new Z,Bi=new Z,zi=new Z;gi.fromOrientedBoundingBox=function(e,t){M.defined("orientedBoundingBox",e),_(t)||(t=new gi);const n=e.halfAxes,r=oe.getColumn(n,0,Di),o=oe.getColumn(n,1,Bi),i=oe.getColumn(n,2,zi);return Z.add(r,o,r),Z.add(r,i,r),t.center=Z.clone(e.center,t.center),t.radius=Z.magnitude(r),t};const ki=new Z,Gi=new Z;gi.fromTransformation=function(e,t){M.typeOf.object("transformation",e),_(t)||(t=new gi);const n=Ae.getTranslation(e,ki),r=Ae.getScale(e,Gi),o=.5*Z.magnitude(r);return t.center=Z.clone(n,t.center),t.radius=o,t},gi.clone=function(e,t){if(_(e))return _(t)?(t.center=Z.clone(e.center,t.center),t.radius=e.radius,t):new gi(e.center,e.radius)},gi.packedLength=4,gi.pack=function(e,t,n){M.typeOf.object("value",e),M.defined("array",t),n=y(n,0);const r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t},gi.unpack=function(e,t,n){M.defined("array",e),t=y(t,0),_(n)||(n=new gi);const r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};const Vi=new Z,Hi=new Z;gi.union=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),_(n)||(n=new gi);const r=e.center,o=e.radius,i=t.center,s=t.radius,a=Z.subtract(i,r,Vi),u=Z.magnitude(a);if(o>=u+s)return e.clone(n),n;if(s>=u+o)return t.clone(n),n;const c=.5*(o+u+s),l=Z.multiplyByScalar(a,(-o+c)/u,Hi);return Z.add(l,r,l),Z.clone(l,n.center),n.radius=c,n};const Wi=new Z;gi.expand=function(e,t,n){M.typeOf.object("sphere",e),M.typeOf.object("point",t),n=gi.clone(e,n);const r=Z.magnitude(Z.subtract(t,n.center,Wi));return r>n.radius&&(n.radius=r),n},gi.intersectPlane=function(e,t){M.typeOf.object("sphere",e),M.typeOf.object("plane",t);const n=e.center,r=e.radius,o=t.normal,i=Z.dot(o,n)+t.distance;return i<-r?mt.OUTSIDE:i<r?mt.INTERSECTING:mt.INSIDE},gi.transform=function(e,t,n){return M.typeOf.object("sphere",e),M.typeOf.object("transform",t),_(n)||(n=new gi),n.center=Ae.multiplyByPoint(t,e.center,n.center),n.radius=Ae.getMaximumScale(t)*e.radius,n};const Xi=new Z;gi.distanceSquaredTo=function(e,t){M.typeOf.object("sphere",e),M.typeOf.object("cartesian",t);const n=Z.subtract(e.center,t,Xi),r=Z.magnitude(n)-e.radius;return r<=0?0:r*r},gi.transformWithoutScale=function(e,t,n){return M.typeOf.object("sphere",e),M.typeOf.object("transform",t),_(n)||(n=new gi),n.center=Ae.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};const $i=new Z;gi.computePlaneDistances=function(e,t,n,r){M.typeOf.object("sphere",e),M.typeOf.object("position",t),M.typeOf.object("direction",n),_(r)||(r=new yt);const o=Z.subtract(e.center,t,$i),i=Z.dot(n,o);return r.start=i-e.radius,r.stop=i+e.radius,r};const Yi=new Z,Zi=new Z,Qi=new Z,Ki=new Z,Ji=new Z,es=new Je,ts=new Array(8);for(let e=0;e<8;++e)ts[e]=new Z;const ns=new dt;function rs(e,t,n){this.minimum=Z.clone(y(e,Z.ZERO)),this.maximum=Z.clone(y(t,Z.ZERO)),n=_(n)?Z.clone(n):Z.midpoint(this.minimum,this.maximum,new Z),this.center=n}gi.projectTo2D=function(e,t,n){M.typeOf.object("sphere",e),ns._ellipsoid=ot.default;const r=(t=y(t,ns)).ellipsoid;let o=e.center;const i=e.radius;let s;s=Z.equals(o,Z.ZERO)?Z.clone(Z.UNIT_X,Yi):r.geodeticSurfaceNormal(o,Yi);const a=Z.cross(Z.UNIT_Z,s,Zi);Z.normalize(a,a);const u=Z.cross(s,a,Qi);Z.normalize(u,u),Z.multiplyByScalar(s,i,s),Z.multiplyByScalar(u,i,u),Z.multiplyByScalar(a,i,a);const c=Z.negate(u,Ji),l=Z.negate(a,Ki),f=ts;let p=f[0];Z.add(s,u,p),Z.add(p,a,p),p=f[1],Z.add(s,u,p),Z.add(p,l,p),p=f[2],Z.add(s,c,p),Z.add(p,l,p),p=f[3],Z.add(s,c,p),Z.add(p,a,p),Z.negate(s,s),p=f[4],Z.add(s,u,p),Z.add(p,a,p),p=f[5],Z.add(s,u,p),Z.add(p,l,p),p=f[6],Z.add(s,c,p),Z.add(p,l,p),p=f[7],Z.add(s,c,p),Z.add(p,a,p);const h=f.length;for(let e=0;e<h;++e){const n=f[e];Z.add(o,n,n);const i=r.cartesianToCartographic(n,es);t.project(i,n)}o=(n=gi.fromPoints(f,n)).center;const d=o.x,m=o.y,_=o.z;return o.x=_,o.y=d,o.z=m,n},gi.isOccluded=function(e,t){return M.typeOf.object("sphere",e),M.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},gi.equals=function(e,t){return e===t||_(e)&&_(t)&&Z.equals(e.center,t.center)&&e.radius===t.radius},gi.prototype.intersectPlane=function(e){return gi.intersectPlane(this,e)},gi.prototype.distanceSquaredTo=function(e){return gi.distanceSquaredTo(this,e)},gi.prototype.computePlaneDistances=function(e,t,n){return gi.computePlaneDistances(this,e,t,n)},gi.prototype.isOccluded=function(e){return gi.isOccluded(this,e)},gi.prototype.equals=function(e){return gi.equals(this,e)},gi.prototype.clone=function(e){return gi.clone(this,e)},gi.prototype.volume=function(){const e=this.radius;return Ci*e*e*e},rs.fromCorners=function(e,t,n){return M.defined("minimum",e),M.defined("maximum",t),_(n)||(n=new rs),n.minimum=Z.clone(e,n.minimum),n.maximum=Z.clone(t,n.maximum),n.center=Z.midpoint(e,t,n.center),n},rs.fromPoints=function(e,t){if(_(t)||(t=new rs),!_(e)||0===e.length)return t.minimum=Z.clone(Z.ZERO,t.minimum),t.maximum=Z.clone(Z.ZERO,t.maximum),t.center=Z.clone(Z.ZERO,t.center),t;let n=e[0].x,r=e[0].y,o=e[0].z,i=e[0].x,s=e[0].y,a=e[0].z;const u=e.length;for(let t=1;t<u;t++){const u=e[t],c=u.x,l=u.y,f=u.z;n=Math.min(c,n),i=Math.max(c,i),r=Math.min(l,r),s=Math.max(l,s),o=Math.min(f,o),a=Math.max(f,a)}const c=t.minimum;c.x=n,c.y=r,c.z=o;const l=t.maximum;return l.x=i,l.y=s,l.z=a,t.center=Z.midpoint(c,l,t.center),t},rs.clone=function(e,t){if(_(e))return _(t)?(t.minimum=Z.clone(e.minimum,t.minimum),t.maximum=Z.clone(e.maximum,t.maximum),t.center=Z.clone(e.center,t.center),t):new rs(e.minimum,e.maximum,e.center)},rs.equals=function(e,t){return e===t||_(e)&&_(t)&&Z.equals(e.center,t.center)&&Z.equals(e.minimum,t.minimum)&&Z.equals(e.maximum,t.maximum)};let os=new Z;rs.intersectPlane=function(e,t){M.defined("box",e),M.defined("plane",t),os=Z.subtract(e.maximum,e.minimum,os);const n=Z.multiplyByScalar(os,.5,os),r=t.normal,o=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),i=Z.dot(e.center,r)+t.distance;return i-o>0?mt.INSIDE:i+o<0?mt.OUTSIDE:mt.INTERSECTING},rs.prototype.clone=function(e){return rs.clone(this,e)},rs.prototype.intersectPlane=function(e){return rs.intersectPlane(this,e)},rs.prototype.equals=function(e){return rs.equals(this,e)};const is={};function ss(e,t,n){const r=e+t;return U.sign(e)!==U.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}is.computeDiscriminant=function(e,t,n){if("number"!=typeof e)throw new g("a is a required number.");if("number"!=typeof t)throw new g("b is a required number.");if("number"!=typeof n)throw new g("c is a required number.");return t*t-4*e*n},is.computeRealRoots=function(e,t,n){if("number"!=typeof e)throw new g("a is a required number.");if("number"!=typeof t)throw new g("b is a required number.");if("number"!=typeof n)throw new g("c is a required number.");let r;if(0===e)return 0===t?[]:[-n/t];if(0===t){if(0===n)return[0,0];const t=Math.abs(n),o=Math.abs(e);if(t<o&&t/o<U.EPSILON14)return[0,0];if(t>o&&o/t<U.EPSILON14)return[];if(r=-n/e,r<0)return[];const i=Math.sqrt(r);return[-i,i]}if(0===n)return r=-t/e,r<0?[r,0]:[0,r];const o=ss(t*t,-(4*e*n),U.EPSILON14);if(o<0)return[];const i=-.5*ss(t,U.sign(t)*Math.sqrt(o),U.EPSILON14);return t>0?[i/e,n/i]:[n/i,i/e]};const as={};function us(e,t,n,r){const o=e,i=t/3,s=n/3,a=r,u=o*s,c=i*a,l=i*i,f=s*s,p=o*s-l,h=o*a-i*s,d=i*a-f,m=4*p*d-h*h;let y,_;if(m<0){let e,t,n;l*c>=u*f?(e=o,t=p,n=-2*i*p+o*h):(e=a,t=d,n=-a*h+2*s*d);const r=-(n<0?-1:1)*Math.abs(e)*Math.sqrt(-m);_=-n+r;const g=_/2,b=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),E=_===r?-b:-t/b;return y=t<=0?b+E:-n/(b*b+E*E+t),l*c>=u*f?[(y-i)/o]:[-a/(y+s)]}const g=p,b=-2*i*p+o*h,E=d,O=-a*h+2*s*d,w=Math.sqrt(m),v=Math.sqrt(3)/2;let T=Math.abs(Math.atan2(o*w,-b)/3);y=2*Math.sqrt(-g);let x=Math.cos(T);_=y*x;let R=y*(-x/2-v*Math.sin(T));const A=_+R>2*i?_-i:R-i,S=o,I=A/S;T=Math.abs(Math.atan2(a*w,-O)/3),y=2*Math.sqrt(-E),x=Math.cos(T),_=y*x,R=y*(-x/2-v*Math.sin(T));const N=-a,C=_+R<2*s?_+s:R+s,P=N/C,M=-A*C-S*N,j=(s*M-i*(A*N))/(-i*M+s*(S*C));return I<=j?I<=P?j<=P?[I,j,P]:[I,P,j]:[P,I,j]:I<=P?[j,I,P]:j<=P?[j,P,I]:[P,j,I]}as.computeDiscriminant=function(e,t,n,r){if("number"!=typeof e)throw new g("a is a required number.");if("number"!=typeof t)throw new g("b is a required number.");if("number"!=typeof n)throw new g("c is a required number.");if("number"!=typeof r)throw new g("d is a required number.");const o=t*t,i=n*n;return 18*e*t*n*r+o*i-27*(e*e)*(r*r)-4*(e*i*n+o*t*r)},as.computeRealRoots=function(e,t,n,r){if("number"!=typeof e)throw new g("a is a required number.");if("number"!=typeof t)throw new g("b is a required number.");if("number"!=typeof n)throw new g("c is a required number.");if("number"!=typeof r)throw new g("d is a required number.");let o,i;if(0===e)return is.computeRealRoots(t,n,r);if(0===t){if(0===n){if(0===r)return[0,0,0];i=-r/e;const t=i<0?-Math.pow(-i,1/3):Math.pow(i,1/3);return[t,t,t]}return 0===r?(o=is.computeRealRoots(e,0,n),0===o.Length?[0]:[o[0],0,o[1]]):us(e,0,n,r)}return 0===n?0===r?(i=-t/e,i<0?[i,0,0]:[0,0,i]):us(e,t,0,r):0===r?(o=is.computeRealRoots(e,t,n),0===o.length?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]):us(e,t,n,r)};const cs={};function ls(e,t,n,r){const o=e*e,i=t-3*o/8,s=n-t*e/2+o*e/8,a=r-n*e/4+t*o/16-3*o*o/256,u=as.computeRealRoots(1,2*i,i*i-4*a,-s*s);if(u.length>0){const t=-e/4,n=u[u.length-1];if(Math.abs(n)<U.EPSILON14){const e=is.computeRealRoots(1,i,a);if(2===e.length){const n=e[0],r=e[1];let o;if(n>=0&&r>=0){const e=Math.sqrt(n),o=Math.sqrt(r);return[t-o,t-e,t+e,t+o]}if(n>=0&&r<0)return o=Math.sqrt(n),[t-o,t+o];if(n<0&&r>=0)return o=Math.sqrt(r),[t-o,t+o]}return[]}if(n>0){const e=Math.sqrt(n),r=(i+n-s/e)/2,o=(i+n+s/e)/2,a=is.computeRealRoots(1,e,r),u=is.computeRealRoots(1,-e,o);return 0!==a.length?(a[0]+=t,a[1]+=t,0!==u.length?(u[0]+=t,u[1]+=t,a[1]<=u[0]?[a[0],a[1],u[0],u[1]]:u[1]<=a[0]?[u[0],u[1],a[0],a[1]]:a[0]>=u[0]&&a[1]<=u[1]?[u[0],a[0],a[1],u[1]]:u[0]>=a[0]&&u[1]<=a[1]?[a[0],u[0],u[1],a[1]]:a[0]>u[0]&&a[0]<u[1]?[u[0],a[0],u[1],a[1]]:[a[0],u[0],a[1],u[1]]):a):0!==u.length?(u[0]+=t,u[1]+=t,u):[]}}return[]}function fs(e,t,n,r){const o=e*e,i=-2*t,s=n*e+t*t-4*r,a=o*r-n*t*e+n*n,u=as.computeRealRoots(1,i,s,a);if(u.length>0){const i=u[0],s=t-i,a=s*s,c=e/2,l=s/2,f=a-4*r,p=a+4*Math.abs(r),h=o-4*i,d=o+4*Math.abs(i);let m,y,_,g,b,E;if(i<0||f*d<h*p){const t=Math.sqrt(h);m=t/2,y=0===t?0:(e*l-n)/t}else{const t=Math.sqrt(f);m=0===t?0:(e*l-n)/t,y=t/2}0===c&&0===m?(_=0,g=0):U.sign(c)===U.sign(m)?(_=c+m,g=i/_):(g=c-m,_=i/g),0===l&&0===y?(b=0,E=0):U.sign(l)===U.sign(y)?(b=l+y,E=r/b):(E=l-y,b=r/E);const O=is.computeRealRoots(1,_,b),w=is.computeRealRoots(1,g,E);if(0!==O.length)return 0!==w.length?O[1]<=w[0]?[O[0],O[1],w[0],w[1]]:w[1]<=O[0]?[w[0],w[1],O[0],O[1]]:O[0]>=w[0]&&O[1]<=w[1]?[w[0],O[0],O[1],w[1]]:w[0]>=O[0]&&w[1]<=O[1]?[O[0],w[0],w[1],O[1]]:O[0]>w[0]&&O[0]<w[1]?[w[0],O[0],w[1],O[1]]:[O[0],w[0],O[1],w[1]]:O;if(0!==w.length)return w}return[]}function ps(e,t){t=Z.clone(y(t,Z.ZERO)),Z.equals(t,Z.ZERO)||Z.normalize(t,t),this.origin=Z.clone(y(e,Z.ZERO)),this.direction=t}cs.computeDiscriminant=function(e,t,n,r,o){if("number"!=typeof e)throw new g("a is a required number.");if("number"!=typeof t)throw new g("b is a required number.");if("number"!=typeof n)throw new g("c is a required number.");if("number"!=typeof r)throw new g("d is a required number.");if("number"!=typeof o)throw new g("e is a required number.");const i=e*e,s=t*t,a=s*t,u=n*n,c=u*n,l=r*r,f=l*r,p=o*o;return s*u*l-4*a*f-4*e*c*l+18*e*t*n*f-27*i*l*l+256*(i*e)*(p*o)+o*(18*a*n*r-4*s*c+16*e*u*u-80*e*t*u*r-6*e*s*l+144*i*n*l)+p*(144*e*s*n-27*s*s-128*i*u-192*i*t*r)},cs.computeRealRoots=function(e,t,n,r,o){if("number"!=typeof e)throw new g("a is a required number.");if("number"!=typeof t)throw new g("b is a required number.");if("number"!=typeof n)throw new g("c is a required number.");if("number"!=typeof r)throw new g("d is a required number.");if("number"!=typeof o)throw new g("e is a required number.");if(Math.abs(e)<U.EPSILON15)return as.computeRealRoots(t,n,r,o);const i=t/e,s=n/e,a=r/e,u=o/e;let c=i<0?1:0;switch(c+=s<0?c+1:c,c+=a<0?c+1:c,c+=u<0?c+1:c,c){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return ls(i,s,a,u);case 1:case 2:case 5:case 8:case 11:return fs(i,s,a,u);default:return}},ps.clone=function(e,t){if(_(e))return _(t)?(t.origin=Z.clone(e.origin),t.direction=Z.clone(e.direction),t):new ps(e.origin,e.direction)},ps.getPoint=function(e,t,n){return M.typeOf.object("ray",e),M.typeOf.number("t",t),_(n)||(n=new Z),n=Z.multiplyByScalar(e.direction,t,n),Z.add(e.origin,n,n)};const hs={rayPlane:function(e,t,n){if(!_(e))throw new g("ray is required.");if(!_(t))throw new g("plane is required.");_(n)||(n=new Z);const r=e.origin,o=e.direction,i=t.normal,s=Z.dot(i,o);if(Math.abs(s)<U.EPSILON15)return;const a=(-t.distance-Z.dot(i,r))/s;return a<0?void 0:(n=Z.multiplyByScalar(o,a,n),Z.add(r,n,n))}},ds=new Z,ms=new Z,ys=new Z,_s=new Z,gs=new Z;hs.rayTriangleParametric=function(e,t,n,r,o){if(!_(e))throw new g("ray is required.");if(!_(t))throw new g("p0 is required.");if(!_(n))throw new g("p1 is required.");if(!_(r))throw new g("p2 is required.");o=y(o,!1);const i=e.origin,s=e.direction,a=Z.subtract(n,t,ds),u=Z.subtract(r,t,ms),c=Z.cross(s,u,ys),l=Z.dot(a,c);let f,p,h,d,m;if(o){if(l<U.EPSILON6)return;if(f=Z.subtract(i,t,_s),h=Z.dot(f,c),h<0||h>l)return;if(p=Z.cross(f,a,gs),d=Z.dot(s,p),d<0||h+d>l)return;m=Z.dot(u,p)/l}else{if(Math.abs(l)<U.EPSILON6)return;const e=1/l;if(f=Z.subtract(i,t,_s),h=Z.dot(f,c)*e,h<0||h>1)return;if(p=Z.cross(f,a,gs),d=Z.dot(s,p)*e,d<0||h+d>1)return;m=Z.dot(u,p)*e}return m},hs.rayTriangle=function(e,t,n,r,o,i){const s=hs.rayTriangleParametric(e,t,n,r,o);if(_(s)&&!(s<0))return _(i)||(i=new Z),Z.multiplyByScalar(e.direction,s,i),Z.add(e.origin,i,i)};const bs=new ps;hs.lineSegmentTriangle=function(e,t,n,r,o,i,s){if(!_(e))throw new g("v0 is required.");if(!_(t))throw new g("v1 is required.");if(!_(n))throw new g("p0 is required.");if(!_(r))throw new g("p1 is required.");if(!_(o))throw new g("p2 is required.");const a=bs;Z.clone(e,a.origin),Z.subtract(t,e,a.direction),Z.normalize(a.direction,a.direction);const u=hs.rayTriangleParametric(a,n,r,o,i);if(!(!_(u)||u<0||u>Z.distance(e,t)))return _(s)||(s=new Z),Z.multiplyByScalar(a.direction,u,s),Z.add(a.origin,s,s)};const Es={root0:0,root1:0};function Os(e,t,n){_(n)||(n=new yt);const r=e.origin,o=e.direction,i=t.center,s=t.radius*t.radius,a=Z.subtract(r,i,ys),u=function(e,t,n,r){const o=t*t-4*e*n;if(o<0)return;if(o>0){const n=1/(2*e),i=Math.sqrt(o),s=(-t+i)*n,a=(-t-i)*n;return s<a?(r.root0=s,r.root1=a):(r.root0=a,r.root1=s),r}const i=-t/(2*e);return 0!==i?(r.root0=r.root1=i,r):void 0}(Z.dot(o,o),2*Z.dot(o,a),Z.magnitudeSquared(a)-s,Es);if(_(u))return n.start=u.root0,n.stop=u.root1,n}hs.raySphere=function(e,t,n){if(!_(e))throw new g("ray is required.");if(!_(t))throw new g("sphere is required.");if(_(n=Os(e,t,n))&&!(n.stop<0))return n.start=Math.max(n.start,0),n};const ws=new ps;hs.lineSegmentSphere=function(e,t,n,r){if(!_(e))throw new g("p0 is required.");if(!_(t))throw new g("p1 is required.");if(!_(n))throw new g("sphere is required.");const o=ws;Z.clone(e,o.origin);const i=Z.subtract(t,e,o.direction),s=Z.magnitude(i);if(Z.normalize(i,i),!(!_(r=Os(o,n,r))||r.stop<0||r.start>s))return r.start=Math.max(r.start,0),r.stop=Math.min(r.stop,s),r};const vs=new Z,Ts=new Z;function xs(e,t,n){const r=e+t;return U.sign(e)!==U.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}hs.rayEllipsoid=function(e,t){if(!_(e))throw new g("ray is required.");if(!_(t))throw new g("ellipsoid is required.");const n=t.oneOverRadii,r=Z.multiplyComponents(n,e.origin,vs),o=Z.multiplyComponents(n,e.direction,Ts),i=Z.magnitudeSquared(r),s=Z.dot(r,o);let a,u,c,l,f;if(i>1){if(s>=0)return;const e=s*s;if(a=i-1,u=Z.magnitudeSquared(o),c=u*a,e<c)return;if(e>c){l=s*s-c,f=-s+Math.sqrt(l);const e=f/u,t=a/f;return e<t?new yt(e,t):{start:t,stop:e}}const t=Math.sqrt(a/u);return new yt(t,t)}return i<1?(a=i-1,u=Z.magnitudeSquared(o),c=u*a,l=s*s-c,f=-s+Math.sqrt(l),new yt(0,f/u)):s<0?(u=Z.magnitudeSquared(o),new yt(0,-s/u)):void 0},hs.quadraticVectorExpression=function(e,t,n,r,o){const i=r*r,s=o*o,a=(e[oe.COLUMN1ROW1]-e[oe.COLUMN2ROW2])*s,u=o*(r*xs(e[oe.COLUMN1ROW0],e[oe.COLUMN0ROW1],U.EPSILON15)+t.y),c=e[oe.COLUMN0ROW0]*i+e[oe.COLUMN2ROW2]*s+r*t.x+n,l=s*xs(e[oe.COLUMN2ROW1],e[oe.COLUMN1ROW2],U.EPSILON15),f=o*(r*xs(e[oe.COLUMN2ROW0],e[oe.COLUMN0ROW2])+t.z);let p;const h=[];if(0===f&&0===l){if(p=is.computeRealRoots(a,u,c),0===p.length)return h;const e=p[0],t=Math.sqrt(Math.max(1-e*e,0));if(h.push(new Z(r,o*e,o*-t)),h.push(new Z(r,o*e,o*t)),2===p.length){const e=p[1],t=Math.sqrt(Math.max(1-e*e,0));h.push(new Z(r,o*e,o*-t)),h.push(new Z(r,o*e,o*t))}return h}const d=f*f,m=l*l,y=f*l,_=a*a+m,g=2*(u*a+y),b=2*c*a+u*u-m+d,E=2*(c*u-y),O=c*c-d;if(0===_&&0===g&&0===b&&0===E)return h;p=cs.computeRealRoots(_,g,b,E,O);const w=p.length;if(0===w)return h;for(let e=0;e<w;++e){const t=p[e],n=t*t,i=Math.max(1-n,0),s=Math.sqrt(i);let d;d=U.sign(a)===U.sign(c)?xs(a*n+c,u*t,U.EPSILON12):U.sign(c)===U.sign(u*t)?xs(a*n,u*t+c,U.EPSILON12):xs(a*n+u*t,c,U.EPSILON12);const m=d*xs(l*t,f,U.EPSILON15);m<0?h.push(new Z(r,o*t,o*s)):m>0?h.push(new Z(r,o*t,o*-s)):0!==s?(h.push(new Z(r,o*t,o*-s)),h.push(new Z(r,o*t,o*s)),++e):h.push(new Z(r,o*t,o*s))}return h};const Rs=new Z,As=new Z,Ss=new Z,Is=new Z,Ns=new Z,Cs=new oe,Ps=new oe,Ms=new oe,js=new oe,Us=new oe,Fs=new oe,qs=new oe,Ls=new Z,Ds=new Z,Bs=new Je;hs.grazingAltitudeLocation=function(e,t){if(!_(e))throw new g("ray is required.");if(!_(t))throw new g("ellipsoid is required.");const n=e.origin,r=e.direction;if(!Z.equals(n,Z.ZERO)){const e=t.geodeticSurfaceNormal(n,Rs);if(Z.dot(r,e)>=0)return n}const o=_(this.rayEllipsoid(e,t)),i=t.transformPositionToScaledSpace(r,Rs),s=Z.normalize(i,i),a=Z.mostOrthogonalAxis(i,Is),u=Z.normalize(Z.cross(a,s,As),As),c=Z.normalize(Z.cross(s,u,Ss),Ss),l=Cs;l[0]=s.x,l[1]=s.y,l[2]=s.z,l[3]=u.x,l[4]=u.y,l[5]=u.z,l[6]=c.x,l[7]=c.y,l[8]=c.z;const f=oe.transpose(l,Ps),p=oe.fromScale(t.radii,Ms),h=oe.fromScale(t.oneOverRadii,js),d=Us;d[0]=0,d[1]=-r.z,d[2]=r.y,d[3]=r.z,d[4]=0,d[5]=-r.x,d[6]=-r.y,d[7]=r.x,d[8]=0;const m=oe.multiply(oe.multiply(f,h,Fs),d,Fs),y=oe.multiply(oe.multiply(m,p,qs),l,qs),b=oe.multiplyByVector(m,n,Ns),E=hs.quadraticVectorExpression(y,Z.negate(b,Rs),0,0,1);let O,w;const v=E.length;if(v>0){let e=Z.clone(Z.ZERO,Ds),i=Number.NEGATIVE_INFINITY;for(let t=0;t<v;++t){O=oe.multiplyByVector(p,oe.multiplyByVector(l,E[t],Ls),Ls);const o=Z.normalize(Z.subtract(O,n,Is),Is),s=Z.dot(o,r);s>i&&(i=s,e=Z.clone(O,e))}const s=t.cartesianToCartographic(e,Bs);return i=U.clamp(i,0,1),w=Z.magnitude(Z.subtract(e,n,Is))*Math.sqrt(1-i*i),w=o?-w:w,s.height=w,t.cartographicToCartesian(s,new Z)}};const zs=new Z;function ks(e,t){if(M.typeOf.object("normal",e),!U.equalsEpsilon(Z.magnitude(e),1,U.EPSILON6))throw new g("normal must be normalized.");M.typeOf.number("distance",t),this.normal=Z.clone(e),this.distance=t}hs.lineSegmentPlane=function(e,t,n,r){if(!_(e))throw new g("endPoint0 is required.");if(!_(t))throw new g("endPoint1 is required.");if(!_(n))throw new g("plane is required.");_(r)||(r=new Z);const o=Z.subtract(t,e,zs),i=n.normal,s=Z.dot(i,o);if(Math.abs(s)<U.EPSILON6)return;const a=Z.dot(i,e),u=-(n.distance+a)/s;return u<0||u>1?void 0:(Z.multiplyByScalar(o,u,r),Z.add(e,r,r),r)},hs.trianglePlaneIntersection=function(e,t,n,r){if(!(_(e)&&_(t)&&_(n)&&_(r)))throw new g("p0, p1, p2, and plane are required.");const o=r.normal,i=r.distance,s=Z.dot(o,e)+i<0,a=Z.dot(o,t)+i<0,u=Z.dot(o,n)+i<0;let c,l,f=0;if(f+=s?1:0,f+=a?1:0,f+=u?1:0,1!==f&&2!==f||(c=new Z,l=new Z),1===f){if(s)return hs.lineSegmentPlane(e,t,r,c),hs.lineSegmentPlane(e,n,r,l),{positions:[e,t,n,c,l],indices:[0,3,4,1,2,4,1,4,3]};if(a)return hs.lineSegmentPlane(t,n,r,c),hs.lineSegmentPlane(t,e,r,l),{positions:[e,t,n,c,l],indices:[1,3,4,2,0,4,2,4,3]};if(u)return hs.lineSegmentPlane(n,e,r,c),hs.lineSegmentPlane(n,t,r,l),{positions:[e,t,n,c,l],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===f){if(!s)return hs.lineSegmentPlane(t,e,r,c),hs.lineSegmentPlane(n,e,r,l),{positions:[e,t,n,c,l],indices:[1,2,4,1,4,3,0,3,4]};if(!a)return hs.lineSegmentPlane(n,t,r,c),hs.lineSegmentPlane(e,t,r,l),{positions:[e,t,n,c,l],indices:[2,0,4,2,4,3,1,3,4]};if(!u)return hs.lineSegmentPlane(e,n,r,c),hs.lineSegmentPlane(t,n,r,l),{positions:[e,t,n,c,l],indices:[0,1,4,0,4,3,2,3,4]}}},ks.fromPointNormal=function(e,t,n){if(M.typeOf.object("point",e),M.typeOf.object("normal",t),!U.equalsEpsilon(Z.magnitude(t),1,U.EPSILON6))throw new g("normal must be normalized.");const r=-Z.dot(t,e);return _(n)?(Z.clone(t,n.normal),n.distance=r,n):new ks(t,r)};const Gs=new Z;ks.fromCartesian4=function(e,t){M.typeOf.object("coefficients",e);const n=Z.fromCartesian4(e,Gs),r=e.w;if(!U.equalsEpsilon(Z.magnitude(n),1,U.EPSILON6))throw new g("normal must be normalized.");return _(t)?(Z.clone(n,t.normal),t.distance=r,t):new ks(n,r)},ks.getPointDistance=function(e,t){return M.typeOf.object("plane",e),M.typeOf.object("point",t),Z.dot(e.normal,t)+e.distance};const Vs=new Z;ks.projectPointOntoPlane=function(e,t,n){M.typeOf.object("plane",e),M.typeOf.object("point",t),_(n)||(n=new Z);const r=ks.getPointDistance(e,t),o=Z.multiplyByScalar(e.normal,r,Vs);return Z.subtract(t,o,n)};const Hs=new Ae,Ws=new ge,Xs=new Z;ks.transform=function(e,t,n){M.typeOf.object("plane",e),M.typeOf.object("transform",t);const r=e.normal,o=e.distance,i=Ae.inverseTranspose(t,Hs);let s=ge.fromElements(r.x,r.y,r.z,o,Ws);s=Ae.multiplyByVector(i,s,s);const a=Z.fromCartesian4(s,Xs);return s=ge.divideByScalar(s,Z.magnitude(a),s),ks.fromCartesian4(s,n)},ks.clone=function(e,t){return M.typeOf.object("plane",e),_(t)?(Z.clone(e.normal,t.normal),t.distance=e.distance,t):new ks(e.normal,e.distance)},ks.equals=function(e,t){return M.typeOf.object("left",e),M.typeOf.object("right",t),e.distance===t.distance&&Z.equals(e.normal,t.normal)},ks.ORIGIN_XY_PLANE=Object.freeze(new ks(Z.UNIT_Z,0)),ks.ORIGIN_YZ_PLANE=Object.freeze(new ks(Z.UNIT_X,0)),ks.ORIGIN_ZX_PLANE=Object.freeze(new ks(Z.UNIT_Y,0));const $s=new ge;function Ys(e,t){if(M.defined("origin",e),!_(e=(t=y(t,ot.default)).scaleToGeodeticSurface(e)))throw new g("origin must not be at the center of the ellipsoid.");const n=To.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=Z.fromCartesian4(Ae.getColumn(n,0,$s)),this._yAxis=Z.fromCartesian4(Ae.getColumn(n,1,$s));const r=Z.fromCartesian4(Ae.getColumn(n,2,$s));this._plane=ks.fromPointNormal(e,r)}Object.defineProperties(Ys.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});const Zs=new rs;Ys.fromPoints=function(e,t){M.defined("cartesians",e);return new Ys(rs.fromPoints(e,Zs).center,t)};const Qs=new ps,Ks=new Z;Ys.prototype.projectPointOntoPlane=function(e,t){M.defined("cartesian",e);const n=Qs;n.origin=e,Z.normalize(e,n.direction);let r=hs.rayPlane(n,this._plane,Ks);if(_(r)||(Z.negate(n.direction,n.direction),r=hs.rayPlane(n,this._plane,Ks)),_(r)){const e=Z.subtract(r,this._origin,r),n=Z.dot(this._xAxis,e),o=Z.dot(this._yAxis,e);return _(t)?(t.x=n,t.y=o,t):new Ve(n,o)}},Ys.prototype.projectPointsOntoPlane=function(e,t){M.defined("cartesians",e),_(t)||(t=[]);let n=0;const r=e.length;for(let o=0;o<r;o++){const r=this.projectPointOntoPlane(e[o],t[n]);_(r)&&(t[n]=r,n++)}return t.length=n,t},Ys.prototype.projectPointToNearestOnPlane=function(e,t){M.defined("cartesian",e),_(t)||(t=new Ve);const n=Qs;n.origin=e,Z.clone(this._plane.normal,n.direction);let r=hs.rayPlane(n,this._plane,Ks);_(r)||(Z.negate(n.direction,n.direction),r=hs.rayPlane(n,this._plane,Ks));const o=Z.subtract(r,this._origin,r),i=Z.dot(this._xAxis,o),s=Z.dot(this._yAxis,o);return t.x=i,t.y=s,t},Ys.prototype.projectPointsToNearestOnPlane=function(e,t){M.defined("cartesians",e),_(t)||(t=[]);const n=e.length;t.length=n;for(let r=0;r<n;r++)t[r]=this.projectPointToNearestOnPlane(e[r],t[r]);return t};const Js=new Z;function ea(e,t){this.center=Z.clone(y(e,Z.ZERO)),this.halfAxes=oe.clone(y(t,oe.ZERO))}Ys.prototype.projectPointOntoEllipsoid=function(e,t){M.defined("cartesian",e),_(t)||(t=new Z);const n=this._ellipsoid,r=this._origin,o=this._xAxis,i=this._yAxis,s=Js;return Z.multiplyByScalar(o,e.x,s),t=Z.add(r,s,t),Z.multiplyByScalar(i,e.y,s),Z.add(t,s,t),n.scaleToGeocentricSurface(t,t),t},Ys.prototype.projectPointsOntoEllipsoid=function(e,t){M.defined("cartesians",e);const n=e.length;_(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.projectPointOntoEllipsoid(e[r],t[r]);return t},ea.packedLength=Z.packedLength+oe.packedLength,ea.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),Z.pack(e.center,t,n),oe.pack(e.halfAxes,t,n+Z.packedLength),t},ea.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new ea),Z.unpack(e,t,n.center),oe.unpack(e,t+Z.packedLength,n.halfAxes),n};const ta=new Z,na=new Z,ra=new Z,oa=new Z,ia=new Z,sa=new Z,aa=new oe,ua={unitary:new oe,diagonal:new oe};ea.fromPoints=function(e,t){if(_(t)||(t=new ea),!_(e)||0===e.length)return t.halfAxes=oe.ZERO,t.center=Z.ZERO,t;let n;const r=e.length,o=Z.clone(e[0],ta);for(n=1;n<r;n++)Z.add(o,e[n],o);const i=1/r;Z.multiplyByScalar(o,i,o);let s,a=0,u=0,c=0,l=0,f=0,p=0;for(n=0;n<r;n++)s=Z.subtract(e[n],o,na),a+=s.x*s.x,u+=s.x*s.y,c+=s.x*s.z,l+=s.y*s.y,f+=s.y*s.z,p+=s.z*s.z;a*=i,u*=i,c*=i,l*=i,f*=i,p*=i;const h=aa;h[0]=a,h[1]=u,h[2]=c,h[3]=u,h[4]=l,h[5]=f,h[6]=c,h[7]=f,h[8]=p;const d=oe.computeEigenDecomposition(h,ua),m=oe.clone(d.unitary,t.halfAxes);let y=oe.getColumn(m,0,oa),g=oe.getColumn(m,1,ia),b=oe.getColumn(m,2,sa),E=-Number.MAX_VALUE,O=-Number.MAX_VALUE,w=-Number.MAX_VALUE,v=Number.MAX_VALUE,T=Number.MAX_VALUE,x=Number.MAX_VALUE;for(n=0;n<r;n++)s=e[n],E=Math.max(Z.dot(y,s),E),O=Math.max(Z.dot(g,s),O),w=Math.max(Z.dot(b,s),w),v=Math.min(Z.dot(y,s),v),T=Math.min(Z.dot(g,s),T),x=Math.min(Z.dot(b,s),x);y=Z.multiplyByScalar(y,.5*(v+E),y),g=Z.multiplyByScalar(g,.5*(T+O),g),b=Z.multiplyByScalar(b,.5*(x+w),b);const R=Z.add(y,g,t.center);Z.add(R,b,R);const A=ra;return A.x=E-v,A.y=O-T,A.z=w-x,Z.multiplyByScalar(A,.5,A),oe.multiplyByScale(t.halfAxes,A,t.halfAxes),t};const ca=new Z,la=new Z;function fa(e,t,n,r,o,i,s,a,u,c,l){if(!(_(o)&&_(i)&&_(s)&&_(a)&&_(u)&&_(c)))throw new g("all extents (minimum/maximum X/Y/Z) are required.");_(l)||(l=new ea);const f=l.halfAxes;oe.setColumn(f,0,t,f),oe.setColumn(f,1,n,f),oe.setColumn(f,2,r,f);let p=ca;p.x=(o+i)/2,p.y=(s+a)/2,p.z=(u+c)/2;const h=la;h.x=(i-o)/2,h.y=(a-s)/2,h.z=(c-u)/2;const d=l.center;return p=oe.multiplyByVector(f,p,p),Z.add(e,p,d),oe.multiplyByScale(f,h,f),l}const pa=new Je,ha=new Z,da=new Je,ma=new Je,ya=new Je,_a=new Je,ga=new Je,ba=new Z,Ea=new Z,Oa=new Z,wa=new Z,va=new Z,Ta=new Ve,xa=new Ve,Ra=new Ve,Aa=new Ve,Sa=new Ve,Ia=new Z,Na=new Z,Ca=new Z,Pa=new Z,Ma=new Ve,ja=new Z,Ua=new Z,Fa=new Z,qa=new ks(Z.UNIT_X,0);ea.fromRectangle=function(e,t,n,r,o){if(!_(e))throw new g("rectangle is required");if(e.width<0||e.width>U.TWO_PI)throw new g("Rectangle width must be between 0 and 2 * pi");if(e.height<0||e.height>U.PI)throw new g("Rectangle height must be between 0 and pi");if(_(r)&&!U.equalsEpsilon(r.radii.x,r.radii.y,U.EPSILON15))throw new g("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");let i,s,a,u,c,l,f;if(t=y(t,0),n=y(n,0),r=y(r,ot.default),e.width<=U.PI){const p=li.center(e,pa),h=new Ys(r.cartographicToCartesian(p,ha),r);f=h.plane;const d=p.longitude,m=e.south<0&&e.north>0?0:p.latitude,y=Je.fromRadians(d,e.north,n,da),_=Je.fromRadians(e.west,e.north,n,ma),g=Je.fromRadians(e.west,m,n,ya),b=Je.fromRadians(e.west,e.south,n,_a),E=Je.fromRadians(d,e.south,n,ga),O=r.cartographicToCartesian(y,ba);let w=r.cartographicToCartesian(_,Ea);const v=r.cartographicToCartesian(g,Oa);let T=r.cartographicToCartesian(b,wa);const x=r.cartographicToCartesian(E,va),R=h.projectPointToNearestOnPlane(O,Ta),A=h.projectPointToNearestOnPlane(w,xa),S=h.projectPointToNearestOnPlane(v,Ra),I=h.projectPointToNearestOnPlane(T,Aa),N=h.projectPointToNearestOnPlane(x,Sa);return i=Math.min(A.x,S.x,I.x),s=-i,u=Math.max(A.y,R.y),a=Math.min(I.y,N.y),_.height=b.height=t,w=r.cartographicToCartesian(_,Ea),T=r.cartographicToCartesian(b,wa),c=Math.min(ks.getPointDistance(f,w),ks.getPointDistance(f,T)),l=n,fa(h.origin,h.xAxis,h.yAxis,h.zAxis,i,s,a,u,c,l,o)}const p=e.south>0,h=e.north<0,d=p?e.south:h?e.north:0,m=li.center(e,pa).longitude,b=Z.fromRadians(m,d,n,r,Ia);b.z=0;const E=Math.abs(b.x)<U.EPSILON10&&Math.abs(b.y)<U.EPSILON10?Z.UNIT_X:Z.normalize(b,Na),O=Z.UNIT_Z,w=Z.cross(E,O,Ca);f=ks.fromPointNormal(b,E,qa);const v=Z.fromRadians(m+U.PI_OVER_TWO,d,n,r,Pa);s=Z.dot(ks.projectPointOntoPlane(f,v,Ma),w),i=-s,u=Z.fromRadians(0,e.north,h?t:n,r,ja).z,a=Z.fromRadians(0,e.south,p?t:n,r,Ua).z;const T=Z.fromRadians(e.east,d,n,r,Fa);return c=ks.getPointDistance(f,T),l=0,fa(b,w,O,E,i,s,a,u,c,l,o)},ea.fromTransformation=function(e,t){return M.typeOf.object("transformation",e),_(t)||(t=new ea),t.center=Ae.getTranslation(e,t.center),t.halfAxes=Ae.getMatrix3(e,t.halfAxes),t.halfAxes=oe.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},ea.clone=function(e,t){if(_(e))return _(t)?(Z.clone(e.center,t.center),oe.clone(e.halfAxes,t.halfAxes),t):new ea(e.center,e.halfAxes)},ea.intersectPlane=function(e,t){if(!_(e))throw new g("box is required.");if(!_(t))throw new g("plane is required.");const n=e.center,r=t.normal,o=e.halfAxes,i=r.x,s=r.y,a=r.z,u=Math.abs(i*o[oe.COLUMN0ROW0]+s*o[oe.COLUMN0ROW1]+a*o[oe.COLUMN0ROW2])+Math.abs(i*o[oe.COLUMN1ROW0]+s*o[oe.COLUMN1ROW1]+a*o[oe.COLUMN1ROW2])+Math.abs(i*o[oe.COLUMN2ROW0]+s*o[oe.COLUMN2ROW1]+a*o[oe.COLUMN2ROW2]),c=Z.dot(r,n)+t.distance;return c<=-u?mt.OUTSIDE:c>=u?mt.INSIDE:mt.INTERSECTING};const La=new Z,Da=new Z,Ba=new Z,za=new Z,ka=new Z,Ga=new Z;ea.distanceSquaredTo=function(e,t){if(!_(e))throw new g("box is required.");if(!_(t))throw new g("cartesian is required.");const n=Z.subtract(t,e.center,ca),r=e.halfAxes;let o=oe.getColumn(r,0,La),i=oe.getColumn(r,1,Da),s=oe.getColumn(r,2,Ba);const a=Z.magnitude(o),u=Z.magnitude(i),c=Z.magnitude(s);let l=!0,f=!0,p=!0;a>0?Z.divideByScalar(o,a,o):l=!1,u>0?Z.divideByScalar(i,u,i):f=!1,c>0?Z.divideByScalar(s,c,s):p=!1;const h=!l+!f+!p;let d,m,y;if(1===h){let e=o;d=i,m=s,f?p||(e=s,m=o):(e=i,d=o),y=Z.cross(d,m,ka),e===o?o=y:e===i?i=y:e===s&&(s=y)}else if(2===h){d=o,f?d=i:p&&(d=s);let e=Z.UNIT_Y;e.equalsEpsilon(d,U.EPSILON3)&&(e=Z.UNIT_X),m=Z.cross(d,e,za),Z.normalize(m,m),y=Z.cross(d,m,ka),Z.normalize(y,y),d===o?(i=m,s=y):d===i?(s=m,o=y):d===s&&(o=m,i=y)}else 3===h&&(o=Z.UNIT_X,i=Z.UNIT_Y,s=Z.UNIT_Z);const b=Ga;b.x=Z.dot(n,o),b.y=Z.dot(n,i),b.z=Z.dot(n,s);let E,O=0;return b.x<-a?(E=b.x+a,O+=E*E):b.x>a&&(E=b.x-a,O+=E*E),b.y<-u?(E=b.y+u,O+=E*E):b.y>u&&(E=b.y-u,O+=E*E),b.z<-c?(E=b.z+c,O+=E*E):b.z>c&&(E=b.z-c,O+=E*E),O};const Va=new Z,Ha=new Z;ea.computePlaneDistances=function(e,t,n,r){if(!_(e))throw new g("box is required.");if(!_(t))throw new g("position is required.");if(!_(n))throw new g("direction is required.");_(r)||(r=new yt);let o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const s=e.center,a=e.halfAxes,u=oe.getColumn(a,0,La),c=oe.getColumn(a,1,Da),l=oe.getColumn(a,2,Ba),f=Z.add(u,c,Va);Z.add(f,l,f),Z.add(f,s,f);const p=Z.subtract(f,t,Ha);let h=Z.dot(n,p);return o=Math.min(h,o),i=Math.max(h,i),Z.add(s,u,f),Z.add(f,c,f),Z.subtract(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Z.add(s,u,f),Z.subtract(f,c,f),Z.add(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Z.add(s,u,f),Z.subtract(f,c,f),Z.subtract(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Z.subtract(s,u,f),Z.add(f,c,f),Z.add(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Z.subtract(s,u,f),Z.add(f,c,f),Z.subtract(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Z.subtract(s,u,f),Z.subtract(f,c,f),Z.add(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),Z.subtract(s,u,f),Z.subtract(f,c,f),Z.subtract(f,l,f),Z.subtract(f,t,p),h=Z.dot(n,p),o=Math.min(h,o),i=Math.max(h,i),r.start=o,r.stop=i,r};const Wa=new Z,Xa=new Z,$a=new Z;ea.computeCorners=function(e,t){M.typeOf.object("box",e),_(t)||(t=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z]);const n=e.center,r=e.halfAxes,o=oe.getColumn(r,0,Wa),i=oe.getColumn(r,1,Xa),s=oe.getColumn(r,2,$a);return Z.clone(n,t[0]),Z.subtract(t[0],o,t[0]),Z.subtract(t[0],i,t[0]),Z.subtract(t[0],s,t[0]),Z.clone(n,t[1]),Z.subtract(t[1],o,t[1]),Z.subtract(t[1],i,t[1]),Z.add(t[1],s,t[1]),Z.clone(n,t[2]),Z.subtract(t[2],o,t[2]),Z.add(t[2],i,t[2]),Z.subtract(t[2],s,t[2]),Z.clone(n,t[3]),Z.subtract(t[3],o,t[3]),Z.add(t[3],i,t[3]),Z.add(t[3],s,t[3]),Z.clone(n,t[4]),Z.add(t[4],o,t[4]),Z.subtract(t[4],i,t[4]),Z.subtract(t[4],s,t[4]),Z.clone(n,t[5]),Z.add(t[5],o,t[5]),Z.subtract(t[5],i,t[5]),Z.add(t[5],s,t[5]),Z.clone(n,t[6]),Z.add(t[6],o,t[6]),Z.add(t[6],i,t[6]),Z.subtract(t[6],s,t[6]),Z.clone(n,t[7]),Z.add(t[7],o,t[7]),Z.add(t[7],i,t[7]),Z.add(t[7],s,t[7]),t};const Ya=new oe;ea.computeTransformation=function(e,t){M.typeOf.object("box",e),_(t)||(t=new Ae);const n=e.center,r=oe.multiplyByUniformScale(e.halfAxes,2,Ya);return Ae.fromRotationTranslation(r,n,t)};const Za=new gi;ea.isOccluded=function(e,t){if(!_(e))throw new g("box is required.");if(!_(t))throw new g("occluder is required.");const n=gi.fromOrientedBoundingBox(e,Za);return!t.isBoundingSphereVisible(n)},ea.prototype.intersectPlane=function(e){return ea.intersectPlane(this,e)},ea.prototype.distanceSquaredTo=function(e){return ea.distanceSquaredTo(this,e)},ea.prototype.computePlaneDistances=function(e,t,n){return ea.computePlaneDistances(this,e,t,n)},ea.prototype.computeCorners=function(e){return ea.computeCorners(this,e)},ea.prototype.computeTransformation=function(e){return ea.computeTransformation(this,e)},ea.prototype.isOccluded=function(e){return ea.isOccluded(this,e)},ea.equals=function(e,t){return e===t||_(e)&&_(t)&&Z.equals(e.center,t.center)&&oe.equals(e.halfAxes,t.halfAxes)},ea.prototype.clone=function(e){return ea.clone(this,e)},ea.prototype.equals=function(e){return ea.equals(this,e)};const Qa={},Ka=new Z,Ja=new Z,eu=new Z,tu=new Z,nu=new ea;function ru(e,t,n,r,o){const i=Z.subtract(e,t,Ka),s=Z.dot(n,i),a=Z.dot(r,i);return Ve.fromElements(s,a,o)}function ou(e,t,n=2){const r=t&&t.length,o=r?t[0]*n:e.length;let i=iu(e,0,o,n,!0);const s=[];if(!i||i.next===i.prev)return s;let a,u,c;if(r&&(i=function(e,t,n,r){const o=[];for(let n=0,i=t.length;n<i;n++){const s=iu(e,t[n]*r,n<i-1?t[n+1]*r:e.length,r,!1);s===s.next&&(s.steiner=!0),o.push(yu(s))}o.sort(pu);for(let e=0;e<o.length;e++)n=hu(o[e],n);return n}(e,t,i,n)),e.length>80*n){a=1/0,u=1/0;let t=-1/0,r=-1/0;for(let i=n;i<o;i+=n){const n=e[i],o=e[i+1];n<a&&(a=n),o<u&&(u=o),n>t&&(t=n),o>r&&(r=o)}c=Math.max(t-a,r-u),c=0!==c?32767/c:0}return au(i,s,n,a,u,c,0),s}function iu(e,t,n,r,o){let i;if(o===function(e,t,n,r){let o=0;for(let i=t,s=n-r;i<n;i+=r)o+=(e[s]-e[i])*(e[i+1]+e[s+1]),s=i;return o}(e,t,n,r)>0)for(let o=t;o<n;o+=r)i=Ru(o/r|0,e[o],e[o+1],i);else for(let o=n-r;o>=t;o-=r)i=Ru(o/r|0,e[o],e[o+1],i);return i&&Eu(i,i.next)&&(Au(i),i=i.next),i}function su(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Eu(r,r.next)&&0!==bu(r.prev,r,r.next))r=r.next;else{if(Au(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function au(e,t,n,r,o,i,s){if(!e)return;!s&&i&&function(e,t,n,r){let o=e;do{0===o.z&&(o.z=mu(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){let t,n=1;do{let r,o=e;e=null;let i=null;for(t=0;o;){t++;let s=o,a=0;for(let e=0;e<n&&(a++,s=s.nextZ,s);e++);let u=n;for(;a>0||u>0&&s;)0!==a&&(0===u||!s||o.z<=s.z)?(r=o,o=o.nextZ,a--):(r=s,s=s.nextZ,u--),i?i.nextZ=r:e=r,r.prevZ=i,i=r;o=s}i.nextZ=null,n*=2}while(t>1)}(o)}(e,r,o,i);let a=e;for(;e.prev!==e.next;){const u=e.prev,c=e.next;if(i?cu(e,r,o,i):uu(e))t.push(u.i,e.i,c.i),Au(e),e=c.next,a=c.next;else if((e=c)===a){s?1===s?au(e=lu(su(e),t),t,n,r,o,i,2):2===s&&fu(e,t,n,r,o,i):au(su(e),t,n,r,o,i,1);break}}}function uu(e){const t=e.prev,n=e,r=e.next;if(bu(t,n,r)>=0)return!1;const o=t.x,i=n.x,s=r.x,a=t.y,u=n.y,c=r.y,l=o<i?o<s?o:s:i<s?i:s,f=a<u?a<c?a:c:u<c?u:c,p=o>i?o>s?o:s:i>s?i:s,h=a>u?a>c?a:c:u>c?u:c;let d=r.next;for(;d!==t;){if(d.x>=l&&d.x<=p&&d.y>=f&&d.y<=h&&_u(o,a,i,u,s,c,d.x,d.y)&&bu(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function cu(e,t,n,r){const o=e.prev,i=e,s=e.next;if(bu(o,i,s)>=0)return!1;const a=o.x,u=i.x,c=s.x,l=o.y,f=i.y,p=s.y,h=a<u?a<c?a:c:u<c?u:c,d=l<f?l<p?l:p:f<p?f:p,m=a>u?a>c?a:c:u>c?u:c,y=l>f?l>p?l:p:f>p?f:p,_=mu(h,d,t,n,r),g=mu(m,y,t,n,r);let b=e.prevZ,E=e.nextZ;for(;b&&b.z>=_&&E&&E.z<=g;){if(b.x>=h&&b.x<=m&&b.y>=d&&b.y<=y&&b!==o&&b!==s&&_u(a,l,u,f,c,p,b.x,b.y)&&bu(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,E.x>=h&&E.x<=m&&E.y>=d&&E.y<=y&&E!==o&&E!==s&&_u(a,l,u,f,c,p,E.x,E.y)&&bu(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;b&&b.z>=_;){if(b.x>=h&&b.x<=m&&b.y>=d&&b.y<=y&&b!==o&&b!==s&&_u(a,l,u,f,c,p,b.x,b.y)&&bu(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;E&&E.z<=g;){if(E.x>=h&&E.x<=m&&E.y>=d&&E.y<=y&&E!==o&&E!==s&&_u(a,l,u,f,c,p,E.x,E.y)&&bu(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function lu(e,t){let n=e;do{const r=n.prev,o=n.next.next;!Eu(r,o)&&Ou(r,n,n.next,o)&&Tu(r,o)&&Tu(o,r)&&(t.push(r.i,n.i,o.i),Au(n),Au(n.next),n=e=o),n=n.next}while(n!==e);return su(n)}function fu(e,t,n,r,o,i){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&gu(s,e)){let a=xu(s,e);return s=su(s,s.next),a=su(a,a.next),au(s,t,n,r,o,i,0),void au(a,t,n,r,o,i,0)}e=e.next}s=s.next}while(s!==e)}function pu(e,t){return e.x-t.x}function hu(e,t){const n=function(e,t){let n=t;const r=e.x,o=e.y;let i,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const e=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s&&(s=e,i=n.x<n.next.x?n:n.next,e===r))return i}n=n.next}while(n!==t);if(!i)return null;const a=i,u=i.x,c=i.y;let l=1/0;n=i;do{if(r>=n.x&&n.x>=u&&r!==n.x&&_u(o<c?r:s,o,u,c,o<c?s:r,o,n.x,n.y)){const t=Math.abs(o-n.y)/(r-n.x);Tu(n,e)&&(t<l||t===l&&(n.x>i.x||n.x===i.x&&du(i,n)))&&(i=n,l=t)}n=n.next}while(n!==a);return i}(e,t);if(!n)return t;const r=xu(n,e);return su(r,r.next),su(n,n.next)}function du(e,t){return bu(e.prev,e,t.prev)<0&&bu(t.next,e,e.next)<0}function mu(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function yu(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function _u(e,t,n,r,o,i,s,a){return(o-s)*(t-a)>=(e-s)*(i-a)&&(e-s)*(r-a)>=(n-s)*(t-a)&&(n-s)*(i-a)>=(o-s)*(r-a)}function gu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ou(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Tu(e,t)&&Tu(t,e)&&function(e,t){let n=e,r=!1;const o=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(bu(e.prev,e,t.prev)||bu(e,t.prev,t))||Eu(e,t)&&bu(e.prev,e,e.next)>0&&bu(t.prev,t,t.next)>0)}function bu(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Eu(e,t){return e.x===t.x&&e.y===t.y}function Ou(e,t,n,r){const o=vu(bu(e,t,n)),i=vu(bu(e,t,r)),s=vu(bu(n,r,e)),a=vu(bu(n,r,t));return o!==i&&s!==a||(!(0!==o||!wu(e,n,t))||(!(0!==i||!wu(e,r,t))||(!(0!==s||!wu(n,e,r))||!(0!==a||!wu(n,t,r)))))}function wu(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function vu(e){return e>0?1:e<0?-1:0}function Tu(e,t){return bu(e.prev,e,e.next)<0?bu(e,t,e.next)>=0&&bu(e,e.prev,t)>=0:bu(e,t,e.prev)<0||bu(e,e.next,t)<0}function xu(e,t){const n=Su(e.i,e.x,e.y),r=Su(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Ru(e,t,n,r){const o=Su(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Au(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Su(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Iu(e,t,n){if(0===e)return t*n;const r=e*e,o=r*r,i=o*r,s=i*r,a=s*r,u=a*r,c=n;return t*((1-r/4-3*o/64-5*i/256-175*s/16384-441*a/65536-4851*u/1048576)*c-(3*r/8+3*o/32+45*i/1024+105*s/4096+2205*a/131072+6237*u/524288)*Math.sin(2*c)+(15*o/256+45*i/1024+525*s/16384+1575*a/65536+155925*u/8388608)*Math.sin(4*c)-(35*i/3072+175*s/12288+3675*a/262144+13475*u/1048576)*Math.sin(6*c)+(315*s/131072+2205*a/524288+43659*u/8388608)*Math.sin(8*c)-(693*a/1310720+6237*u/5242880)*Math.sin(10*c)+1001*u/8388608*Math.sin(12*c))}function Nu(e,t){if(0===e)return Math.log(Math.tan(.5*(U.PI_OVER_TWO+t)));const n=e*Math.sin(t);return Math.log(Math.tan(.5*(U.PI_OVER_TWO+t)))-e/2*Math.log((1+n)/(1-n))}Qa.validOutline=function(e){M.defined("positions",e);const t=ea.fromPoints(e,nu).halfAxes,n=oe.getColumn(t,0,Ja),r=oe.getColumn(t,1,eu),o=oe.getColumn(t,2,tu),i=Z.magnitude(n),s=Z.magnitude(r),a=Z.magnitude(o);return!(0===i&&(0===s||0===a)||0===s&&0===a)},Qa.computeProjectTo2DArguments=function(e,t,n,r){M.defined("positions",e),M.defined("centerResult",t),M.defined("planeAxis1Result",n),M.defined("planeAxis2Result",r);const o=ea.fromPoints(e,nu),i=o.halfAxes,s=oe.getColumn(i,0,Ja),a=oe.getColumn(i,1,eu),u=oe.getColumn(i,2,tu),c=Z.magnitude(s),l=Z.magnitude(a),f=Z.magnitude(u),p=Math.min(c,l,f);if(0===c&&(0===l||0===f)||0===l&&0===f)return!1;let h,d;return p!==l&&p!==f||(h=s),p===c?h=a:p===f&&(d=a),p!==c&&p!==l||(d=u),Z.normalize(h,n),Z.normalize(d,r),Z.clone(o.center,t),!0},Qa.createProjectPointsTo2DFunction=function(e,t,n){return function(r){const o=new Array(r.length);for(let i=0;i<r.length;i++)o[i]=ru(r[i],e,t,n);return o}},Qa.createProjectPointTo2DFunction=function(e,t,n){return function(r,o){return ru(r,e,t,n,o)}};const Cu=new Z,Pu=new Z;function Mu(e,t,n,r){const o=Z.normalize(r.cartographicToCartesian(t,Pu),Cu),i=Z.normalize(r.cartographicToCartesian(n,Pu),Pu);M.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(Z.angleBetween(o,i))-Math.PI),.0125);const s=r.maximumRadius,a=r.minimumRadius,u=s*s,c=a*a;e._ellipticitySquared=(u-c)/u,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=Je.clone(t,e._start),e._start.height=0,e._end=Je.clone(n,e._end),e._end.height=0,e._heading=function(e,t,n,r,o){const i=Nu(e._ellipticity,n),s=Nu(e._ellipticity,o);return Math.atan2(U.negativePiToPi(r-t),s-i)}(e,t.longitude,t.latitude,n.longitude,n.latitude),e._distance=function(e,t,n,r,o,i,s){const a=e._heading,u=i-r;let c=0;if(U.equalsEpsilon(Math.abs(a),U.PI_OVER_TWO,U.EPSILON8))if(t===n)c=t*Math.cos(o)*U.negativePiToPi(u);else{const n=Math.sin(o);c=t*Math.cos(o)*U.negativePiToPi(u)/Math.sqrt(1-e._ellipticitySquared*n*n)}else{const n=Iu(e._ellipticity,t,o);c=(Iu(e._ellipticity,t,s)-n)/Math.cos(a)}return Math.abs(c)}(e,r.maximumRadius,r.minimumRadius,t.longitude,t.latitude,n.longitude,n.latitude)}function ju(e,t,n,r,o,i){if(0===n)return Je.clone(e,i);const s=o*o;let a,u,c;if(Math.abs(U.PI_OVER_TWO-Math.abs(t))>U.EPSILON8){if(u=function(e,t,n){const r=e/n;if(0===t)return r;const o=r*r,i=o*r,s=i*r,a=t*t,u=a*a,c=u*a,l=c*a,f=l*a,p=f*a,h=Math.sin(2*r),d=Math.cos(2*r),m=Math.sin(4*r),y=Math.cos(4*r),_=Math.sin(6*r),g=Math.cos(6*r),b=Math.sin(8*r),E=Math.cos(8*r),O=Math.sin(10*r);return r+r*a/4+7*r*u/64+15*r*c/256+579*r*l/16384+1515*r*f/65536+16837*r*p/1048576+(3*r*u/16+45*r*c/256-r*(32*o-561)*l/4096-r*(232*o-1677)*f/16384+r*(399985-90560*o+512*s)*p/5242880)*d+(21*r*c/256+483*r*l/4096-r*(224*o-1969)*f/16384-r*(33152*o-112599)*p/1048576)*y+(151*r*l/4096+4681*r*f/65536+1479*r*p/16384-453*i*p/32768)*g+(1097*r*f/65536+42783*r*p/1048576)*E+8011*r*p/1048576*Math.cos(10*r)+(3*a/8+3*u/16+213*c/2048-3*o*c/64+255*l/4096-33*o*l/512+20861*f/524288-33*o*f/512+s*f/1024+28273*p/1048576-471*o*p/8192+9*s*p/4096)*h+(21*u/256+21*c/256+533*l/8192-21*o*l/512+197*f/4096-315*o*f/4096+584039*p/16777216-12517*o*p/131072+7*s*p/2048)*m+(151*c/6144+151*l/4096+5019*f/131072-453*o*f/16384+26965*p/786432-8607*o*p/131072)*_+(1097*l/131072+1097*f/65536+225797*p/10485760-1097*o*p/65536)*b+(8011*f/2621440+8011*p/1048576)*O+293393*p/251658240*Math.sin(12*r)}(Iu(o,r,e.latitude)+n*Math.cos(t),o,r),Math.abs(t)<U.EPSILON10)a=U.negativePiToPi(e.longitude);else{const n=Nu(o,e.latitude),r=Nu(o,u);c=Math.tan(t)*(r-n),a=U.negativePiToPi(e.longitude+c)}}else{let i;if(u=e.latitude,0===o)i=r*Math.cos(e.latitude);else{const t=Math.sin(e.latitude);i=r*Math.cos(e.latitude)/Math.sqrt(1-s*t*t)}c=n/i,a=t>0?U.negativePiToPi(e.longitude+c):U.negativePiToPi(e.longitude-c)}return _(i)?(i.longitude=a,i.latitude=u,i.height=0,i):new Je(a,u,0)}function Uu(e,t,n){const r=y(n,ot.default);this._ellipsoid=r,this._start=new Je,this._end=new Je,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,_(e)&&_(t)&&Mu(this,e,t,r)}Object.defineProperties(Uu.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return M.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return M.defined("distance",this._distance),this._heading}}}),Uu.fromStartHeadingDistance=function(e,t,n,r,o){M.defined("start",e),M.defined("heading",t),M.defined("distance",n),M.typeOf.number.greaterThan("distance",n,0);const i=y(r,ot.default),s=i.maximumRadius,a=i.minimumRadius,u=s*s,c=a*a,l=Math.sqrt((u-c)/u),f=ju(e,t=U.negativePiToPi(t),n,i.maximumRadius,l);return!_(o)||_(r)&&!r.equals(o.ellipsoid)?new Uu(e,f,i):(o.setEndPoints(e,f),o)},Uu.prototype.setEndPoints=function(e,t){M.defined("start",e),M.defined("end",t),Mu(this,e,t,this._ellipsoid)},Uu.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)},Uu.prototype.interpolateUsingSurfaceDistance=function(e,t){if(M.typeOf.number("distance",e),!_(this._distance)||0===this._distance)throw new g("EllipsoidRhumbLine must have distinct start and end set.");return ju(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)},Uu.prototype.findIntersectionWithLongitude=function(e,t){if(M.typeOf.number("intersectionLongitude",e),!_(this._distance)||0===this._distance)throw new g("EllipsoidRhumbLine must have distinct start and end set.");const n=this._ellipticity,r=this._heading,o=Math.abs(r),i=this._start;if(e=U.negativePiToPi(e),U.equalsEpsilon(Math.abs(e),Math.PI,U.EPSILON14)&&(e=U.sign(i.longitude)*Math.PI),_(t)||(t=new Je),Math.abs(U.PI_OVER_TWO-o)<=U.EPSILON8)return t.longitude=e,t.latitude=i.latitude,t.height=0,t;if(U.equalsEpsilon(Math.abs(U.PI_OVER_TWO-o),U.PI_OVER_TWO,U.EPSILON8)){if(U.equalsEpsilon(e,i.longitude,U.EPSILON12))return;return t.longitude=e,t.latitude=U.PI_OVER_TWO*U.sign(U.PI_OVER_TWO-r),t.height=0,t}const s=i.latitude,a=n*Math.sin(s),u=Math.tan(.5*(U.PI_OVER_TWO+s))*Math.exp((e-i.longitude)/Math.tan(r)),c=(1+a)/(1-a);let l,f=i.latitude;do{l=f;const e=n*Math.sin(l),t=(1+e)/(1-e);f=2*Math.atan(u*Math.pow(t/c,n/2))-U.PI_OVER_TWO}while(!U.equalsEpsilon(f,l,U.EPSILON12));return t.longitude=e,t.latitude=f,t.height=0,t},Uu.prototype.findIntersectionWithLatitude=function(e,t){if(M.typeOf.number("intersectionLatitude",e),!_(this._distance)||0===this._distance)throw new g("EllipsoidRhumbLine must have distinct start and end set.");const n=this._ellipticity,r=this._heading,o=this._start;if(U.equalsEpsilon(Math.abs(r),U.PI_OVER_TWO,U.EPSILON8))return;const i=Nu(n,o.latitude),s=Nu(n,e),a=Math.tan(r)*(s-i),u=U.negativePiToPi(o.longitude+a);return _(t)?(t.longitude=u,t.latitude=e,t.height=0,t):new Je(u,e,0)};var Fu=Object.freeze({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3});function qu(e,t,n,r){this[0]=y(e,0),this[1]=y(n,0),this[2]=y(t,0),this[3]=y(r,0)}qu.packedLength=4,qu.pack=function(e,t,n){return M.typeOf.object("value",e),M.defined("array",t),n=y(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t},qu.unpack=function(e,t,n){return M.defined("array",e),t=y(t,0),_(n)||(n=new qu),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n},qu.packArray=function(e,t){M.defined("array",e);const n=e.length,r=4*n;if(_(t)){if(!Array.isArray(t)&&t.length!==r)throw new g("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let r=0;r<n;++r)qu.pack(e[r],t,4*r);return t},qu.unpackArray=function(e,t){if(M.defined("array",e),M.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new g("array length must be a multiple of 4.");const n=e.length;_(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;t[n]=qu.unpack(e,r,t[n])}return t},qu.clone=function(e,t){if(_(e))return _(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new qu(e[0],e[2],e[1],e[3])},qu.fromArray=qu.unpack,qu.fromColumnMajorArray=function(e,t){return M.defined("values",e),qu.clone(e,t)},qu.fromRowMajorArray=function(e,t){return M.defined("values",e),_(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new qu(e[0],e[1],e[2],e[3])},qu.fromScale=function(e,t){return M.typeOf.object("scale",e),_(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new qu(e.x,0,0,e.y)},qu.fromUniformScale=function(e,t){return M.typeOf.number("scale",e),_(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new qu(e,0,0,e)},qu.fromRotation=function(e,t){M.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return _(t)?(t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t):new qu(n,-r,r,n)},qu.toArray=function(e,t){return M.typeOf.object("matrix",e),_(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},qu.getElementIndex=function(e,t){return M.typeOf.number.greaterThanOrEquals("row",t,0),M.typeOf.number.lessThanOrEquals("row",t,1),M.typeOf.number.greaterThanOrEquals("column",e,0),M.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},qu.getColumn=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,1),M.typeOf.object("result",n);const r=2*t,o=e[r],i=e[r+1];return n.x=o,n.y=i,n},qu.setColumn=function(e,t,n,r){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,1),M.typeOf.object("cartesian",n),M.typeOf.object("result",r);const o=2*t;return(r=qu.clone(e,r))[o]=n.x,r[o+1]=n.y,r},qu.getRow=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,1),M.typeOf.object("result",n);const r=e[t],o=e[t+2];return n.x=r,n.y=o,n},qu.setRow=function(e,t,n,r){return M.typeOf.object("matrix",e),M.typeOf.number.greaterThanOrEquals("index",t,0),M.typeOf.number.lessThanOrEquals("index",t,1),M.typeOf.object("cartesian",n),M.typeOf.object("result",r),(r=qu.clone(e,r))[t]=n.x,r[t+2]=n.y,r};const Lu=new Ve;qu.setScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("scale",t),M.typeOf.object("result",n);const r=qu.getScale(e,Lu),o=t.x/r.x,i=t.y/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*i,n[3]=e[3]*i,n};const Du=new Ve;qu.setUniformScale=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.number("scale",t),M.typeOf.object("result",n);const r=qu.getScale(e,Du),o=t/r.x,i=t/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*i,n[3]=e[3]*i,n};const Bu=new Ve;qu.getScale=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t.x=Ve.magnitude(Ve.fromElements(e[0],e[1],Bu)),t.y=Ve.magnitude(Ve.fromElements(e[2],e[3],Bu)),t};const zu=new Ve;qu.getMaximumScale=function(e){return qu.getScale(e,zu),Ve.maximumComponent(zu)};const ku=new Ve;qu.setRotation=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("result",n);const r=qu.getScale(e,ku);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.y,n[3]=t[3]*r.y,n};const Gu=new Ve;qu.getRotation=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=qu.getScale(e,Gu);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t},qu.multiply=function(e,t,n){M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n);const r=e[0]*t[0]+e[2]*t[1],o=e[0]*t[2]+e[2]*t[3],i=e[1]*t[0]+e[3]*t[1],s=e[1]*t[2]+e[3]*t[3];return n[0]=r,n[1]=i,n[2]=o,n[3]=s,n},qu.add=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},qu.subtract=function(e,t,n){return M.typeOf.object("left",e),M.typeOf.object("right",t),M.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},qu.multiplyByVector=function(e,t,n){M.typeOf.object("matrix",e),M.typeOf.object("cartesian",t),M.typeOf.object("result",n);const r=e[0]*t.x+e[2]*t.y,o=e[1]*t.x+e[3]*t.y;return n.x=r,n.y=o,n},qu.multiplyByScalar=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.number("scalar",t),M.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},qu.multiplyByScale=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.object("scale",t),M.typeOf.object("result",n),n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n},qu.multiplyByUniformScale=function(e,t,n){return M.typeOf.object("matrix",e),M.typeOf.number("scale",t),M.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},qu.negate=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},qu.transpose=function(e,t){M.typeOf.object("matrix",e),M.typeOf.object("result",t);const n=e[0],r=e[2],o=e[1],i=e[3];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t},qu.abs=function(e,t){return M.typeOf.object("matrix",e),M.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},qu.equals=function(e,t){return e===t||_(e)&&_(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},qu.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]},qu.equalsEpsilon=function(e,t,n){return n=y(n,0),e===t||_(e)&&_(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n},qu.IDENTITY=Object.freeze(new qu(1,0,0,1)),qu.ZERO=Object.freeze(new qu(0,0,0,0)),qu.COLUMN0ROW0=0,qu.COLUMN0ROW1=1,qu.COLUMN1ROW0=2,qu.COLUMN1ROW1=3,Object.defineProperties(qu.prototype,{length:{get:function(){return qu.packedLength}}}),qu.prototype.clone=function(e){return qu.clone(this,e)},qu.prototype.equals=function(e){return qu.equals(this,e)},qu.prototype.equalsEpsilon=function(e,t){return qu.equalsEpsilon(this,e,t)},qu.prototype.toString=function(){return`(${this[0]}, ${this[2]})\n(${this[1]}, ${this[3]})`};const Vu={POINTS:b.POINTS,LINES:b.LINES,LINE_LOOP:b.LINE_LOOP,LINE_STRIP:b.LINE_STRIP,TRIANGLES:b.TRIANGLES,TRIANGLE_STRIP:b.TRIANGLE_STRIP,TRIANGLE_FAN:b.TRIANGLE_FAN,isLines:function(e){return e===Vu.LINES||e===Vu.LINE_LOOP||e===Vu.LINE_STRIP},isTriangles:function(e){return e===Vu.TRIANGLES||e===Vu.TRIANGLE_STRIP||e===Vu.TRIANGLE_FAN},validate:function(e){return e===Vu.POINTS||e===Vu.LINES||e===Vu.LINE_LOOP||e===Vu.LINE_STRIP||e===Vu.TRIANGLES||e===Vu.TRIANGLE_STRIP||e===Vu.TRIANGLE_FAN}};var Hu=Object.freeze(Vu);function Wu(e){e=y(e,y.EMPTY_OBJECT),M.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=y(e.primitiveType,Hu.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=y(e.geometryType,Fu.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}Wu.computeNumberOfVertices=function(e){M.typeOf.object("geometry",e);let t=-1;for(const n in e.attributes)if(e.attributes.hasOwnProperty(n)&&_(e.attributes[n])&&_(e.attributes[n].values)){const r=e.attributes[n],o=r.values.length/r.componentsPerAttribute;if(t!==o&&-1!==t)throw new g("All attribute lists must have the same number of attributes.");t=o}return t};const Xu=new Je,$u=new Z,Yu=new Ae,Zu=[new Je,new Je,new Je],Qu=[new Ve,new Ve,new Ve],Ku=[new Ve,new Ve,new Ve],Ju=new Z,ec=new Zr,tc=new Ae,nc=new qu;function rc(e){if(!_((e=y(e,y.EMPTY_OBJECT)).componentDatatype))throw new g("options.componentDatatype is required.");if(!_(e.componentsPerAttribute))throw new g("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||e.componentsPerAttribute>4)throw new g("options.componentsPerAttribute must be between 1 and 4.");if(!_(e.values))throw new g("options.values is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=y(e.normalize,!1),this.values=e.values}Wu._textureCoordinateRotationPoints=function(e,t,n,r){let o;const i=li.center(r,Xu),s=Je.toCartesian(i,n,$u),a=To.eastNorthUpToFixedFrame(s,n,Yu),u=Ae.inverse(a,Yu),c=Qu,l=Zu;l[0].longitude=r.west,l[0].latitude=r.south,l[1].longitude=r.west,l[1].latitude=r.north,l[2].longitude=r.east,l[2].latitude=r.south;let f=Ju;for(o=0;o<3;o++)Je.toCartesian(l[o],n,f),f=Ae.multiplyByPointAsVector(u,f,f),c[o].x=f.x,c[o].y=f.y;const p=Zr.fromAxisAngle(Z.UNIT_Z,-t,ec),h=oe.fromQuaternion(p,tc),d=e.length;let m=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(o=0;o<d;o++)f=Ae.multiplyByPointAsVector(u,e[o],f),f=oe.multiplyByVector(h,f,f),m=Math.min(m,f.x),y=Math.min(y,f.y),_=Math.max(_,f.x),g=Math.max(g,f.y);const b=qu.fromRotation(t,nc),E=Ku;E[0].x=m,E[0].y=y,E[1].x=m,E[1].y=g,E[2].x=_,E[2].y=y;const O=c[0],w=c[2].x-O.x,v=c[1].y-O.y;for(o=0;o<3;o++){const e=E[o];qu.multiplyByVector(b,e,e),e.x=(e.x-O.x)/w,e.y=(e.y-O.y)/v}const T=E[0],x=E[1],R=E[2],A=new Array(6);return Ve.pack(T,A),Ve.pack(x,A,2),Ve.pack(R,A,4),A};const oc={CLOCKWISE:b.CW,COUNTER_CLOCKWISE:b.CCW,validate:function(e){return e===oc.CLOCKWISE||e===oc.COUNTER_CLOCKWISE}};var ic=Object.freeze(oc);const sc=new Z,ac=new Z,uc={computeArea2D:function(e){M.defined("positions",e),M.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);const t=e.length;let n=0;for(let r=t-1,o=0;o<t;r=o++){const t=e[r],i=e[o];n+=t.x*i.y-i.x*t.y}return.5*n},computeWindingOrder2D:function(e){return uc.computeArea2D(e)>0?ic.COUNTER_CLOCKWISE:ic.CLOCKWISE},triangulate:function(e,t){M.defined("positions",e);return ou(Ve.packArray(e),t,2)}},cc=new Z,lc=new Z,fc=new Z,pc=new Z,hc=new Z,dc=new Z,mc=new Z,yc=new Ve,_c=new Ve,gc=new Ve,bc=new Ve;uc.computeSubdivision=function(e,t,n,r,o){o=y(o,U.RADIANS_PER_DEGREE);const i=_(r);M.typeOf.object("ellipsoid",e),M.defined("positions",t),M.defined("indices",n),M.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),M.typeOf.number.equals("indices.length % 3","0",n.length%3,0),M.typeOf.number.greaterThan("granularity",o,0);const s=n.slice(0);let a;const u=t.length,c=new Array(3*u),l=new Array(2*u);let f=0,p=0;for(a=0;a<u;a++){const e=t[a];if(c[f++]=e.x,c[f++]=e.y,c[f++]=e.z,i){const e=r[a];l[p++]=e.x,l[p++]=e.y}}const h=[],d={},m=e.maximumRadius,g=U.chordLength(o,m),b=g*g;for(;s.length>0;){const e=s.pop(),t=s.pop(),n=s.pop(),r=Z.fromArray(c,3*n,cc),o=Z.fromArray(c,3*t,lc),u=Z.fromArray(c,3*e,fc);let f,p,y;i&&(f=Ve.fromArray(l,2*n,yc),p=Ve.fromArray(l,2*t,_c),y=Ve.fromArray(l,2*e,gc));const g=Z.multiplyByScalar(Z.normalize(r,pc),m,pc),E=Z.multiplyByScalar(Z.normalize(o,hc),m,hc),O=Z.multiplyByScalar(Z.normalize(u,dc),m,dc),w=Z.magnitudeSquared(Z.subtract(g,E,mc)),v=Z.magnitudeSquared(Z.subtract(E,O,mc)),T=Z.magnitudeSquared(Z.subtract(O,g,mc)),x=Math.max(w,v,T);let R,A,S;x>b?w===x?(R=`${Math.min(n,t)} ${Math.max(n,t)}`,a=d[R],_(a)||(A=Z.add(r,o,mc),Z.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),a=c.length/3-1,d[R]=a,i&&(S=Ve.add(f,p,bc),Ve.multiplyByScalar(S,.5,S),l.push(S.x,S.y))),s.push(n,a,e),s.push(a,t,e)):v===x?(R=`${Math.min(t,e)} ${Math.max(t,e)}`,a=d[R],_(a)||(A=Z.add(o,u,mc),Z.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),a=c.length/3-1,d[R]=a,i&&(S=Ve.add(p,y,bc),Ve.multiplyByScalar(S,.5,S),l.push(S.x,S.y))),s.push(t,a,n),s.push(a,e,n)):T===x&&(R=`${Math.min(e,n)} ${Math.max(e,n)}`,a=d[R],_(a)||(A=Z.add(u,r,mc),Z.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),a=c.length/3-1,d[R]=a,i&&(S=Ve.add(y,f,bc),Ve.multiplyByScalar(S,.5,S),l.push(S.x,S.y))),s.push(e,a,t),s.push(a,n,t)):(h.push(n),h.push(t),h.push(e))}const E={attributes:{position:new rc({componentDatatype:O.DOUBLE,componentsPerAttribute:3,values:c})},indices:h,primitiveType:Hu.TRIANGLES};return i&&(E.attributes.st=new rc({componentDatatype:O.FLOAT,componentsPerAttribute:2,values:l})),new Wu(E)};const Ec=new Je,Oc=new Je,wc=new Je,vc=new Je;function Tc(){this.name=void 0,this.meshes=[]}function xc(){this.name=void 0,this.primitives=[]}function Rc(){this.material=void 0,this.indices=new w(O.UNSIGNED_INT),this.positions=new w(O.FLOAT),this.normals=new w(O.FLOAT),this.uvs=new w(O.FLOAT)}uc.computeRhumbLineSubdivision=function(e,t,n,r,o){o=y(o,U.RADIANS_PER_DEGREE);const i=_(r);M.typeOf.object("ellipsoid",e),M.defined("positions",t),M.defined("indices",n),M.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),M.typeOf.number.equals("indices.length % 3","0",n.length%3,0),M.typeOf.number.greaterThan("granularity",o,0);const s=n.slice(0);let a;const u=t.length,c=new Array(3*u),l=new Array(2*u);let f=0,p=0;for(a=0;a<u;a++){const e=t[a];if(c[f++]=e.x,c[f++]=e.y,c[f++]=e.z,i){const e=r[a];l[p++]=e.x,l[p++]=e.y}}const h=[],d={},m=e.maximumRadius,g=U.chordLength(o,m),b=new Uu(void 0,void 0,e),E=new Uu(void 0,void 0,e),w=new Uu(void 0,void 0,e);for(;s.length>0;){const t=s.pop(),n=s.pop(),r=s.pop(),o=Z.fromArray(c,3*r,cc),u=Z.fromArray(c,3*n,lc),f=Z.fromArray(c,3*t,fc);let p,m,y;i&&(p=Ve.fromArray(l,2*r,yc),m=Ve.fromArray(l,2*n,_c),y=Ve.fromArray(l,2*t,gc));const O=e.cartesianToCartographic(o,Ec),v=e.cartesianToCartographic(u,Oc),T=e.cartesianToCartographic(f,wc);b.setEndPoints(O,v);const x=b.surfaceDistance;E.setEndPoints(v,T);const R=E.surfaceDistance;w.setEndPoints(T,O);const A=w.surfaceDistance,S=Math.max(x,R,A);let I,N,C,P,M;S>g?x===S?(I=`${Math.min(r,n)} ${Math.max(r,n)}`,a=d[I],_(a)||(N=b.interpolateUsingFraction(.5,vc),C=.5*(O.height+v.height),P=Z.fromRadians(N.longitude,N.latitude,C,e,mc),c.push(P.x,P.y,P.z),a=c.length/3-1,d[I]=a,i&&(M=Ve.add(p,m,bc),Ve.multiplyByScalar(M,.5,M),l.push(M.x,M.y))),s.push(r,a,t),s.push(a,n,t)):R===S?(I=`${Math.min(n,t)} ${Math.max(n,t)}`,a=d[I],_(a)||(N=E.interpolateUsingFraction(.5,vc),C=.5*(v.height+T.height),P=Z.fromRadians(N.longitude,N.latitude,C,e,mc),c.push(P.x,P.y,P.z),a=c.length/3-1,d[I]=a,i&&(M=Ve.add(m,y,bc),Ve.multiplyByScalar(M,.5,M),l.push(M.x,M.y))),s.push(n,a,r),s.push(a,t,r)):A===S&&(I=`${Math.min(t,r)} ${Math.max(t,r)}`,a=d[I],_(a)||(N=w.interpolateUsingFraction(.5,vc),C=.5*(T.height+O.height),P=Z.fromRadians(N.longitude,N.latitude,C,e,mc),c.push(P.x,P.y,P.z),a=c.length/3-1,d[I]=a,i&&(M=Ve.add(y,p,bc),Ve.multiplyByScalar(M,.5,M),l.push(M.x,M.y))),s.push(t,a,n),s.push(a,r,n)):(h.push(r),h.push(n),h.push(t))}const v={attributes:{position:new rc({componentDatatype:O.DOUBLE,componentsPerAttribute:3,values:c})},indices:h,primitiveType:Hu.TRIANGLES};return i&&(v.attributes.st=new rc({componentDatatype:O.FLOAT,componentsPerAttribute:2,values:l})),new Wu(v)},uc.scaleToGeodeticHeight=function(e,t,n,r){n=y(n,ot.default);let o=sc,i=ac;if(t=y(t,0),r=y(r,!0),_(e)){const s=e.length;for(let a=0;a<s;a+=3)Z.fromArray(e,a,i),r&&(i=n.scaleToGeodeticSurface(i,i)),0!==t&&(o=n.geodeticSurfaceNormal(i,o),Z.multiplyByScalar(o,t,o),Z.add(i,o,i)),e[a]=i.x,e[a+1]=i.y,e[a+2]=i.z}return e};const Ac=/v(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Sc=/vn(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Ic=/vt(\s+[\d|\.|\+|\-|e|E]+)(\s+[\d|\.|\+|\-|e|E]+)/,Nc=/(-?\d+)\/?(-?\d*)\/?(-?\d*)/g,Cc=new Z;function Pc(e,t){const n=function(e,t){if("X"===e&&"Y"===t)return Ge.X_UP_TO_Y_UP;if("X"===e&&"Z"===t)return Ge.X_UP_TO_Z_UP;if("Y"===e&&"X"===t)return Ge.Y_UP_TO_X_UP;if("Y"===e&&"Z"===t)return Ge.Y_UP_TO_Z_UP;if("Z"===e&&"X"===t)return Ge.Z_UP_TO_X_UP;if("Z"===e&&"Y"===t)return Ge.Z_UP_TO_Y_UP}(t.inputUpAxis,t.outputUpAxis);let r,o,i,s,a=new w(O.FLOAT),u=new w(O.FLOAT),c=new w(O.FLOAT);const l=[];let f={};let p=0,d=0,g=[],b="";const E=[],v=[],T=[],x=[];function R(){f={},p=0}function A(e){return""===e?void 0:e}function I(e){r=new Tc,r.name=A(e),l.push(r),N()}function N(e){o=new xc,o.name=A(e),r.meshes.push(o),C()}function C(){i=new Rc,i.material=s,o.primitives.push(i),R(),d=0}function P(e){const t=o.primitives,n=t.length;for(let r=0;r<n;++r)if(t[r].material===s&&(!_(e)||e(t[r])))return i=t[r],R(),void(d=i.positions.length/3);C()}function M(e,t,n){const r=_(e[0]),o=_(t[0]),i=n.uvs.length>0,s=n.normals.length>0;return i===r&&s===o}function j(e,t,n){const r=parseInt(e);return r<0?t.length/n+r:r-1}function U(e,t,n){const r=e.length;for(let o=0;o<r;++o)0===e[o].length?e[o]=void 0:e[o]=j(e[o],t,n)}function F(e,t,n,r){let o=f[e];return _(o)||(o=d++,f[e]=o,function(e,t,n){if(_(e)&&a.length>0){if(3*e>=a.length)throw new Re(`Position index ${e} is out of bounds`);const t=a.get(3*e),n=a.get(3*e+1),r=a.get(3*e+2);i.positions.push(t),i.positions.push(n),i.positions.push(r)}if(_(n)&&u.length>0){if(3*n>=u.length)throw new Re(`Normal index ${n} is out of bounds`);const e=u.get(3*n),t=u.get(3*n+1),r=u.get(3*n+2);i.normals.push(e),i.normals.push(t),i.normals.push(r)}if(_(t)&&c.length>0){if(2*t>=c.length)throw new Re(`UV index ${t} is out of bounds`);const e=c.get(2*t),n=c.get(2*t+1);i.uvs.push(e),i.uvs.push(n)}}(t,n,r),p++,p>1e6&&R()),o}function q(e,t){const n=a.get(3*e),r=a.get(3*e+1),o=a.get(3*e+2);return Z.fromElements(n,r,o,t)}const L=new Z,D=new Z,B=new Z,k=new Z,G=new Z,V=new Z,H=new Z,W=new Z,X=new Z,$=[new Z,new Z,new Z,new Z],Y=[],Q=[];function K(e,t,n,r){if(!_(r))return!0;const o=function(e,t){const n=u.get(3*e),r=u.get(3*e+1),o=u.get(3*e+2);return Z.fromElements(n,r,o,t)}(r,X),i=q(e,L),s=q(t,D),a=q(n,B),c=Z.subtract(s,i,k),l=Z.subtract(a,i,G),f=Z.cross(c,l,B);return Z.dot(o,f)>=0}function J(e,t,n,r){r?(i.indices.push(e),i.indices.push(t),i.indices.push(n)):(i.indices.push(e),i.indices.push(n),i.indices.push(t))}function ee(e,t,n,r,o){if(U(t,a,3),U(r,u,3),U(n,c,2),function(e,t,n,r){const o=e.length;for(let i=0;i<o;++i)e[i]=`${y(t[i],"")}/${y(n[i],"")}/${y(r[i],"")}`}(e,t,n,r),function(e,t){0===i.indices.length||M(e,t,i)||P((function(n){return M(e,t,n)}))}(n,x),3===e.length){const i=!o||K(t[0],t[1],t[2],r[0]);J(F(e[0],t[0],n[0],r[0]),F(e[1],t[1],n[1],r[1]),F(e[2],t[2],n[2],r[2]),i)}else{const o=Q,i=Y;o.length=0,i.length=0;for(let s=0;s<e.length;++s){const a=F(e[s],t[s],n[s],r[s]);i.push(a),s===$.length&&$.push(new Z),o.push(q(t[s],$[s]))}if(!Qa.computeProjectTo2DArguments(o,V,H,W))return;const s=Qa.createProjectPointsTo2DFunction(V,H,W)(o),a=uc.triangulate(s),u=uc.computeWindingOrder2D(s)!==ic.CLOCKWISE;for(let e=0;e<a.length-2;e+=3)J(i[a[e]],i[a[e+1]],i[a[e+2]],u)}}return I(),S(e,(function(e){let r;if(0===(e=e.trim()).length||"#"===e.charAt(0));else if(/^o\s/i.test(e)){I(e.substring(2).trim())}else if(/^g\s/i.test(e)){N(e.substring(2).trim())}else if(/^usemtl/i.test(e)){const t=e.substring(7).trim();s=A(t),P()}else if(/^mtllib/i.test(e)){const t=e.substring(7).trim();g=g.concat(function(e){const t=[];e=e.replace(/^"(.+)"$/,"$1");const n=e.split(" "),r=n.length;let o=0;for(let e=0;e<r;++e){if(".mtl"!==h.extname(n[e]))continue;const r=n.slice(o,e+1).join(" ");t.push(r),o=e+1}return t}(t))}else if(null!==(r=Ac.exec(e))){const e=Cc;e.x=parseFloat(r[1]),e.y=parseFloat(r[2]),e.z=parseFloat(r[3]),_(n)&&Ae.multiplyByPoint(n,e,e),a.push(e.x),a.push(e.y),a.push(e.z)}else if(null!==(r=Sc.exec(e))){const e=Z.fromElements(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]),X);Z.equals(e,Z.ZERO)?Z.clone(Z.UNIT_Z,e):Z.normalize(e,e),_(n)&&Ae.multiplyByPointAsVector(n,e,e),u.push(e.x),u.push(e.y),u.push(e.z)}else if(null!==(r=Ic.exec(e)))c.push(parseFloat(r[1])),c.push(1-parseFloat(r[2]));else{if("\\"===e.slice(-1))return void(b+=e.substring(0,e.length-1));if(b+=e,"f "===b.substring(0,2)){for(;null!==(r=Nc.exec(b));)E.push(r[0]),v.push(r[1]),T.push(r[2]),x.push(r[3]);E.length>2&&ee(E,v,T,x,t.triangleWindingOrderSanitization),E.length=0,v.length=0,x.length=0,T.length=0}b=""}})).then((function(){return a=void 0,u=void 0,c=void 0,function(e,t,n,r,o){if(e=function(e){return e=function(e){const t=[],n=e.length;for(let r=0;r<n;++r){const n=e[r],o=Mc(n.meshes);if(0!==o.length)if(n.meshes=o,!_(n.name)&&jc(o)){const e=o.length;for(let n=0;n<e;++n){const e=o[n],r=new Tc;r.name=e.name,r.meshes=[e],t.push(r)}}else t.push(n)}return t}(e),function(e){const t={};Uc(e,"Node",t);const n=e.length;for(let r=0;r<n;++r){const n=e[r];Uc(n.meshes,`${n.name}-Mesh`,t)}}(e),e}(e),0===e.length)throw new Re(`${n} does not have any geometry data`);const i=h.basename(n,h.extname(n));return function(e,t,n){const r=h.dirname(t);let o=[];return e=e.filter((function(e,t,n){return n.indexOf(e)===t})),m.Promise.map(e,(function(e){const t=h.join(r,h.basename(e));return z(t,n).then((function(e){o=o.concat(e)})).catch((function(e){n.logger(e.message),n.logger(`Could not read material file at ${t}. Using default material instead.`)}))}),{concurrency:10}).then((function(){return o}))}(t,n,o).then((function(t){return t.length>0&&!r&&function(e,t){const n=t[0].name,r=e.length;for(let t=0;t<r;++t){const r=e[t].meshes,o=r.length;for(let e=0;e<o;++e){const t=r[e].primitives,o=t.length;for(let e=0;e<o;++e){const r=t[e];r.material=y(r.material,n)}}}}(e,t),function(e,t){const n=t.find((function(e){return 0===e.name.length}));if(!_(n))return;const r=e.length;for(let t=0;t<r;++t){const r=e[t].meshes,o=r.length;for(let e=0;e<o;++e){const t=r[e].primitives,o=t.length;for(let e=0;e<o;++e){const r=t[e];_(r.material)||(r.material=n.name)}}}}(e,t),{nodes:e,materials:t,name:i}}))}(l,g,e,_(s),t)}))}function Mc(e){return e.filter((function(e){return e.primitives=e.primitives.filter((function(e){return e.indices.length>0&&e.positions.length>0})),e.primitives.length>0}))}function jc(e){const t=e.length;for(let n=0;n<t;++n)if(_(e[n].name))return!0;return!1}function Uc(e,t,n){const r=e.length;for(let o=0;o<r;++o){const r=e[o];let i=y(r.name,t);const s=n[i];_(s)?(n[i]++,i=`${i}_${s}`):n[i]=1,r.name=i}}const Fc=z.getDefaultMaterial;function qc(e,t){const n=e.nodes;let r=e.materials;const o=e.name;r=function(e,t,n){const r=[],o={},i=e.length;for(let s=0;s<i;++s){const i=e[s].meshes,a=i.length;for(let e=0;e<a;++e){const s=i[e].primitives,a=s.length;for(let e=0;e<a;++e){const i=s[e],a=i.uvs.length>0,u={hasUvs:a,hasNormals:i.normals.length>0},c=y(i.material,"default"),l=Xc(c,u,o);i.material=l,o[l]=u;let f=Hc(r,l);if(_(f))continue;const p=Hc(t,c);f=_(p)?kc(p,!a):Fc(n),f.name=l,r.push(f)}}}return r}(n,r,t);const i={accessors:[],asset:{},buffers:[],bufferViews:[],extensionsUsed:[],extensionsRequired:[],images:[],materials:[],meshes:[],nodes:[],samplers:[],scene:0,scenes:[],textures:[]};i.asset={generator:"obj2gltf",version:"2.0"},i.scenes.push({nodes:[]});const s={positionBuffers:[],normalBuffers:[],uvBuffers:[],indexBuffers:[],positionAccessors:[],normalAccessors:[],uvAccessors:[],indexAccessors:[]},a=function(e){const t=e.length;for(let n=0;n<t;++n){const t=e[n].meshes,r=t.length;for(let e=0;e<r;++e){const n=t[e].primitives,r=n.length;for(let e=0;e<r;++e){if(n[e].positions.length/3>65534)return!0}}}return!1}(n),u=n.length;for(let e=0;e<u;++e){const o=n[e],u=o.meshes,c=u.length;if(1===c){const e=Zc(i,r,s,a,u[0],t);Qc(i,o.name,e,void 0)}else{const e=Qc(i,o.name);for(let n=0;n<c;++n){const o=u[n],c=Zc(i,r,s,a,o,t);Qc(i,o.name,c,e)}}}return i.images.length>0&&i.samplers.push({wrapS:b.REPEAT,wrapT:b.REPEAT}),function(e,t,n,r){const o=t.positionBuffers.concat(t.normalBuffers,t.uvBuffers,t.indexBuffers),i=o.length;let s=0;for(let e=0;e<i;++e)s+=o[e].length;r?function(e,t,n){Bc(e,t.positionBuffers,t.positionAccessors,12,b.ARRAY_BUFFER,n),Bc(e,t.normalBuffers,t.normalAccessors,12,b.ARRAY_BUFFER,n),Bc(e,t.uvBuffers,t.uvAccessors,8,b.ARRAY_BUFFER,n),Bc(e,t.indexBuffers,t.indexAccessors,void 0,b.ELEMENT_ARRAY_BUFFER,n)}(e,t,n):function(e,t,n){Lc(e,t.positionBuffers,t.positionAccessors,12,b.ARRAY_BUFFER),Lc(e,t.normalBuffers,t.normalAccessors,12,b.ARRAY_BUFFER),Lc(e,t.uvBuffers,t.uvAccessors,8,b.ARRAY_BUFFER),Lc(e,t.indexBuffers,t.indexAccessors,void 0,b.ELEMENT_ARRAY_BUFFER);let r=[];r=r.concat(t.positionBuffers,t.normalBuffers,t.uvBuffers,t.indexBuffers);const o=function(e){const t=e.length%4;if(0===t)return e;const n=0===t?0:4-t,r=Buffer.alloc(n);return Buffer.concat([e,r])}(Buffer.concat(r));e.buffers.push({name:n,byteLength:o.length,extras:{_obj2gltf:{source:o}}})}(e,t,n)}(i,s,o,t.separate),t.specularGlossiness&&(i.extensionsUsed.push("KHR_materials_pbrSpecularGlossiness"),i.extensionsRequired.push("KHR_materials_pbrSpecularGlossiness")),t.unlit&&(i.extensionsUsed.push("KHR_materials_unlit"),i.extensionsRequired.push("KHR_materials_unlit")),i}function Lc(e,t,n,r,o){const i=t.length;if(0===i)return;const s=e.bufferViews.length,a=e.bufferViews[s-1],u=_(a)?a.byteOffset+a.byteLength:0;let c=0;for(let r=0;r<i;++r){const o=e.accessors[n[r]];o.bufferView=s,o.byteOffset=c,c+=t[r].length}e.bufferViews.push({name:`bufferView_${s}`,buffer:0,byteLength:c,byteOffset:u,byteStride:r,target:o})}function Dc(e,t,n,r,o,i){const s=e.buffers.length,a=e.bufferViews.length;e.buffers.push({name:`${i}_${s}`,byteLength:t.length,extras:{_obj2gltf:{source:t}}}),e.bufferViews.push({buffer:s,byteLength:t.length,byteOffset:0,byteStride:r,target:o}),e.accessors[n].bufferView=a,e.accessors[n].byteOffset=0}function Bc(e,t,n,r,o,i){const s=t.length;for(let a=0;a<s;++a)Dc(e,t[a],n[a],r,o,i)}function zc(e,t){let n;const r=e.images,o=r.length;for(let e=0;e<o;++e)if(r[e].extras._obj2gltf===t){n=e;break}return _(n)||(n=function(e,t){const n=t.name,r=t.name,o=e.images.length,i=e.textures.length;return e.images.push({name:n,extras:{_obj2gltf:t}}),e.textures.push({name:r,sampler:0,source:o}),i}(e,t)),{index:n}}function kc(e,t){if("object"!=typeof e)return e;if(e instanceof T){if(t)return;return e}if(Array.isArray(e)){const n=e.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=kc(e[o],t);return r}const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=kc(e[r],t));return n}function Gc(e,t){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];r instanceof T?t[n]=zc(e,r):Array.isArray(r)||"object"!=typeof r||Gc(e,r)}}function Vc(e,t,n){Gc(e,t);const r=e.materials.length;return n.unlit&&(_(t.extensions)||(t.extensions={}),t.extensions.KHR_materials_unlit={}),e.materials.push(t),r}function Hc(e,t){const n=e.length;for(let r=0;r<n;++r)if(e[r].name===t)return e[r]}function Wc(e,t){return e.hasUvs===t.hasUvs&&e.hasNormals===t.hasNormals}function Xc(e,t,n){let r=e,o=2;for(;_(n[r])&&!Wc(t,n[r]);)r=`${e}-${o++}`;return r}function $c(e,t,n,r){const o=t.length/n,i=t.getMinMax(n),s=3===n?"VEC3":"VEC2",a={name:r,componentType:b.FLOAT,count:o,min:i.min,max:i.max,type:s},u=e.accessors.length;return e.accessors.push(a),u}function Yc(e,t,n,r,o,i,s,a){const u=i.positions.length>0,c=i.normals.length>0,l=i.uvs.length>0,f={};if(u){const t=$c(e,i.positions,3,`${o.name}_${s}_positions`);f.POSITION=t,n.positionBuffers.push(i.positions.toFloatBuffer()),n.positionAccessors.push(t)}if(c){const t=$c(e,i.normals,3,`${o.name}_${s}_normals`);f.NORMAL=t,n.normalBuffers.push(i.normals.toFloatBuffer()),n.normalAccessors.push(t)}if(l){const t=$c(e,i.uvs,2,`${o.name}_${s}_texcoords`);f.TEXCOORD_0=t,n.uvBuffers.push(i.uvs.toFloatBuffer()),n.uvAccessors.push(t)}const p=function(e,t,n,r){const o=n?b.UNSIGNED_INT:b.UNSIGNED_SHORT,i=t.length,s=t.getMinMax(1),a={name:r,componentType:o,count:i,min:s.min,max:s.max,type:"SCALAR"},u=e.accessors.length;return e.accessors.push(a),u}(e,i.indices,r,`${o.name}_${s}_indices`),h=r?i.indices.toUint32Buffer():i.indices.toUint16Buffer();n.indexBuffers.push(h),n.indexAccessors.push(p),i.positions=void 0,i.normals=void 0,i.uvs=void 0,i.indices=void 0;const d=function(e,t,n,r){const o=Hc(t,n);let i=function(e,t){const n=e.length;for(let r=0;r<n;++r)if(e[r].name===t)return r}(e.materials,n);return _(i)||(i=Vc(e,o,r)),i}(e,t,i.material,a);return{attributes:f,indices:p,material:d,mode:b.TRIANGLES}}function Zc(e,t,n,r,o,i){const s=[],a=o.primitives,u=a.length;for(let c=0;c<u;++c)s.push(Yc(e,t,n,r,o,a[c],c,i));const c={name:o.name,primitives:s},l=e.meshes.length;return e.meshes.push(c),l}function Qc(e,t,n,r){const o={name:t,mesh:n},i=e.nodes.length;if(e.nodes.push(o),_(r)){const t=e.nodes[r];_(t.children)||(t.children=[]),t.children.push(i)}else e.scenes[e.scene].nodes.push(i);return i}function Kc(e,t){return function(e){const t=[],n=e.images,r=n.length;for(let e=0;e<r;++e)t.push(Jc(n[e].extras._obj2gltf));return m.Promise.all(t)}(e).then((function(){const t=[];return t.push(function(e){const t=e.images;return m.Promise.map(t,(function(e){const t=e.extras._obj2gltf,n=e.name+t.extension;return e.uri=n,e}),{concurrency:10})}(e)),function(e){const t=e.buffers[0],n=t.extras._obj2gltf.source;if(n.length>201326580)throw new Re("Buffer is too large to embed in the glTF. Use the --separate flag instead.");t.uri=`data:application/octet-stream;base64,${n.toString("base64")}`}(e),m.Promise.all(t).then((function(){return function(e){const t=e.buffers,n=t.length;for(let e=0;e<n;++e)delete t[e].extras;const r=e.images,o=r.length;for(let e=0;e<o;++e)delete r[e].extras}(e),el(e),e}))}))}function Jc(e){if(!_(e.source)&&_(e.pixels)&&".png"===e.extension)return function(e){const t=new PNG({width:e.width,height:e.height,colorType:e.transparent?6:2,inputColorType:6,inputHasAlpha:!0});return t.data=e.pixels,new m.Promise((function(e,n){const r=[],o=t.pack();o.on("data",(function(e){r.push(e)})),o.on("end",(function(){e(Buffer.concat(r))})),o.on("error",n)}))}(e).then((function(t){e.source=t}))}function el(e){Object.keys(e).forEach((function(t){!_(e[t])||Array.isArray(e[t])&&0===e[t].length?delete e[t]:"object"==typeof e[t]&&el(e[t])}))}function tl(e,t){const n=tl.defaults;if((t=y(t,{})).binary=y(t.binary,n.binary),t.separate=y(t.separate,n.separate),t.separateTextures=y(t.separateTextures,n.separateTextures)||t.separate,t.checkTransparency=y(t.checkTransparency,n.checkTransparency),t.doubleSidedMaterial=y(t.doubleSidedMaterial,n.doubleSidedMaterial),t.secure=y(t.secure,n.secure),t.packOcclusion=y(t.packOcclusion,n.packOcclusion),t.metallicRoughness=y(t.metallicRoughness,n.metallicRoughness),t.specularGlossiness=y(t.specularGlossiness,n.specularGlossiness),t.unlit=y(t.unlit,n.unlit),t.overridingTextures=y(t.overridingTextures,y.EMPTY_OBJECT),t.logger=y(t.logger,(function(e){console.log(e)})),t.inputUpAxis=y(t.inputUpAxis,n.inputUpAxis),t.outputUpAxis=y(t.outputUpAxis,n.outputUpAxis),t.triangleWindingOrderSanitization=y(t.triangleWindingOrderSanitization,n.triangleWindingOrderSanitization),!_(e))throw new g("objPath is required");if(t.metallicRoughness+t.specularGlossiness+t.unlit>1)throw new g("Only one material type may be set from [metallicRoughness, specularGlossiness, unlit].");if(_(t.overridingTextures.metallicRoughnessOcclusionTexture)&&_(t.overridingTextures.specularGlossinessTexture))throw new g("metallicRoughnessOcclusionTexture and specularGlossinessTexture cannot both be defined.");return _(t.overridingTextures.metallicRoughnessOcclusionTexture)&&(t.metallicRoughness=!0,t.specularGlossiness=!1,t.packOcclusion=!0),_(t.overridingTextures.specularGlossinessTexture)&&(t.metallicRoughness=!1,t.specularGlossiness=!0),Pc(e,t).then((function(e){return qc(e,t)})).then((function(e){return Kc(e)}))}tl.defaults={binary:!1,separate:!1,separateTextures:!1,checkTransparency:!1,doubleSidedMaterial:!1,secure:!1,packOcclusion:!1,metallicRoughness:!1,specularGlossiness:!1,unlit:!1,inputUpAxis:"Y",outputUpAxis:"Y",windingOrderSanitization:!1};export{tl as default};
